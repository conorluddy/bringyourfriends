<!DOCTYPE html>

<html>
<head>
  <title>jquery.mobile-1.4.2.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="friends.html">
                friends.js
              </a>
            
              
              <a class="source" href="init.html">
                init.js
              </a>
            
              
              <a class="source" href="notifications.html">
                notifications.js
              </a>
            
              
              <a class="source" href="setMsg.html">
                setMsg.js
              </a>
            
              
              <a class="source" href="story.html">
                story.js
              </a>
            
              
              <a class="source" href="trip.html">
                trip.js
              </a>
            
              
              <a class="source" href="liftapp.html">
                liftapp.js
              </a>
            
              
              <a class="source" href="locate.html">
                locate.js
              </a>
            
              
              <a class="source" href="marker.html">
                marker.js
              </a>
            
              
              <a class="source" href="directions.html">
                directions.js
              </a>
            
              
              <a class="source" href="initialise.html">
                initialise.js
              </a>
            
              
              <a class="source" href="styles.html">
                styles.js
              </a>
            
              
              <a class="source" href="helper.html">
                helper.js
              </a>
            
              
              <a class="source" href="plugins.html">
                plugins.js
              </a>
            
              
              <a class="source" href="coordinates.html">
                coordinates.js
              </a>
            
              
              <a class="source" href="friends.html">
                friends.js
              </a>
            
              
              <a class="source" href="invitees.html">
                invitees.js
              </a>
            
              
              <a class="source" href="marker.html">
                marker.js
              </a>
            
              
              <a class="source" href="message.html">
                message.js
              </a>
            
              
              <a class="source" href="notifications.html">
                notifications.js
              </a>
            
              
              <a class="source" href="trip.html">
                trip.js
              </a>
            
              
              <a class="source" href="ui.html">
                ui.js
              </a>
            
              
              <a class="source" href="jquery.mobile-1.4.2.html">
                jquery.mobile-1.4.2.js
              </a>
            
              
              <a class="source" href="jquery.mobile-1.4.2.min.html">
                jquery.mobile-1.4.2.min.js
              </a>
            
              
              <a class="source" href="modernizr-2.6.2.min.html">
                modernizr-2.6.2.min.js
              </a>
            
              
              <a class="source" href="zepto.min.html">
                zepto.min.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>jquery.mobile-1.4.2.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*!
* jQuery Mobile 1.4.2
* Git HEAD hash: 9d9a42a27d0c693e8b5569c3a10d771916af5045 &lt;&gt; Date: Fri Feb 28 2014 17:32:01 UTC
* http://jquerymobile.com
*
* Copyright 2010, 2014 jQuery Foundation, Inc. and other contributors
* Released under the MIT license.
* http://jquery.org/license
*
*/</span>


(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( root, doc, factory )</span> {</span>
	<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> define === <span class="hljs-string">"function"</span> &amp;&amp; define.amd ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>AMD. Register as an anonymous module.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		define( [ <span class="hljs-string">"jquery"</span> ], <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( $ )</span> {</span>
			factory( $, root, doc );
			<span class="hljs-keyword">return</span> $.mobile;
		});
	} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Browser globals</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		factory( root.jQuery, root, doc );
	}
}( <span class="hljs-keyword">this</span>, document, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( jQuery, window, document, undefined )</span> {</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $ )</span> {</span>
	$.mobile = {};
}( jQuery ));

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>
	$.extend( $.mobile, {</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Version of the jQuery Mobile Framework</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		version: <span class="hljs-string">"1.4.2"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Deprecated and no longer used in 1.4 remove in 1.5
Define the url parameter used for referencing widget-generated sub-pages.
Translates to example.html&amp;ui-page=subpageIdentifier
hash segment before &amp;ui-page= is used to make Ajax request</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		subPageUrlKey: <span class="hljs-string">"ui-page"</span>,

		hideUrlBar: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Keepnative Selector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		keepNative: <span class="hljs-string">":jqmData(role='none'), :jqmData(role='nojs')"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Deprecated in 1.4 remove in 1.5
Class assigned to page currently in view, and during transitions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		activePageClass: <span class="hljs-string">"ui-page-active"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Deprecated in 1.4 remove in 1.5
Class used for “active” button state, from CSS framework</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		activeBtnClass: <span class="hljs-string">"ui-btn-active"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Deprecated in 1.4 remove in 1.5
Class used for “focus” form element state, from CSS framework</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		focusClass: <span class="hljs-string">"ui-focus"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Automatically handle clicks and form submissions through Ajax, when same-domain</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		ajaxEnabled: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Automatically load and show pages based on location.hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		hashListeningEnabled: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>disable to prevent jquery from bothering with links</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		linkBindingEnabled: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Set default page transition - ‘none’ for no transitions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		defaultPageTransition: <span class="hljs-string">"fade"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Set maximum window width for transitions to apply - ‘false’ for no limit</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		maxTransitionWidth: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Minimum scroll distance that will be remembered when returning to a page
Deprecated remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		minScrollBack: <span class="hljs-number">0</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Set default dialog transition - ‘none’ for no transitions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		defaultDialogTransition: <span class="hljs-string">"pop"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Error response message - appears when an Ajax page request fails</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		pageLoadErrorMessage: <span class="hljs-string">"Error Loading Page"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>For error messages, which theme does the box uses?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		pageLoadErrorMessageTheme: <span class="hljs-string">"a"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>replace calls to window.history.back with phonegaps navigation helper
where it is provided on the window object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		phonegapNavigationEnabled: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>automatically initialize the DOM when it’s ready</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		autoInitializePage: <span class="hljs-literal">true</span>,

		pushStateEnabled: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>allows users to opt in to ignoring content by marking a parent element as
data-ignored</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		ignoreContentEnabled: <span class="hljs-literal">false</span>,

		buttonMarkup: {
			hoverDelay: <span class="hljs-number">200</span>
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>disable the alteration of the dynamic base tag or links in the case
that a dynamic base tag isn’t supported</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		dynamicBaseEnabled: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>default the property to remove dependency on assignment in init module</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		pageContainer: $(),</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>enable cross-domain page support</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		allowCrossDomainPages: <span class="hljs-literal">false</span>,

		dialogHashKey: <span class="hljs-string">"&amp;ui-state=dialog"</span>
	});
})( jQuery, <span class="hljs-keyword">this</span> );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>
	<span class="hljs-keyword">var</span> nsNormalizeDict = {},
		oldFind = $.find,
		rbrace = <span class="hljs-regexp">/(?:\{[\s\S]*\}|\[[\s\S]*\])$/</span>,
		jqmDataRE = <span class="hljs-regexp">/:jqmData\(([^)]*)\)/g</span>;

	$.extend( $.mobile, {</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Namespace used framework-wide for data-attrs. Default is no namespace</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		ns: <span class="hljs-string">""</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Retrieve an attribute from an element and perform some massaging of the value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		getAttribute: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( element, key )</span> {</span>
			<span class="hljs-keyword">var</span> data;

			element = element.jquery ? element[<span class="hljs-number">0</span>] : element;

			<span class="hljs-keyword">if</span> ( element &amp;&amp; element.getAttribute ) {
				data = element.getAttribute( <span class="hljs-string">"data-"</span> + $.mobile.ns + key );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Copied from core’s src/data.js:dataAttr()
Convert from a string to a proper data type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">try</span> {
				data = data === <span class="hljs-string">"true"</span> ? <span class="hljs-literal">true</span> :
					data === <span class="hljs-string">"false"</span> ? <span class="hljs-literal">false</span> :
					data === <span class="hljs-string">"null"</span> ? <span class="hljs-literal">null</span> :</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Only convert to a number if it doesn’t change the string</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					+data + <span class="hljs-string">""</span> === data ? +data :
					rbrace.test( data ) ? <span class="hljs-built_in">JSON</span>.parse( data ) :
					data;
			} <span class="hljs-keyword">catch</span>( err ) {}

			<span class="hljs-keyword">return</span> data;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Expose our cache for testing purposes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		nsNormalizeDict: nsNormalizeDict,</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Take a data attribute property, prepend the namespace
and then camel case the attribute string. Add the result
to our nsNormalizeDict so we don’t have to do this again.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		nsNormalize: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( prop )</span> {</span>
			<span class="hljs-keyword">return</span> nsNormalizeDict[ prop ] ||
				( nsNormalizeDict[ prop ] = $.camelCase( $.mobile.ns + prop ) );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Find the closest javascript page element to gather settings data jsperf test
<a href="http://jsperf.com/single-complex-selector-vs-many-complex-selectors/edit">http://jsperf.com/single-complex-selector-vs-many-complex-selectors/edit</a>
possibly naive, but it shows that the parsing overhead for <em>just</em> the page selector vs
the page and dialog selector is negligable. This could probably be speed up by
doing a similar parent node traversal to the one found in the inherited theme code above</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		closestPageData: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $target )</span> {</span>
			<span class="hljs-keyword">return</span> $target
				.closest( <span class="hljs-string">":jqmData(role='page'), :jqmData(role='dialog')"</span> )
				.data( <span class="hljs-string">"mobile-page"</span> );
		}

	});</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Mobile version of data and removeData and hasData methods
ensures all data is set and retrieved using jQuery Mobile’s data namespace</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.fn.jqmData = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( prop, value )</span> {</span>
		<span class="hljs-keyword">var</span> result;
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> prop !== <span class="hljs-string">"undefined"</span> ) {
			<span class="hljs-keyword">if</span> ( prop ) {
				prop = $.mobile.nsNormalize( prop );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>undefined is permitted as an explicit input for the second param
in this case it returns the value and does not set it to undefined</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">arguments</span>.length &lt; <span class="hljs-number">2</span> || value === <span class="hljs-literal">undefined</span> ) {
				result = <span class="hljs-keyword">this</span>.data( prop );
			} <span class="hljs-keyword">else</span> {
				result = <span class="hljs-keyword">this</span>.data( prop, value );
			}
		}
		<span class="hljs-keyword">return</span> result;
	};

	$.jqmData = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elem, prop, value )</span> {</span>
		<span class="hljs-keyword">var</span> result;
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> prop !== <span class="hljs-string">"undefined"</span> ) {
			result = $.data( elem, prop ? $.mobile.nsNormalize( prop ) : prop, value );
		}
		<span class="hljs-keyword">return</span> result;
	};

	$.fn.jqmRemoveData = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( prop )</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.removeData( $.mobile.nsNormalize( prop ) );
	};

	$.jqmRemoveData = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elem, prop )</span> {</span>
		<span class="hljs-keyword">return</span> $.removeData( elem, $.mobile.nsNormalize( prop ) );
	};

	$.find = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( selector, context, ret, extra )</span> {</span>
		<span class="hljs-keyword">if</span> ( selector.indexOf( <span class="hljs-string">":jqmData"</span> ) &gt; -<span class="hljs-number">1</span> ) {
			selector = selector.replace( jqmDataRE, <span class="hljs-string">"[data-"</span> + ( $.mobile.ns || <span class="hljs-string">""</span> ) + <span class="hljs-string">"$1]"</span> );
		}

		<span class="hljs-keyword">return</span> oldFind.call( <span class="hljs-keyword">this</span>, selector, context, ret, extra );
	};

	$.extend( $.find, oldFind );

})( jQuery, <span class="hljs-keyword">this</span> );

<span class="hljs-comment">/*!
 * jQuery UI Core c0ab71056b936627e8a7821f03c044aec6280a40
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> uuid = <span class="hljs-number">0</span>,
	runiqueId = <span class="hljs-regexp">/^ui-id-\d+$/</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>$.ui might exist from components with no dependencies, e.g., $.ui.position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.ui = $.ui || {};

$.extend( $.ui, {
	version: <span class="hljs-string">"c0ab71056b936627e8a7821f03c044aec6280a40"</span>,

	keyCode: {
		BACKSPACE: <span class="hljs-number">8</span>,
		COMMA: <span class="hljs-number">188</span>,
		DELETE: <span class="hljs-number">46</span>,
		DOWN: <span class="hljs-number">40</span>,
		END: <span class="hljs-number">35</span>,
		ENTER: <span class="hljs-number">13</span>,
		ESCAPE: <span class="hljs-number">27</span>,
		HOME: <span class="hljs-number">36</span>,
		LEFT: <span class="hljs-number">37</span>,
		PAGE_DOWN: <span class="hljs-number">34</span>,
		PAGE_UP: <span class="hljs-number">33</span>,
		PERIOD: <span class="hljs-number">190</span>,
		RIGHT: <span class="hljs-number">39</span>,
		SPACE: <span class="hljs-number">32</span>,
		TAB: <span class="hljs-number">9</span>,
		UP: <span class="hljs-number">38</span>
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>plugins</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.fn.extend({
	focus: (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( orig )</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( delay, fn )</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> delay === <span class="hljs-string">"number"</span> ?
				<span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">var</span> elem = <span class="hljs-keyword">this</span>;
					setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
						$( elem ).focus();
						<span class="hljs-keyword">if</span> ( fn ) {
							fn.call( elem );
						}
					}, delay );
				}) :
				orig.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		};
	})( $.fn.focus ),

	scrollParent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> scrollParent;
		<span class="hljs-keyword">if</span> (($.ui.ie &amp;&amp; (<span class="hljs-regexp">/(static|relative)/</span>).test(<span class="hljs-keyword">this</span>.css(<span class="hljs-string">"position"</span>))) || (<span class="hljs-regexp">/absolute/</span>).test(<span class="hljs-keyword">this</span>.css(<span class="hljs-string">"position"</span>))) {
			scrollParent = <span class="hljs-keyword">this</span>.parents().filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">return</span> (<span class="hljs-regexp">/(relative|absolute|fixed)/</span>).test($.css(<span class="hljs-keyword">this</span>,<span class="hljs-string">"position"</span>)) &amp;&amp; (<span class="hljs-regexp">/(auto|scroll)/</span>).test($.css(<span class="hljs-keyword">this</span>,<span class="hljs-string">"overflow"</span>)+$.css(<span class="hljs-keyword">this</span>,<span class="hljs-string">"overflow-y"</span>)+$.css(<span class="hljs-keyword">this</span>,<span class="hljs-string">"overflow-x"</span>));
			}).eq(<span class="hljs-number">0</span>);
		} <span class="hljs-keyword">else</span> {
			scrollParent = <span class="hljs-keyword">this</span>.parents().filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">return</span> (<span class="hljs-regexp">/(auto|scroll)/</span>).test($.css(<span class="hljs-keyword">this</span>,<span class="hljs-string">"overflow"</span>)+$.css(<span class="hljs-keyword">this</span>,<span class="hljs-string">"overflow-y"</span>)+$.css(<span class="hljs-keyword">this</span>,<span class="hljs-string">"overflow-x"</span>));
			}).eq(<span class="hljs-number">0</span>);
		}

		<span class="hljs-keyword">return</span> ( <span class="hljs-regexp">/fixed/</span> ).test( <span class="hljs-keyword">this</span>.css( <span class="hljs-string">"position"</span>) ) || !scrollParent.length ? $( <span class="hljs-keyword">this</span>[ <span class="hljs-number">0</span> ].ownerDocument || document ) : scrollParent;
	},

	uniqueId: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.id ) {
				<span class="hljs-keyword">this</span>.id = <span class="hljs-string">"ui-id-"</span> + (++uuid);
			}
		});
	},

	removeUniqueId: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( runiqueId.test( <span class="hljs-keyword">this</span>.id ) ) {
				$( <span class="hljs-keyword">this</span> ).removeAttr( <span class="hljs-string">"id"</span> );
			}
		});
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>selectors</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">focusable</span><span class="hljs-params">( element, isTabIndexNotNaN )</span> {</span>
	<span class="hljs-keyword">var</span> map, mapName, img,
		nodeName = element.nodeName.toLowerCase();
	<span class="hljs-keyword">if</span> ( <span class="hljs-string">"area"</span> === nodeName ) {
		map = element.parentNode;
		mapName = map.name;
		<span class="hljs-keyword">if</span> ( !element.href || !mapName || map.nodeName.toLowerCase() !== <span class="hljs-string">"map"</span> ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
		img = $( <span class="hljs-string">"img[usemap=#"</span> + mapName + <span class="hljs-string">"]"</span> )[<span class="hljs-number">0</span>];
		<span class="hljs-keyword">return</span> !!img &amp;&amp; visible( img );
	}
	<span class="hljs-keyword">return</span> ( <span class="hljs-regexp">/input|select|textarea|button|object/</span>.test( nodeName ) ?
		!element.disabled :
		<span class="hljs-string">"a"</span> === nodeName ?
			element.href || isTabIndexNotNaN :
			isTabIndexNotNaN) &amp;&amp;</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>the element and all of its ancestors must be visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		visible( element );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">visible</span><span class="hljs-params">( element )</span> {</span>
	<span class="hljs-keyword">return</span> $.expr.filters.visible( element ) &amp;&amp;
		!$( element ).parents().addBack().filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.css( <span class="hljs-keyword">this</span>, <span class="hljs-string">"visibility"</span> ) === <span class="hljs-string">"hidden"</span>;
		}).length;
}

$.extend( $.expr[ <span class="hljs-string">":"</span> ], {
	data: $.expr.createPseudo ?
		$.expr.createPseudo(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( dataName )</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elem )</span> {</span>
				<span class="hljs-keyword">return</span> !!$.data( elem, dataName );
			};
		}) :</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>support: jQuery &lt;1.8</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elem, i, match )</span> {</span>
			<span class="hljs-keyword">return</span> !!$.data( elem, match[ <span class="hljs-number">3</span> ] );
		},

	focusable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( element )</span> {</span>
		<span class="hljs-keyword">return</span> focusable( element, !<span class="hljs-built_in">isNaN</span>( $.attr( element, <span class="hljs-string">"tabindex"</span> ) ) );
	},

	tabbable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( element )</span> {</span>
		<span class="hljs-keyword">var</span> tabIndex = $.attr( element, <span class="hljs-string">"tabindex"</span> ),
			isTabIndexNaN = <span class="hljs-built_in">isNaN</span>( tabIndex );
		<span class="hljs-keyword">return</span> ( isTabIndexNaN || tabIndex &gt;= <span class="hljs-number">0</span> ) &amp;&amp; focusable( element, !isTabIndexNaN );
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>support: jQuery &lt;1.8</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> ( !$( <span class="hljs-string">"&lt;a&gt;"</span> ).outerWidth( <span class="hljs-number">1</span> ).jquery ) {
	$.each( [ <span class="hljs-string">"Width"</span>, <span class="hljs-string">"Height"</span> ], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( i, name )</span> {</span>
		<span class="hljs-keyword">var</span> side = name === <span class="hljs-string">"Width"</span> ? [ <span class="hljs-string">"Left"</span>, <span class="hljs-string">"Right"</span> ] : [ <span class="hljs-string">"Top"</span>, <span class="hljs-string">"Bottom"</span> ],
			type = name.toLowerCase(),
			orig = {
				innerWidth: $.fn.innerWidth,
				innerHeight: $.fn.innerHeight,
				outerWidth: $.fn.outerWidth,
				outerHeight: $.fn.outerHeight
			};

		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reduce</span><span class="hljs-params">( elem, size, border, margin )</span> {</span>
			$.each( side, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				size -= <span class="hljs-built_in">parseFloat</span>( $.css( elem, <span class="hljs-string">"padding"</span> + <span class="hljs-keyword">this</span> ) ) || <span class="hljs-number">0</span>;
				<span class="hljs-keyword">if</span> ( border ) {
					size -= <span class="hljs-built_in">parseFloat</span>( $.css( elem, <span class="hljs-string">"border"</span> + <span class="hljs-keyword">this</span> + <span class="hljs-string">"Width"</span> ) ) || <span class="hljs-number">0</span>;
				}
				<span class="hljs-keyword">if</span> ( margin ) {
					size -= <span class="hljs-built_in">parseFloat</span>( $.css( elem, <span class="hljs-string">"margin"</span> + <span class="hljs-keyword">this</span> ) ) || <span class="hljs-number">0</span>;
				}
			});
			<span class="hljs-keyword">return</span> size;
		}

		$.fn[ <span class="hljs-string">"inner"</span> + name ] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( size )</span> {</span>
			<span class="hljs-keyword">if</span> ( size === <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">return</span> orig[ <span class="hljs-string">"inner"</span> + name ].call( <span class="hljs-keyword">this</span> );
			}

			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( <span class="hljs-keyword">this</span> ).css( type, reduce( <span class="hljs-keyword">this</span>, size ) + <span class="hljs-string">"px"</span> );
			});
		};

		$.fn[ <span class="hljs-string">"outer"</span> + name] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( size, margin )</span> {</span>
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> size !== <span class="hljs-string">"number"</span> ) {
				<span class="hljs-keyword">return</span> orig[ <span class="hljs-string">"outer"</span> + name ].call( <span class="hljs-keyword">this</span>, size );
			}

			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( <span class="hljs-keyword">this</span>).css( type, reduce( <span class="hljs-keyword">this</span>, size, <span class="hljs-literal">true</span>, margin ) + <span class="hljs-string">"px"</span> );
			});
		};
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>support: jQuery &lt;1.8</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> ( !$.fn.addBack ) {
	$.fn.addBack = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( selector )</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.add( selector == <span class="hljs-literal">null</span> ?
			<span class="hljs-keyword">this</span>.prevObject : <span class="hljs-keyword">this</span>.prevObject.filter( selector )
		);
	};
}</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>support: jQuery 1.6.1, 1.6.2 (<a href="http://bugs.jquery.com/ticket/9413">http://bugs.jquery.com/ticket/9413</a>)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> ( $( <span class="hljs-string">"&lt;a&gt;"</span> ).data( <span class="hljs-string">"a-b"</span>, <span class="hljs-string">"a"</span> ).removeData( <span class="hljs-string">"a-b"</span> ).data( <span class="hljs-string">"a-b"</span> ) ) {
	$.fn.removeData = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( removeData )</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( key )</span> {</span>
			<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">arguments</span>.length ) {
				<span class="hljs-keyword">return</span> removeData.call( <span class="hljs-keyword">this</span>, $.camelCase( key ) );
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span> removeData.call( <span class="hljs-keyword">this</span> );
			}
		};
	})( $.fn.removeData );
}</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>deprecated</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.ui.ie = !!<span class="hljs-regexp">/msie [\w.]+/</span>.exec( navigator.userAgent.toLowerCase() );

$.support.selectstart = <span class="hljs-string">"onselectstart"</span> <span class="hljs-keyword">in</span> document.createElement( <span class="hljs-string">"div"</span> );
$.fn.extend({
	disableSelection: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.bind( ( $.support.selectstart ? <span class="hljs-string">"selectstart"</span> : <span class="hljs-string">"mousedown"</span> ) +
			<span class="hljs-string">".ui-disableSelection"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
				event.preventDefault();
			});
	},

	enableSelection: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.unbind( <span class="hljs-string">".ui-disableSelection"</span> );
	},

	zIndex: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( zIndex )</span> {</span>
		<span class="hljs-keyword">if</span> ( zIndex !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.css( <span class="hljs-string">"zIndex"</span>, zIndex );
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.length ) {
			<span class="hljs-keyword">var</span> elem = $( <span class="hljs-keyword">this</span>[ <span class="hljs-number">0</span> ] ), position, value;
			<span class="hljs-keyword">while</span> ( elem.length &amp;&amp; elem[ <span class="hljs-number">0</span> ] !== document ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Ignore z-index if position is set to a value where z-index is ignored by the browser
This makes behavior of this function consistent across browsers
WebKit always returns auto if the element is positioned</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				position = elem.css( <span class="hljs-string">"position"</span> );
				<span class="hljs-keyword">if</span> ( position === <span class="hljs-string">"absolute"</span> || position === <span class="hljs-string">"relative"</span> || position === <span class="hljs-string">"fixed"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>IE returns 0 when zIndex is not specified
other browsers return a string
we ignore the case of nested elements with an explicit value of 0</p>
<div style="z-index: -10;"><div style="z-index: 0;"></div></div>

            </div>
            
            <div class="content"><div class='highlight'><pre>					value = <span class="hljs-built_in">parseInt</span>( elem.css( <span class="hljs-string">"zIndex"</span> ), <span class="hljs-number">10</span> );
					<span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">isNaN</span>( value ) &amp;&amp; value !== <span class="hljs-number">0</span> ) {
						<span class="hljs-keyword">return</span> value;
					}
				}
				elem = elem.parent();
			}
		}

		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>$.ui.plugin is deprecated. Use $.widget() extensions instead.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.ui.plugin = {
	add: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( module, option, set )</span> {</span>
		<span class="hljs-keyword">var</span> i,
			proto = $.ui[ module ].prototype;
		<span class="hljs-keyword">for</span> ( i <span class="hljs-keyword">in</span> set ) {
			proto.plugins[ i ] = proto.plugins[ i ] || [];
			proto.plugins[ i ].push( [ option, set[ i ] ] );
		}
	},
	call: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( instance, name, args, allowDisconnected )</span> {</span>
		<span class="hljs-keyword">var</span> i,
			set = instance.plugins[ name ];

		<span class="hljs-keyword">if</span> ( !set ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( !allowDisconnected &amp;&amp; ( !instance.element[ <span class="hljs-number">0</span> ].parentNode || instance.element[ <span class="hljs-number">0</span> ].parentNode.nodeType === <span class="hljs-number">11</span> ) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; set.length; i++ ) {
			<span class="hljs-keyword">if</span> ( instance.options[ set[ i ][ <span class="hljs-number">0</span> ] ] ) {
				set[ i ][ <span class="hljs-number">1</span> ].apply( instance.element, args );
			}
		}
	}
};

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Subtract the height of external toolbars from the page height, if the page does not have
internal toolbars of the same type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> compensateToolbars = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( page, desiredHeight )</span> {</span>
		<span class="hljs-keyword">var</span> pageParent = page.parent(),
			toolbarsAffectingHeight = [],
			externalHeaders = pageParent.children( <span class="hljs-string">":jqmData(role='header')"</span> ),
			internalHeaders = page.children( <span class="hljs-string">":jqmData(role='header')"</span> ),
			externalFooters = pageParent.children( <span class="hljs-string">":jqmData(role='footer')"</span> ),
			internalFooters = page.children( <span class="hljs-string">":jqmData(role='footer')"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>If we have no internal headers, but we do have external headers, then their height
reduces the page height</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( internalHeaders.length === <span class="hljs-number">0</span> &amp;&amp; externalHeaders.length &gt; <span class="hljs-number">0</span> ) {
			toolbarsAffectingHeight = toolbarsAffectingHeight.concat( externalHeaders.toArray() );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>If we have no internal footers, but we do have external footers, then their height
reduces the page height</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( internalFooters.length === <span class="hljs-number">0</span> &amp;&amp; externalFooters.length &gt; <span class="hljs-number">0</span> ) {
			toolbarsAffectingHeight = toolbarsAffectingHeight.concat( externalFooters.toArray() );
		}

		$.each( toolbarsAffectingHeight, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index, value )</span> {</span>
			desiredHeight -= $( value ).outerHeight();
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Height must be at least zero</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max( <span class="hljs-number">0</span>, desiredHeight );
	};

	$.extend( $.mobile, {</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>define the window and the document objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		window: $( window ),
		document: $( document ),</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>TODO: Remove and use $.ui.keyCode directly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		keyCode: $.ui.keyCode,</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Place to store various widget extensions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		behaviors: {},</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Scroll page vertically: scroll to 0 to hide iOS address bar, or pass a Y value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		silentScroll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( ypos )</span> {</span>
			<span class="hljs-keyword">if</span> ( $.type( ypos ) !== <span class="hljs-string">"number"</span> ) {
				ypos = $.mobile.defaultHomeScroll;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>prevent scrollstart and scrollstop events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.event.special.scrollstart.enabled = <span class="hljs-literal">false</span>;

			setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				window.scrollTo( <span class="hljs-number">0</span>, ypos );
				$.mobile.document.trigger( <span class="hljs-string">"silentscroll"</span>, { x: <span class="hljs-number">0</span>, y: ypos });
			}, <span class="hljs-number">20</span> );

			setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$.event.special.scrollstart.enabled = <span class="hljs-literal">true</span>;
			}, <span class="hljs-number">150</span> );
		},

		getClosestBaseUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( ele )</span>	{</span></pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Find the closest page and extract out its url.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> url = $( ele ).closest( <span class="hljs-string">".ui-page"</span> ).jqmData( <span class="hljs-string">"url"</span> ),
				base = $.mobile.path.documentBase.hrefNoHash;

			<span class="hljs-keyword">if</span> ( !$.mobile.dynamicBaseEnabled || !url || !$.mobile.path.isPath( url ) ) {
				url = base;
			}

			<span class="hljs-keyword">return</span> $.mobile.path.makeUrlAbsolute( url, base );
		},
		removeActiveLinkClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( forceRemoval )</span> {</span>
			<span class="hljs-keyword">if</span> ( !!$.mobile.activeClickedLink &amp;&amp;
				( !$.mobile.activeClickedLink.closest( <span class="hljs-string">"."</span> + $.mobile.activePageClass ).length ||
					forceRemoval ) ) {

				$.mobile.activeClickedLink.removeClass( $.mobile.activeBtnClass );
			}
			$.mobile.activeClickedLink = <span class="hljs-literal">null</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>DEPRECATED in 1.4
Find the closest parent with a theme class on it. Note that
we are not using $.fn.closest() on purpose here because this
method gets called quite a bit and we need it to be as fast
as possible.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		getInheritedTheme: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( el, defaultTheme )</span> {</span>
			<span class="hljs-keyword">var</span> e = el[ <span class="hljs-number">0</span> ],
				ltr = <span class="hljs-string">""</span>,
				re = <span class="hljs-regexp">/ui-(bar|body|overlay)-([a-z])\b/</span>,
				c, m;
			<span class="hljs-keyword">while</span> ( e ) {
				c = e.className || <span class="hljs-string">""</span>;
				<span class="hljs-keyword">if</span> ( c &amp;&amp; ( m = re.exec( c ) ) &amp;&amp; ( ltr = m[ <span class="hljs-number">2</span> ] ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>We found a parent with a theme class
on it so bail from this loop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">break</span>;
				}

				e = e.parentNode;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Return the theme letter we found, if none, return the
specified default.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> ltr || defaultTheme || <span class="hljs-string">"a"</span>;
		},

		enhanceable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elements )</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.haveParents( elements, <span class="hljs-string">"enhance"</span> );
		},

		hijackable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elements )</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.haveParents( elements, <span class="hljs-string">"ajax"</span> );
		},

		haveParents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elements, attr )</span> {</span>
			<span class="hljs-keyword">if</span> ( !$.mobile.ignoreContentEnabled ) {
				<span class="hljs-keyword">return</span> elements;
			}

			<span class="hljs-keyword">var</span> count = elements.length,
				$newSet = $(),
				e, $element, excluded,
				i, c;

			<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; count; i++ ) {
				$element = elements.eq( i );
				excluded = <span class="hljs-literal">false</span>;
				e = elements[ i ];

				<span class="hljs-keyword">while</span> ( e ) {
					c = e.getAttribute ? e.getAttribute( <span class="hljs-string">"data-"</span> + $.mobile.ns + attr ) : <span class="hljs-string">""</span>;

					<span class="hljs-keyword">if</span> ( c === <span class="hljs-string">"false"</span> ) {
						excluded = <span class="hljs-literal">true</span>;
						<span class="hljs-keyword">break</span>;
					}

					e = e.parentNode;
				}

				<span class="hljs-keyword">if</span> ( !excluded ) {
					$newSet = $newSet.add( $element );
				}
			}

			<span class="hljs-keyword">return</span> $newSet;
		},

		getScreenHeight: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Native innerHeight returns more accurate value for this across platforms,
jQuery version is here as a normalized fallback for platforms like Symbian</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> window.innerHeight || $.mobile.window.height();
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>simply set the active page’s minimum height to screen height, depending on orientation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		resetActivePageHeight: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( height )</span> {</span>
			<span class="hljs-keyword">var</span> page = $( <span class="hljs-string">"."</span> + $.mobile.activePageClass ),
				pageHeight = page.height(),
				pageOuterHeight = page.outerHeight( <span class="hljs-literal">true</span> );

			height = compensateToolbars( page,
				( <span class="hljs-keyword">typeof</span> height === <span class="hljs-string">"number"</span> ) ? height : $.mobile.getScreenHeight() );

			page.css( <span class="hljs-string">"min-height"</span>, height - ( pageOuterHeight - pageHeight ) );
		},

		loading: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>If this is the first call to this function, instantiate a loader widget</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> loader = <span class="hljs-keyword">this</span>.loading._widget || $( $.mobile.loader.prototype.defaultHtml ).loader(),</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Call the appropriate method on the loader</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				returnValue = loader.loader.apply( loader, <span class="hljs-built_in">arguments</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Make sure the loader is retained for future calls to this function.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.loading._widget = loader;

			<span class="hljs-keyword">return</span> returnValue;
		}
	});

	$.addDependents = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elem, newDependents )</span> {</span>
		<span class="hljs-keyword">var</span> $elem = $( elem ),
			dependents = $elem.jqmData( <span class="hljs-string">"dependents"</span> ) || $();

		$elem.jqmData( <span class="hljs-string">"dependents"</span>, $( dependents ).add( newDependents ) );
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>plugins</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.fn.extend({
		removeWithDependents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$.removeWithDependents( <span class="hljs-keyword">this</span> );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Enhance child elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		enhanceWithin: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> index,
				widgetElements = {},
				keepNative = $.mobile.page.prototype.keepNativeSelector(),
				that = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>Add no js class to elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.mobile.nojs ) {
				$.mobile.nojs( <span class="hljs-keyword">this</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Bind links for ajax nav</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.mobile.links ) {
				$.mobile.links( <span class="hljs-keyword">this</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>Degrade inputs for styleing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.mobile.degradeInputsWithin ) {
				$.mobile.degradeInputsWithin( <span class="hljs-keyword">this</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>Run buttonmarkup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.fn.buttonMarkup ) {
				<span class="hljs-keyword">this</span>.find( $.fn.buttonMarkup.initSelector ).not( keepNative )
				.jqmEnhanceable().buttonMarkup();
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>Add classes for fieldContain</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.fn.fieldcontain ) {
				<span class="hljs-keyword">this</span>.find( <span class="hljs-string">":jqmData(role='fieldcontain')"</span> ).not( keepNative )
				.jqmEnhanceable().fieldcontain();
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Enhance widgets</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.each( $.mobile.widgets, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( name, constructor )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>If initSelector not false find elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( constructor.initSelector ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Filter elements that should not be enhanced based on parents</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">var</span> elements = $.mobile.enhanceable( that.find( constructor.initSelector ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>If any matching elements remain filter ones with keepNativeSelector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( elements.length &gt; <span class="hljs-number">0</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>$.mobile.page.prototype.keepNativeSelector is deprecated this is just for backcompat
Switch to $.mobile.keepNative in 1.5 which is just a value not a function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						elements = elements.not( keepNative );
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>Enhance whatever is left</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( elements.length &gt; <span class="hljs-number">0</span> ) {
						widgetElements[ constructor.prototype.widgetName ] = elements;
					}
				}
			});

			<span class="hljs-keyword">for</span> ( index <span class="hljs-keyword">in</span> widgetElements ) {
				widgetElements[ index ][ index ]();
			}

			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		},

		addDependents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( newDependents )</span> {</span>
			$.addDependents( <span class="hljs-keyword">this</span>, newDependents );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>note that this helper doesn’t attempt to handle the callback
or setting of an html element’s text, its only purpose is
to return the html encoded version of the text in all cases. (thus the name)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		getEncodedText: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $( <span class="hljs-string">"&lt;a&gt;"</span> ).text( <span class="hljs-keyword">this</span>.text() ).html();
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>fluent helper function for the mobile namespaced equivalent</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		jqmEnhanceable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.enhanceable( <span class="hljs-keyword">this</span> );
		},

		jqmHijackable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.hijackable( <span class="hljs-keyword">this</span> );
		}
	});

	$.removeWithDependents = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( nativeElement )</span> {</span>
		<span class="hljs-keyword">var</span> element = $( nativeElement );

		( element.jqmData( <span class="hljs-string">"dependents"</span> ) || $() ).remove();
		element.remove();
	};
	$.addDependents = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( nativeElement, newDependents )</span> {</span>
		<span class="hljs-keyword">var</span> element = $( nativeElement ),
			dependents = element.jqmData( <span class="hljs-string">"dependents"</span> ) || $();

		element.jqmData( <span class="hljs-string">"dependents"</span>, $( dependents ).add( newDependents ) );
	};

	$.find.matches = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( expr, set )</span> {</span>
		<span class="hljs-keyword">return</span> $.find( expr, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, set );
	};

	$.find.matchesSelector = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( node, expr )</span> {</span>
		<span class="hljs-keyword">return</span> $.find( expr, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, [ node ] ).length &gt; <span class="hljs-number">0</span>;
	};

})( jQuery, <span class="hljs-keyword">this</span> );


<span class="hljs-comment">/*!
 * jQuery UI Widget c0ab71056b936627e8a7821f03c044aec6280a40
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> uuid = <span class="hljs-number">0</span>,
	slice = <span class="hljs-built_in">Array</span>.prototype.slice,
	_cleanData = $.cleanData;
$.cleanData = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elems )</span> {</span>
	<span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, elem; (elem = elems[i]) != <span class="hljs-literal">null</span>; i++ ) {
		<span class="hljs-keyword">try</span> {
			$( elem ).triggerHandler( <span class="hljs-string">"remove"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p><a href="http://bugs.jquery.com/ticket/8235">http://bugs.jquery.com/ticket/8235</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">catch</span>( e ) {}
	}
	_cleanData( elems );
};

$.widget = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( name, base, prototype )</span> {</span>
	<span class="hljs-keyword">var</span> fullName, existingConstructor, constructor, basePrototype,</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p>proxiedPrototype allows the provided prototype to remain unmodified
so that it can be used as a mixin for multiple widgets (#8876)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		proxiedPrototype = {},
		namespace = name.split( <span class="hljs-string">"."</span> )[ <span class="hljs-number">0</span> ];

	name = name.split( <span class="hljs-string">"."</span> )[ <span class="hljs-number">1</span> ];
	fullName = namespace + <span class="hljs-string">"-"</span> + name;

	<span class="hljs-keyword">if</span> ( !prototype ) {
		prototype = base;
		base = $.Widget;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <p>create selector for plugin</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.expr[ <span class="hljs-string">":"</span> ][ fullName.toLowerCase() ] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elem )</span> {</span>
		<span class="hljs-keyword">return</span> !!$.data( elem, fullName );
	};

	$[ namespace ] = $[ namespace ] || {};
	existingConstructor = $[ namespace ][ name ];
	constructor = $[ namespace ][ name ] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options, element )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>allow instantiation without “new” keyword</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._createWidget ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> constructor( options, element );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p>allow instantiation without initializing for simple inheritance
must use “new” keyword (the code above always passes args)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">arguments</span>.length ) {
			<span class="hljs-keyword">this</span>._createWidget( options, element );
		}
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>extend with the existing constructor to carry over any static properties</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.extend( constructor, existingConstructor, {
		version: prototype.version,</pre></div></div>
            
        </li>
        
        
        <li id="section-85">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>copy the object used to create the prototype in case we need to
redefine the widget later</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_proto: $.extend( {}, prototype ),</pre></div></div>
            
        </li>
        
        
        <li id="section-86">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>track widgets that inherit from this widget in case this widget is
redefined after a widget inherits from it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_childConstructors: []
	});

	basePrototype = <span class="hljs-keyword">new</span> base();</pre></div></div>
            
        </li>
        
        
        <li id="section-87">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>we need to make the options hash a property directly on the new instance
otherwise we’ll modify the options hash on the prototype that we’re
inheriting from</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	basePrototype.options = $.widget.extend( {}, basePrototype.options );
	$.each( prototype, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( prop, value )</span> {</span>
		<span class="hljs-keyword">if</span> ( !$.isFunction( value ) ) {
			proxiedPrototype[ prop ] = value;
			<span class="hljs-keyword">return</span>;
		}
		proxiedPrototype[ prop ] = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> _super = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">return</span> base.prototype[ prop ].apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
				},
				_superApply = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( args )</span> {</span>
					<span class="hljs-keyword">return</span> base.prototype[ prop ].apply( <span class="hljs-keyword">this</span>, args );
				};
			<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> __super = <span class="hljs-keyword">this</span>._super,
					__superApply = <span class="hljs-keyword">this</span>._superApply,
					returnValue;

				<span class="hljs-keyword">this</span>._super = _super;
				<span class="hljs-keyword">this</span>._superApply = _superApply;

				returnValue = value.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

				<span class="hljs-keyword">this</span>._super = __super;
				<span class="hljs-keyword">this</span>._superApply = __superApply;

				<span class="hljs-keyword">return</span> returnValue;
			};
		})();
	});
	constructor.prototype = $.widget.extend( basePrototype, {</pre></div></div>
            
        </li>
        
        
        <li id="section-88">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>TODO: remove support for widgetEventPrefix
always use the name + a colon as the prefix, e.g., draggable:start
don’t prefix for widgets that aren’t DOM-based</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		widgetEventPrefix: existingConstructor ? (basePrototype.widgetEventPrefix || name) : name
	}, proxiedPrototype, {
		constructor: constructor,
		namespace: namespace,
		widgetName: name,
		widgetFullName: fullName
	});</pre></div></div>
            
        </li>
        
        
        <li id="section-89">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>If this widget is being redefined then we need to find all widgets that
are inheriting from it and redefine all of them so that they inherit from
the new version of this widget. We’re essentially trying to replace one
level in the prototype chain.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( existingConstructor ) {
		$.each( existingConstructor._childConstructors, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( i, child )</span> {</span>
			<span class="hljs-keyword">var</span> childPrototype = child.prototype;</pre></div></div>
            
        </li>
        
        
        <li id="section-90">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>redefine the child widget using the same prototype that was
originally used, but inherit from the new version of the base</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.widget( childPrototype.namespace + <span class="hljs-string">"."</span> + childPrototype.widgetName, constructor, child._proto );
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-91">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>remove the list of existing child constructors from the old constructor
so the old child constructors can be garbage collected</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">delete</span> existingConstructor._childConstructors;
	} <span class="hljs-keyword">else</span> {
		base._childConstructors.push( constructor );
	}

	$.widget.bridge( name, constructor );

	<span class="hljs-keyword">return</span> constructor;
};

$.widget.extend = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( target )</span> {</span>
	<span class="hljs-keyword">var</span> input = slice.call( <span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span> ),
		inputIndex = <span class="hljs-number">0</span>,
		inputLength = input.length,
		key,
		value;
	<span class="hljs-keyword">for</span> ( ; inputIndex &lt; inputLength; inputIndex++ ) {
		<span class="hljs-keyword">for</span> ( key <span class="hljs-keyword">in</span> input[ inputIndex ] ) {
			value = input[ inputIndex ][ key ];
			<span class="hljs-keyword">if</span> ( input[ inputIndex ].hasOwnProperty( key ) &amp;&amp; value !== <span class="hljs-literal">undefined</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-92">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>Clone objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( $.isPlainObject( value ) ) {
					target[ key ] = $.isPlainObject( target[ key ] ) ?
						$.widget.extend( {}, target[ key ], value ) :</pre></div></div>
            
        </li>
        
        
        <li id="section-93">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>Don’t extend strings, arrays, etc. with objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						$.widget.extend( {}, value );</pre></div></div>
            
        </li>
        
        
        <li id="section-94">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>Copy everything else by reference</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				} <span class="hljs-keyword">else</span> {
					target[ key ] = value;
				}
			}
		}
	}
	<span class="hljs-keyword">return</span> target;
};

$.widget.bridge = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( name, object )</span> {</span>
	<span class="hljs-keyword">var</span> fullName = object.prototype.widgetFullName || name;
	$.fn[ name ] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> isMethodCall = <span class="hljs-keyword">typeof</span> options === <span class="hljs-string">"string"</span>,
			args = slice.call( <span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span> ),
			returnValue = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-95">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>allow multiple hashes to be passed on init</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		options = !isMethodCall &amp;&amp; args.length ?
			$.widget.extend.apply( <span class="hljs-literal">null</span>, [ options ].concat(args) ) :
			options;

		<span class="hljs-keyword">if</span> ( isMethodCall ) {
			<span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> methodValue,
					instance = $.data( <span class="hljs-keyword">this</span>, fullName );
				<span class="hljs-keyword">if</span> ( options === <span class="hljs-string">"instance"</span> ) {
					returnValue = instance;
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
				<span class="hljs-keyword">if</span> ( !instance ) {
					<span class="hljs-keyword">return</span> $.error( <span class="hljs-string">"cannot call methods on "</span> + name + <span class="hljs-string">" prior to initialization; "</span> +
						<span class="hljs-string">"attempted to call method '"</span> + options + <span class="hljs-string">"'"</span> );
				}
				<span class="hljs-keyword">if</span> ( !$.isFunction( instance[options] ) || options.charAt( <span class="hljs-number">0</span> ) === <span class="hljs-string">"_"</span> ) {
					<span class="hljs-keyword">return</span> $.error( <span class="hljs-string">"no such method '"</span> + options + <span class="hljs-string">"' for "</span> + name + <span class="hljs-string">" widget instance"</span> );
				}
				methodValue = instance[ options ].apply( instance, args );
				<span class="hljs-keyword">if</span> ( methodValue !== instance &amp;&amp; methodValue !== <span class="hljs-literal">undefined</span> ) {
					returnValue = methodValue &amp;&amp; methodValue.jquery ?
						returnValue.pushStack( methodValue.get() ) :
						methodValue;
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
			});
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> instance = $.data( <span class="hljs-keyword">this</span>, fullName );
				<span class="hljs-keyword">if</span> ( instance ) {
					instance.option( options || {} )._init();
				} <span class="hljs-keyword">else</span> {
					$.data( <span class="hljs-keyword">this</span>, fullName, <span class="hljs-keyword">new</span> object( options, <span class="hljs-keyword">this</span> ) );
				}
			});
		}

		<span class="hljs-keyword">return</span> returnValue;
	};
};

$.Widget = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( <span class="hljs-comment">/* options, element */</span> )</span> {</span>};
$.Widget._childConstructors = [];

$.Widget.prototype = {
	widgetName: <span class="hljs-string">"widget"</span>,
	widgetEventPrefix: <span class="hljs-string">""</span>,
	defaultElement: <span class="hljs-string">"&lt;div&gt;"</span>,
	options: {
		disabled: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-96">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>callbacks</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		create: <span class="hljs-literal">null</span>
	},
	_createWidget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options, element )</span> {</span>
		element = $( element || <span class="hljs-keyword">this</span>.defaultElement || <span class="hljs-keyword">this</span> )[ <span class="hljs-number">0</span> ];
		<span class="hljs-keyword">this</span>.element = $( element );
		<span class="hljs-keyword">this</span>.uuid = uuid++;
		<span class="hljs-keyword">this</span>.eventNamespace = <span class="hljs-string">"."</span> + <span class="hljs-keyword">this</span>.widgetName + <span class="hljs-keyword">this</span>.uuid;
		<span class="hljs-keyword">this</span>.options = $.widget.extend( {},
			<span class="hljs-keyword">this</span>.options,
			<span class="hljs-keyword">this</span>._getCreateOptions(),
			options );

		<span class="hljs-keyword">this</span>.bindings = $();
		<span class="hljs-keyword">this</span>.hoverable = $();
		<span class="hljs-keyword">this</span>.focusable = $();

		<span class="hljs-keyword">if</span> ( element !== <span class="hljs-keyword">this</span> ) {
			$.data( element, <span class="hljs-keyword">this</span>.widgetFullName, <span class="hljs-keyword">this</span> );
			<span class="hljs-keyword">this</span>._on( <span class="hljs-literal">true</span>, <span class="hljs-keyword">this</span>.element, {
				remove: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
					<span class="hljs-keyword">if</span> ( event.target === element ) {
						<span class="hljs-keyword">this</span>.destroy();
					}
				}
			});
			<span class="hljs-keyword">this</span>.document = $( element.style ?</pre></div></div>
            
        </li>
        
        
        <li id="section-97">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>element within the document</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				element.ownerDocument :</pre></div></div>
            
        </li>
        
        
        <li id="section-98">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>element is window or document</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				element.document || element );
			<span class="hljs-keyword">this</span>.window = $( <span class="hljs-keyword">this</span>.document[<span class="hljs-number">0</span>].defaultView || <span class="hljs-keyword">this</span>.document[<span class="hljs-number">0</span>].parentWindow );
		}

		<span class="hljs-keyword">this</span>._create();
		<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"create"</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">this</span>._getCreateEventData() );
		<span class="hljs-keyword">this</span>._init();
	},
	_getCreateOptions: $.noop,
	_getCreateEventData: $.noop,
	_create: $.noop,
	_init: $.noop,

	destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._destroy();</pre></div></div>
            
        </li>
        
        
        <li id="section-99">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>we can probably remove the unbind calls in 2.0
all event bindings should go through this._on()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.element
			.unbind( <span class="hljs-keyword">this</span>.eventNamespace )
			.removeData( <span class="hljs-keyword">this</span>.widgetFullName )</pre></div></div>
            
        </li>
        
        
        <li id="section-100">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <p>support: jquery &lt;1.6.3
<a href="http://bugs.jquery.com/ticket/9413">http://bugs.jquery.com/ticket/9413</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			.removeData( $.camelCase( <span class="hljs-keyword">this</span>.widgetFullName ) );
		<span class="hljs-keyword">this</span>.widget()
			.unbind( <span class="hljs-keyword">this</span>.eventNamespace )
			.removeAttr( <span class="hljs-string">"aria-disabled"</span> )
			.removeClass(
				<span class="hljs-keyword">this</span>.widgetFullName + <span class="hljs-string">"-disabled "</span> +
				<span class="hljs-string">"ui-state-disabled"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-101">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>clean up events and states</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.bindings.unbind( <span class="hljs-keyword">this</span>.eventNamespace );
		<span class="hljs-keyword">this</span>.hoverable.removeClass( <span class="hljs-string">"ui-state-hover"</span> );
		<span class="hljs-keyword">this</span>.focusable.removeClass( <span class="hljs-string">"ui-state-focus"</span> );
	},
	_destroy: $.noop,

	widget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.element;
	},

	option: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( key, value )</span> {</span>
		<span class="hljs-keyword">var</span> options = key,
			parts,
			curOption,
			i;

		<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">arguments</span>.length === <span class="hljs-number">0</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-102">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>don’t return a reference to the internal hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> $.widget.extend( {}, <span class="hljs-keyword">this</span>.options );
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> key === <span class="hljs-string">"string"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-103">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <p>handle nested keys, e.g., “foo.bar” =&gt; { foo: { bar: <em>_</em> } }</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			options = {};
			parts = key.split( <span class="hljs-string">"."</span> );
			key = parts.shift();
			<span class="hljs-keyword">if</span> ( parts.length ) {
				curOption = options[ key ] = $.widget.extend( {}, <span class="hljs-keyword">this</span>.options[ key ] );
				<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; parts.length - <span class="hljs-number">1</span>; i++ ) {
					curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};
					curOption = curOption[ parts[ i ] ];
				}
				key = parts.pop();
				<span class="hljs-keyword">if</span> ( value === <span class="hljs-literal">undefined</span> ) {
					<span class="hljs-keyword">return</span> curOption[ key ] === <span class="hljs-literal">undefined</span> ? <span class="hljs-literal">null</span> : curOption[ key ];
				}
				curOption[ key ] = value;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">if</span> ( value === <span class="hljs-literal">undefined</span> ) {
					<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.options[ key ] === <span class="hljs-literal">undefined</span> ? <span class="hljs-literal">null</span> : <span class="hljs-keyword">this</span>.options[ key ];
				}
				options[ key ] = value;
			}
		}

		<span class="hljs-keyword">this</span>._setOptions( options );

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> key;

		<span class="hljs-keyword">for</span> ( key <span class="hljs-keyword">in</span> options ) {
			<span class="hljs-keyword">this</span>._setOption( key, options[ key ] );
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},
	_setOption: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( key, value )</span> {</span>
		<span class="hljs-keyword">this</span>.options[ key ] = value;

		<span class="hljs-keyword">if</span> ( key === <span class="hljs-string">"disabled"</span> ) {
			<span class="hljs-keyword">this</span>.widget()
				.toggleClass( <span class="hljs-keyword">this</span>.widgetFullName + <span class="hljs-string">"-disabled"</span>, !!value );
			<span class="hljs-keyword">this</span>.hoverable.removeClass( <span class="hljs-string">"ui-state-hover"</span> );
			<span class="hljs-keyword">this</span>.focusable.removeClass( <span class="hljs-string">"ui-state-focus"</span> );
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	enable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._setOptions({ disabled: <span class="hljs-literal">false</span> });
	},
	disable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._setOptions({ disabled: <span class="hljs-literal">true</span> });
	},

	_on: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( suppressDisabledCheck, element, handlers )</span> {</span>
		<span class="hljs-keyword">var</span> delegateElement,
			instance = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-104">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <p>no suppressDisabledCheck flag, shuffle arguments</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> suppressDisabledCheck !== <span class="hljs-string">"boolean"</span> ) {
			handlers = element;
			element = suppressDisabledCheck;
			suppressDisabledCheck = <span class="hljs-literal">false</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-105">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <p>no element argument, shuffle and use this.element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !handlers ) {
			handlers = element;
			element = <span class="hljs-keyword">this</span>.element;
			delegateElement = <span class="hljs-keyword">this</span>.widget();
		} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-106">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              <p>accept selectors, DOM elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			element = delegateElement = $( element );
			<span class="hljs-keyword">this</span>.bindings = <span class="hljs-keyword">this</span>.bindings.add( element );
		}

		$.each( handlers, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event, handler )</span> {</span>
			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handlerProxy</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-107">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>allow widgets to customize the disabled handling</p>
<ul>
<li>disabled as an array instead of boolean</li>
<li>disabled class as method for disabling individual parts</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !suppressDisabledCheck &amp;&amp;
						( instance.options.disabled === <span class="hljs-literal">true</span> ||
							$( <span class="hljs-keyword">this</span> ).hasClass( <span class="hljs-string">"ui-state-disabled"</span> ) ) ) {
					<span class="hljs-keyword">return</span>;
				}
				<span class="hljs-keyword">return</span> ( <span class="hljs-keyword">typeof</span> handler === <span class="hljs-string">"string"</span> ? instance[ handler ] : handler )
					.apply( instance, <span class="hljs-built_in">arguments</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-108">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <p>copy the guid so direct unbinding works</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> handler !== <span class="hljs-string">"string"</span> ) {
				handlerProxy.guid = handler.guid =
					handler.guid || handlerProxy.guid || $.guid++;
			}

			<span class="hljs-keyword">var</span> match = event.match( <span class="hljs-regexp">/^(\w+)\s*(.*)$/</span> ),
				eventName = match[<span class="hljs-number">1</span>] + instance.eventNamespace,
				selector = match[<span class="hljs-number">2</span>];
			<span class="hljs-keyword">if</span> ( selector ) {
				delegateElement.delegate( selector, eventName, handlerProxy );
			} <span class="hljs-keyword">else</span> {
				element.bind( eventName, handlerProxy );
			}
		});
	},

	_off: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( element, eventName )</span> {</span>
		eventName = (eventName || <span class="hljs-string">""</span>).split( <span class="hljs-string">" "</span> ).join( <span class="hljs-keyword">this</span>.eventNamespace + <span class="hljs-string">" "</span> ) + <span class="hljs-keyword">this</span>.eventNamespace;
		element.unbind( eventName ).undelegate( eventName );
	},

	_delay: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( handler, delay )</span> {</span>
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handlerProxy</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> ( <span class="hljs-keyword">typeof</span> handler === <span class="hljs-string">"string"</span> ? instance[ handler ] : handler )
				.apply( instance, <span class="hljs-built_in">arguments</span> );
		}
		<span class="hljs-keyword">var</span> instance = <span class="hljs-keyword">this</span>;
		<span class="hljs-keyword">return</span> setTimeout( handlerProxy, delay || <span class="hljs-number">0</span> );
	},

	_hoverable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( element )</span> {</span>
		<span class="hljs-keyword">this</span>.hoverable = <span class="hljs-keyword">this</span>.hoverable.add( element );
		<span class="hljs-keyword">this</span>._on( element, {
			mouseenter: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
				$( event.currentTarget ).addClass( <span class="hljs-string">"ui-state-hover"</span> );
			},
			mouseleave: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
				$( event.currentTarget ).removeClass( <span class="hljs-string">"ui-state-hover"</span> );
			}
		});
	},

	_focusable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( element )</span> {</span>
		<span class="hljs-keyword">this</span>.focusable = <span class="hljs-keyword">this</span>.focusable.add( element );
		<span class="hljs-keyword">this</span>._on( element, {
			focusin: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
				$( event.currentTarget ).addClass( <span class="hljs-string">"ui-state-focus"</span> );
			},
			focusout: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
				$( event.currentTarget ).removeClass( <span class="hljs-string">"ui-state-focus"</span> );
			}
		});
	},

	_trigger: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( type, event, data )</span> {</span>
		<span class="hljs-keyword">var</span> prop, orig,
			callback = <span class="hljs-keyword">this</span>.options[ type ];

		data = data || {};
		event = $.Event( event );
		event.type = ( type === <span class="hljs-keyword">this</span>.widgetEventPrefix ?
			type :
			<span class="hljs-keyword">this</span>.widgetEventPrefix + type ).toLowerCase();</pre></div></div>
            
        </li>
        
        
        <li id="section-109">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>the original event may come from any element
so we need to reset the target on the new event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		event.target = <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ];</pre></div></div>
            
        </li>
        
        
        <li id="section-110">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <p>copy original event properties over to the new event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		orig = event.originalEvent;
		<span class="hljs-keyword">if</span> ( orig ) {
			<span class="hljs-keyword">for</span> ( prop <span class="hljs-keyword">in</span> orig ) {
				<span class="hljs-keyword">if</span> ( !( prop <span class="hljs-keyword">in</span> event ) ) {
					event[ prop ] = orig[ prop ];
				}
			}
		}

		<span class="hljs-keyword">this</span>.element.trigger( event, data );
		<span class="hljs-keyword">return</span> !( $.isFunction( callback ) &amp;&amp;
			callback.apply( <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>], [ event ].concat( data ) ) === <span class="hljs-literal">false</span> ||
			event.isDefaultPrevented() );
	}
};

$.each( { show: <span class="hljs-string">"fadeIn"</span>, hide: <span class="hljs-string">"fadeOut"</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( method, defaultEffect )</span> {</span>
	$.Widget.prototype[ <span class="hljs-string">"_"</span> + method ] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( element, options, callback )</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> options === <span class="hljs-string">"string"</span> ) {
			options = { effect: options };
		}
		<span class="hljs-keyword">var</span> hasOptions,
			effectName = !options ?
				method :
				options === <span class="hljs-literal">true</span> || <span class="hljs-keyword">typeof</span> options === <span class="hljs-string">"number"</span> ?
					defaultEffect :
					options.effect || defaultEffect;
		options = options || {};
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> options === <span class="hljs-string">"number"</span> ) {
			options = { duration: options };
		}
		hasOptions = !$.isEmptyObject( options );
		options.complete = callback;
		<span class="hljs-keyword">if</span> ( options.delay ) {
			element.delay( options.delay );
		}
		<span class="hljs-keyword">if</span> ( hasOptions &amp;&amp; $.effects &amp;&amp; $.effects.effect[ effectName ] ) {
			element[ method ]( options );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( effectName !== method &amp;&amp; element[ effectName ] ) {
			element[ effectName ]( options.duration, options.easing, callback );
		} <span class="hljs-keyword">else</span> {
			element.queue(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( next )</span> {</span>
				$( <span class="hljs-keyword">this</span> )[ method ]();
				<span class="hljs-keyword">if</span> ( callback ) {
					callback.call( element[ <span class="hljs-number">0</span> ] );
				}
				next();
			});
		}
	};
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> rcapitals = <span class="hljs-regexp">/[A-Z]/g</span>,
	replaceFunction = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( c )</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-string">"-"</span> + c.toLowerCase();
	};

$.extend( $.Widget.prototype, {
	_getCreateOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> option, value,
			elem = <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ],
			options = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-111">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !$.mobile.getAttribute( elem, <span class="hljs-string">"defaults"</span> ) ) {
			<span class="hljs-keyword">for</span> ( option <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.options ) {
				value = $.mobile.getAttribute( elem, option.replace( rcapitals, replaceFunction ) );

				<span class="hljs-keyword">if</span> ( value != <span class="hljs-literal">null</span> ) {
					options[ option ] = value;
				}
			}
		}

		<span class="hljs-keyword">return</span> options;
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-112">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>TODO: Remove in 1.5 for backcompat only</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.widget = $.Widget;

})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $ )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-113">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>TODO move loader class down into the widget settings</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> loaderClass = <span class="hljs-string">"ui-loader"</span>, $html = $( <span class="hljs-string">"html"</span> );

	$.widget( <span class="hljs-string">"mobile.loader"</span>, {</pre></div></div>
            
        </li>
        
        
        <li id="section-114">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>NOTE if the global config settings are defined they will override these
     options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		options: {</pre></div></div>
            
        </li>
        
        
        <li id="section-115">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <p>the theme for the loading message</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			theme: <span class="hljs-string">"a"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-116">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>whether the text in the loading message is shown</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			textVisible: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-117">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <p>custom html for the inner content of the loading message</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			html: <span class="hljs-string">""</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-118">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              <p>the text to be displayed when the popup is shown</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			text: <span class="hljs-string">"loading"</span>
		},

		defaultHtml: <span class="hljs-string">"&lt;div class='"</span> + loaderClass + <span class="hljs-string">"'&gt;"</span> +
			<span class="hljs-string">"&lt;span class='ui-icon-loading'&gt;&lt;/span&gt;"</span> +
			<span class="hljs-string">"&lt;h1&gt;&lt;/h1&gt;"</span> +
			<span class="hljs-string">"&lt;/div&gt;"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-119">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>For non-fixed supportin browsers. Position at y center (if scrollTop supported), above the activeBtn (if defined), or just 100px from top</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		fakeFixLoader: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> activeBtn = $( <span class="hljs-string">"."</span> + $.mobile.activeBtnClass ).first();

			<span class="hljs-keyword">this</span>.element
				.css({
					top: $.support.scrollTop &amp;&amp; <span class="hljs-keyword">this</span>.window.scrollTop() + <span class="hljs-keyword">this</span>.window.height() / <span class="hljs-number">2</span> ||
						activeBtn.length &amp;&amp; activeBtn.offset().top || <span class="hljs-number">100</span>
				});
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-120">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <p>check position of loader to see if it appears to be “fixed” to center
if not, use abs positioning</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		checkLoaderPosition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> offset = <span class="hljs-keyword">this</span>.element.offset(),
				scrollTop = <span class="hljs-keyword">this</span>.window.scrollTop(),
				screenHeight = $.mobile.getScreenHeight();

			<span class="hljs-keyword">if</span> ( offset.top &lt; scrollTop || ( offset.top - scrollTop ) &gt; screenHeight ) {
				<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-string">"ui-loader-fakefix"</span> );
				<span class="hljs-keyword">this</span>.fakeFixLoader();
				<span class="hljs-keyword">this</span>.window
					.unbind( <span class="hljs-string">"scroll"</span>, <span class="hljs-keyword">this</span>.checkLoaderPosition )
					.bind( <span class="hljs-string">"scroll"</span>, $.proxy( <span class="hljs-keyword">this</span>.fakeFixLoader, <span class="hljs-keyword">this</span> ) );
			}
		},

		resetHtml: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element.html( $( <span class="hljs-keyword">this</span>.defaultHtml ).html() );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-121">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <p>Turn on/off page loading message. Theme doubles as an object argument
with the following shape: { theme: ‘’, text: ‘’, html: ‘’, textVisible: ‘’ }
NOTE that the $.mobile.loading* settings and params past the first are deprecated
TODO sweet jesus we need to break some of this out</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		show: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theme, msgText, textonly )</span> {</span>
			<span class="hljs-keyword">var</span> textVisible, message, loadSettings;

			<span class="hljs-keyword">this</span>.resetHtml();</pre></div></div>
            
        </li>
        
        
        <li id="section-122">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <p>use the prototype options so that people can set them globally at
mobile init. Consistency, it’s what’s for dinner</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.type( theme ) === <span class="hljs-string">"object"</span> ) {
				loadSettings = $.extend( {}, <span class="hljs-keyword">this</span>.options, theme );

				theme = loadSettings.theme;
			} <span class="hljs-keyword">else</span> {
				loadSettings = <span class="hljs-keyword">this</span>.options;</pre></div></div>
            
        </li>
        
        
        <li id="section-123">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-123">&#182;</a>
              </div>
              <p>here we prefer the theme value passed as a string argument, then
we prefer the global option because we can’t use undefined default
prototype options, then the prototype option</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				theme = theme || loadSettings.theme;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-124">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-124">&#182;</a>
              </div>
              <p>set the message text, prefer the param, then the settings object
then loading message</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			message = msgText || ( loadSettings.text === <span class="hljs-literal">false</span> ? <span class="hljs-string">""</span> : loadSettings.text );</pre></div></div>
            
        </li>
        
        
        <li id="section-125">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-125">&#182;</a>
              </div>
              <p>prepare the dom</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$html.addClass( <span class="hljs-string">"ui-loading"</span> );

			textVisible = loadSettings.textVisible;</pre></div></div>
            
        </li>
        
        
        <li id="section-126">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-126">&#182;</a>
              </div>
              <p>add the proper css given the options (theme, text, etc)
Force text visibility if the second argument was supplied, or
if the text was explicitly set in the object args</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element.attr(<span class="hljs-string">"class"</span>, loaderClass +
				<span class="hljs-string">" ui-corner-all ui-body-"</span> + theme +
				<span class="hljs-string">" ui-loader-"</span> + ( textVisible || msgText || theme.text ? <span class="hljs-string">"verbose"</span> : <span class="hljs-string">"default"</span> ) +
				( loadSettings.textonly || textonly ? <span class="hljs-string">" ui-loader-textonly"</span> : <span class="hljs-string">""</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-127">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-127">&#182;</a>
              </div>
              <p>TODO verify that jquery.fn.html is ok to use in both cases here
     this might be overly defensive in preventing unknowing xss
if the html attribute is defined on the loading settings, use that
otherwise use the fallbacks from above</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( loadSettings.html ) {
				<span class="hljs-keyword">this</span>.element.html( loadSettings.html );
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"h1"</span> ).text( message );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-128">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-128">&#182;</a>
              </div>
              <p>attach the loader to the DOM</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element.appendTo( $.mobile.pageContainer );</pre></div></div>
            
        </li>
        
        
        <li id="section-129">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-129">&#182;</a>
              </div>
              <p>check that the loader is visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.checkLoaderPosition();</pre></div></div>
            
        </li>
        
        
        <li id="section-130">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-130">&#182;</a>
              </div>
              <p>on scroll check the loader position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.window.bind( <span class="hljs-string">"scroll"</span>, $.proxy( <span class="hljs-keyword">this</span>.checkLoaderPosition, <span class="hljs-keyword">this</span> ) );
		},

		hide: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$html.removeClass( <span class="hljs-string">"ui-loading"</span> );

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.text ) {
				<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-loader-fakefix"</span> );
			}

			$.mobile.window.unbind( <span class="hljs-string">"scroll"</span>, <span class="hljs-keyword">this</span>.fakeFixLoader );
			$.mobile.window.unbind( <span class="hljs-string">"scroll"</span>, <span class="hljs-keyword">this</span>.checkLoaderPosition );
		}
	});

})(jQuery, <span class="hljs-keyword">this</span>);


<span class="hljs-comment">/*!
 * jQuery hashchange event - v1.3 - 7/21/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-131">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-131">&#182;</a>
              </div>
              <p>Script: jQuery hashchange event</p>
<p><em>Version: 1.3, Last updated: 7/21/2010</em></p>
<p>Project Home - <a href="http://benalman.com/projects/jquery-hashchange-plugin/">http://benalman.com/projects/jquery-hashchange-plugin/</a>
GitHub       - <a href="http://github.com/cowboy/jquery-hashchange/">http://github.com/cowboy/jquery-hashchange/</a>
Source       - <a href="http://github.com/cowboy/jquery-hashchange/raw/master/jquery.ba-hashchange.js">http://github.com/cowboy/jquery-hashchange/raw/master/jquery.ba-hashchange.js</a>
(Minified)   - <a href="http://github.com/cowboy/jquery-hashchange/raw/master/jquery.ba-hashchange.min.js">http://github.com/cowboy/jquery-hashchange/raw/master/jquery.ba-hashchange.min.js</a> (0.8kb gzipped)</p>
<p>About: License</p>
<p>Copyright (c) 2010 “Cowboy” Ben Alman,
Dual licensed under the MIT and GPL licenses.
<a href="http://benalman.com/about/license/">http://benalman.com/about/license/</a></p>
<p>About: Examples</p>
<p>These working examples, complete with fully commented code, illustrate a few
ways in which this plugin can be used.</p>
<p>hashchange event - <a href="http://benalman.com/code/projects/jquery-hashchange/examples/hashchange/">http://benalman.com/code/projects/jquery-hashchange/examples/hashchange/</a>
document.domain - <a href="http://benalman.com/code/projects/jquery-hashchange/examples/document_domain/">http://benalman.com/code/projects/jquery-hashchange/examples/document_domain/</a></p>
<p>About: Support and Testing</p>
<p>Information about what version or versions of jQuery this plugin has been
tested with, what browsers it has been tested in, and where the unit tests
reside (so you can test it yourself).</p>
<p>jQuery Versions - 1.2.6, 1.3.2, 1.4.1, 1.4.2
Browsers Tested - Internet Explorer 6-8, Firefox 2-4, Chrome 5-6, Safari 3.2-5,
                  Opera 9.6-10.60, iPhone 3.1, Android 1.6-2.2, BlackBerry 4.6-5.
Unit Tests      - <a href="http://benalman.com/code/projects/jquery-hashchange/unit/">http://benalman.com/code/projects/jquery-hashchange/unit/</a></p>
<p>About: Known issues</p>
<p>While this jQuery hashchange event implementation is quite stable and
robust, there are a few unfortunate browser bugs surrounding expected
hashchange event-based behaviors, independent of any JavaScript
window.onhashchange abstraction. See the following examples for more
information:</p>
<p>Chrome: Back Button - <a href="http://benalman.com/code/projects/jquery-hashchange/examples/bug-chrome-back-button/">http://benalman.com/code/projects/jquery-hashchange/examples/bug-chrome-back-button/</a>
Firefox: Remote XMLHttpRequest - <a href="http://benalman.com/code/projects/jquery-hashchange/examples/bug-firefox-remote-xhr/">http://benalman.com/code/projects/jquery-hashchange/examples/bug-firefox-remote-xhr/</a>
WebKit: Back Button in an Iframe - <a href="http://benalman.com/code/projects/jquery-hashchange/examples/bug-webkit-hash-iframe/">http://benalman.com/code/projects/jquery-hashchange/examples/bug-webkit-hash-iframe/</a>
Safari: Back Button from a different domain - <a href="http://benalman.com/code/projects/jquery-hashchange/examples/bug-safari-back-from-diff-domain/">http://benalman.com/code/projects/jquery-hashchange/examples/bug-safari-back-from-diff-domain/</a></p>
<p>Also note that should a browser natively support the window.onhashchange 
event, but not report that it does, the fallback polling loop will be used.</p>
<p>About: Release History</p>
<p>1.3   - (7/21/2010) Reorganized IE6/7 Iframe code to make it more
        “removable” for mobile-only development. Added IE6/7 document.title
        support. Attempted to make Iframe as hidden as possible by using
        techniques from <a href="http://www.paciellogroup.com/blog/?p=604">http://www.paciellogroup.com/blog/?p=604</a>. Added 
        support for the “shortcut” format $(window).hashchange( fn ) and
        $(window).hashchange() like jQuery provides for built-in events.
        Renamed jQuery.hashchangeDelay to <jQuery.fn.hashchange.delay> and
        lowered its default value to 50. Added <jQuery.fn.hashchange.domain>
        and <jQuery.fn.hashchange.src> properties plus document-domain.html
        file to address access denied issues when setting document.domain in
        IE6/7.
1.2   - (2/11/2010) Fixed a bug where coming back to a page using this plugin
        from a page on another domain would cause an error in Safari 4. Also,
        IE6/7 Iframe is now inserted after the body (this actually works),
        which prevents the page from scrolling when the event is first bound.
        Event can also now be bound before DOM ready, but it won’t be usable
        before then in IE6/7.
1.1   - (1/21/2010) Incorporated document.documentMode test to fix IE8 bug
        where browser version is incorrectly reported as 8.0, despite
        inclusion of the X-UA-Compatible IE=EmulateIE7 meta tag.
1.0   - (1/9/2010) Initial Release. Broke out the jQuery BBQ event.special
        window.onhashchange functionality into a separate plugin for users
        who want just the basic event &amp; back button support, without all the
        extra awesomeness that BBQ provides. This plugin will be included as
        part of jQuery BBQ, but also be available separately.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($,window,undefined)</span>{</span>
  <span class="hljs-string">'$:nomunge'</span>; <span class="hljs-comment">// Used by YUI compressor.</span></pre></div></div>
            
        </li>
        
        
        <li id="section-132">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-132">&#182;</a>
              </div>
              <p>Reused string.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> str_hashchange = <span class="hljs-string">'hashchange'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-133">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-133">&#182;</a>
              </div>
              <p>Method / object references.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    doc = document,
    fake_onhashchange,
    special = $.event.special,</pre></div></div>
            
        </li>
        
        
        <li id="section-134">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-134">&#182;</a>
              </div>
              <p>Does the browser support window.onhashchange? Note that IE8 running in
IE7 compatibility mode reports true for ‘onhashchange’ in window, even
though the event isn’t supported, so also test document.documentMode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    doc_mode = doc.documentMode,
    supports_onhashchange = <span class="hljs-string">'on'</span> + str_hashchange <span class="hljs-keyword">in</span> window &amp;&amp; ( doc_mode === <span class="hljs-literal">undefined</span> || doc_mode &gt; <span class="hljs-number">7</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-135">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-135">&#182;</a>
              </div>
              <p>Get location.hash (or what you’d expect location.hash to be) sans any
leading #. Thanks for making this necessary, Firefox!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_fragment</span><span class="hljs-params">( url )</span> {</span>
    url = url || location.href;
    <span class="hljs-keyword">return</span> <span class="hljs-string">'#'</span> + url.replace( <span class="hljs-regexp">/^[^#]*#?(.*)$/</span>, <span class="hljs-string">'$1'</span> );
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-136">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-136">&#182;</a>
              </div>
              <p>Method: jQuery.fn.hashchange</p>
<p>Bind a handler to the window.onhashchange event or trigger all bound
window.onhashchange event handlers. This behavior is consistent with
jQuery’s built-in event handlers.</p>
<p>Usage:</p>
<blockquote>
<p>jQuery(window).hashchange( [ handler ] );</p>
</blockquote>
<p>Arguments:</p>
<p> handler - (Function) Optional handler to be bound to the hashchange
   event. This is a “shortcut” for the more verbose form:
   jQuery(window).bind( ‘hashchange’, handler ). If handler is omitted,
   all bound window.onhashchange event handlers will be triggered. This
   is a shortcut for the more verbose
   jQuery(window).trigger( ‘hashchange’ ). These forms are described in
   the <hashchange event> section.</p>
<p>Returns:</p>
<p> (jQuery) The initial jQuery collection of elements.</p>

            </div>
            
        </li>
        
        
        <li id="section-137">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-137">&#182;</a>
              </div>
              <p>Allow the “shortcut” format $(elem).hashchange( fn ) for binding and
$(elem).hashchange() for triggering, like jQuery does for built-in events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  $.fn[ str_hashchange ] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( fn )</span> {</span>
    <span class="hljs-keyword">return</span> fn ? <span class="hljs-keyword">this</span>.bind( str_hashchange, fn ) : <span class="hljs-keyword">this</span>.trigger( str_hashchange );
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-138">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-138">&#182;</a>
              </div>
              <p>Property: jQuery.fn.hashchange.delay</p>
<p>The numeric interval (in milliseconds) at which the <hashchange event>
polling loop executes. Defaults to 50.</p>

            </div>
            
        </li>
        
        
        <li id="section-139">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-139">&#182;</a>
              </div>
              <p>Property: jQuery.fn.hashchange.domain</p>
<p>If you’re setting document.domain in your JavaScript, and you want hash
history to work in IE6/7, not only must this property be set, but you must
also set document.domain BEFORE jQuery is loaded into the page. This
property is only applicable if you are supporting IE6/7 (or IE8 operating
in “IE7 compatibility” mode).</p>
<p>In addition, the <jQuery.fn.hashchange.src> property must be set to the
path of the included “document-domain.html” file, which can be renamed or
modified if necessary (note that the document.domain specified must be the
same in both your main JavaScript as well as in this file).</p>
<p>Usage:</p>
<p>jQuery.fn.hashchange.domain = document.domain;</p>

            </div>
            
        </li>
        
        
        <li id="section-140">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-140">&#182;</a>
              </div>
              <p>Property: jQuery.fn.hashchange.src</p>
<p>If, for some reason, you need to specify an Iframe src file (for example,
when setting document.domain as in <jQuery.fn.hashchange.domain>), you can
do so using this property. Note that when using this property, history
won’t be recorded in IE6/7 until the Iframe src file loads. This property
is only applicable if you are supporting IE6/7 (or IE8 operating in “IE7
compatibility” mode).</p>
<p>Usage:</p>
<p>jQuery.fn.hashchange.src = ‘path/to/file.html’;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  
  $.fn[ str_hashchange ].delay = <span class="hljs-number">50</span>;
  <span class="hljs-comment">/*
  $.fn[ str_hashchange ].domain = null;
  $.fn[ str_hashchange ].src = null;
  */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-141">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-141">&#182;</a>
              </div>
              <p>Event: hashchange event</p>
<p>Fired when location.hash changes. In browsers that support it, the native
HTML5 window.onhashchange event is used, otherwise a polling loop is
initialized, running every <jQuery.fn.hashchange.delay> milliseconds to
see if the hash has changed. In IE6/7 (and IE8 operating in “IE7
compatibility” mode), a hidden Iframe is created to allow the back button
and hash-based history to work.</p>
<p>Usage as described in <jQuery.fn.hashchange>:</p>
<blockquote>
<p>// Bind an event handler.
jQuery(window).hashchange( function(e) {
  var hash = location.hash;
  …
});</p>
<p>// Manually trigger the event handler.
jQuery(window).hashchange();</p>
</blockquote>
<p>A more verbose usage that allows for event namespacing:</p>
<blockquote>
<p>// Bind an event handler.
jQuery(window).bind( ‘hashchange’, function(e) {
  var hash = location.hash;
  …
});</p>
<p>// Manually trigger the event handler.
jQuery(window).trigger( ‘hashchange’ );</p>
</blockquote>
<p>Additional Notes:</p>
<ul>
<li>The polling loop and Iframe are not created until at least one handler
is actually bound to the ‘hashchange’ event.</li>
<li>If you need the bound handler(s) to execute immediately, in cases where
a location.hash exists on page load, via bookmark or page refresh for
example, use jQuery(window).hashchange() or the more verbose 
jQuery(window).trigger( ‘hashchange’ ).</li>
<li>The event can be bound before DOM ready, but since it won’t be usable
before then in IE6/7 (due to the necessary Iframe), recommended usage is
to bind it inside a DOM ready handler.</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-142">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-142">&#182;</a>
              </div>
              <p>Override existing $.event.special.hashchange methods (allowing this plugin
to be defined after jQuery BBQ in BBQ’s source code).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  special[ str_hashchange ] = $.extend( special[ str_hashchange ], {</pre></div></div>
            
        </li>
        
        
        <li id="section-143">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-143">&#182;</a>
              </div>
              <p>Called only when the first ‘hashchange’ event is bound to window.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-144">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-144">&#182;</a>
              </div>
              <p>If window.onhashchange is supported natively, there’s nothing to do..</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> ( supports_onhashchange ) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }</pre></div></div>
            
        </li>
        
        
        <li id="section-145">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-145">&#182;</a>
              </div>
              <p>Otherwise, we need to create our own. And we don’t want to call this
until the user binds to the event, just in case they never do, since it
will create a polling loop and possibly even a hidden Iframe.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      $( fake_onhashchange.start );
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-146">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-146">&#182;</a>
              </div>
              <p>Called only when the last ‘hashchange’ event is unbound from window.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    teardown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-147">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-147">&#182;</a>
              </div>
              <p>If window.onhashchange is supported natively, there’s nothing to do..</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> ( supports_onhashchange ) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }</pre></div></div>
            
        </li>
        
        
        <li id="section-148">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-148">&#182;</a>
              </div>
              <p>Otherwise, we need to stop ours (if possible).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      $( fake_onhashchange.stop );
    }
    
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-149">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-149">&#182;</a>
              </div>
              <p>fake_onhashchange does all the work of triggering the window.onhashchange
event for browsers that don’t natively support it, including creating a
polling loop to watch for hash changes and in IE 6/7 creating a hidden
Iframe to enable back and forward.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  fake_onhashchange = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
    <span class="hljs-keyword">var</span> self = {},
      timeout_id,</pre></div></div>
            
        </li>
        
        
        <li id="section-150">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-150">&#182;</a>
              </div>
              <p>Remember the initial hash so it doesn’t get triggered immediately.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      last_hash = get_fragment(),
      
      fn_retval = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(val)</span>{</span> <span class="hljs-keyword">return</span> val; },
      history_set = fn_retval,
      history_get = fn_retval;</pre></div></div>
            
        </li>
        
        
        <li id="section-151">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-151">&#182;</a>
              </div>
              <p>Start the polling loop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    self.start = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
      timeout_id || poll();
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-152">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-152">&#182;</a>
              </div>
              <p>Stop the polling loop.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    self.stop = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
      timeout_id &amp;&amp; clearTimeout( timeout_id );
      timeout_id = <span class="hljs-literal">undefined</span>;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-153">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-153">&#182;</a>
              </div>
              <p>This polling loop checks every $.fn.hashchange.delay milliseconds to see
if location.hash has changed, and triggers the ‘hashchange’ event on
window when necessary.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">poll</span><span class="hljs-params">()</span> {</span>
      <span class="hljs-keyword">var</span> hash = get_fragment(),
        history_hash = history_get( last_hash );
      
      <span class="hljs-keyword">if</span> ( hash !== last_hash ) {
        history_set( last_hash = hash, history_hash );
        
        $(window).trigger( str_hashchange );
        
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( history_hash !== last_hash ) {
        location.href = location.href.replace( <span class="hljs-regexp">/#.*/</span>, <span class="hljs-string">''</span> ) + history_hash;
      }
      
      timeout_id = setTimeout( poll, $.fn[ str_hashchange ].delay );
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-154">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-154">&#182;</a>
              </div>
              <p>vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
vvvvvvvvvvvvvvvvvvv REMOVE IF NOT SUPPORTING IE6/7/8 vvvvvvvvvvvvvvvvvvv
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    window.attachEvent &amp;&amp; !window.addEventListener &amp;&amp; !supports_onhashchange &amp;&amp; (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span></pre></div></div>
            
        </li>
        
        
        <li id="section-155">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-155">&#182;</a>
              </div>
              <p>Not only do IE6/7 need the “magical” Iframe treatment, but so does IE8
when running in “IE7 compatibility” mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      
      <span class="hljs-keyword">var</span> iframe,
        iframe_src;</pre></div></div>
            
        </li>
        
        
        <li id="section-156">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-156">&#182;</a>
              </div>
              <p>When the event is bound and polling starts in IE 6/7, create a hidden
Iframe for history handling.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      self.start = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
        <span class="hljs-keyword">if</span> ( !iframe ) {
          iframe_src = $.fn[ str_hashchange ].src;
          iframe_src = iframe_src &amp;&amp; iframe_src + get_fragment();</pre></div></div>
            
        </li>
        
        
        <li id="section-157">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-157">&#182;</a>
              </div>
              <p>Create hidden Iframe. Attempt to make Iframe as hidden as possible
by using techniques from <a href="http://www.paciellogroup.com/blog/?p=604">http://www.paciellogroup.com/blog/?p=604</a>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          iframe = $(<span class="hljs-string">'&lt;iframe tabindex="-1" title="empty"/&gt;'</span>).hide()</pre></div></div>
            
        </li>
        
        
        <li id="section-158">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-158">&#182;</a>
              </div>
              <p>When Iframe has completely loaded, initialize the history and
start polling.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            .one( <span class="hljs-string">'load'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
              iframe_src || history_set( get_fragment() );
              poll();
            })</pre></div></div>
            
        </li>
        
        
        <li id="section-159">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-159">&#182;</a>
              </div>
              <p>Load Iframe src if specified, otherwise nothing.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            .attr( <span class="hljs-string">'src'</span>, iframe_src || <span class="hljs-string">'javascript:0'</span> )</pre></div></div>
            
        </li>
        
        
        <li id="section-160">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-160">&#182;</a>
              </div>
              <p>Append Iframe after the end of the body to prevent unnecessary
initial page scrolling (yes, this works).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            .insertAfter( <span class="hljs-string">'body'</span> )[<span class="hljs-number">0</span>].contentWindow;</pre></div></div>
            
        </li>
        
        
        <li id="section-161">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-161">&#182;</a>
              </div>
              <p>Whenever <code>document.title</code> changes, update the Iframe’s title to
prettify the back/next history menu entries. Since IE sometimes
errors with “Unspecified error” the very first time this is set
(yes, very useful) wrap this with a try/catch block.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          doc.onpropertychange = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
            <span class="hljs-keyword">try</span> {
              <span class="hljs-keyword">if</span> ( event.propertyName === <span class="hljs-string">'title'</span> ) {
                iframe.document.title = doc.title;
              }
            } <span class="hljs-keyword">catch</span>(e) {}
          };
          
        }
      };</pre></div></div>
            
        </li>
        
        
        <li id="section-162">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-162">&#182;</a>
              </div>
              <p>Override the “stop” method since an IE6/7 Iframe was created. Even
if there are no longer any bound event handlers, the polling loop
is still necessary for back/next to work at all!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      self.stop = fn_retval;</pre></div></div>
            
        </li>
        
        
        <li id="section-163">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-163">&#182;</a>
              </div>
              <p>Get history by looking at the hidden Iframe’s location.hash.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      history_get = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
        <span class="hljs-keyword">return</span> get_fragment( iframe.location.href );
      };</pre></div></div>
            
        </li>
        
        
        <li id="section-164">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-164">&#182;</a>
              </div>
              <p>Set a new history item by opening and then closing the Iframe
document, <em>then</em> setting its location.hash. If document.domain has
been set, update that as well.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      history_set = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( hash, history_hash )</span> {</span>
        <span class="hljs-keyword">var</span> iframe_doc = iframe.document,
          domain = $.fn[ str_hashchange ].domain;
        
        <span class="hljs-keyword">if</span> ( hash !== history_hash ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-165">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-165">&#182;</a>
              </div>
              <p>Update Iframe with any initial <code>document.title</code> that might be set.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          iframe_doc.title = doc.title;</pre></div></div>
            
        </li>
        
        
        <li id="section-166">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-166">&#182;</a>
              </div>
              <p>Opening the Iframe’s document after it has been closed is what
actually adds a history entry.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          iframe_doc.open();</pre></div></div>
            
        </li>
        
        
        <li id="section-167">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-167">&#182;</a>
              </div>
              <p>Set document.domain for the Iframe document as well, if necessary.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          domain &amp;&amp; iframe_doc.write( <span class="hljs-string">'&lt;script&gt;document.domain="'</span> + domain + <span class="hljs-string">'"&lt;/script&gt;'</span> );
          
          iframe_doc.close();</pre></div></div>
            
        </li>
        
        
        <li id="section-168">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-168">&#182;</a>
              </div>
              <p>Update the Iframe’s hash, for great justice.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          iframe.location.hash = hash;
        }
      };
      
    })();</pre></div></div>
            
        </li>
        
        
        <li id="section-169">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-169">&#182;</a>
              </div>
              <p>^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^ REMOVE IF NOT SUPPORTING IE6/7/8 ^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    
    <span class="hljs-keyword">return</span> self;
  })();
  
})(jQuery,<span class="hljs-keyword">this</span>);

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

	<span class="hljs-comment">/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors &amp; copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */</span>
	window.matchMedia = window.matchMedia || (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( doc, undefined )</span> {</span>

		<span class="hljs-keyword">var</span> bool,
			docElem = doc.documentElement,
			refNode = docElem.firstElementChild || docElem.firstChild,</pre></div></div>
            
        </li>
        
        
        <li id="section-170">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-170">&#182;</a>
              </div>
              <p>fakeBody required for <FF4 when executed in <head></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			fakeBody = doc.createElement( <span class="hljs-string">"body"</span> ),
			div = doc.createElement( <span class="hljs-string">"div"</span> );

		div.id = <span class="hljs-string">"mq-test-1"</span>;
		div.style.cssText = <span class="hljs-string">"position:absolute;top:-100em"</span>;
		fakeBody.style.background = <span class="hljs-string">"none"</span>;
		fakeBody.appendChild(div);

		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(q)</span>{</span>

			div.innerHTML = <span class="hljs-string">"&amp;shy;&lt;style media=\""</span> + q + <span class="hljs-string">"\"&gt; #mq-test-1 { width: 42px; }&lt;/style&gt;"</span>;

			docElem.insertBefore( fakeBody, refNode );
			bool = div.offsetWidth === <span class="hljs-number">42</span>;
			docElem.removeChild( fakeBody );

			<span class="hljs-keyword">return</span> {
				matches: bool,
				media: q
			};

		};

	}( document ));</pre></div></div>
            
        </li>
        
        
        <li id="section-171">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-171">&#182;</a>
              </div>
              <p>$.mobile.media uses matchMedia to return a boolean.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.media = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( q )</span> {</span>
		<span class="hljs-keyword">return</span> window.matchMedia( q ).matches;
	};

})(jQuery);

	(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
		<span class="hljs-keyword">var</span> support = {
			touch: <span class="hljs-string">"ontouchend"</span> <span class="hljs-keyword">in</span> document
		};

		$.mobile.support = $.mobile.support || {};
		$.extend( $.support, support );
		$.extend( $.mobile.support, support );
	}( jQuery ));

	(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
		$.extend( $.support, {
			orientation: <span class="hljs-string">"orientation"</span> <span class="hljs-keyword">in</span> window &amp;&amp; <span class="hljs-string">"onorientationchange"</span> <span class="hljs-keyword">in</span> window
		});
	}( jQuery ));

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-172">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-172">&#182;</a>
              </div>
              <p>thx Modernizr</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">propExists</span><span class="hljs-params">( prop )</span> {</span>
	<span class="hljs-keyword">var</span> uc_prop = prop.charAt( <span class="hljs-number">0</span> ).toUpperCase() + prop.substr( <span class="hljs-number">1</span> ),
		props = ( prop + <span class="hljs-string">" "</span> + vendors.join( uc_prop + <span class="hljs-string">" "</span> ) + uc_prop ).split( <span class="hljs-string">" "</span> ),
		v;

	<span class="hljs-keyword">for</span> ( v <span class="hljs-keyword">in</span> props ) {
		<span class="hljs-keyword">if</span> ( fbCSS[ props[ v ] ] !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		}
	}
}

<span class="hljs-keyword">var</span> fakeBody = $( <span class="hljs-string">"&lt;body&gt;"</span> ).prependTo( <span class="hljs-string">"html"</span> ),
	fbCSS = fakeBody[ <span class="hljs-number">0</span> ].style,
	vendors = [ <span class="hljs-string">"Webkit"</span>, <span class="hljs-string">"Moz"</span>, <span class="hljs-string">"O"</span> ],
	webos = <span class="hljs-string">"palmGetResource"</span> <span class="hljs-keyword">in</span> window, <span class="hljs-comment">//only used to rule out scrollTop</span>
	operamini = window.operamini &amp;&amp; ({}).toString.call( window.operamini ) === <span class="hljs-string">"[object OperaMini]"</span>,
	bb = window.blackberry &amp;&amp; !propExists( <span class="hljs-string">"-webkit-transform"</span> ), <span class="hljs-comment">//only used to rule out box shadow, as it's filled opaque on BB 5 and lower</span>
	nokiaLTE7_3;</pre></div></div>
            
        </li>
        
        
        <li id="section-173">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-173">&#182;</a>
              </div>
              <p>inline SVG support test</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inlineSVG</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-174">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-174">&#182;</a>
              </div>
              <p>Thanks Modernizr &amp; Erik Dahlstrom</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> w = window,
		svg = !!w.document.createElementNS &amp;&amp; !!w.document.createElementNS( <span class="hljs-string">"http://www.w3.org/2000/svg"</span>, <span class="hljs-string">"svg"</span> ).createSVGRect &amp;&amp; !( w.opera &amp;&amp; navigator.userAgent.indexOf( <span class="hljs-string">"Chrome"</span> ) === -<span class="hljs-number">1</span> ),
		support = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( data )</span> {</span>
			<span class="hljs-keyword">if</span> ( !( data &amp;&amp; svg ) ) {
				$( <span class="hljs-string">"html"</span> ).addClass( <span class="hljs-string">"ui-nosvg"</span> );
			}
		},
		img = <span class="hljs-keyword">new</span> w.Image();

	img.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		support( <span class="hljs-literal">false</span> );
	};
	img.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		support( img.width === <span class="hljs-number">1</span> &amp;&amp; img.height === <span class="hljs-number">1</span> );
	};
	img.src = <span class="hljs-string">"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transform3dTest</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">var</span> mqProp = <span class="hljs-string">"transform-3d"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-175">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-175">&#182;</a>
              </div>
              <p>Because the <code>translate3d</code> test below throws false positives in Android:</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		ret = $.mobile.media( <span class="hljs-string">"(-"</span> + vendors.join( <span class="hljs-string">"-"</span> + mqProp + <span class="hljs-string">"),(-"</span> ) + <span class="hljs-string">"-"</span> + mqProp + <span class="hljs-string">"),("</span> + mqProp + <span class="hljs-string">")"</span> ),
		el, transforms, t;

	<span class="hljs-keyword">if</span> ( ret ) {
		<span class="hljs-keyword">return</span> !!ret;
	}

	el = document.createElement( <span class="hljs-string">"div"</span> );
	transforms = {</pre></div></div>
            
        </li>
        
        
        <li id="section-176">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-176">&#182;</a>
              </div>
              <p>We’re omitting Opera for the time being; MS uses unprefixed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-string">"MozTransform"</span>: <span class="hljs-string">"-moz-transform"</span>,
		<span class="hljs-string">"transform"</span>: <span class="hljs-string">"transform"</span>
	};

	fakeBody.append( el );

	<span class="hljs-keyword">for</span> ( t <span class="hljs-keyword">in</span> transforms ) {
		<span class="hljs-keyword">if</span> ( el.style[ t ] !== <span class="hljs-literal">undefined</span> ) {
			el.style[ t ] = <span class="hljs-string">"translate3d( 100px, 1px, 1px )"</span>;
			ret = window.getComputedStyle( el ).getPropertyValue( transforms[ t ] );
		}
	}
	<span class="hljs-keyword">return</span> ( !!ret &amp;&amp; ret !== <span class="hljs-string">"none"</span> );
}</pre></div></div>
            
        </li>
        
        
        <li id="section-177">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-177">&#182;</a>
              </div>
              <p>Test for dynamic-updating base tag support ( allows us to avoid href,src attr rewriting )</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">baseTagTest</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">var</span> fauxBase = location.protocol + <span class="hljs-string">"//"</span> + location.host + location.pathname + <span class="hljs-string">"ui-dir/"</span>,
		base = $( <span class="hljs-string">"head base"</span> ),
		fauxEle = <span class="hljs-literal">null</span>,
		href = <span class="hljs-string">""</span>,
		link, rebase;

	<span class="hljs-keyword">if</span> ( !base.length ) {
		base = fauxEle = $( <span class="hljs-string">"&lt;base&gt;"</span>, { <span class="hljs-string">"href"</span>: fauxBase }).appendTo( <span class="hljs-string">"head"</span> );
	} <span class="hljs-keyword">else</span> {
		href = base.attr( <span class="hljs-string">"href"</span> );
	}

	link = $( <span class="hljs-string">"&lt;a href='testurl' /&gt;"</span> ).prependTo( fakeBody );
	rebase = link[ <span class="hljs-number">0</span> ].href;
	base[ <span class="hljs-number">0</span> ].href = href || location.pathname;

	<span class="hljs-keyword">if</span> ( fauxEle ) {
		fauxEle.remove();
	}
	<span class="hljs-keyword">return</span> rebase.indexOf( fauxBase ) === <span class="hljs-number">0</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-178">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-178">&#182;</a>
              </div>
              <p>Thanks Modernizr</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cssPointerEventsTest</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">var</span> element = document.createElement( <span class="hljs-string">"x"</span> ),
		documentElement = document.documentElement,
		getComputedStyle = window.getComputedStyle,
		supports;

	<span class="hljs-keyword">if</span> ( !( <span class="hljs-string">"pointerEvents"</span> <span class="hljs-keyword">in</span> element.style ) ) {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	}

	element.style.pointerEvents = <span class="hljs-string">"auto"</span>;
	element.style.pointerEvents = <span class="hljs-string">"x"</span>;
	documentElement.appendChild( element );
	supports = getComputedStyle &amp;&amp;
	getComputedStyle( element, <span class="hljs-string">""</span> ).pointerEvents === <span class="hljs-string">"auto"</span>;
	documentElement.removeChild( element );
	<span class="hljs-keyword">return</span> !!supports;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boundingRect</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">var</span> div = document.createElement( <span class="hljs-string">"div"</span> );
	<span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> div.getBoundingClientRect !== <span class="hljs-string">"undefined"</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-179">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-179">&#182;</a>
              </div>
              <p>non-UA-based IE version check by James Padolsey, modified by jdalton - from <a href="http://gist.github.com/527683">http://gist.github.com/527683</a>
allows for inclusion of IE 6+, including Windows Mobile 7</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.extend( $.mobile, { browser: {} } );
$.mobile.browser.oldIE = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">var</span> v = <span class="hljs-number">3</span>,
		div = document.createElement( <span class="hljs-string">"div"</span> ),
		a = div.all || [];

	<span class="hljs-keyword">do</span> {
		div.innerHTML = <span class="hljs-string">"&lt;!--[if gt IE "</span> + ( ++v ) + <span class="hljs-string">"]&gt;&lt;br&gt;&lt;![endif]--&gt;"</span>;
	} <span class="hljs-keyword">while</span>( a[<span class="hljs-number">0</span>] );

	<span class="hljs-keyword">return</span> v &gt; <span class="hljs-number">4</span> ? v : !v;
})();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fixedPosition</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">var</span> w = window,
		ua = navigator.userAgent,
		platform = navigator.platform,</pre></div></div>
            
        </li>
        
        
        <li id="section-180">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-180">&#182;</a>
              </div>
              <p>Rendering engine is Webkit, and capture major version</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		wkmatch = ua.match( <span class="hljs-regexp">/AppleWebKit\/([0-9]+)/</span> ),
		wkversion = !!wkmatch &amp;&amp; wkmatch[ <span class="hljs-number">1</span> ],
		ffmatch = ua.match( <span class="hljs-regexp">/Fennec\/([0-9]+)/</span> ),
		ffversion = !!ffmatch &amp;&amp; ffmatch[ <span class="hljs-number">1</span> ],
		operammobilematch = ua.match( <span class="hljs-regexp">/Opera Mobi\/([0-9]+)/</span> ),
		omversion = !!operammobilematch &amp;&amp; operammobilematch[ <span class="hljs-number">1</span> ];

	<span class="hljs-keyword">if</span> (</pre></div></div>
            
        </li>
        
        
        <li id="section-181">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-181">&#182;</a>
              </div>
              <p>iOS 4.3 and older : Platform is iPhone/Pad/Touch and Webkit version is less than 534 (ios5)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		( ( platform.indexOf( <span class="hljs-string">"iPhone"</span> ) &gt; -<span class="hljs-number">1</span> || platform.indexOf( <span class="hljs-string">"iPad"</span> ) &gt; -<span class="hljs-number">1</span>  || platform.indexOf( <span class="hljs-string">"iPod"</span> ) &gt; -<span class="hljs-number">1</span> ) &amp;&amp; wkversion &amp;&amp; wkversion &lt; <span class="hljs-number">534</span> ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-182">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-182">&#182;</a>
              </div>
              <p>Opera Mini</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		( w.operamini &amp;&amp; ({}).toString.call( w.operamini ) === <span class="hljs-string">"[object OperaMini]"</span> ) ||
		( operammobilematch &amp;&amp; omversion &lt; <span class="hljs-number">7458</span> )	||</pre></div></div>
            
        </li>
        
        
        <li id="section-183">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-183">&#182;</a>
              </div>
              <p>Android lte 2.1: Platform is Android and Webkit version is less than 533 (Android 2.2)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		( ua.indexOf( <span class="hljs-string">"Android"</span> ) &gt; -<span class="hljs-number">1</span> &amp;&amp; wkversion &amp;&amp; wkversion &lt; <span class="hljs-number">533</span> ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-184">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-184">&#182;</a>
              </div>
              <p>Firefox Mobile before 6.0 -</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		( ffversion &amp;&amp; ffversion &lt; <span class="hljs-number">6</span> ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-185">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-185">&#182;</a>
              </div>
              <p>WebOS less than 3</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		( <span class="hljs-string">"palmGetResource"</span> <span class="hljs-keyword">in</span> window &amp;&amp; wkversion &amp;&amp; wkversion &lt; <span class="hljs-number">534</span> )	||</pre></div></div>
            
        </li>
        
        
        <li id="section-186">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-186">&#182;</a>
              </div>
              <p>MeeGo</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		( ua.indexOf( <span class="hljs-string">"MeeGo"</span> ) &gt; -<span class="hljs-number">1</span> &amp;&amp; ua.indexOf( <span class="hljs-string">"NokiaBrowser/8.5.0"</span> ) &gt; -<span class="hljs-number">1</span> ) ) {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	}

	<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

$.extend( $.support, {</pre></div></div>
            
        </li>
        
        
        <li id="section-187">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-187">&#182;</a>
              </div>
              <p>Note, Chrome for iOS has an extremely quirky implementation of popstate.
We’ve chosen to take the shortest path to a bug fix here for issue #5426
See the following link for information about the regex chosen
<a href="https://developers.google.com/chrome/mobile/docs/user-agent#chrome_for_ios_user-agent">https://developers.google.com/chrome/mobile/docs/user-agent#chrome_for_ios_user-agent</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	pushState: <span class="hljs-string">"pushState"</span> <span class="hljs-keyword">in</span> history &amp;&amp;
		<span class="hljs-string">"replaceState"</span> <span class="hljs-keyword">in</span> history &amp;&amp;</pre></div></div>
            
        </li>
        
        
        <li id="section-188">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-188">&#182;</a>
              </div>
              <p>When running inside a FF iframe, calling replaceState causes an error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		!( window.navigator.userAgent.indexOf( <span class="hljs-string">"Firefox"</span> ) &gt;= <span class="hljs-number">0</span> &amp;&amp; window.top !== window ) &amp;&amp;
		( window.navigator.userAgent.search(<span class="hljs-regexp">/CriOS/</span>) === -<span class="hljs-number">1</span> ),

	mediaquery: $.mobile.media( <span class="hljs-string">"only all"</span> ),
	cssPseudoElement: !!propExists( <span class="hljs-string">"content"</span> ),
	touchOverflow: !!propExists( <span class="hljs-string">"overflowScrolling"</span> ),
	cssTransform3d: transform3dTest(),
	boxShadow: !!propExists( <span class="hljs-string">"boxShadow"</span> ) &amp;&amp; !bb,
	fixedPosition: fixedPosition(),
	scrollTop: (<span class="hljs-string">"pageXOffset"</span> <span class="hljs-keyword">in</span> window ||
		<span class="hljs-string">"scrollTop"</span> <span class="hljs-keyword">in</span> document.documentElement ||
		<span class="hljs-string">"scrollTop"</span> <span class="hljs-keyword">in</span> fakeBody[ <span class="hljs-number">0</span> ]) &amp;&amp; !webos &amp;&amp; !operamini,

	dynamicBaseTag: baseTagTest(),
	cssPointerEvents: cssPointerEventsTest(),
	boundingRect: boundingRect(),
	inlineSVG: inlineSVG
});

fakeBody.remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-189">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-189">&#182;</a>
              </div>
              <p>$.mobile.ajaxBlacklist is used to override ajaxEnabled on platforms that have known conflicts with hash history updates (BB5, Symbian)
or that generally work better browsing in regular http for full page refreshes (Opera Mini)
Note: This detection below is used as a last resort.
We recommend only using these detection methods when all other more reliable/forward-looking approaches are not possible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>nokiaLTE7_3 = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

	<span class="hljs-keyword">var</span> ua = window.navigator.userAgent;</pre></div></div>
            
        </li>
        
        
        <li id="section-190">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-190">&#182;</a>
              </div>
              <p>The following is an attempt to match Nokia browsers that are running Symbian/s60, with webkit, version 7.3 or older</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">return</span> ua.indexOf( <span class="hljs-string">"Nokia"</span> ) &gt; -<span class="hljs-number">1</span> &amp;&amp;
			( ua.indexOf( <span class="hljs-string">"Symbian/3"</span> ) &gt; -<span class="hljs-number">1</span> || ua.indexOf( <span class="hljs-string">"Series60/5"</span> ) &gt; -<span class="hljs-number">1</span> ) &amp;&amp;
			ua.indexOf( <span class="hljs-string">"AppleWebKit"</span> ) &gt; -<span class="hljs-number">1</span> &amp;&amp;
			ua.match( <span class="hljs-regexp">/(BrowserNG|NokiaBrowser)\/7\.[0-3]/</span> );
})();</pre></div></div>
            
        </li>
        
        
        <li id="section-191">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-191">&#182;</a>
              </div>
              <p>Support conditions that must be met in order to proceed
default enhanced qualifications are media query support OR IE 7+</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
$.mobile.gradeA = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">return</span> ( ( $.support.mediaquery &amp;&amp; $.support.cssPseudoElement ) || $.mobile.browser.oldIE &amp;&amp; $.mobile.browser.oldIE &gt;= <span class="hljs-number">8</span> ) &amp;&amp; ( $.support.boundingRect || $.fn.jquery.match(<span class="hljs-regexp">/1\.[0-7+]\.[0-9+]?/</span>) !== <span class="hljs-literal">null</span> );
};

$.mobile.ajaxBlacklist =</pre></div></div>
            
        </li>
        
        
        <li id="section-192">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-192">&#182;</a>
              </div>
              <p>BlackBerry browsers, pre-webkit</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			window.blackberry &amp;&amp; !window.WebKitPoint ||</pre></div></div>
            
        </li>
        
        
        <li id="section-193">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-193">&#182;</a>
              </div>
              <p>Opera Mini</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			operamini ||</pre></div></div>
            
        </li>
        
        
        <li id="section-194">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-194">&#182;</a>
              </div>
              <p>Symbian webkits pre 7.3</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			nokiaLTE7_3;</pre></div></div>
            
        </li>
        
        
        <li id="section-195">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-195">&#182;</a>
              </div>
              <p>Lastly, this workaround is the only way we’ve found so far to get pre 7.3 Symbian webkit devices
to render the stylesheets when they’re referenced before this script, as we’d recommend doing.
This simply reappends the CSS in place, which for some reason makes it apply</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> ( nokiaLTE7_3 ) {
	$(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		$( <span class="hljs-string">"head link[rel='stylesheet']"</span> ).attr( <span class="hljs-string">"rel"</span>, <span class="hljs-string">"alternate stylesheet"</span> ).attr( <span class="hljs-string">"rel"</span>, <span class="hljs-string">"stylesheet"</span> );
	});
}</pre></div></div>
            
        </li>
        
        
        <li id="section-196">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-196">&#182;</a>
              </div>
              <p>For ruling out shadows via css</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> ( !$.support.boxShadow ) {
	$( <span class="hljs-string">"html"</span> ).addClass( <span class="hljs-string">"ui-noboxshadow"</span> );
}

})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
	<span class="hljs-keyword">var</span> $win = $.mobile.window, self,
		dummyFnToInitNavigate = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		};

	$.event.special.beforenavigate = {
		setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$win.on( <span class="hljs-string">"navigate"</span>, dummyFnToInitNavigate );
		},

		teardown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$win.off( <span class="hljs-string">"navigate"</span>, dummyFnToInitNavigate );
		}
	};

	$.event.special.navigate = self = {
		bound: <span class="hljs-literal">false</span>,

		pushStateEnabled: <span class="hljs-literal">true</span>,

		originalEventName: <span class="hljs-literal">undefined</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-197">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-197">&#182;</a>
              </div>
              <p>If pushstate support is present and push state support is defined to
be true on the mobile namespace.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		isPushStateEnabled: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.support.pushState &amp;&amp;
				$.mobile.pushStateEnabled === <span class="hljs-literal">true</span> &amp;&amp;
				<span class="hljs-keyword">this</span>.isHashChangeEnabled();
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-198">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-198">&#182;</a>
              </div>
              <p>!! assumes mobile namespace is present</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		isHashChangeEnabled: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.hashListeningEnabled === <span class="hljs-literal">true</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-199">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-199">&#182;</a>
              </div>
              <p>TODO a lot of duplication between popstate and hashchange</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		popstate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> newEvent = <span class="hljs-keyword">new</span> $.Event( <span class="hljs-string">"navigate"</span> ),
				beforeNavigate = <span class="hljs-keyword">new</span> $.Event( <span class="hljs-string">"beforenavigate"</span> ),
				state = event.originalEvent.state || {};

			beforeNavigate.originalEvent = event;
			$win.trigger( beforeNavigate );

			<span class="hljs-keyword">if</span> ( beforeNavigate.isDefaultPrevented() ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">if</span> ( event.historyState ) {
				$.extend(state, event.historyState);
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-200">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-200">&#182;</a>
              </div>
              <p>Make sure the original event is tracked for the end
user to inspect incase they want to do something special</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			newEvent.originalEvent = event;</pre></div></div>
            
        </li>
        
        
        <li id="section-201">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-201">&#182;</a>
              </div>
              <p>NOTE we let the current stack unwind because any assignment to
     location.hash will stop the world and run this event handler. By
     doing this we create a similar behavior to hashchange on hash
     assignment</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$win.trigger( newEvent, {
					state: state
				});
			}, <span class="hljs-number">0</span>);
		},

		hashchange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event <span class="hljs-comment">/*, data */</span> )</span> {</span>
			<span class="hljs-keyword">var</span> newEvent = <span class="hljs-keyword">new</span> $.Event( <span class="hljs-string">"navigate"</span> ),
				beforeNavigate = <span class="hljs-keyword">new</span> $.Event( <span class="hljs-string">"beforenavigate"</span> );

			beforeNavigate.originalEvent = event;
			$win.trigger( beforeNavigate );

			<span class="hljs-keyword">if</span> ( beforeNavigate.isDefaultPrevented() ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-202">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-202">&#182;</a>
              </div>
              <p>Make sure the original event is tracked for the end
user to inspect incase they want to do something special</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			newEvent.originalEvent = event;</pre></div></div>
            
        </li>
        
        
        <li id="section-203">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-203">&#182;</a>
              </div>
              <p>Trigger the hashchange with state provided by the user
that altered the hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$win.trigger( newEvent, {</pre></div></div>
            
        </li>
        
        
        <li id="section-204">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-204">&#182;</a>
              </div>
              <p>Users that want to fully normalize the two events
will need to do history management down the stack and
add the state to the event before this binding is fired
TODO consider allowing for the explicit addition of callbacks
     to be fired before this value is set to avoid event timing issues</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				state: event.hashchangeState || {}
			});
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-205">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-205">&#182;</a>
              </div>
              <p>TODO We really only want to set this up once
     but I’m not clear if there’s a beter way to achieve
     this with the jQuery special event structure</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( <span class="hljs-comment">/* data, namespaces */</span> )</span> {</span>
			<span class="hljs-keyword">if</span> ( self.bound ) {
				<span class="hljs-keyword">return</span>;
			}

			self.bound = <span class="hljs-literal">true</span>;

			<span class="hljs-keyword">if</span> ( self.isPushStateEnabled() ) {
				self.originalEventName = <span class="hljs-string">"popstate"</span>;
				$win.bind( <span class="hljs-string">"popstate.navigate"</span>, self.popstate );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( self.isHashChangeEnabled() ) {
				self.originalEventName = <span class="hljs-string">"hashchange"</span>;
				$win.bind( <span class="hljs-string">"hashchange.navigate"</span>, self.hashchange );
			}
		}
	};
})( jQuery );



(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
		<span class="hljs-keyword">var</span> path, $base, dialogHashKey = <span class="hljs-string">"&amp;ui-state=dialog"</span>;

		$.mobile.path = path = {
			uiStateKey: <span class="hljs-string">"&amp;ui-state"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-206">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-206">&#182;</a>
              </div>
              <p>This scary looking regular expression parses an absolute URL or its relative
variants (protocol, site, document, query, and hash), into the various
components (protocol, host, path, query, fragment, etc that make up the
URL as well as some other commonly used sub-parts. When used with RegExp.exec()
or String.match, it parses the URL into a results array that looks like this:</p>
<pre><code>[<span class="hljs-number">0</span>]: http:<span class="hljs-comment">//jblas:password@mycompany.com:8080/mail/inbox?msg=1234&amp;type=unread#msg-content</span>
[<span class="hljs-number">1</span>]: http:<span class="hljs-comment">//jblas:password@mycompany.com:8080/mail/inbox?msg=1234&amp;type=unread</span>
[<span class="hljs-number">2</span>]: http:<span class="hljs-comment">//jblas:password@mycompany.com:8080/mail/inbox</span>
[<span class="hljs-number">3</span>]: http:<span class="hljs-comment">//jblas:password@mycompany.com:8080</span>
[<span class="hljs-number">4</span>]: http:
[<span class="hljs-number">5</span>]: <span class="hljs-comment">//</span>
[<span class="hljs-number">6</span>]: jblas:password@mycompany.com:<span class="hljs-number">8080</span>
[<span class="hljs-number">7</span>]: jblas:password
[<span class="hljs-number">8</span>]: jblas
[<span class="hljs-number">9</span>]: password
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>			urlParseRE: <span class="hljs-regexp">/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-207">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-207">&#182;</a>
              </div>
              <p>Abstraction to address xss (Issue #4787) by removing the authority in
browsers that auto    decode it. All references to location.href should be
replaced with a call to this method so that it can be dealt with properly here</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			getLocation: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
				<span class="hljs-keyword">var</span> uri = url ? <span class="hljs-keyword">this</span>.parseUrl( url ) : location,
					hash = <span class="hljs-keyword">this</span>.parseUrl( url || location.href ).hash;</pre></div></div>
            
        </li>
        
        
        <li id="section-208">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-208">&#182;</a>
              </div>
              <p>mimic the browser with an empty string when the hash is empty</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				hash = hash === <span class="hljs-string">"#"</span> ? <span class="hljs-string">""</span> : hash;</pre></div></div>
            
        </li>
        
        
        <li id="section-209">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-209">&#182;</a>
              </div>
              <p>Make sure to parse the url or the location object for the hash because using location.hash
is autodecoded in firefox, the rest of the url should be from the object (location unless
we’re testing) to avoid the inclusion of the authority</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> uri.protocol + <span class="hljs-string">"//"</span> + uri.host + uri.pathname + uri.search + hash;
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-210">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-210">&#182;</a>
              </div>
              <p>return the original document url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			getDocumentUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( asParsedObject )</span> {</span>
				<span class="hljs-keyword">return</span> asParsedObject ? $.extend( {}, path.documentUrl ) : path.documentUrl.href;
			},

			parseLocation: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.parseUrl( <span class="hljs-keyword">this</span>.getLocation() );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-211">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-211">&#182;</a>
              </div>
              <p>Parse a URL into a structure that allows easy access to
all of the URL components by name.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			parseUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-212">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-212">&#182;</a>
              </div>
              <p>If we’re passed an object, we’ll assume that it is
a parsed url object and just return it back to the caller.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( $.type( url ) === <span class="hljs-string">"object"</span> ) {
					<span class="hljs-keyword">return</span> url;
				}

				<span class="hljs-keyword">var</span> matches = path.urlParseRE.exec( url || <span class="hljs-string">""</span> ) || [];</pre></div></div>
            
        </li>
        
        
        <li id="section-213">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-213">&#182;</a>
              </div>
              <p>Create an object that allows the caller to access the sub-matches
by name. Note that IE returns an empty string instead of undefined,
like all other browsers do, so we normalize everything so its consistent
no matter what browser we’re running on.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">return</span> {
						href:         matches[  <span class="hljs-number">0</span> ] || <span class="hljs-string">""</span>,
						hrefNoHash:   matches[  <span class="hljs-number">1</span> ] || <span class="hljs-string">""</span>,
						hrefNoSearch: matches[  <span class="hljs-number">2</span> ] || <span class="hljs-string">""</span>,
						domain:       matches[  <span class="hljs-number">3</span> ] || <span class="hljs-string">""</span>,
						protocol:     matches[  <span class="hljs-number">4</span> ] || <span class="hljs-string">""</span>,
						doubleSlash:  matches[  <span class="hljs-number">5</span> ] || <span class="hljs-string">""</span>,
						authority:    matches[  <span class="hljs-number">6</span> ] || <span class="hljs-string">""</span>,
						username:     matches[  <span class="hljs-number">8</span> ] || <span class="hljs-string">""</span>,
						password:     matches[  <span class="hljs-number">9</span> ] || <span class="hljs-string">""</span>,
						host:         matches[ <span class="hljs-number">10</span> ] || <span class="hljs-string">""</span>,
						hostname:     matches[ <span class="hljs-number">11</span> ] || <span class="hljs-string">""</span>,
						port:         matches[ <span class="hljs-number">12</span> ] || <span class="hljs-string">""</span>,
						pathname:     matches[ <span class="hljs-number">13</span> ] || <span class="hljs-string">""</span>,
						directory:    matches[ <span class="hljs-number">14</span> ] || <span class="hljs-string">""</span>,
						filename:     matches[ <span class="hljs-number">15</span> ] || <span class="hljs-string">""</span>,
						search:       matches[ <span class="hljs-number">16</span> ] || <span class="hljs-string">""</span>,
						hash:         matches[ <span class="hljs-number">17</span> ] || <span class="hljs-string">""</span>
					};
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-214">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-214">&#182;</a>
              </div>
              <p>Turn relPath into an asbolute path. absPath is
an optional absolute path which describes what
relPath is relative to.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			makePathAbsolute: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( relPath, absPath )</span> {</span>
				<span class="hljs-keyword">var</span> absStack,
					relStack,
					i, d;

				<span class="hljs-keyword">if</span> ( relPath &amp;&amp; relPath.charAt( <span class="hljs-number">0</span> ) === <span class="hljs-string">"/"</span> ) {
					<span class="hljs-keyword">return</span> relPath;
				}

				relPath = relPath || <span class="hljs-string">""</span>;
				absPath = absPath ? absPath.replace( <span class="hljs-regexp">/^\/|(\/[^\/]*|[^\/]+)$/g</span>, <span class="hljs-string">""</span> ) : <span class="hljs-string">""</span>;

				absStack = absPath ? absPath.split( <span class="hljs-string">"/"</span> ) : [];
				relStack = relPath.split( <span class="hljs-string">"/"</span> );

				<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; relStack.length; i++ ) {
					d = relStack[ i ];
					<span class="hljs-keyword">switch</span> ( d ) {
						<span class="hljs-keyword">case</span> <span class="hljs-string">"."</span>:
							<span class="hljs-keyword">break</span>;
						<span class="hljs-keyword">case</span> <span class="hljs-string">".."</span>:
							<span class="hljs-keyword">if</span> ( absStack.length ) {
								absStack.pop();
							}
							<span class="hljs-keyword">break</span>;
						<span class="hljs-keyword">default</span>:
							absStack.push( d );
							<span class="hljs-keyword">break</span>;
					}
				}
				<span class="hljs-keyword">return</span> <span class="hljs-string">"/"</span> + absStack.join( <span class="hljs-string">"/"</span> );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-215">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-215">&#182;</a>
              </div>
              <p>Returns true if both urls have the same domain.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isSameDomain: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( absUrl1, absUrl2 )</span> {</span>
				<span class="hljs-keyword">return</span> path.parseUrl( absUrl1 ).domain === path.parseUrl( absUrl2 ).domain;
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-216">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-216">&#182;</a>
              </div>
              <p>Returns true for any relative variant.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isRelativeUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-217">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-217">&#182;</a>
              </div>
              <p>All relative Url variants have one thing in common, no protocol.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> path.parseUrl( url ).protocol === <span class="hljs-string">""</span>;
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-218">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-218">&#182;</a>
              </div>
              <p>Returns true for an absolute url.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isAbsoluteUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
				<span class="hljs-keyword">return</span> path.parseUrl( url ).protocol !== <span class="hljs-string">""</span>;
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-219">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-219">&#182;</a>
              </div>
              <p>Turn the specified realtive URL into an absolute one. This function
can handle all relative variants (protocol, site, document, query, fragment).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			makeUrlAbsolute: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( relUrl, absUrl )</span> {</span>
				<span class="hljs-keyword">if</span> ( !path.isRelativeUrl( relUrl ) ) {
					<span class="hljs-keyword">return</span> relUrl;
				}

				<span class="hljs-keyword">if</span> ( absUrl === <span class="hljs-literal">undefined</span> ) {
					absUrl = <span class="hljs-keyword">this</span>.documentBase;
				}

				<span class="hljs-keyword">var</span> relObj = path.parseUrl( relUrl ),
					absObj = path.parseUrl( absUrl ),
					protocol = relObj.protocol || absObj.protocol,
					doubleSlash = relObj.protocol ? relObj.doubleSlash : ( relObj.doubleSlash || absObj.doubleSlash ),
					authority = relObj.authority || absObj.authority,
					hasPath = relObj.pathname !== <span class="hljs-string">""</span>,
					pathname = path.makePathAbsolute( relObj.pathname || absObj.filename, absObj.pathname ),
					search = relObj.search || ( !hasPath &amp;&amp; absObj.search ) || <span class="hljs-string">""</span>,
					hash = relObj.hash;

				<span class="hljs-keyword">return</span> protocol + doubleSlash + authority + pathname + search + hash;
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-220">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-220">&#182;</a>
              </div>
              <p>Add search (aka query) params to the specified url.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			addSearchParams: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, params )</span> {</span>
				<span class="hljs-keyword">var</span> u = path.parseUrl( url ),
					p = ( <span class="hljs-keyword">typeof</span> params === <span class="hljs-string">"object"</span> ) ? $.param( params ) : params,
					s = u.search || <span class="hljs-string">"?"</span>;
				<span class="hljs-keyword">return</span> u.hrefNoSearch + s + ( s.charAt( s.length - <span class="hljs-number">1</span> ) !== <span class="hljs-string">"?"</span> ? <span class="hljs-string">"&amp;"</span> : <span class="hljs-string">""</span> ) + p + ( u.hash || <span class="hljs-string">""</span> );
			},

			convertUrlToDataUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( absUrl )</span> {</span>
				<span class="hljs-keyword">var</span> u = path.parseUrl( absUrl );
				<span class="hljs-keyword">if</span> ( path.isEmbeddedPage( u ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-221">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-221">&#182;</a>
              </div>
              <p>For embedded pages, remove the dialog hash key as in getFilePath(),
and remove otherwise the Data Url won’t match the id of the embedded Page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">return</span> u.hash
						.split( dialogHashKey )[<span class="hljs-number">0</span>]
						.replace( <span class="hljs-regexp">/^#/</span>, <span class="hljs-string">""</span> )
						.replace( <span class="hljs-regexp">/\?.*$/</span>, <span class="hljs-string">""</span> );
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( path.isSameDomain( u, <span class="hljs-keyword">this</span>.documentBase ) ) {
					<span class="hljs-keyword">return</span> u.hrefNoHash.replace( <span class="hljs-keyword">this</span>.documentBase.domain, <span class="hljs-string">""</span> ).split( dialogHashKey )[<span class="hljs-number">0</span>];
				}

				<span class="hljs-keyword">return</span> window.decodeURIComponent(absUrl);
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-222">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-222">&#182;</a>
              </div>
              <p>get path from current hash, or from a file path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			get: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( newPath )</span> {</span>
				<span class="hljs-keyword">if</span> ( newPath === <span class="hljs-literal">undefined</span> ) {
					newPath = path.parseLocation().hash;
				}
				<span class="hljs-keyword">return</span> path.stripHash( newPath ).replace( <span class="hljs-regexp">/[^\/]*\.[^\/*]+$/</span>, <span class="hljs-string">""</span> );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-223">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-223">&#182;</a>
              </div>
              <p>set location hash to path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			set: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( path )</span> {</span>
				location.hash = path;
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-224">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-224">&#182;</a>
              </div>
              <p>test if a given url (string) is a path
NOTE might be exceptionally naive</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isPath: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
				<span class="hljs-keyword">return</span> ( <span class="hljs-regexp">/\//</span> ).test( url );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-225">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-225">&#182;</a>
              </div>
              <p>return a url path with the window’s location protocol/hostname/pathname removed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			clean: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
				<span class="hljs-keyword">return</span> url.replace( <span class="hljs-keyword">this</span>.documentBase.domain, <span class="hljs-string">""</span> );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-226">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-226">&#182;</a>
              </div>
              <p>just return the url without an initial #</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			stripHash: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
				<span class="hljs-keyword">return</span> url.replace( <span class="hljs-regexp">/^#/</span>, <span class="hljs-string">""</span> );
			},

			stripQueryParams: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
				<span class="hljs-keyword">return</span> url.replace( <span class="hljs-regexp">/\?.*$/</span>, <span class="hljs-string">""</span> );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-227">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-227">&#182;</a>
              </div>
              <p>remove the preceding hash, any query params, and dialog notations</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			cleanHash: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( hash )</span> {</span>
				<span class="hljs-keyword">return</span> path.stripHash( hash.replace( <span class="hljs-regexp">/\?.*$/</span>, <span class="hljs-string">""</span> ).replace( dialogHashKey, <span class="hljs-string">""</span> ) );
			},

			isHashValid: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( hash )</span> {</span>
				<span class="hljs-keyword">return</span> ( <span class="hljs-regexp">/^#[^#]+$/</span> ).test( hash );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-228">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-228">&#182;</a>
              </div>
              <p>check whether a url is referencing the same domain, or an external domain or different protocol
could be mailto, etc</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isExternal: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
				<span class="hljs-keyword">var</span> u = path.parseUrl( url );
				<span class="hljs-keyword">return</span> u.protocol &amp;&amp; u.domain !== <span class="hljs-keyword">this</span>.documentUrl.domain ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;
			},

			hasProtocol: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
				<span class="hljs-keyword">return</span> ( <span class="hljs-regexp">/^(:?\w+:)/</span> ).test( url );
			},

			isEmbeddedPage: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
				<span class="hljs-keyword">var</span> u = path.parseUrl( url );</pre></div></div>
            
        </li>
        
        
        <li id="section-229">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-229">&#182;</a>
              </div>
              <p>if the path is absolute, then we need to compare the url against
both the this.documentUrl and the documentBase. The main reason for this
is that links embedded within external documents will refer to the
application document, whereas links embedded within the application
document will be resolved against the document base.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( u.protocol !== <span class="hljs-string">""</span> ) {
					<span class="hljs-keyword">return</span> ( !<span class="hljs-keyword">this</span>.isPath(u.hash) &amp;&amp; u.hash &amp;&amp; ( u.hrefNoHash === <span class="hljs-keyword">this</span>.documentUrl.hrefNoHash || ( <span class="hljs-keyword">this</span>.documentBaseDiffers &amp;&amp; u.hrefNoHash === <span class="hljs-keyword">this</span>.documentBase.hrefNoHash ) ) );
				}
				<span class="hljs-keyword">return</span> ( <span class="hljs-regexp">/^#/</span> ).test( u.href );
			},

			squash: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, resolutionUrl )</span> {</span>
				<span class="hljs-keyword">var</span> href, cleanedUrl, search, stateIndex,
					isPath = <span class="hljs-keyword">this</span>.isPath( url ),
					uri = <span class="hljs-keyword">this</span>.parseUrl( url ),
					preservedHash = uri.hash,
					uiState = <span class="hljs-string">""</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-230">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-230">&#182;</a>
              </div>
              <p>produce a url against which we can resole the provided path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				resolutionUrl = resolutionUrl || (path.isPath(url) ? path.getLocation() : path.getDocumentUrl());</pre></div></div>
            
        </li>
        
        
        <li id="section-231">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-231">&#182;</a>
              </div>
              <p>If the url is anything but a simple string, remove any preceding hash
eg #foo/bar -&gt; foo/bar</p>
<h1 id="foo-foo">foo -&gt; #foo</h1>

            </div>
            
            <div class="content"><div class='highlight'><pre>				cleanedUrl = isPath ? path.stripHash( url ) : url;</pre></div></div>
            
        </li>
        
        
        <li id="section-232">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-232">&#182;</a>
              </div>
              <p>If the url is a full url with a hash check if the parsed hash is a path
if it is, strip the #, and use it otherwise continue without change</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				cleanedUrl = path.isPath( uri.hash ) ? path.stripHash( uri.hash ) : cleanedUrl;</pre></div></div>
            
        </li>
        
        
        <li id="section-233">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-233">&#182;</a>
              </div>
              <p>Split the UI State keys off the href</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				stateIndex = cleanedUrl.indexOf( <span class="hljs-keyword">this</span>.uiStateKey );</pre></div></div>
            
        </li>
        
        
        <li id="section-234">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-234">&#182;</a>
              </div>
              <p>store the ui state keys for use</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( stateIndex &gt; -<span class="hljs-number">1</span> ) {
					uiState = cleanedUrl.slice( stateIndex );
					cleanedUrl = cleanedUrl.slice( <span class="hljs-number">0</span>, stateIndex );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-235">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-235">&#182;</a>
              </div>
              <p>make the cleanedUrl absolute relative to the resolution url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				href = path.makeUrlAbsolute( cleanedUrl, resolutionUrl );</pre></div></div>
            
        </li>
        
        
        <li id="section-236">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-236">&#182;</a>
              </div>
              <p>grab the search from the resolved url since parsing from
the passed url may not yield the correct result</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				search = <span class="hljs-keyword">this</span>.parseUrl( href ).search;</pre></div></div>
            
        </li>
        
        
        <li id="section-237">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-237">&#182;</a>
              </div>
              <p>TODO all this crap is terrible, clean it up</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( isPath ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-238">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-238">&#182;</a>
              </div>
              <p>reject the hash if it’s a path or it’s just a dialog key</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( path.isPath( preservedHash ) || preservedHash.replace(<span class="hljs-string">"#"</span>, <span class="hljs-string">""</span>).indexOf( <span class="hljs-keyword">this</span>.uiStateKey ) === <span class="hljs-number">0</span>) {
						preservedHash = <span class="hljs-string">""</span>;
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-239">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-239">&#182;</a>
              </div>
              <p>Append the UI State keys where it exists and it’s been removed
from the url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( uiState &amp;&amp; preservedHash.indexOf( <span class="hljs-keyword">this</span>.uiStateKey ) === -<span class="hljs-number">1</span>) {
						preservedHash += uiState;
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-240">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-240">&#182;</a>
              </div>
              <p>make sure that pound is on the front of the hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( preservedHash.indexOf( <span class="hljs-string">"#"</span> ) === -<span class="hljs-number">1</span> &amp;&amp; preservedHash !== <span class="hljs-string">""</span> ) {
						preservedHash = <span class="hljs-string">"#"</span> + preservedHash;
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-241">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-241">&#182;</a>
              </div>
              <p>reconstruct each of the pieces with the new search string and hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					href = path.parseUrl( href );
					href = href.protocol + <span class="hljs-string">"//"</span> + href.host + href.pathname + search + preservedHash;
				} <span class="hljs-keyword">else</span> {
					href += href.indexOf( <span class="hljs-string">"#"</span> ) &gt; -<span class="hljs-number">1</span> ? uiState : <span class="hljs-string">"#"</span> + uiState;
				}

				<span class="hljs-keyword">return</span> href;
			},

			isPreservableHash: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( hash )</span> {</span>
				<span class="hljs-keyword">return</span> hash.replace( <span class="hljs-string">"#"</span>, <span class="hljs-string">""</span> ).indexOf( <span class="hljs-keyword">this</span>.uiStateKey ) === <span class="hljs-number">0</span>;
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-242">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-242">&#182;</a>
              </div>
              <p>Escape weird characters in the hash if it is to be used as a selector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			hashToSelector: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( hash )</span> {</span>
				<span class="hljs-keyword">var</span> hasHash = ( hash.substring( <span class="hljs-number">0</span>, <span class="hljs-number">1</span> ) === <span class="hljs-string">"#"</span> );
				<span class="hljs-keyword">if</span> ( hasHash ) {
					hash = hash.substring( <span class="hljs-number">1</span> );
				}
				<span class="hljs-keyword">return</span> ( hasHash ? <span class="hljs-string">"#"</span> : <span class="hljs-string">""</span> ) + hash.replace( <span class="hljs-regexp">/([!"#$%&amp;'()*+,./:;&lt;=&gt;?@[\]^`{|}~])/g</span>, <span class="hljs-string">"\\$1"</span> );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-243">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-243">&#182;</a>
              </div>
              <p>return the substring of a filepath before the sub-page key, for making
a server request</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			getFilePath: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( path )</span> {</span>
				<span class="hljs-keyword">var</span> splitkey = <span class="hljs-string">"&amp;"</span> + $.mobile.subPageUrlKey;
				<span class="hljs-keyword">return</span> path &amp;&amp; path.split( splitkey )[<span class="hljs-number">0</span>].split( dialogHashKey )[<span class="hljs-number">0</span>];
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-244">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-244">&#182;</a>
              </div>
              <p>check if the specified url refers to the first page in the main
application document.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isFirstPageUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-245">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-245">&#182;</a>
              </div>
              <p>We only deal with absolute paths.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">var</span> u = path.parseUrl( path.makeUrlAbsolute( url, <span class="hljs-keyword">this</span>.documentBase ) ),</pre></div></div>
            
        </li>
        
        
        <li id="section-246">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-246">&#182;</a>
              </div>
              <p>Does the url have the same path as the document?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					samePath = u.hrefNoHash === <span class="hljs-keyword">this</span>.documentUrl.hrefNoHash ||
						( <span class="hljs-keyword">this</span>.documentBaseDiffers &amp;&amp;
							u.hrefNoHash === <span class="hljs-keyword">this</span>.documentBase.hrefNoHash ),</pre></div></div>
            
        </li>
        
        
        <li id="section-247">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-247">&#182;</a>
              </div>
              <p>Get the first page element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					fp = $.mobile.firstPage,</pre></div></div>
            
        </li>
        
        
        <li id="section-248">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-248">&#182;</a>
              </div>
              <p>Get the id of the first page element if it has one.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					fpId = fp &amp;&amp; fp[<span class="hljs-number">0</span>] ? fp[<span class="hljs-number">0</span>].id : <span class="hljs-literal">undefined</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-249">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-249">&#182;</a>
              </div>
              <p>The url refers to the first page if the path matches the document and
it either has no hash value, or the hash is exactly equal to the id
of the first page element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> samePath &amp;&amp;
					( !u.hash ||
						u.hash === <span class="hljs-string">"#"</span> ||
						( fpId &amp;&amp; u.hash.replace( <span class="hljs-regexp">/^#/</span>, <span class="hljs-string">""</span> ) === fpId ) );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-250">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-250">&#182;</a>
              </div>
              <p>Some embedded browsers, like the web view in Phone Gap, allow
cross-domain XHR requests if the document doing the request was loaded
via the file:// protocol. This is usually to allow the application to
“phone home” and fetch app specific data. We normally let the browser
handle external/cross-domain urls, but if the allowCrossDomainPages
option is true, we will allow cross-domain http/https requests to go
through our page loading logic.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isPermittedCrossDomainRequest: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( docUrl, reqUrl )</span> {</span>
				<span class="hljs-keyword">return</span> $.mobile.allowCrossDomainPages &amp;&amp;
					(docUrl.protocol === <span class="hljs-string">"file:"</span> || docUrl.protocol === <span class="hljs-string">"content:"</span>) &amp;&amp;
					reqUrl.search( <span class="hljs-regexp">/^https?:/</span> ) !== -<span class="hljs-number">1</span>;
			}
		};

		path.documentUrl = path.parseLocation();

		$base = $( <span class="hljs-string">"head"</span> ).find( <span class="hljs-string">"base"</span> );

		path.documentBase = $base.length ?
			path.parseUrl( path.makeUrlAbsolute( $base.attr( <span class="hljs-string">"href"</span> ), path.documentUrl.href ) ) :
			path.documentUrl;

		path.documentBaseDiffers = (path.documentUrl.hrefNoHash !== path.documentBase.hrefNoHash);</pre></div></div>
            
        </li>
        
        
        <li id="section-251">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-251">&#182;</a>
              </div>
              <p>return the original document base url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		path.getDocumentBase = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( asParsedObject )</span> {</span>
			<span class="hljs-keyword">return</span> asParsedObject ? $.extend( {}, path.documentBase ) : path.documentBase.href;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-252">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-252">&#182;</a>
              </div>
              <p>DEPRECATED as of 1.4.0 - remove in 1.5.0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.extend( $.mobile, {</pre></div></div>
            
        </li>
        
        
        <li id="section-253">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-253">&#182;</a>
              </div>
              <p>return the original document url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			getDocumentUrl: path.getDocumentUrl,</pre></div></div>
            
        </li>
        
        
        <li id="section-254">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-254">&#182;</a>
              </div>
              <p>return the original document base url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			getDocumentBase: path.getDocumentBase
		});
})( jQuery );



(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
	$.mobile.History = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( stack, index )</span> {</span>
		<span class="hljs-keyword">this</span>.stack = stack || [];
		<span class="hljs-keyword">this</span>.activeIndex = index || <span class="hljs-number">0</span>;
	};

	$.extend($.mobile.History.prototype, {
		getActive: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.stack[ <span class="hljs-keyword">this</span>.activeIndex ];
		},

		getLast: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.stack[ <span class="hljs-keyword">this</span>.previousIndex ];
		},

		getNext: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.stack[ <span class="hljs-keyword">this</span>.activeIndex + <span class="hljs-number">1</span> ];
		},

		getPrev: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.stack[ <span class="hljs-keyword">this</span>.activeIndex - <span class="hljs-number">1</span> ];
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-255">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-255">&#182;</a>
              </div>
              <p>addNew is used whenever a new page is added</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		add: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, data )</span> {</span>
			data = data || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-256">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-256">&#182;</a>
              </div>
              <p>if there’s forward history, wipe it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.getNext() ) {
				<span class="hljs-keyword">this</span>.clearForward();
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-257">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-257">&#182;</a>
              </div>
              <p>if the hash is included in the data make sure the shape
is consistent for comparison</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( data.hash &amp;&amp; data.hash.indexOf( <span class="hljs-string">"#"</span> ) === -<span class="hljs-number">1</span>) {
				data.hash = <span class="hljs-string">"#"</span> + data.hash;
			}

			data.url = url;
			<span class="hljs-keyword">this</span>.stack.push( data );
			<span class="hljs-keyword">this</span>.activeIndex = <span class="hljs-keyword">this</span>.stack.length - <span class="hljs-number">1</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-258">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-258">&#182;</a>
              </div>
              <p>wipe urls ahead of active index</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		clearForward: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.stack = <span class="hljs-keyword">this</span>.stack.slice( <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.activeIndex + <span class="hljs-number">1</span> );
		},

		find: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, stack, earlyReturn )</span> {</span>
			stack = stack || <span class="hljs-keyword">this</span>.stack;

			<span class="hljs-keyword">var</span> entry, i, length = stack.length, index;

			<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; length; i++ ) {
				entry = stack[i];

				<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">decodeURIComponent</span>(url) === <span class="hljs-built_in">decodeURIComponent</span>(entry.url) ||
					<span class="hljs-built_in">decodeURIComponent</span>(url) === <span class="hljs-built_in">decodeURIComponent</span>(entry.hash) ) {
					index = i;

					<span class="hljs-keyword">if</span> ( earlyReturn ) {
						<span class="hljs-keyword">return</span> index;
					}
				}
			}

			<span class="hljs-keyword">return</span> index;
		},

		closest: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url )</span> {</span>
			<span class="hljs-keyword">var</span> closest, a = <span class="hljs-keyword">this</span>.activeIndex;</pre></div></div>
            
        </li>
        
        
        <li id="section-259">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-259">&#182;</a>
              </div>
              <p>First, take the slice of the history stack before the current index and search
for a url match. If one is found, we’ll avoid avoid looking through forward history
NOTE the preference for backward history movement is driven by the fact that
     most mobile browsers only have a dedicated back button, and users rarely use
     the forward button in desktop browser anyhow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			closest = <span class="hljs-keyword">this</span>.find( url, <span class="hljs-keyword">this</span>.stack.slice(<span class="hljs-number">0</span>, a) );</pre></div></div>
            
        </li>
        
        
        <li id="section-260">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-260">&#182;</a>
              </div>
              <p>If nothing was found in backward history check forward. The <code>true</code>
value passed as the third parameter causes the find method to break
on the first match in the forward history slice. The starting index
of the slice must then be added to the result to get the element index
in the original history stack :( :(</p>
<p>TODO this is hyper confusing and should be cleaned up (ugh so bad)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( closest === <span class="hljs-literal">undefined</span> ) {
				closest = <span class="hljs-keyword">this</span>.find( url, <span class="hljs-keyword">this</span>.stack.slice(a), <span class="hljs-literal">true</span> );
				closest = closest === <span class="hljs-literal">undefined</span> ? closest : closest + a;
			}

			<span class="hljs-keyword">return</span> closest;
		},

		direct: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( opts )</span> {</span>
			<span class="hljs-keyword">var</span> newActiveIndex = <span class="hljs-keyword">this</span>.closest( opts.url ), a = <span class="hljs-keyword">this</span>.activeIndex;</pre></div></div>
            
        </li>
        
        
        <li id="section-261">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-261">&#182;</a>
              </div>
              <p>save new page index, null check to prevent falsey 0 result
record the previous index for reference</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( newActiveIndex !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>.activeIndex = newActiveIndex;
				<span class="hljs-keyword">this</span>.previousIndex = a;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-262">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-262">&#182;</a>
              </div>
              <p>invoke callbacks where appropriate</p>
<p>TODO this is also convoluted and confusing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( newActiveIndex &lt; a ) {
				( opts.present || opts.back || $.noop )( <span class="hljs-keyword">this</span>.getActive(), <span class="hljs-string">"back"</span> );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( newActiveIndex &gt; a ) {
				( opts.present || opts.forward || $.noop )( <span class="hljs-keyword">this</span>.getActive(), <span class="hljs-string">"forward"</span> );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( newActiveIndex === <span class="hljs-literal">undefined</span> &amp;&amp; opts.missing ) {
				opts.missing( <span class="hljs-keyword">this</span>.getActive() );
			}
		}
	});
})( jQuery );



(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
	<span class="hljs-keyword">var</span> path = $.mobile.path,
		initialHref = location.href;

	$.mobile.Navigator = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( history )</span> {</span>
		<span class="hljs-keyword">this</span>.history = history;
		<span class="hljs-keyword">this</span>.ignoreInitialHashChange = <span class="hljs-literal">true</span>;

		$.mobile.window.bind({
			<span class="hljs-string">"popstate.history"</span>: $.proxy( <span class="hljs-keyword">this</span>.popstate, <span class="hljs-keyword">this</span> ),
			<span class="hljs-string">"hashchange.history"</span>: $.proxy( <span class="hljs-keyword">this</span>.hashchange, <span class="hljs-keyword">this</span> )
		});
	};

	$.extend($.mobile.Navigator.prototype, {
		squash: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, data )</span> {</span>
			<span class="hljs-keyword">var</span> state, href, hash = path.isPath(url) ? path.stripHash(url) : url;

			href = path.squash( url );</pre></div></div>
            
        </li>
        
        
        <li id="section-263">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-263">&#182;</a>
              </div>
              <p>make sure to provide this information when it isn’t explicitly set in the
data object that was passed to the squash method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			state = $.extend({
				hash: hash,
				url: href
			}, data);</pre></div></div>
            
        </li>
        
        
        <li id="section-264">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-264">&#182;</a>
              </div>
              <p>replace the current url with the new href and store the state
Note that in some cases we might be replacing an url with the
same url. We do this anyways because we need to make sure that
all of our history entries have a state object associated with
them. This allows us to work around the case where $.mobile.back()
is called to transition from an external page to an embedded page.
In that particular case, a hashchange event is <em>NOT</em> generated by the browser.
Ensuring each history entry has a state object means that onPopState()
will always trigger our hashchange callback even when a hashchange event
is not fired.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			window.history.replaceState( state, state.title || document.title, href );

			<span class="hljs-keyword">return</span> state;
		},

		hash: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, href )</span> {</span>
			<span class="hljs-keyword">var</span> parsed, loc, hash, resolved;</pre></div></div>
            
        </li>
        
        
        <li id="section-265">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-265">&#182;</a>
              </div>
              <p>Grab the hash for recording. If the passed url is a path
we used the parsed version of the squashed url to reconstruct,
otherwise we assume it’s a hash and store it directly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			parsed = path.parseUrl( url );
			loc = path.parseLocation();

			<span class="hljs-keyword">if</span> ( loc.pathname + loc.search === parsed.pathname + parsed.search ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-266">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-266">&#182;</a>
              </div>
              <p>If the pathname and search of the passed url is identical to the current loc
then we must use the hash. Otherwise there will be no event
eg, url = “/foo/bar?baz#bang”, location.href = “<a href="http://example.com/foo/bar?baz">http://example.com/foo/bar?baz</a>“</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				hash = parsed.hash ? parsed.hash : parsed.pathname + parsed.search;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( path.isPath(url) ) {
				resolved = path.parseUrl( href );</pre></div></div>
            
        </li>
        
        
        <li id="section-267">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-267">&#182;</a>
              </div>
              <p>If the passed url is a path, make it domain relative and remove any trailing hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				hash = resolved.pathname + resolved.search + (path.isPreservableHash( resolved.hash )? resolved.hash.replace( <span class="hljs-string">"#"</span>, <span class="hljs-string">""</span> ) : <span class="hljs-string">""</span>);
			} <span class="hljs-keyword">else</span> {
				hash = url;
			}

			<span class="hljs-keyword">return</span> hash;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-268">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-268">&#182;</a>
              </div>
              <p>TODO reconsider name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		go: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, data, noEvents )</span> {</span>
			<span class="hljs-keyword">var</span> state, href, hash, popstateEvent,
				isPopStateEvent = $.event.special.navigate.isPushStateEnabled();</pre></div></div>
            
        </li>
        
        
        <li id="section-269">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-269">&#182;</a>
              </div>
              <p>Get the url as it would look squashed on to the current resolution url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			href = path.squash( url );</pre></div></div>
            
        </li>
        
        
        <li id="section-270">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-270">&#182;</a>
              </div>
              <p>sort out what the hash sould be from the url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			hash = <span class="hljs-keyword">this</span>.hash( url, href );</pre></div></div>
            
        </li>
        
        
        <li id="section-271">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-271">&#182;</a>
              </div>
              <p>Here we prevent the next hash change or popstate event from doing any
history management. In the case of hashchange we don’t swallow it
if there will be no hashchange fired (since that won’t reset the value)
and will swallow the following hashchange</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( noEvents &amp;&amp; hash !== path.stripHash(path.parseLocation().hash) ) {
				<span class="hljs-keyword">this</span>.preventNextHashChange = noEvents;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-272">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-272">&#182;</a>
              </div>
              <p>IMPORTANT in the case where popstate is supported the event will be triggered
     directly, stopping further execution - ie, interupting the flow of this
     method call to fire bindings at this expression. Below the navigate method
     there is a binding to catch this event and stop its propagation.</p>
<pre><code> We then trigger a <span class="hljs-keyword">new</span> popstate event on the window <span class="hljs-keyword">with</span> a <span class="hljs-literal">null</span> state
 so that the navigate events can conclude their work properly
</code></pre><p>if the url is a path we want to preserve the query params that are available on
the current url.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.preventHashAssignPopState = <span class="hljs-literal">true</span>;
			window.location.hash = hash;</pre></div></div>
            
        </li>
        
        
        <li id="section-273">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-273">&#182;</a>
              </div>
              <p>If popstate is enabled and the browser triggers <code>popstate</code> events when the hash
is set (this often happens immediately in browsers like Chrome), then the
this flag will be set to false already. If it’s a browser that does not trigger
a <code>popstate</code> on hash assignement or <code>replaceState</code> then we need avoid the branch
that swallows the event created by the popstate generated by the hash assignment
At the time of this writing this happens with Opera 12 and some version of IE</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.preventHashAssignPopState = <span class="hljs-literal">false</span>;

			state = $.extend({
				url: href,
				hash: hash,
				title: document.title
			}, data);

			<span class="hljs-keyword">if</span> ( isPopStateEvent ) {
				popstateEvent = <span class="hljs-keyword">new</span> $.Event( <span class="hljs-string">"popstate"</span> );
				popstateEvent.originalEvent = {
					type: <span class="hljs-string">"popstate"</span>,
					state: <span class="hljs-literal">null</span>
				};

				<span class="hljs-keyword">this</span>.squash( url, state );</pre></div></div>
            
        </li>
        
        
        <li id="section-274">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-274">&#182;</a>
              </div>
              <p>Trigger a new faux popstate event to replace the one that we
caught that was triggered by the hash setting above.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !noEvents ) {
					<span class="hljs-keyword">this</span>.ignorePopState = <span class="hljs-literal">true</span>;
					$.mobile.window.trigger( popstateEvent );
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-275">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-275">&#182;</a>
              </div>
              <p>record the history entry so that the information can be included
in hashchange event driven navigate events in a similar fashion to
the state that’s provided by popstate</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.history.add( state.url, state );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-276">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-276">&#182;</a>
              </div>
              <p>This binding is intended to catch the popstate events that are fired
when execution of the <code>$.navigate</code> method stops at window.location.hash = url;
and completely prevent them from propagating. The popstate event will then be
retriggered after execution resumes</p>
<p>TODO grab the original event here and use it for the synthetic event in the
     second half of the navigate execution that will follow this binding</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		popstate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> hash, state;</pre></div></div>
            
        </li>
        
        
        <li id="section-277">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-277">&#182;</a>
              </div>
              <p>Partly to support our test suite which manually alters the support
value to test hashchange. Partly to prevent all around weirdness</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !$.event.special.navigate.isPushStateEnabled() ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-278">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-278">&#182;</a>
              </div>
              <p>If this is the popstate triggered by the actual alteration of the hash
prevent it completely. History is tracked manually</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.preventHashAssignPopState ) {
				<span class="hljs-keyword">this</span>.preventHashAssignPopState = <span class="hljs-literal">false</span>;
				event.stopImmediatePropagation();
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-279">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-279">&#182;</a>
              </div>
              <p>if this is the popstate triggered after the <code>replaceState</code> call in the go
method, then simply ignore it. The history entry has already been captured</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.ignorePopState ) {
				<span class="hljs-keyword">this</span>.ignorePopState = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-280">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-280">&#182;</a>
              </div>
              <p>If there is no state, and the history stack length is one were
probably getting the page load popstate fired by browsers like chrome
avoid it and set the one time flag to false.
TODO: Do we really need all these conditions? Comparing location hrefs
should be sufficient.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !event.originalEvent.state &amp;&amp;
				<span class="hljs-keyword">this</span>.history.stack.length === <span class="hljs-number">1</span> &amp;&amp;
				<span class="hljs-keyword">this</span>.ignoreInitialHashChange ) {
				<span class="hljs-keyword">this</span>.ignoreInitialHashChange = <span class="hljs-literal">false</span>;

				<span class="hljs-keyword">if</span> ( location.href === initialHref ) {
					event.preventDefault();
					<span class="hljs-keyword">return</span>;
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-281">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-281">&#182;</a>
              </div>
              <p>account for direct manipulation of the hash. That is, we will receive a popstate
when the hash is changed by assignment, and it won’t have a state associated. We
then need to squash the hash. See below for handling of hash assignment that
matches an existing history entry
TODO it might be better to only add to the history stack
     when the hash is adjacent to the active history entry</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			hash = path.parseLocation().hash;
			<span class="hljs-keyword">if</span> ( !event.originalEvent.state &amp;&amp; hash ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-282">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-282">&#182;</a>
              </div>
              <p>squash the hash that’s been assigned on the URL with replaceState
also grab the resulting state object for storage</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				state = <span class="hljs-keyword">this</span>.squash( hash );</pre></div></div>
            
        </li>
        
        
        <li id="section-283">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-283">&#182;</a>
              </div>
              <p>record the new hash as an additional history entry
to match the browser’s treatment of hash assignment</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.history.add( state.url, state );</pre></div></div>
            
        </li>
        
        
        <li id="section-284">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-284">&#182;</a>
              </div>
              <p>pass the newly created state information
along with the event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				event.historyState = state;</pre></div></div>
            
        </li>
        
        
        <li id="section-285">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-285">&#182;</a>
              </div>
              <p>do not alter history, we’ve added a new history entry
so we know where we are</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-286">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-286">&#182;</a>
              </div>
              <p>If all else fails this is a popstate that comes from the back or forward buttons
make sure to set the state of our history stack properly, and record the directionality</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.history.direct({
				url: (event.originalEvent.state || {}).url || hash,</pre></div></div>
            
        </li>
        
        
        <li id="section-287">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-287">&#182;</a>
              </div>
              <p>When the url is either forward or backward in history include the entry
as data on the event object for merging as data in the navigate event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				present: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( historyEntry, direction )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-288">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-288">&#182;</a>
              </div>
              <p>make sure to create a new object to pass down as the navigate event data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					event.historyState = $.extend({}, historyEntry);
					event.historyState.direction = direction;
				}
			});
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-289">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-289">&#182;</a>
              </div>
              <p>NOTE must bind before <code>navigate</code> special event hashchange binding otherwise the
     navigation data won’t be attached to the hashchange event in time for those
     bindings to attach it to the <code>navigate</code> special event
TODO add a check here that <code>hashchange.navigate</code> is bound already otherwise it’s
     broken (exception?)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		hashchange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> history, hash;</pre></div></div>
            
        </li>
        
        
        <li id="section-290">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-290">&#182;</a>
              </div>
              <p>If hashchange listening is explicitly disabled or pushstate is supported
avoid making use of the hashchange handler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> (!$.event.special.navigate.isHashChangeEnabled() ||
				$.event.special.navigate.isPushStateEnabled() ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-291">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-291">&#182;</a>
              </div>
              <p>On occasion explicitly want to prevent the next hash from propogating because we only
with to alter the url to represent the new state do so here</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.preventNextHashChange ) {
				<span class="hljs-keyword">this</span>.preventNextHashChange = <span class="hljs-literal">false</span>;
				event.stopImmediatePropagation();
				<span class="hljs-keyword">return</span>;
			}

			history = <span class="hljs-keyword">this</span>.history;
			hash = path.parseLocation().hash;</pre></div></div>
            
        </li>
        
        
        <li id="section-292">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-292">&#182;</a>
              </div>
              <p>If this is a hashchange caused by the back or forward button
make sure to set the state of our history stack properly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.history.direct({
				url: hash,</pre></div></div>
            
        </li>
        
        
        <li id="section-293">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-293">&#182;</a>
              </div>
              <p>When the url is either forward or backward in history include the entry
as data on the event object for merging as data in the navigate event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				present: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( historyEntry, direction )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-294">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-294">&#182;</a>
              </div>
              <p>make sure to create a new object to pass down as the navigate event data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					event.hashchangeState = $.extend({}, historyEntry);
					event.hashchangeState.direction = direction;
				},</pre></div></div>
            
        </li>
        
        
        <li id="section-295">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-295">&#182;</a>
              </div>
              <p>When we don’t find a hash in our history clearly we’re aiming to go there
record the entry as new for future traversal</p>
<p>NOTE it’s not entirely clear that this is the right thing to do given that we
     can’t know the users intention. It might be better to explicitly <em>not</em>
     support location.hash assignment in preference to $.navigate calls
TODO first arg to add should be the href, but it causes issues in identifying
     embeded pages</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				missing: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					history.add( hash, {
						hash: hash,
						title: document.title
					});
				}
			});
		}
	});
})( jQuery );



(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-296">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-296">&#182;</a>
              </div>
              <p>TODO consider queueing navigation activity until previous activities have completed
     so that end users don’t have to think about it. Punting for now
TODO !! move the event bindings into callbacks on the navigate event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.navigate = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, data, noEvents )</span> {</span>
		$.mobile.navigate.navigator.go( url, data, noEvents );
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-297">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-297">&#182;</a>
              </div>
              <p>expose the history on the navigate method in anticipation of full integration with
existing navigation functionalty that is tightly coupled to the history information</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.navigate.history = <span class="hljs-keyword">new</span> $.mobile.History();</pre></div></div>
            
        </li>
        
        
        <li id="section-298">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-298">&#182;</a>
              </div>
              <p>instantiate an instance of the navigator for use within the $.navigate method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.navigate.navigator = <span class="hljs-keyword">new</span> $.mobile.Navigator( $.mobile.navigate.history );

	<span class="hljs-keyword">var</span> loc = $.mobile.path.parseLocation();
	$.mobile.navigate.history.add( loc.href, {hash: loc.hash} );
})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
	<span class="hljs-keyword">var</span> props = {
			<span class="hljs-string">"animation"</span>: {},
			<span class="hljs-string">"transition"</span>: {}
		},
		testElement = document.createElement( <span class="hljs-string">"a"</span> ),
		vendorPrefixes = [ <span class="hljs-string">""</span>, <span class="hljs-string">"webkit-"</span>, <span class="hljs-string">"moz-"</span>, <span class="hljs-string">"o-"</span> ];

	$.each( [ <span class="hljs-string">"animation"</span>, <span class="hljs-string">"transition"</span> ], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( i, test )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-299">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-299">&#182;</a>
              </div>
              <p>Get correct name for test</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> testName = ( i === <span class="hljs-number">0</span> ) ? test + <span class="hljs-string">"-"</span> + <span class="hljs-string">"name"</span> : test;

		$.each( vendorPrefixes, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( j, prefix )</span> {</span>
			<span class="hljs-keyword">if</span> ( testElement.style[ $.camelCase( prefix + testName ) ] !== <span class="hljs-literal">undefined</span> ) {
				 props[ test ][ <span class="hljs-string">"prefix"</span> ] = prefix;
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-300">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-300">&#182;</a>
              </div>
              <p>Set event and duration names for later use</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		props[ test ][ <span class="hljs-string">"duration"</span> ] =
			$.camelCase( props[ test ][ <span class="hljs-string">"prefix"</span> ] + test + <span class="hljs-string">"-"</span> + <span class="hljs-string">"duration"</span> );
		props[ test ][ <span class="hljs-string">"event"</span> ] =
			$.camelCase( props[ test ][ <span class="hljs-string">"prefix"</span> ] + test + <span class="hljs-string">"-"</span> + <span class="hljs-string">"end"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-301">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-301">&#182;</a>
              </div>
              <p>All lower case if not a vendor prop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( props[ test ][ <span class="hljs-string">"prefix"</span> ] === <span class="hljs-string">""</span> ) {
			props[ test ][ <span class="hljs-string">"event"</span> ] = props[ test ][ <span class="hljs-string">"event"</span> ].toLowerCase();
		}
	});</pre></div></div>
            
        </li>
        
        
        <li id="section-302">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-302">&#182;</a>
              </div>
              <p>If a valid prefix was found then the it is supported by the browser</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.support.cssTransitions = ( props[ <span class="hljs-string">"transition"</span> ][ <span class="hljs-string">"prefix"</span> ] !== <span class="hljs-literal">undefined</span> );
	$.support.cssAnimations = ( props[ <span class="hljs-string">"animation"</span> ][ <span class="hljs-string">"prefix"</span> ] !== <span class="hljs-literal">undefined</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-303">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-303">&#182;</a>
              </div>
              <p>Remove the testElement</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$( testElement ).remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-304">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-304">&#182;</a>
              </div>
              <p>Animation complete callback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.fn.animationComplete = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( callback, type, fallbackTime )</span> {</span>
		<span class="hljs-keyword">var</span> timer, duration,
			that = <span class="hljs-keyword">this</span>,
			animationType = ( !type || type === <span class="hljs-string">"animation"</span> ) ? <span class="hljs-string">"animation"</span> : <span class="hljs-string">"transition"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-305">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-305">&#182;</a>
              </div>
              <p>Make sure selected type is supported by browser</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ( $.support.cssTransitions &amp;&amp; animationType === <span class="hljs-string">"transition"</span> ) ||
			( $.support.cssAnimations &amp;&amp; animationType === <span class="hljs-string">"animation"</span> ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-306">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-306">&#182;</a>
              </div>
              <p>If a fallback time was not passed set one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( fallbackTime === <span class="hljs-literal">undefined</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-307">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-307">&#182;</a>
              </div>
              <p>Make sure the was not bound to document before checking .css</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( $( <span class="hljs-keyword">this</span> ).context !== document ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-308">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-308">&#182;</a>
              </div>
              <p>Parse the durration since its in second multiple by 1000 for milliseconds
Multiply by 3 to make sure we give the animation plenty of time.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					duration = <span class="hljs-built_in">parseFloat</span>(
						$( <span class="hljs-keyword">this</span> ).css( props[ animationType ].duration )
					) * <span class="hljs-number">3000</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-309">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-309">&#182;</a>
              </div>
              <p>If we could not read a duration use the default</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( duration === <span class="hljs-number">0</span> || duration === <span class="hljs-literal">undefined</span> || <span class="hljs-built_in">isNaN</span>( duration ) ) {
					duration = $.fn.animationComplete.defaultDuration;
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-310">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-310">&#182;</a>
              </div>
              <p>Sets up the fallback if event never comes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			timer = setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( that ).off( props[ animationType ].event );
				callback.apply( that );
			}, duration );</pre></div></div>
            
        </li>
        
        
        <li id="section-311">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-311">&#182;</a>
              </div>
              <p>Bind the event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> $( <span class="hljs-keyword">this</span> ).one( props[ animationType ].event, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-312">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-312">&#182;</a>
              </div>
              <p>Clear the timer so we dont call callback twice</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				clearTimeout( timer );
				callback.call( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
			});
		} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-313">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-313">&#182;</a>
              </div>
              <p>CSS animation / transitions not supported
Defer execution for consistency between webkit/non webkit</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			setTimeout( $.proxy( callback, <span class="hljs-keyword">this</span> ), <span class="hljs-number">0</span> );
			<span class="hljs-keyword">return</span> $( <span class="hljs-keyword">this</span> );
		}
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-314">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-314">&#182;</a>
              </div>
              <p>Allow default callback to be configured on mobileInit</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.fn.animationComplete.defaultDuration = <span class="hljs-number">1000</span>;
})( jQuery );</pre></div></div>
            
        </li>
        
        
        <li id="section-315">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-315">&#182;</a>
              </div>
              <p>This plugin is an experiment for abstracting away the touch and mouse
events so that developers don’t have to worry about which method of input
the device their document is loaded on supports.</p>
<p>The idea here is to allow the developer to register listeners for the
basic mouse events, such as mousedown, mousemove, mouseup, and click,
and the plugin will take care of registering the correct listeners
behind the scenes to invoke the listener at the fastest possible time
for that device, while still retaining the order of event firing in
the traditional mouse environment, should multiple handlers be registered
on the same element for different events.</p>
<p>The current version exposes the following virtual events to jQuery bind methods:
“vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, document, undefined )</span> {</span>

<span class="hljs-keyword">var</span> dataPropertyName = <span class="hljs-string">"virtualMouseBindings"</span>,
	touchTargetPropertyName = <span class="hljs-string">"virtualTouchID"</span>,
	virtualEventNames = <span class="hljs-string">"vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel"</span>.split( <span class="hljs-string">" "</span> ),
	touchEventProps = <span class="hljs-string">"clientX clientY pageX pageY screenX screenY"</span>.split( <span class="hljs-string">" "</span> ),
	mouseHookProps = $.event.mouseHooks ? $.event.mouseHooks.props : [],
	mouseEventProps = $.event.props.concat( mouseHookProps ),
	activeDocHandlers = {},
	resetTimerID = <span class="hljs-number">0</span>,
	startX = <span class="hljs-number">0</span>,
	startY = <span class="hljs-number">0</span>,
	didScroll = <span class="hljs-literal">false</span>,
	clickBlockList = [],
	blockMouseTriggers = <span class="hljs-literal">false</span>,
	blockTouchTriggers = <span class="hljs-literal">false</span>,
	eventCaptureSupported = <span class="hljs-string">"addEventListener"</span> <span class="hljs-keyword">in</span> document,
	$document = $( document ),
	nextTouchID = <span class="hljs-number">1</span>,
	lastTouchID = <span class="hljs-number">0</span>, threshold,
	i;

$.vmouse = {
	moveDistanceThreshold: <span class="hljs-number">10</span>,
	clickDistanceThreshold: <span class="hljs-number">10</span>,
	resetTimerDuration: <span class="hljs-number">1500</span>
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNativeEvent</span><span class="hljs-params">( event )</span> {</span>

	<span class="hljs-keyword">while</span> ( event &amp;&amp; <span class="hljs-keyword">typeof</span> event.originalEvent !== <span class="hljs-string">"undefined"</span> ) {
		event = event.originalEvent;
	}
	<span class="hljs-keyword">return</span> event;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createVirtualEvent</span><span class="hljs-params">( event, eventType )</span> {</span>

	<span class="hljs-keyword">var</span> t = event.type,
		oe, props, ne, prop, ct, touch, i, j, len;

	event = $.Event( event );
	event.type = eventType;

	oe = event.originalEvent;
	props = $.event.props;</pre></div></div>
            
        </li>
        
        
        <li id="section-316">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-316">&#182;</a>
              </div>
              <p>addresses separation of $.event.props in to $.event.mouseHook.props and Issue 3280
<a href="https://github.com/jquery/jquery-mobile/issues/3280">https://github.com/jquery/jquery-mobile/issues/3280</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( t.search( <span class="hljs-regexp">/^(mouse|click)/</span> ) &gt; -<span class="hljs-number">1</span> ) {
		props = mouseEventProps;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-317">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-317">&#182;</a>
              </div>
              <p>copy original event properties over to the new event
this would happen if we could call $.event.fix instead of $.Event
but we don’t have a way to force an event to be fixed multiple times</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( oe ) {
		<span class="hljs-keyword">for</span> ( i = props.length, prop; i; ) {
			prop = props[ --i ];
			event[ prop ] = oe[ prop ];
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-318">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-318">&#182;</a>
              </div>
              <p>make sure that if the mouse and click virtual events are generated
without a .which one is defined</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( t.search(<span class="hljs-regexp">/mouse(down|up)|click/</span>) &gt; -<span class="hljs-number">1</span> &amp;&amp; !event.which ) {
		event.which = <span class="hljs-number">1</span>;
	}

	<span class="hljs-keyword">if</span> ( t.search(<span class="hljs-regexp">/^touch/</span>) !== -<span class="hljs-number">1</span> ) {
		ne = getNativeEvent( oe );
		t = ne.touches;
		ct = ne.changedTouches;
		touch = ( t &amp;&amp; t.length ) ? t[<span class="hljs-number">0</span>] : ( ( ct &amp;&amp; ct.length ) ? ct[ <span class="hljs-number">0</span> ] : <span class="hljs-literal">undefined</span> );

		<span class="hljs-keyword">if</span> ( touch ) {
			<span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>, len = touchEventProps.length; j &lt; len; j++) {
				prop = touchEventProps[ j ];
				event[ prop ] = touch[ prop ];
			}
		}
	}

	<span class="hljs-keyword">return</span> event;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getVirtualBindingFlags</span><span class="hljs-params">( element )</span> {</span>

	<span class="hljs-keyword">var</span> flags = {},
		b, k;

	<span class="hljs-keyword">while</span> ( element ) {

		b = $.data( element, dataPropertyName );

		<span class="hljs-keyword">for</span> (  k <span class="hljs-keyword">in</span> b ) {
			<span class="hljs-keyword">if</span> ( b[ k ] ) {
				flags[ k ] = flags.hasVirtualBinding = <span class="hljs-literal">true</span>;
			}
		}
		element = element.parentNode;
	}
	<span class="hljs-keyword">return</span> flags;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getClosestElementWithVirtualBinding</span><span class="hljs-params">( element, eventType )</span> {</span>
	<span class="hljs-keyword">var</span> b;
	<span class="hljs-keyword">while</span> ( element ) {

		b = $.data( element, dataPropertyName );

		<span class="hljs-keyword">if</span> ( b &amp;&amp; ( !eventType || b[ eventType ] ) ) {
			<span class="hljs-keyword">return</span> element;
		}
		element = element.parentNode;
	}
	<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enableTouchBindings</span><span class="hljs-params">()</span> {</span>
	blockTouchTriggers = <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disableTouchBindings</span><span class="hljs-params">()</span> {</span>
	blockTouchTriggers = <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enableMouseBindings</span><span class="hljs-params">()</span> {</span>
	lastTouchID = <span class="hljs-number">0</span>;
	clickBlockList.length = <span class="hljs-number">0</span>;
	blockMouseTriggers = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-319">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-319">&#182;</a>
              </div>
              <p>When mouse bindings are enabled, our
touch bindings are disabled.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	disableTouchBindings();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disableMouseBindings</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-320">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-320">&#182;</a>
              </div>
              <p>When mouse bindings are disabled, our
touch bindings are enabled.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	enableTouchBindings();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startResetTimer</span><span class="hljs-params">()</span> {</span>
	clearResetTimer();
	resetTimerID = setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		resetTimerID = <span class="hljs-number">0</span>;
		enableMouseBindings();
	}, $.vmouse.resetTimerDuration );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearResetTimer</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">if</span> ( resetTimerID ) {
		clearTimeout( resetTimerID );
		resetTimerID = <span class="hljs-number">0</span>;
	}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">triggerVirtualEvent</span><span class="hljs-params">( eventType, event, flags )</span> {</span>
	<span class="hljs-keyword">var</span> ve;

	<span class="hljs-keyword">if</span> ( ( flags &amp;&amp; flags[ eventType ] ) ||
				( !flags &amp;&amp; getClosestElementWithVirtualBinding( event.target, eventType ) ) ) {

		ve = createVirtualEvent( event, eventType );

		$( event.target).trigger( ve );
	}

	<span class="hljs-keyword">return</span> ve;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mouseEventCallback</span><span class="hljs-params">( event )</span> {</span>
	<span class="hljs-keyword">var</span> touchID = $.data( event.target, touchTargetPropertyName ),
		ve;

	<span class="hljs-keyword">if</span> ( !blockMouseTriggers &amp;&amp; ( !lastTouchID || lastTouchID !== touchID ) ) {
		ve = triggerVirtualEvent( <span class="hljs-string">"v"</span> + event.type, event );
		<span class="hljs-keyword">if</span> ( ve ) {
			<span class="hljs-keyword">if</span> ( ve.isDefaultPrevented() ) {
				event.preventDefault();
			}
			<span class="hljs-keyword">if</span> ( ve.isPropagationStopped() ) {
				event.stopPropagation();
			}
			<span class="hljs-keyword">if</span> ( ve.isImmediatePropagationStopped() ) {
				event.stopImmediatePropagation();
			}
		}
	}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleTouchStart</span><span class="hljs-params">( event )</span> {</span>

	<span class="hljs-keyword">var</span> touches = getNativeEvent( event ).touches,
		target, flags, t;

	<span class="hljs-keyword">if</span> ( touches &amp;&amp; touches.length === <span class="hljs-number">1</span> ) {

		target = event.target;
		flags = getVirtualBindingFlags( target );

		<span class="hljs-keyword">if</span> ( flags.hasVirtualBinding ) {

			lastTouchID = nextTouchID++;
			$.data( target, touchTargetPropertyName, lastTouchID );

			clearResetTimer();

			disableMouseBindings();
			didScroll = <span class="hljs-literal">false</span>;

			t = getNativeEvent( event ).touches[ <span class="hljs-number">0</span> ];
			startX = t.pageX;
			startY = t.pageY;

			triggerVirtualEvent( <span class="hljs-string">"vmouseover"</span>, event, flags );
			triggerVirtualEvent( <span class="hljs-string">"vmousedown"</span>, event, flags );
		}
	}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleScroll</span><span class="hljs-params">( event )</span> {</span>
	<span class="hljs-keyword">if</span> ( blockTouchTriggers ) {
		<span class="hljs-keyword">return</span>;
	}

	<span class="hljs-keyword">if</span> ( !didScroll ) {
		triggerVirtualEvent( <span class="hljs-string">"vmousecancel"</span>, event, getVirtualBindingFlags( event.target ) );
	}

	didScroll = <span class="hljs-literal">true</span>;
	startResetTimer();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleTouchMove</span><span class="hljs-params">( event )</span> {</span>
	<span class="hljs-keyword">if</span> ( blockTouchTriggers ) {
		<span class="hljs-keyword">return</span>;
	}

	<span class="hljs-keyword">var</span> t = getNativeEvent( event ).touches[ <span class="hljs-number">0</span> ],
		didCancel = didScroll,
		moveThreshold = $.vmouse.moveDistanceThreshold,
		flags = getVirtualBindingFlags( event.target );

		didScroll = didScroll ||
			( <span class="hljs-built_in">Math</span>.abs( t.pageX - startX ) &gt; moveThreshold ||
				<span class="hljs-built_in">Math</span>.abs( t.pageY - startY ) &gt; moveThreshold );

	<span class="hljs-keyword">if</span> ( didScroll &amp;&amp; !didCancel ) {
		triggerVirtualEvent( <span class="hljs-string">"vmousecancel"</span>, event, flags );
	}

	triggerVirtualEvent( <span class="hljs-string">"vmousemove"</span>, event, flags );
	startResetTimer();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleTouchEnd</span><span class="hljs-params">( event )</span> {</span>
	<span class="hljs-keyword">if</span> ( blockTouchTriggers ) {
		<span class="hljs-keyword">return</span>;
	}

	disableTouchBindings();

	<span class="hljs-keyword">var</span> flags = getVirtualBindingFlags( event.target ),
		ve, t;
	triggerVirtualEvent( <span class="hljs-string">"vmouseup"</span>, event, flags );

	<span class="hljs-keyword">if</span> ( !didScroll ) {
		ve = triggerVirtualEvent( <span class="hljs-string">"vclick"</span>, event, flags );
		<span class="hljs-keyword">if</span> ( ve &amp;&amp; ve.isDefaultPrevented() ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-321">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-321">&#182;</a>
              </div>
              <p>The target of the mouse events that follow the touchend
event don’t necessarily match the target used during the
touch. This means we need to rely on coordinates for blocking
any click that is generated.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			t = getNativeEvent( event ).changedTouches[ <span class="hljs-number">0</span> ];
			clickBlockList.push({
				touchID: lastTouchID,
				x: t.clientX,
				y: t.clientY
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-322">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-322">&#182;</a>
              </div>
              <p>Prevent any mouse events that follow from triggering
virtual event notifications.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			blockMouseTriggers = <span class="hljs-literal">true</span>;
		}
	}
	triggerVirtualEvent( <span class="hljs-string">"vmouseout"</span>, event, flags);
	didScroll = <span class="hljs-literal">false</span>;

	startResetTimer();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasVirtualBindings</span><span class="hljs-params">( ele )</span> {</span>
	<span class="hljs-keyword">var</span> bindings = $.data( ele, dataPropertyName ),
		k;

	<span class="hljs-keyword">if</span> ( bindings ) {
		<span class="hljs-keyword">for</span> ( k <span class="hljs-keyword">in</span> bindings ) {
			<span class="hljs-keyword">if</span> ( bindings[ k ] ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
		}
	}
	<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dummyMouseHandler</span><span class="hljs-params">()</span> {</span>}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSpecialEventObject</span><span class="hljs-params">( eventType )</span> {</span>
	<span class="hljs-keyword">var</span> realType = eventType.substr( <span class="hljs-number">1</span> );

	<span class="hljs-keyword">return</span> {
		setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* data, namespace */</span>)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-323">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-323">&#182;</a>
              </div>
              <p>If this is the first virtual mouse binding for this element,
add a bindings object to its data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
			<span class="hljs-keyword">if</span> ( !hasVirtualBindings( <span class="hljs-keyword">this</span> ) ) {
				$.data( <span class="hljs-keyword">this</span>, dataPropertyName, {} );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-324">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-324">&#182;</a>
              </div>
              <p>If setup is called, we know it is the first binding for this
eventType, so initialize the count for the eventType to zero.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> bindings = $.data( <span class="hljs-keyword">this</span>, dataPropertyName );
			bindings[ eventType ] = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-325">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-325">&#182;</a>
              </div>
              <p>If this is the first virtual mouse event for this type,
register a global handler on the document.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
			activeDocHandlers[ eventType ] = ( activeDocHandlers[ eventType ] || <span class="hljs-number">0</span> ) + <span class="hljs-number">1</span>;

			<span class="hljs-keyword">if</span> ( activeDocHandlers[ eventType ] === <span class="hljs-number">1</span> ) {
				$document.bind( realType, mouseEventCallback );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-326">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-326">&#182;</a>
              </div>
              <p>Some browsers, like Opera Mini, won’t dispatch mouse/click events
for elements unless they actually have handlers registered on them.
To get around this, we register dummy handlers on the elements.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
			$( <span class="hljs-keyword">this</span> ).bind( realType, dummyMouseHandler );</pre></div></div>
            
        </li>
        
        
        <li id="section-327">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-327">&#182;</a>
              </div>
              <p>For now, if event capture is not supported, we rely on mouse handlers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( eventCaptureSupported ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-328">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-328">&#182;</a>
              </div>
              <p>If this is the first virtual mouse binding for the document,
register our touchstart handler on the document.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
				activeDocHandlers[ <span class="hljs-string">"touchstart"</span> ] = ( activeDocHandlers[ <span class="hljs-string">"touchstart"</span> ] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;

				<span class="hljs-keyword">if</span> ( activeDocHandlers[ <span class="hljs-string">"touchstart"</span> ] === <span class="hljs-number">1</span> ) {
					$document.bind( <span class="hljs-string">"touchstart"</span>, handleTouchStart )
						.bind( <span class="hljs-string">"touchend"</span>, handleTouchEnd )</pre></div></div>
            
        </li>
        
        
        <li id="section-329">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-329">&#182;</a>
              </div>
              <p>On touch platforms, touching the screen and then dragging your finger
causes the window content to scroll after some distance threshold is
exceeded. On these platforms, a scroll prevents a click event from being
dispatched, and on some platforms, even the touchend is suppressed. To
mimic the suppression of the click event, we need to watch for a scroll
event. Unfortunately, some platforms like iOS don’t dispatch scroll
events until <em>AFTER</em> the user lifts their finger (touchend). This means
we need to watch both scroll and touchmove events to figure out whether
or not a scroll happenens before the touchend event is fired.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
						.bind( <span class="hljs-string">"touchmove"</span>, handleTouchMove )
						.bind( <span class="hljs-string">"scroll"</span>, handleScroll );
				}
			}
		},

		teardown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* data, namespace */</span>)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-330">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-330">&#182;</a>
              </div>
              <p>If this is the last virtual binding for this eventType,
remove its global handler from the document.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
			--activeDocHandlers[ eventType ];

			<span class="hljs-keyword">if</span> ( !activeDocHandlers[ eventType ] ) {
				$document.unbind( realType, mouseEventCallback );
			}

			<span class="hljs-keyword">if</span> ( eventCaptureSupported ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-331">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-331">&#182;</a>
              </div>
              <p>If this is the last virtual mouse binding in existence,
remove our document touchstart listener.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
				--activeDocHandlers[ <span class="hljs-string">"touchstart"</span> ];

				<span class="hljs-keyword">if</span> ( !activeDocHandlers[ <span class="hljs-string">"touchstart"</span> ] ) {
					$document.unbind( <span class="hljs-string">"touchstart"</span>, handleTouchStart )
						.unbind( <span class="hljs-string">"touchmove"</span>, handleTouchMove )
						.unbind( <span class="hljs-string">"touchend"</span>, handleTouchEnd )
						.unbind( <span class="hljs-string">"scroll"</span>, handleScroll );
				}
			}

			<span class="hljs-keyword">var</span> $<span class="hljs-keyword">this</span> = $( <span class="hljs-keyword">this</span> ),
				bindings = $.data( <span class="hljs-keyword">this</span>, dataPropertyName );</pre></div></div>
            
        </li>
        
        
        <li id="section-332">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-332">&#182;</a>
              </div>
              <p>teardown may be called when an element was
removed from the DOM. If this is the case,
jQuery core may have already stripped the element
of any data bindings so we need to check it before
using it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( bindings ) {
				bindings[ eventType ] = <span class="hljs-literal">false</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-333">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-333">&#182;</a>
              </div>
              <p>Unregister the dummy event handler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
			$<span class="hljs-keyword">this</span>.unbind( realType, dummyMouseHandler );</pre></div></div>
            
        </li>
        
        
        <li id="section-334">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-334">&#182;</a>
              </div>
              <p>If this is the last virtual mouse binding on the
element, remove the binding data from the element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
			<span class="hljs-keyword">if</span> ( !hasVirtualBindings( <span class="hljs-keyword">this</span> ) ) {
				$<span class="hljs-keyword">this</span>.removeData( dataPropertyName );
			}
		}
	};
}</pre></div></div>
            
        </li>
        
        
        <li id="section-335">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-335">&#182;</a>
              </div>
              <p>Expose our custom events to the jQuery bind/unbind mechanism.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; virtualEventNames.length; i++ ) {
	$.event.special[ virtualEventNames[ i ] ] = getSpecialEventObject( virtualEventNames[ i ] );
}</pre></div></div>
            
        </li>
        
        
        <li id="section-336">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-336">&#182;</a>
              </div>
              <p>Add a capture click handler to block clicks.
Note that we require event capture support for this so if the device
doesn’t support it, we punt for now and rely solely on mouse events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> ( eventCaptureSupported ) {
	document.addEventListener( <span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> {</span>
		<span class="hljs-keyword">var</span> cnt = clickBlockList.length,
			target = e.target,
			x, y, ele, i, o, touchID;

		<span class="hljs-keyword">if</span> ( cnt ) {
			x = e.clientX;
			y = e.clientY;
			threshold = $.vmouse.clickDistanceThreshold;</pre></div></div>
            
        </li>
        
        
        <li id="section-337">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-337">&#182;</a>
              </div>
              <p>The idea here is to run through the clickBlockList to see if
the current click event is in the proximity of one of our
vclick events that had preventDefault() called on it. If we find
one, then we block the click.</p>
<p>Why do we have to rely on proximity?</p>
<p>Because the target of the touch event that triggered the vclick
can be different from the target of the click event synthesized
by the browser. The target of a mouse/click event that is synthesized
from a touch event seems to be implementation specific. For example,
some browsers will fire mouse/click events for a link that is near
a touch event, even though the target of the touchstart/touchend event
says the user touched outside the link. Also, it seems that with most
browsers, the target of the mouse/click event is not calculated until the
time it is dispatched, so if you replace an element that you touched
with another element, the target of the mouse/click will be the new
element underneath that point.</p>
<p>Aside from proximity, we also check to see if the target and any
of its ancestors were the ones that blocked a click. This is necessary
because of the strange mouse/click target calculation done in the
Android 2.1 browser, where if you click on an element, and there is a
mouse/click handler on one of its ancestors, the target will be the
innermost child of the touched element, even if that child is no where
near the point of touch.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
			ele = target;

			<span class="hljs-keyword">while</span> ( ele ) {
				<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; cnt; i++ ) {
					o = clickBlockList[ i ];
					touchID = <span class="hljs-number">0</span>;

					<span class="hljs-keyword">if</span> ( ( ele === target &amp;&amp; <span class="hljs-built_in">Math</span>.abs( o.x - x ) &lt; threshold &amp;&amp; <span class="hljs-built_in">Math</span>.abs( o.y - y ) &lt; threshold ) ||
								$.data( ele, touchTargetPropertyName ) === o.touchID ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-338">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-338">&#182;</a>
              </div>
              <p>XXX: We may want to consider removing matches from the block list
     instead of waiting for the reset timer to fire.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						e.preventDefault();
						e.stopPropagation();
						<span class="hljs-keyword">return</span>;
					}
				}
				ele = ele.parentNode;
			}
		}
	}, <span class="hljs-literal">true</span>);
}
})( jQuery, window, document );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>
	<span class="hljs-keyword">var</span> $document = $( document ),
		supportTouch = $.mobile.support.touch,
		scrollEvent = <span class="hljs-string">"touchmove scroll"</span>,
		touchStartEvent = supportTouch ? <span class="hljs-string">"touchstart"</span> : <span class="hljs-string">"mousedown"</span>,
		touchStopEvent = supportTouch ? <span class="hljs-string">"touchend"</span> : <span class="hljs-string">"mouseup"</span>,
		touchMoveEvent = supportTouch ? <span class="hljs-string">"touchmove"</span> : <span class="hljs-string">"mousemove"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-339">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-339">&#182;</a>
              </div>
              <p>setup new event shortcuts</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.each( ( <span class="hljs-string">"touchstart touchmove touchend "</span> +
		<span class="hljs-string">"tap taphold "</span> +
		<span class="hljs-string">"swipe swipeleft swiperight "</span> +
		<span class="hljs-string">"scrollstart scrollstop"</span> ).split( <span class="hljs-string">" "</span> ), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( i, name )</span> {</span>

		$.fn[ name ] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( fn )</span> {</span>
			<span class="hljs-keyword">return</span> fn ? <span class="hljs-keyword">this</span>.bind( name, fn ) : <span class="hljs-keyword">this</span>.trigger( name );
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-340">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-340">&#182;</a>
              </div>
              <p>jQuery &lt; 1.8</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.attrFn ) {
			$.attrFn[ name ] = <span class="hljs-literal">true</span>;
		}
	});

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">triggerCustomEvent</span><span class="hljs-params">( obj, eventType, event, bubble )</span> {</span>
		<span class="hljs-keyword">var</span> originalType = event.type;
		event.type = eventType;
		<span class="hljs-keyword">if</span> ( bubble ) {
			$.event.trigger( event, <span class="hljs-literal">undefined</span>, obj );
		} <span class="hljs-keyword">else</span> {
			$.event.dispatch.call( obj, event );
		}
		event.type = originalType;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-341">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-341">&#182;</a>
              </div>
              <p>also handles scrollstop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.event.special.scrollstart = {

		enabled: <span class="hljs-literal">true</span>,
		setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

			<span class="hljs-keyword">var</span> thisObject = <span class="hljs-keyword">this</span>,
				$<span class="hljs-keyword">this</span> = $( thisObject ),
				scrolling,
				timer;

			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trigger</span><span class="hljs-params">( event, state )</span> {</span>
				scrolling = state;
				triggerCustomEvent( thisObject, scrolling ? <span class="hljs-string">"scrollstart"</span> : <span class="hljs-string">"scrollstop"</span>, event );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-342">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-342">&#182;</a>
              </div>
              <p>iPhone triggers scroll after a small delay; use touchmove instead</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$<span class="hljs-keyword">this</span>.bind( scrollEvent, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>

				<span class="hljs-keyword">if</span> ( !$.event.special.scrollstart.enabled ) {
					<span class="hljs-keyword">return</span>;
				}

				<span class="hljs-keyword">if</span> ( !scrolling ) {
					trigger( event, <span class="hljs-literal">true</span> );
				}

				clearTimeout( timer );
				timer = setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					trigger( event, <span class="hljs-literal">false</span> );
				}, <span class="hljs-number">50</span> );
			});
		},
		teardown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$( <span class="hljs-keyword">this</span> ).unbind( scrollEvent );
		}
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-343">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-343">&#182;</a>
              </div>
              <p>also handles taphold</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.event.special.tap = {
		tapholdThreshold: <span class="hljs-number">750</span>,
		emitTapOnTaphold: <span class="hljs-literal">true</span>,
		setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> thisObject = <span class="hljs-keyword">this</span>,
				$<span class="hljs-keyword">this</span> = $( thisObject ),
				isTaphold = <span class="hljs-literal">false</span>;

			$<span class="hljs-keyword">this</span>.bind( <span class="hljs-string">"vmousedown"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
				isTaphold = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">if</span> ( event.which &amp;&amp; event.which !== <span class="hljs-number">1</span> ) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}

				<span class="hljs-keyword">var</span> origTarget = event.target,
					timer;

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearTapTimer</span><span class="hljs-params">()</span> {</span>
					clearTimeout( timer );
				}

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearTapHandlers</span><span class="hljs-params">()</span> {</span>
					clearTapTimer();

					$<span class="hljs-keyword">this</span>.unbind( <span class="hljs-string">"vclick"</span>, clickHandler )
						.unbind( <span class="hljs-string">"vmouseup"</span>, clearTapTimer );
					$document.unbind( <span class="hljs-string">"vmousecancel"</span>, clearTapHandlers );
				}

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clickHandler</span><span class="hljs-params">( event )</span> {</span>
					clearTapHandlers();</pre></div></div>
            
        </li>
        
        
        <li id="section-344">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-344">&#182;</a>
              </div>
              <p>ONLY trigger a ‘tap’ event if the start target is
the same as the stop target.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( !isTaphold &amp;&amp; origTarget === event.target ) {
						triggerCustomEvent( thisObject, <span class="hljs-string">"tap"</span>, event );
					} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( isTaphold ) {
						event.stopPropagation();
					}
				}

				$<span class="hljs-keyword">this</span>.bind( <span class="hljs-string">"vmouseup"</span>, clearTapTimer )
					.bind( <span class="hljs-string">"vclick"</span>, clickHandler );
				$document.bind( <span class="hljs-string">"vmousecancel"</span>, clearTapHandlers );

				timer = setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">if</span> ( !$.event.special.tap.emitTapOnTaphold ) {
						isTaphold = <span class="hljs-literal">true</span>;
					}
					triggerCustomEvent( thisObject, <span class="hljs-string">"taphold"</span>, $.Event( <span class="hljs-string">"taphold"</span>, { target: origTarget } ) );
				}, $.event.special.tap.tapholdThreshold );
			});
		},
		teardown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$( <span class="hljs-keyword">this</span> ).unbind( <span class="hljs-string">"vmousedown"</span> ).unbind( <span class="hljs-string">"vclick"</span> ).unbind( <span class="hljs-string">"vmouseup"</span> );
			$document.unbind( <span class="hljs-string">"vmousecancel"</span> );
		}
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-345">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-345">&#182;</a>
              </div>
              <p>Also handles swipeleft, swiperight</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.event.special.swipe = {</pre></div></div>
            
        </li>
        
        
        <li id="section-346">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-346">&#182;</a>
              </div>
              <p>More than this horizontal displacement, and we will suppress scrolling.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		scrollSupressionThreshold: <span class="hljs-number">30</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-347">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-347">&#182;</a>
              </div>
              <p>More time than this, and it isn’t a swipe.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		durationThreshold: <span class="hljs-number">1000</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-348">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-348">&#182;</a>
              </div>
              <p>Swipe horizontal displacement must be more than this.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		horizontalDistanceThreshold: <span class="hljs-number">30</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-349">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-349">&#182;</a>
              </div>
              <p>Swipe vertical displacement must be less than this.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		verticalDistanceThreshold: <span class="hljs-number">30</span>,

		getLocation: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> winPageX = window.pageXOffset,
				winPageY = window.pageYOffset,
				x = event.clientX,
				y = event.clientY;

			<span class="hljs-keyword">if</span> ( event.pageY === <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">Math</span>.floor( y ) &gt; <span class="hljs-built_in">Math</span>.floor( event.pageY ) ||
				event.pageX === <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">Math</span>.floor( x ) &gt; <span class="hljs-built_in">Math</span>.floor( event.pageX ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-350">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-350">&#182;</a>
              </div>
              <p>iOS4 clientX/clientY have the value that should have been
in pageX/pageY. While pageX/page/ have the value 0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				x = x - winPageX;
				y = y - winPageY;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( y &lt; ( event.pageY - winPageY) || x &lt; ( event.pageX - winPageX ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-351">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-351">&#182;</a>
              </div>
              <p>Some Android browsers have totally bogus values for clientX/Y
when scrolling/zooming a page. Detectable since clientX/clientY
should never be smaller than pageX/pageY minus page scroll</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				x = event.pageX - winPageX;
				y = event.pageY - winPageY;
			}

			<span class="hljs-keyword">return</span> {
				x: x,
				y: y
			};
		},

		start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> data = event.originalEvent.touches ?
					event.originalEvent.touches[ <span class="hljs-number">0</span> ] : event,
				location = $.event.special.swipe.getLocation( data );
			<span class="hljs-keyword">return</span> {
						time: ( <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() ).getTime(),
						coords: [ location.x, location.y ],
						origin: $( event.target )
					};
		},

		stop: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> data = event.originalEvent.touches ?
					event.originalEvent.touches[ <span class="hljs-number">0</span> ] : event,
				location = $.event.special.swipe.getLocation( data );
			<span class="hljs-keyword">return</span> {
						time: ( <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() ).getTime(),
						coords: [ location.x, location.y ]
					};
		},

		handleSwipe: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( start, stop, thisObject, origTarget )</span> {</span>
			<span class="hljs-keyword">if</span> ( stop.time - start.time &lt; $.event.special.swipe.durationThreshold &amp;&amp;
				<span class="hljs-built_in">Math</span>.abs( start.coords[ <span class="hljs-number">0</span> ] - stop.coords[ <span class="hljs-number">0</span> ] ) &gt; $.event.special.swipe.horizontalDistanceThreshold &amp;&amp;
				<span class="hljs-built_in">Math</span>.abs( start.coords[ <span class="hljs-number">1</span> ] - stop.coords[ <span class="hljs-number">1</span> ] ) &lt; $.event.special.swipe.verticalDistanceThreshold ) {
				<span class="hljs-keyword">var</span> direction = start.coords[<span class="hljs-number">0</span>] &gt; stop.coords[ <span class="hljs-number">0</span> ] ? <span class="hljs-string">"swipeleft"</span> : <span class="hljs-string">"swiperight"</span>;

				triggerCustomEvent( thisObject, <span class="hljs-string">"swipe"</span>, $.Event( <span class="hljs-string">"swipe"</span>, { target: origTarget, swipestart: start, swipestop: stop }), <span class="hljs-literal">true</span> );
				triggerCustomEvent( thisObject, direction,$.Event( direction, { target: origTarget, swipestart: start, swipestop: stop } ), <span class="hljs-literal">true</span> );
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

		},</pre></div></div>
            
        </li>
        
        
        <li id="section-352">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-352">&#182;</a>
              </div>
              <p>This serves as a flag to ensure that at most one swipe event event is
in work at any given time</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		eventInProgress: <span class="hljs-literal">false</span>,

		setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> events,
				thisObject = <span class="hljs-keyword">this</span>,
				$<span class="hljs-keyword">this</span> = $( thisObject ),
				context = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-353">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-353">&#182;</a>
              </div>
              <p>Retrieve the events data for this element and add the swipe context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			events = $.data( <span class="hljs-keyword">this</span>, <span class="hljs-string">"mobile-events"</span> );
			<span class="hljs-keyword">if</span> ( !events ) {
				events = { length: <span class="hljs-number">0</span> };
				$.data( <span class="hljs-keyword">this</span>, <span class="hljs-string">"mobile-events"</span>, events );
			}
			events.length++;
			events.swipe = context;

			context.start = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-354">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-354">&#182;</a>
              </div>
              <p>Bail if we’re already working on a swipe event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( $.event.special.swipe.eventInProgress ) {
					<span class="hljs-keyword">return</span>;
				}
				$.event.special.swipe.eventInProgress = <span class="hljs-literal">true</span>;

				<span class="hljs-keyword">var</span> stop,
					start = $.event.special.swipe.start( event ),
					origTarget = event.target,
					emitted = <span class="hljs-literal">false</span>;

				context.move = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
					<span class="hljs-keyword">if</span> ( !start ) {
						<span class="hljs-keyword">return</span>;
					}

					stop = $.event.special.swipe.stop( event );
					<span class="hljs-keyword">if</span> ( !emitted ) {
						emitted = $.event.special.swipe.handleSwipe( start, stop, thisObject, origTarget );
						<span class="hljs-keyword">if</span> ( emitted ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-355">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-355">&#182;</a>
              </div>
              <p>Reset the context to make way for the next swipe event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>							$.event.special.swipe.eventInProgress = <span class="hljs-literal">false</span>;
						}
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-356">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-356">&#182;</a>
              </div>
              <p>prevent scrolling</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">Math</span>.abs( start.coords[ <span class="hljs-number">0</span> ] - stop.coords[ <span class="hljs-number">0</span> ] ) &gt; $.event.special.swipe.scrollSupressionThreshold ) {
						event.preventDefault();
					}
				};

				context.stop = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
						emitted = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-357">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-357">&#182;</a>
              </div>
              <p>Reset the context to make way for the next swipe event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						$.event.special.swipe.eventInProgress = <span class="hljs-literal">false</span>;
						$document.off( touchMoveEvent, context.move );
						context.move = <span class="hljs-literal">null</span>;
				};

				$document.on( touchMoveEvent, context.move )
					.one( touchStopEvent, context.stop );
			};
			$<span class="hljs-keyword">this</span>.on( touchStartEvent, context.start );
		},

		teardown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> events, context;

			events = $.data( <span class="hljs-keyword">this</span>, <span class="hljs-string">"mobile-events"</span> );
			<span class="hljs-keyword">if</span> ( events ) {
				context = events.swipe;
				<span class="hljs-keyword">delete</span> events.swipe;
				events.length--;
				<span class="hljs-keyword">if</span> ( events.length === <span class="hljs-number">0</span> ) {
					$.removeData( <span class="hljs-keyword">this</span>, <span class="hljs-string">"mobile-events"</span> );
				}
			}

			<span class="hljs-keyword">if</span> ( context ) {
				<span class="hljs-keyword">if</span> ( context.start ) {
					$( <span class="hljs-keyword">this</span> ).off( touchStartEvent, context.start );
				}
				<span class="hljs-keyword">if</span> ( context.move ) {
					$document.off( touchMoveEvent, context.move );
				}
				<span class="hljs-keyword">if</span> ( context.stop ) {
					$document.off( touchStopEvent, context.stop );
				}
			}
		}
	};
	$.each({
		scrollstop: <span class="hljs-string">"scrollstart"</span>,
		taphold: <span class="hljs-string">"tap"</span>,
		swipeleft: <span class="hljs-string">"swipe"</span>,
		swiperight: <span class="hljs-string">"swipe"</span>
	}, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event, sourceEvent )</span> {</span>

		$.event.special[ event ] = {
			setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( <span class="hljs-keyword">this</span> ).bind( sourceEvent, $.noop );
			},
			teardown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( <span class="hljs-keyword">this</span> ).unbind( sourceEvent );
			}
		};
	});

})( jQuery, <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-358">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-358">&#182;</a>
              </div>
              <p>throttled resize event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $ )</span> {</span>
		$.event.special.throttledresize = {
			setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( <span class="hljs-keyword">this</span> ).bind( <span class="hljs-string">"resize"</span>, handler );
			},
			teardown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( <span class="hljs-keyword">this</span> ).unbind( <span class="hljs-string">"resize"</span>, handler );
			}
		};

		<span class="hljs-keyword">var</span> throttle = <span class="hljs-number">250</span>,
			handler = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				curr = ( <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() ).getTime();
				diff = curr - lastCall;

				<span class="hljs-keyword">if</span> ( diff &gt;= throttle ) {

					lastCall = curr;
					$( <span class="hljs-keyword">this</span> ).trigger( <span class="hljs-string">"throttledresize"</span> );

				} <span class="hljs-keyword">else</span> {

					<span class="hljs-keyword">if</span> ( heldCall ) {
						clearTimeout( heldCall );
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-359">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-359">&#182;</a>
              </div>
              <p>Promise a held call will still execute</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					heldCall = setTimeout( handler, throttle - diff );
				}
			},
			lastCall = <span class="hljs-number">0</span>,
			heldCall,
			curr,
			diff;
	})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window )</span> {</span>
	<span class="hljs-keyword">var</span> win = $( window ),
		event_name = <span class="hljs-string">"orientationchange"</span>,
		get_orientation,
		last_orientation,
		initial_orientation_is_landscape,
		initial_orientation_is_default,
		portrait_map = { <span class="hljs-string">"0"</span>: <span class="hljs-literal">true</span>, <span class="hljs-string">"180"</span>: <span class="hljs-literal">true</span> },
		ww, wh, landscape_threshold;</pre></div></div>
            
        </li>
        
        
        <li id="section-360">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-360">&#182;</a>
              </div>
              <p>It seems that some device/browser vendors use window.orientation values 0 and 180 to
denote the “default” orientation. For iOS devices, and most other smart-phones tested,
the default orientation is always “portrait”, but in some Android and RIM based tablets,
the default orientation is “landscape”. The following code attempts to use the window
dimensions to figure out what the current orientation is, and then makes adjustments
to the to the portrait_map if necessary, so that we can properly decode the
window.orientation value whenever get_orientation() is called.</p>
<p>Note that we used to use a media query to figure out what the orientation the browser
thinks it is in:</p>
<pre><code>initial_orientation_is_landscape = $.mobile.media(<span class="hljs-string">"all and (orientation: landscape)"</span>);
</code></pre><p>but there was an iPhone/iPod Touch bug beginning with iOS 4.2, up through iOS 5.1,
where the browser <em>ALWAYS</em> applied the landscape media query. This bug does not
happen on iPad.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
	<span class="hljs-keyword">if</span> ( $.support.orientation ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-361">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-361">&#182;</a>
              </div>
              <p>Check the window width and height to figure out what the current orientation
of the device is at this moment. Note that we’ve initialized the portrait map
values to 0 and 180, <em>AND</em> we purposely check for landscape so that if we guess
wrong, , we default to the assumption that portrait is the default orientation.
We use a threshold check below because on some platforms like iOS, the iPhone
form-factor can report a larger width than height if the user turns on the
developer console. The actual threshold value is somewhat arbitrary, we just
need to make sure it is large enough to exclude the developer console case.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		ww = window.innerWidth || win.width();
		wh = window.innerHeight || win.height();
		landscape_threshold = <span class="hljs-number">50</span>;

		initial_orientation_is_landscape = ww &gt; wh &amp;&amp; ( ww - wh ) &gt; landscape_threshold;</pre></div></div>
            
        </li>
        
        
        <li id="section-362">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-362">&#182;</a>
              </div>
              <p>Now check to see if the current window.orientation is 0 or 180.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		initial_orientation_is_default = portrait_map[ window.orientation ];</pre></div></div>
            
        </li>
        
        
        <li id="section-363">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-363">&#182;</a>
              </div>
              <p>If the initial orientation is landscape, but window.orientation reports 0 or 180, <em>OR</em>
if the initial orientation is portrait, but window.orientation reports 90 or -90, we
need to flip our portrait_map values because landscape is the default orientation for
this device/browser.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ( initial_orientation_is_landscape &amp;&amp; initial_orientation_is_default ) || ( !initial_orientation_is_landscape &amp;&amp; !initial_orientation_is_default ) ) {
			portrait_map = { <span class="hljs-string">"-90"</span>: <span class="hljs-literal">true</span>, <span class="hljs-string">"90"</span>: <span class="hljs-literal">true</span> };
		}
	}

	$.event.special.orientationchange = $.extend( {}, $.event.special.orientationchange, {
		setup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-364">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-364">&#182;</a>
              </div>
              <p>If the event is supported natively, return false so that jQuery
will bind to the event using DOM methods.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.support.orientation &amp;&amp; !$.event.special.orientationchange.disabled ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-365">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-365">&#182;</a>
              </div>
              <p>Get the current orientation to avoid initial double-triggering.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			last_orientation = get_orientation();</pre></div></div>
            
        </li>
        
        
        <li id="section-366">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-366">&#182;</a>
              </div>
              <p>Because the orientationchange event doesn’t exist, simulate the
event by testing window dimensions on resize.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			win.bind( <span class="hljs-string">"throttledresize"</span>, handler );
		},
		teardown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-367">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-367">&#182;</a>
              </div>
              <p>If the event is not supported natively, return false so that
jQuery will unbind the event using DOM methods.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.support.orientation &amp;&amp; !$.event.special.orientationchange.disabled ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-368">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-368">&#182;</a>
              </div>
              <p>Because the orientationchange event doesn’t exist, unbind the
resize event handler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			win.unbind( <span class="hljs-string">"throttledresize"</span>, handler );
		},
		add: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( handleObj )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-369">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-369">&#182;</a>
              </div>
              <p>Save a reference to the bound event handler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> old_handler = handleObj.handler;

			handleObj.handler = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-370">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-370">&#182;</a>
              </div>
              <p>Modify event object, adding the .orientation property.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				event.orientation = get_orientation();</pre></div></div>
            
        </li>
        
        
        <li id="section-371">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-371">&#182;</a>
              </div>
              <p>Call the originally-bound event handler and return its result.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> old_handler.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
			};
		}
	});</pre></div></div>
            
        </li>
        
        
        <li id="section-372">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-372">&#182;</a>
              </div>
              <p>If the event is not supported natively, this handler will be bound to
the window resize event to simulate the orientationchange event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handler</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-373">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-373">&#182;</a>
              </div>
              <p>Get the current orientation.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> orientation = get_orientation();

		<span class="hljs-keyword">if</span> ( orientation !== last_orientation ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-374">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-374">&#182;</a>
              </div>
              <p>The orientation has changed, so trigger the orientationchange event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			last_orientation = orientation;
			win.trigger( event_name );
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-375">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-375">&#182;</a>
              </div>
              <p>Get the current page orientation. This method is exposed publicly, should it
be needed, as jQuery.event.special.orientationchange.orientation()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.event.special.orientationchange.orientation = get_orientation = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> isPortrait = <span class="hljs-literal">true</span>, elem = document.documentElement;</pre></div></div>
            
        </li>
        
        
        <li id="section-376">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-376">&#182;</a>
              </div>
              <p>prefer window orientation to the calculation based on screensize as
the actual screen resize takes place before or after the orientation change event
has been fired depending on implementation (eg android 2.3 is before, iphone after).
More testing is required to determine if a more reliable method of determining the new screensize
is possible when orientationchange is fired. (eg, use media queries + element + opacity)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.support.orientation ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-377">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-377">&#182;</a>
              </div>
              <p>if the window orientation registers as 0 or 180 degrees report
portrait, otherwise landscape</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isPortrait = portrait_map[ window.orientation ];
		} <span class="hljs-keyword">else</span> {
			isPortrait = elem &amp;&amp; elem.clientWidth / elem.clientHeight &lt; <span class="hljs-number">1.1</span>;
		}

		<span class="hljs-keyword">return</span> isPortrait ? <span class="hljs-string">"portrait"</span> : <span class="hljs-string">"landscape"</span>;
	};

	$.fn[ event_name ] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( fn )</span> {</span>
		<span class="hljs-keyword">return</span> fn ? <span class="hljs-keyword">this</span>.bind( event_name, fn ) : <span class="hljs-keyword">this</span>.trigger( event_name );
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-378">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-378">&#182;</a>
              </div>
              <p>jQuery &lt; 1.8</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( $.attrFn ) {
		$.attrFn[ event_name ] = <span class="hljs-literal">true</span>;
	}

}( jQuery, <span class="hljs-keyword">this</span> ));




(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-379">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-379">&#182;</a>
              </div>
              <p>existing base tag?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> baseElement = $( <span class="hljs-string">"head"</span> ).children( <span class="hljs-string">"base"</span> ),</pre></div></div>
            
        </li>
        
        
        <li id="section-380">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-380">&#182;</a>
              </div>
              <p>base element management, defined depending on dynamic base tag support
TODO move to external widget</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	base = {</pre></div></div>
            
        </li>
        
        
        <li id="section-381">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-381">&#182;</a>
              </div>
              <p>define base element, for use in routing asset urls that are referenced
in Ajax-requested markup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		element: ( baseElement.length ? baseElement :
			$( <span class="hljs-string">"&lt;base&gt;"</span>, { href: $.mobile.path.documentBase.hrefNoHash } ).prependTo( $( <span class="hljs-string">"head"</span> ) ) ),

		linkSelector: <span class="hljs-string">"[src], link[href], a[rel='external'], :jqmData(ajax='false'), a[target]"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-382">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-382">&#182;</a>
              </div>
              <p>set the generated BASE element’s href to a new page’s base path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		set: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( href )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-383">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-383">&#182;</a>
              </div>
              <p>we should do nothing if the user wants to manage their url base
manually</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !$.mobile.dynamicBaseEnabled ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-384">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-384">&#182;</a>
              </div>
              <p>we should use the base tag if we can manipulate it dynamically</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.support.dynamicBaseTag ) {
				base.element.attr( <span class="hljs-string">"href"</span>,
					$.mobile.path.makeUrlAbsolute( href, $.mobile.path.documentBase ) );
			}
		},

		rewrite: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( href, page )</span> {</span>
			<span class="hljs-keyword">var</span> newPath = $.mobile.path.get( href );

			page.find( base.linkSelector ).each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( i, link )</span> {</span>
				<span class="hljs-keyword">var</span> thisAttr = $( link ).is( <span class="hljs-string">"[href]"</span> ) ? <span class="hljs-string">"href"</span> :
					$( link ).is( <span class="hljs-string">"[src]"</span> ) ? <span class="hljs-string">"src"</span> : <span class="hljs-string">"action"</span>,
				thisUrl = $( link ).attr( thisAttr );</pre></div></div>
            
        </li>
        
        
        <li id="section-385">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-385">&#182;</a>
              </div>
              <p>XXX_jblas: We need to fix this so that it removes the document
           base URL, and then prepends with the new page URL.
if full path exists and is same, chop it - helps IE out</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				thisUrl = thisUrl.replace( location.protocol + <span class="hljs-string">"//"</span> +
					location.host + location.pathname, <span class="hljs-string">""</span> );

				<span class="hljs-keyword">if</span> ( !<span class="hljs-regexp">/^(\w+:|#|\/)/</span>.test( thisUrl ) ) {
					$( link ).attr( thisAttr, newPath + thisUrl );
				}
			});
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-386">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-386">&#182;</a>
              </div>
              <p>set the generated BASE element’s href to a new page’s base path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		reset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* href */</span>)</span> {</span>
			base.element.attr( <span class="hljs-string">"href"</span>, $.mobile.path.documentBase.hrefNoSearch );
		}
	};

	$.mobile.base = base;

})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
$.mobile.widgets = {};

<span class="hljs-keyword">var</span> originalWidget = $.widget,</pre></div></div>
            
        </li>
        
        
        <li id="section-387">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-387">&#182;</a>
              </div>
              <p>Record the original, non-mobileinit-modified version of $.mobile.keepNative
so we can later determine whether someone has modified $.mobile.keepNative</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	keepNativeFactoryDefault = $.mobile.keepNative;

$.widget = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( orig )</span> {</span>
	<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> constructor = orig.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> ),
			name = constructor.prototype.widgetName;

		constructor.initSelector = ( ( constructor.prototype.initSelector !== <span class="hljs-literal">undefined</span> ) ?
			constructor.prototype.initSelector : <span class="hljs-string">":jqmData(role='"</span> + name + <span class="hljs-string">"')"</span> );

		$.mobile.widgets[ name ] = constructor;

		<span class="hljs-keyword">return</span> constructor;
	};
})( $.widget );</pre></div></div>
            
        </li>
        
        
        <li id="section-388">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-388">&#182;</a>
              </div>
              <p>Make sure $.widget still has bridge and extend methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.extend( $.widget, originalWidget );</pre></div></div>
            
        </li>
        
        
        <li id="section-389">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-389">&#182;</a>
              </div>
              <p>For backcompat remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.document.on( <span class="hljs-string">"create"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
	$( event.target ).enhanceWithin();
});

$.widget( <span class="hljs-string">"mobile.page"</span>, {
	options: {
		theme: <span class="hljs-string">"a"</span>,
		domCache: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-390">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-390">&#182;</a>
              </div>
              <p>Deprecated in 1.4 remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		keepNativeDefault: $.mobile.keepNative,</pre></div></div>
            
        </li>
        
        
        <li id="section-391">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-391">&#182;</a>
              </div>
              <p>Deprecated in 1.4 remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		contentTheme: <span class="hljs-literal">null</span>,
		enhanced: <span class="hljs-literal">false</span>
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-392">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-392">&#182;</a>
              </div>
              <p>DEPRECATED for &gt; 1.4
TODO remove at 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_createWidget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		$.Widget.prototype._createWidget.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"init"</span> );
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-393">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-393">&#182;</a>
              </div>
              <p>If false is returned by the callbacks do not create the page</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"beforecreate"</span> ) === <span class="hljs-literal">false</span> ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}

		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.options.enhanced ) {
			<span class="hljs-keyword">this</span>._enhance();
		}

		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.element, {
			pagebeforehide: <span class="hljs-string">"removeContainerBackground"</span>,
			pagebeforeshow: <span class="hljs-string">"_handlePageBeforeShow"</span>
		});

		<span class="hljs-keyword">this</span>.element.enhanceWithin();</pre></div></div>
            
        </li>
        
        
        <li id="section-394">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-394">&#182;</a>
              </div>
              <p>Dialog widget is deprecated in 1.4 remove this in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.mobile.getAttribute( <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>], <span class="hljs-string">"role"</span> ) === <span class="hljs-string">"dialog"</span> &amp;&amp; $.mobile.dialog ) {
			<span class="hljs-keyword">this</span>.element.dialog();
		}
	},

	_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> attrPrefix = <span class="hljs-string">"data-"</span> + $.mobile.ns,
			self = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.role ) {
			<span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"role"</span>, <span class="hljs-keyword">this</span>.options.role );
		}

		<span class="hljs-keyword">this</span>.element
			.attr( <span class="hljs-string">"tabindex"</span>, <span class="hljs-string">"0"</span> )
			.addClass( <span class="hljs-string">"ui-page ui-page-theme-"</span> + <span class="hljs-keyword">this</span>.options.theme );</pre></div></div>
            
        </li>
        
        
        <li id="section-395">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-395">&#182;</a>
              </div>
              <p>Manipulation of content os Deprecated as of 1.4 remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"["</span> + attrPrefix + <span class="hljs-string">"role='content']"</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> $<span class="hljs-keyword">this</span> = $( <span class="hljs-keyword">this</span> ),
				theme = <span class="hljs-keyword">this</span>.getAttribute( attrPrefix + <span class="hljs-string">"theme"</span> ) || <span class="hljs-literal">undefined</span>;
				self.options.contentTheme = theme || self.options.contentTheme || ( self.options.dialog &amp;&amp; self.options.theme ) || ( self.element.jqmData(<span class="hljs-string">"role"</span>) === <span class="hljs-string">"dialog"</span> &amp;&amp;  self.options.theme );
				$<span class="hljs-keyword">this</span>.addClass( <span class="hljs-string">"ui-content"</span> );
				<span class="hljs-keyword">if</span> ( self.options.contentTheme ) {
					$<span class="hljs-keyword">this</span>.addClass( <span class="hljs-string">"ui-body-"</span> + ( self.options.contentTheme ) );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-396">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-396">&#182;</a>
              </div>
              <p>Add ARIA role</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				$<span class="hljs-keyword">this</span>.attr( <span class="hljs-string">"role"</span>, <span class="hljs-string">"main"</span> ).addClass( <span class="hljs-string">"ui-content"</span> );
		});
	},

	bindRemove: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( callback )</span> {</span>
		<span class="hljs-keyword">var</span> page = <span class="hljs-keyword">this</span>.element;</pre></div></div>
            
        </li>
        
        
        <li id="section-397">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-397">&#182;</a>
              </div>
              <p>when dom caching is not enabled or the page is embedded bind to remove the page on hide</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !page.data( <span class="hljs-string">"mobile-page"</span> ).options.domCache &amp;&amp;
			page.is( <span class="hljs-string">":jqmData(external-page='true')"</span> ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-398">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-398">&#182;</a>
              </div>
              <p>TODO use _on - that is, sort out why it doesn’t work in this case</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			page.bind( <span class="hljs-string">"pagehide.remove"</span>, callback || <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e, data )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-399">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-399">&#182;</a>
              </div>
              <p>check if this is a same page transition and if so don’t remove the page</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span>( !data.samePage ){
					<span class="hljs-keyword">var</span> $<span class="hljs-keyword">this</span> = $( <span class="hljs-keyword">this</span> ),
						prEvent = <span class="hljs-keyword">new</span> $.Event( <span class="hljs-string">"pageremove"</span> );

					$<span class="hljs-keyword">this</span>.trigger( prEvent );

					<span class="hljs-keyword">if</span> ( !prEvent.isDefaultPrevented() ) {
						$<span class="hljs-keyword">this</span>.removeWithDependents();
					}
				}
			});
		}
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( o )</span> {</span>
		<span class="hljs-keyword">if</span> ( o.theme !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-page-theme-"</span> + <span class="hljs-keyword">this</span>.options.theme ).addClass( <span class="hljs-string">"ui-page-theme-"</span> + o.theme );
		}

		<span class="hljs-keyword">if</span> ( o.contentTheme !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"[data-"</span> + $.mobile.ns + <span class="hljs-string">"='content']"</span> ).removeClass( <span class="hljs-string">"ui-body-"</span> + <span class="hljs-keyword">this</span>.options.contentTheme )
				.addClass( <span class="hljs-string">"ui-body-"</span> + o.contentTheme );
		}
	},

	_handlePageBeforeShow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* e */</span>)</span> {</span>
		<span class="hljs-keyword">this</span>.setContainerBackground();
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-400">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-400">&#182;</a>
              </div>
              <p>Deprecated in 1.4 remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	removeContainerBackground: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.element.closest( <span class="hljs-string">":mobile-pagecontainer"</span> ).pagecontainer({ <span class="hljs-string">"theme"</span>: <span class="hljs-string">"none"</span> });
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-401">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-401">&#182;</a>
              </div>
              <p>Deprecated in 1.4 remove in 1.5
set the page container background to the page theme</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	setContainerBackground: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theme )</span> {</span>
		<span class="hljs-keyword">this</span>.element.parent().pagecontainer( { <span class="hljs-string">"theme"</span>: theme || <span class="hljs-keyword">this</span>.options.theme } );
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-402">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-402">&#182;</a>
              </div>
              <p>Deprecated in 1.4 remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	keepNativeSelector: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
			keepNative = $.trim( options.keepNative || <span class="hljs-string">""</span> ),
			globalValue = $.trim( $.mobile.keepNative ),
			optionValue = $.trim( options.keepNativeDefault ),</pre></div></div>
            
        </li>
        
        
        <li id="section-403">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-403">&#182;</a>
              </div>
              <p>Check if $.mobile.keepNative has changed from the factory default</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			newDefault = ( keepNativeFactoryDefault === globalValue ?
				<span class="hljs-string">""</span> : globalValue ),</pre></div></div>
            
        </li>
        
        
        <li id="section-404">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-404">&#182;</a>
              </div>
              <p>If $.mobile.keepNative has not changed, use options.keepNativeDefault</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			oldDefault = ( newDefault === <span class="hljs-string">""</span> ? optionValue : <span class="hljs-string">""</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-405">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-405">&#182;</a>
              </div>
              <p>Concatenate keepNative selectors from all sources where the value has
changed or, if nothing has changed, return the default</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> ( ( keepNative ? [ keepNative ] : [] )
			.concat( newDefault ? [ newDefault ] : [] )
			.concat( oldDefault ? [ oldDefault ] : [] )
			.join( <span class="hljs-string">", "</span> ) );
	}
});
})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

	$.widget( <span class="hljs-string">"mobile.pagecontainer"</span>, {
		options: {
			theme: <span class="hljs-string">"a"</span>
		},

		initSelector: <span class="hljs-literal">false</span>,

		_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.setLastScrollEnabled = <span class="hljs-literal">true</span>;

			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.window, {</pre></div></div>
            
        </li>
        
        
        <li id="section-406">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-406">&#182;</a>
              </div>
              <p>disable an scroll setting when a hashchange has been fired,
this only works because the recording of the scroll position
is delayed for 100ms after the browser might have changed the
position because of the hashchange</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				navigate: <span class="hljs-string">"_disableRecordScroll"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-407">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-407">&#182;</a>
              </div>
              <p>bind to scrollstop for the first page, “pagechange” won’t be
fired in that case</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				scrollstop: <span class="hljs-string">"_delayedRecordScroll"</span>
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-408">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-408">&#182;</a>
              </div>
              <p>TODO consider moving the navigation handler OUT of widget into
     some other object as glue between the navigate event and the
     content widget load and change methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.window, { navigate: <span class="hljs-string">"_filterNavigateEvents"</span> });</pre></div></div>
            
        </li>
        
        
        <li id="section-409">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-409">&#182;</a>
              </div>
              <p>TODO move from page<em> events to content</em> events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._on({ pagechange: <span class="hljs-string">"_afterContentChange"</span> });</pre></div></div>
            
        </li>
        
        
        <li id="section-410">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-410">&#182;</a>
              </div>
              <p>handle initial hashchange from chrome :(</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.window.one( <span class="hljs-string">"navigate"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>.setLastScrollEnabled = <span class="hljs-literal">true</span>;
			}, <span class="hljs-keyword">this</span>));
		},

		_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
			<span class="hljs-keyword">if</span> ( options.theme !== <span class="hljs-literal">undefined</span> &amp;&amp; options.theme !== <span class="hljs-string">"none"</span> ) {
				<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-overlay-"</span> + <span class="hljs-keyword">this</span>.options.theme )
					.addClass( <span class="hljs-string">"ui-overlay-"</span> + options.theme );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( options.theme !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-overlay-"</span> + <span class="hljs-keyword">this</span>.options.theme );
			}

			<span class="hljs-keyword">this</span>._super( options );
		},

		_disableRecordScroll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.setLastScrollEnabled = <span class="hljs-literal">false</span>;
		},

		_enableRecordScroll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.setLastScrollEnabled = <span class="hljs-literal">true</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-411">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-411">&#182;</a>
              </div>
              <p>TODO consider the name here, since it’s purpose specific</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_afterContentChange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-412">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-412">&#182;</a>
              </div>
              <p>once the page has changed, re-enable the scroll recording</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.setLastScrollEnabled = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-413">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-413">&#182;</a>
              </div>
              <p>remove any binding that previously existed on the get scroll
which may or may not be different than the scroll element
determined for this page previously</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._off( <span class="hljs-keyword">this</span>.window, <span class="hljs-string">"scrollstop"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-414">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-414">&#182;</a>
              </div>
              <p>determine and bind to the current scoll element which may be the
window or in the case of touch overflow the element touch overflow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.window, { scrollstop: <span class="hljs-string">"_delayedRecordScroll"</span> });
		},

		_recordScroll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-415">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-415">&#182;</a>
              </div>
              <p>this barrier prevents setting the scroll value based on
the browser scrolling the window based on a hashchange</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.setLastScrollEnabled ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">var</span> active = <span class="hljs-keyword">this</span>._getActiveHistory(),
				currentScroll, minScroll, defaultScroll;

			<span class="hljs-keyword">if</span> ( active ) {
				currentScroll = <span class="hljs-keyword">this</span>._getScroll();
				minScroll = <span class="hljs-keyword">this</span>._getMinScroll();
				defaultScroll = <span class="hljs-keyword">this</span>._getDefaultScroll();</pre></div></div>
            
        </li>
        
        
        <li id="section-416">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-416">&#182;</a>
              </div>
              <p>Set active page’s lastScroll prop. If the location we’re
scrolling to is less than minScrollBack, let it go.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				active.lastScroll = currentScroll &lt; minScroll ? defaultScroll : currentScroll;
			}
		},

		_delayedRecordScroll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			setTimeout( $.proxy(<span class="hljs-keyword">this</span>, <span class="hljs-string">"_recordScroll"</span>), <span class="hljs-number">100</span> );
		},

		_getScroll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.window.scrollTop();
		},

		_getMinScroll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.minScrollBack;
		},

		_getDefaultScroll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.defaultHomeScroll;
		},

		_filterNavigateEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e, data )</span> {</span>
			<span class="hljs-keyword">var</span> url;

			<span class="hljs-keyword">if</span> ( e.originalEvent &amp;&amp; e.originalEvent.isDefaultPrevented() ) {
				<span class="hljs-keyword">return</span>;
			}

			url = e.originalEvent.type.indexOf( <span class="hljs-string">"hashchange"</span> ) &gt; -<span class="hljs-number">1</span> ? data.state.hash : data.state.url;

			<span class="hljs-keyword">if</span> ( !url ) {
				url = <span class="hljs-keyword">this</span>._getHash();
			}

			<span class="hljs-keyword">if</span> ( !url || url === <span class="hljs-string">"#"</span> || url.indexOf( <span class="hljs-string">"#"</span> + $.mobile.path.uiStateKey ) === <span class="hljs-number">0</span> ) {
				url = location.href;
			}

			<span class="hljs-keyword">this</span>._handleNavigate( url, data.state );
		},

		_getHash: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.path.parseLocation().hash;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-417">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-417">&#182;</a>
              </div>
              <p>TODO active page should be managed by the container (ie, it should be a property)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		getActivePage: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.activePage;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-418">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-418">&#182;</a>
              </div>
              <p>TODO the first page should be a property set during _create using the logic
     that currently resides in init</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_getInitialContent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.firstPage;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-419">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-419">&#182;</a>
              </div>
              <p>TODO each content container should have a history object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_getHistory: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.navigate.history;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-420">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-420">&#182;</a>
              </div>
              <p>TODO use _getHistory</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_getActiveHistory: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.navigate.history.getActive();
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-421">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-421">&#182;</a>
              </div>
              <p>TODO the document base should be determined at creation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_getDocumentBase: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.path.documentBase;
		},

		back: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.go( -<span class="hljs-number">1</span> );
		},

		forward: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.go( <span class="hljs-number">1</span> );
		},

		go: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( steps )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-422">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-422">&#182;</a>
              </div>
              <p>if hashlistening is enabled use native history method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.mobile.hashListeningEnabled ) {
				window.history.go( steps );
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-423">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-423">&#182;</a>
              </div>
              <p>we are not listening to the hash so handle history internally</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">var</span> activeIndex = $.mobile.navigate.history.activeIndex,
					index = activeIndex + <span class="hljs-built_in">parseInt</span>( steps, <span class="hljs-number">10</span> ),
					url = $.mobile.navigate.history.stack[ index ].url,
					direction = ( steps &gt;= <span class="hljs-number">1</span> )? <span class="hljs-string">"forward"</span> : <span class="hljs-string">"back"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-424">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-424">&#182;</a>
              </div>
              <p>update the history object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				$.mobile.navigate.history.activeIndex = index;
				$.mobile.navigate.history.previousIndex = activeIndex;</pre></div></div>
            
        </li>
        
        
        <li id="section-425">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-425">&#182;</a>
              </div>
              <p>change to the new page</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.change( url, { direction: direction, changeHash: <span class="hljs-literal">false</span>, fromHashChange: <span class="hljs-literal">true</span> } );
			}
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-426">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-426">&#182;</a>
              </div>
              <p>TODO rename _handleDestination</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_handleDestination: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( to )</span> {</span>
			<span class="hljs-keyword">var</span> history;</pre></div></div>
            
        </li>
        
        
        <li id="section-427">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-427">&#182;</a>
              </div>
              <p>clean the hash for comparison if it’s a url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.type(to) === <span class="hljs-string">"string"</span> ) {
				to = $.mobile.path.stripHash( to );
			}

			<span class="hljs-keyword">if</span> ( to ) {
				history = <span class="hljs-keyword">this</span>._getHistory();</pre></div></div>
            
        </li>
        
        
        <li id="section-428">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-428">&#182;</a>
              </div>
              <p>At this point, ‘to’ can be one of 3 things, a cached page
element from a history stack entry, an id, or site-relative /
absolute URL. If ‘to’ is an id, we need to resolve it against
the documentBase, not the location.href, since the hashchange
could’ve been the result of a forward/backward navigation
that crosses from an external page/dialog to an internal
page/dialog.</p>
<p>TODO move check to history object or path object?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				to = !$.mobile.path.isPath( to ) ? ( $.mobile.path.makeUrlAbsolute( <span class="hljs-string">"#"</span> + to, <span class="hljs-keyword">this</span>._getDocumentBase() ) ) : to;</pre></div></div>
            
        </li>
        
        
        <li id="section-429">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-429">&#182;</a>
              </div>
              <p>If we’re about to go to an initial URL that contains a
reference to a non-existent internal page, go to the first
page instead. We know that the initial hash refers to a
non-existent page, because the initial hash did not end
up in the initial history entry
TODO move check to history object?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( to === $.mobile.path.makeUrlAbsolute( <span class="hljs-string">"#"</span> + history.initialDst, <span class="hljs-keyword">this</span>._getDocumentBase() ) &amp;&amp;
					history.stack.length &amp;&amp;
					history.stack[<span class="hljs-number">0</span>].url !== history.initialDst.replace( $.mobile.dialogHashKey, <span class="hljs-string">""</span> ) ) {
					to = <span class="hljs-keyword">this</span>._getInitialContent();
				}
			}
			<span class="hljs-keyword">return</span> to || <span class="hljs-keyword">this</span>._getInitialContent();
		},

		_handleDialog: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( changePageOptions, data )</span> {</span>
			<span class="hljs-keyword">var</span> to, active, activeContent = <span class="hljs-keyword">this</span>.getActivePage();</pre></div></div>
            
        </li>
        
        
        <li id="section-430">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-430">&#182;</a>
              </div>
              <p>If current active page is not a dialog skip the dialog and continue
in the same direction</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( activeContent &amp;&amp; !activeContent.hasClass( <span class="hljs-string">"ui-dialog"</span> ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-431">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-431">&#182;</a>
              </div>
              <p>determine if we’re heading forward or backward and continue
accordingly past the current dialog</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( data.direction === <span class="hljs-string">"back"</span> ) {
					<span class="hljs-keyword">this</span>.back();
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">this</span>.forward();
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-432">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-432">&#182;</a>
              </div>
              <p>prevent changePage call</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-433">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-433">&#182;</a>
              </div>
              <p>if the current active page is a dialog and we’re navigating
to a dialog use the dialog objected saved in the stack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				to = data.pageUrl;
				active = <span class="hljs-keyword">this</span>._getActiveHistory();</pre></div></div>
            
        </li>
        
        
        <li id="section-434">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-434">&#182;</a>
              </div>
              <p>make sure to set the role, transition and reversal
as most of this is lost by the domCache cleaning</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				$.extend( changePageOptions, {
					role: active.role,
					transition: active.transition,
					reverse: data.direction === <span class="hljs-string">"back"</span>
				});
			}

			<span class="hljs-keyword">return</span> to;
		},

		_handleNavigate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, data )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-435">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-435">&#182;</a>
              </div>
              <p>find first page via hash
TODO stripping the hash twice with handleUrl</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> to = $.mobile.path.stripHash( url ), history = <span class="hljs-keyword">this</span>._getHistory(),</pre></div></div>
            
        </li>
        
        
        <li id="section-436">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-436">&#182;</a>
              </div>
              <p>transition is false if it’s the first page, undefined
otherwise (and may be overridden by default)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				transition = history.stack.length === <span class="hljs-number">0</span> ? <span class="hljs-string">"none"</span> : <span class="hljs-literal">undefined</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-437">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-437">&#182;</a>
              </div>
              <p>default options for the changPage calls made after examining
the current state of the page and the hash, NOTE that the
transition is derived from the previous history entry</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				changePageOptions = {
					changeHash: <span class="hljs-literal">false</span>,
					fromHashChange: <span class="hljs-literal">true</span>,
					reverse: data.direction === <span class="hljs-string">"back"</span>
				};

			$.extend( changePageOptions, data, {
				transition: ( history.getLast() || {} ).transition || transition
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-438">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-438">&#182;</a>
              </div>
              <p>TODO move to _handleDestination ?
If this isn’t the first page, if the current url is a dialog hash
key, and the initial destination isn’t equal to the current target
page, use the special dialog handling</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( history.activeIndex &gt; <span class="hljs-number">0</span> &amp;&amp;
				to.indexOf( $.mobile.dialogHashKey ) &gt; -<span class="hljs-number">1</span> &amp;&amp;
				history.initialDst !== to ) {

				to = <span class="hljs-keyword">this</span>._handleDialog( changePageOptions, data );

				<span class="hljs-keyword">if</span> ( to === <span class="hljs-literal">false</span> ) {
					<span class="hljs-keyword">return</span>;
				}
			}

			<span class="hljs-keyword">this</span>._changeContent( <span class="hljs-keyword">this</span>._handleDestination( to ), changePageOptions );
		},

		_changeContent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( to, opts )</span> {</span>
			$.mobile.changePage( to, opts );
		},

		_getBase: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.base;
		},

		_getNs: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.ns;
		},

		_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( content, role )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-439">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-439">&#182;</a>
              </div>
              <p>TODO consider supporting a custom callback, and passing in
the settings which includes the role</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> content.page({ role: role });
		},

		_include: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( page, settings )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-440">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-440">&#182;</a>
              </div>
              <p>append to page and enhance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			page.appendTo( <span class="hljs-keyword">this</span>.element );</pre></div></div>
            
        </li>
        
        
        <li id="section-441">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-441">&#182;</a>
              </div>
              <p>use the page widget to enhance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._enhance( page, settings.role );</pre></div></div>
            
        </li>
        
        
        <li id="section-442">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-442">&#182;</a>
              </div>
              <p>remove page on hide</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			page.page( <span class="hljs-string">"bindRemove"</span> );
		},

		_find: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( absUrl )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-443">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-443">&#182;</a>
              </div>
              <p>TODO consider supporting a custom callback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> fileUrl = <span class="hljs-keyword">this</span>._createFileUrl( absUrl ),
				dataUrl = <span class="hljs-keyword">this</span>._createDataUrl( absUrl ),
				page, initialContent = <span class="hljs-keyword">this</span>._getInitialContent();</pre></div></div>
            
        </li>
        
        
        <li id="section-444">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-444">&#182;</a>
              </div>
              <p>Check to see if the page already exists in the DOM.
NOTE do <em>not</em> use the :jqmData pseudo selector because parenthesis
     are a valid url char and it breaks on the first occurence</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			page = <span class="hljs-keyword">this</span>.element
				.children( <span class="hljs-string">"[data-"</span> + <span class="hljs-keyword">this</span>._getNs() +<span class="hljs-string">"url='"</span> + dataUrl + <span class="hljs-string">"']"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-445">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-445">&#182;</a>
              </div>
              <p>If we failed to find the page, check to see if the url is a
reference to an embedded page. If so, it may have been dynamically
injected by a developer, in which case it would be lacking a
data-url attribute and in need of enhancement.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( page.length === <span class="hljs-number">0</span> &amp;&amp; dataUrl &amp;&amp; !$.mobile.path.isPath( dataUrl ) ) {
				page = <span class="hljs-keyword">this</span>.element.children( $.mobile.path.hashToSelector(<span class="hljs-string">"#"</span> + dataUrl) )
					.attr( <span class="hljs-string">"data-"</span> + <span class="hljs-keyword">this</span>._getNs() + <span class="hljs-string">"url"</span>, dataUrl )
					.jqmData( <span class="hljs-string">"url"</span>, dataUrl );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-446">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-446">&#182;</a>
              </div>
              <p>If we failed to find a page in the DOM, check the URL to see if it
refers to the first page in the application. Also check to make sure
our cached-first-page is actually in the DOM. Some user deployed
apps are pruning the first page from the DOM for various reasons.
We check for this case here because we don’t want a first-page with
an id falling through to the non-existent embedded page error case.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( page.length === <span class="hljs-number">0</span> &amp;&amp;
				$.mobile.path.isFirstPageUrl( fileUrl ) &amp;&amp;
				initialContent &amp;&amp;
				initialContent.parent().length ) {
				page = $( initialContent );
			}

			<span class="hljs-keyword">return</span> page;
		},

		_getLoader: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.loading();
		},

		_showLoading: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( delay, theme, msg, textonly )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-447">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-447">&#182;</a>
              </div>
              <p>This configurable timeout allows cached pages a brief
delay to load without showing a message</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._loadMsg ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">this</span>._loadMsg = setTimeout($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>._getLoader().loader( <span class="hljs-string">"show"</span>, theme, msg, textonly );
				<span class="hljs-keyword">this</span>._loadMsg = <span class="hljs-number">0</span>;
			}, <span class="hljs-keyword">this</span>), delay );
		},

		_hideLoading: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-448">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-448">&#182;</a>
              </div>
              <p>Stop message show timer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			clearTimeout( <span class="hljs-keyword">this</span>._loadMsg );
			<span class="hljs-keyword">this</span>._loadMsg = <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-449">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-449">&#182;</a>
              </div>
              <p>Hide loading message</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._getLoader().loader( <span class="hljs-string">"hide"</span> );
		},

		_showError: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-450">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-450">&#182;</a>
              </div>
              <p>make sure to remove the current loading message</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._hideLoading();</pre></div></div>
            
        </li>
        
        
        <li id="section-451">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-451">&#182;</a>
              </div>
              <p>show the error message</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._showLoading( <span class="hljs-number">0</span>, $.mobile.pageLoadErrorMessageTheme, $.mobile.pageLoadErrorMessage, <span class="hljs-literal">true</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-452">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-452">&#182;</a>
              </div>
              <p>hide the error message after a delay
TODO configuration</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			setTimeout( $.proxy(<span class="hljs-keyword">this</span>, <span class="hljs-string">"_hideLoading"</span>), <span class="hljs-number">1500</span> );
		},

		_parse: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( html, fileUrl )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-453">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-453">&#182;</a>
              </div>
              <p>TODO consider allowing customization of this method. It’s very JQM specific</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> page, all = $( <span class="hljs-string">"&lt;div&gt;&lt;/div&gt;"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-454">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-454">&#182;</a>
              </div>
              <p>workaround to allow scripts to execute when included in page divs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			all.get( <span class="hljs-number">0</span> ).innerHTML = html;

			page = all.find( <span class="hljs-string">":jqmData(role='page'), :jqmData(role='dialog')"</span> ).first();</pre></div></div>
            
        </li>
        
        
        <li id="section-455">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-455">&#182;</a>
              </div>
              <p>if page elem couldn’t be found, create one and insert the body element’s contents</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !page.length ) {
				page = $( <span class="hljs-string">"&lt;div data-"</span> + <span class="hljs-keyword">this</span>._getNs() + <span class="hljs-string">"role='page'&gt;"</span> +
					( html.split( <span class="hljs-regexp">/&lt;\/?body[^&gt;]*&gt;/gmi</span> )[<span class="hljs-number">1</span>] || <span class="hljs-string">""</span> ) +
					<span class="hljs-string">"&lt;/div&gt;"</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-456">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-456">&#182;</a>
              </div>
              <p>TODO tagging a page with external to make sure that embedded pages aren’t
removed by the various page handling code is bad. Having page handling code
in many places is bad. Solutions post 1.0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			page.attr( <span class="hljs-string">"data-"</span> + <span class="hljs-keyword">this</span>._getNs() + <span class="hljs-string">"url"</span>, $.mobile.path.convertUrlToDataUrl(fileUrl) )
				.attr( <span class="hljs-string">"data-"</span> + <span class="hljs-keyword">this</span>._getNs() + <span class="hljs-string">"external-page"</span>, <span class="hljs-literal">true</span> );

			<span class="hljs-keyword">return</span> page;
		},

		_setLoadedTitle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( page, html )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-457">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-457">&#182;</a>
              </div>
              <p>page title regexp</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> newPageTitle = html.match( <span class="hljs-regexp">/&lt;title[^&gt;]*&gt;([^&lt;]*)/</span> ) &amp;&amp; <span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span>;

			<span class="hljs-keyword">if</span> ( newPageTitle &amp;&amp; !page.jqmData(<span class="hljs-string">"title"</span>) ) {
				newPageTitle = $( <span class="hljs-string">"&lt;div&gt;"</span> + newPageTitle + <span class="hljs-string">"&lt;/div&gt;"</span> ).text();
				page.jqmData( <span class="hljs-string">"title"</span>, newPageTitle );
			}
		},

		_isRewritableBaseTag: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.dynamicBaseEnabled &amp;&amp; !$.support.dynamicBaseTag;
		},

		_createDataUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( absoluteUrl )</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.path.convertUrlToDataUrl( absoluteUrl );
		},

		_createFileUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( absoluteUrl )</span> {</span>
			<span class="hljs-keyword">return</span> $.mobile.path.getFilePath( absoluteUrl );
		},

		_triggerWithDeprecated: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( name, data, page )</span> {</span>
			<span class="hljs-keyword">var</span> deprecatedEvent = $.Event( <span class="hljs-string">"page"</span> + name ),
				newEvent = $.Event( <span class="hljs-keyword">this</span>.widgetName + name );</pre></div></div>
            
        </li>
        
        
        <li id="section-458">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-458">&#182;</a>
              </div>
              <p>DEPRECATED
trigger the old deprecated event on the page if it’s provided</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			( page || <span class="hljs-keyword">this</span>.element ).trigger( deprecatedEvent, data );</pre></div></div>
            
        </li>
        
        
        <li id="section-459">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-459">&#182;</a>
              </div>
              <p>use the widget trigger method for the new content* event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element.trigger( newEvent, data );

			<span class="hljs-keyword">return</span> {
				deprecatedEvent: deprecatedEvent,
				event: newEvent
			};
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-460">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-460">&#182;</a>
              </div>
              <p>TODO it would be nice to split this up more but everything appears to be “one off”
     or require ordering such that other bits are sprinkled in between parts that
     could be abstracted out as a group</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_loadSuccess: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( absUrl, triggerData, settings, deferred )</span> {</span>
			<span class="hljs-keyword">var</span> fileUrl = <span class="hljs-keyword">this</span>._createFileUrl( absUrl ),
				dataUrl = <span class="hljs-keyword">this</span>._createDataUrl( absUrl );

			<span class="hljs-keyword">return</span> $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( html, textStatus, xhr )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-461">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-461">&#182;</a>
              </div>
              <p>pre-parse html to check for a data-url,
use it as the new fileUrl, base path, etc</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">var</span> content,</pre></div></div>
            
        </li>
        
        
        <li id="section-462">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-462">&#182;</a>
              </div>
              <p>TODO handle dialogs again</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					pageElemRegex = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>( <span class="hljs-string">"(&lt;[^&gt;]+\\bdata-"</span> + <span class="hljs-keyword">this</span>._getNs() + <span class="hljs-string">"role=[\"']?page[\"']?[^&gt;]*&gt;)"</span> ),

					dataUrlRegex = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>( <span class="hljs-string">"\\bdata-"</span> + <span class="hljs-keyword">this</span>._getNs() + <span class="hljs-string">"url=[\"']?([^\"'&gt;]*)[\"']?"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-463">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-463">&#182;</a>
              </div>
              <p>data-url must be provided for the base tag so resource requests
can be directed to the correct url. loading into a temprorary
element makes these requests immediately</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( pageElemRegex.test( html ) &amp;&amp;
					<span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span> &amp;&amp;
					dataUrlRegex.test( <span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span> ) &amp;&amp;
					<span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span> ) {
					fileUrl = $.mobile.path.getFilePath( $(<span class="hljs-string">"&lt;div&gt;"</span> + <span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span> + <span class="hljs-string">"&lt;/div&gt;"</span>).text() );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-464">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-464">&#182;</a>
              </div>
              <p>dont update the base tag if we are prefetching</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( settings.prefetch === <span class="hljs-literal">undefined</span> ) {
					<span class="hljs-keyword">this</span>._getBase().set( fileUrl );
				}

				content = <span class="hljs-keyword">this</span>._parse( html, fileUrl );

				<span class="hljs-keyword">this</span>._setLoadedTitle( content, html );</pre></div></div>
            
        </li>
        
        
        <li id="section-465">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-465">&#182;</a>
              </div>
              <p>Add the content reference and xhr to our triggerData.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				triggerData.xhr = xhr;
				triggerData.textStatus = textStatus;</pre></div></div>
            
        </li>
        
        
        <li id="section-466">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-466">&#182;</a>
              </div>
              <p>DEPRECATED</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				triggerData.page = content;

				triggerData.content = content;</pre></div></div>
            
        </li>
        
        
        <li id="section-467">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-467">&#182;</a>
              </div>
              <p>If the default behavior is prevented, stop here!
Note that it is the responsibility of the listener/handler
that called preventDefault(), to resolve/reject the
deferred object within the triggerData.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"load"</span>, <span class="hljs-literal">undefined</span>, triggerData ) ) {
					<span class="hljs-keyword">return</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-468">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-468">&#182;</a>
              </div>
              <p>rewrite src and href attrs to use a base url if the base tag won’t work</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isRewritableBaseTag() &amp;&amp; content ) {
					<span class="hljs-keyword">this</span>._getBase().rewrite( fileUrl, content );
				}

				<span class="hljs-keyword">this</span>._include( content, settings );</pre></div></div>
            
        </li>
        
        
        <li id="section-469">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-469">&#182;</a>
              </div>
              <p>Enhancing the content may result in new dialogs/sub content being inserted
into the DOM. If the original absUrl refers to a sub-content, that is the
real content we are interested in.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( absUrl.indexOf( <span class="hljs-string">"&amp;"</span> + $.mobile.subPageUrlKey ) &gt; -<span class="hljs-number">1</span> ) {
					content = <span class="hljs-keyword">this</span>.element.children( <span class="hljs-string">"[data-"</span> + <span class="hljs-keyword">this</span>._getNs() +<span class="hljs-string">"url='"</span> + dataUrl + <span class="hljs-string">"']"</span> );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-470">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-470">&#182;</a>
              </div>
              <p>Remove loading message.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( settings.showLoadMsg ) {
					<span class="hljs-keyword">this</span>._hideLoading();
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-471">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-471">&#182;</a>
              </div>
              <p>BEGIN DEPRECATED —————————————————————————-
Let listeners know the content loaded successfully.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.element.trigger( <span class="hljs-string">"pageload"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-472">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-472">&#182;</a>
              </div>
              <p>END DEPRECATED ——————————————————————————-</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
				deferred.resolve( absUrl, settings, content );
			}, <span class="hljs-keyword">this</span>);
		},

		_loadDefaults: {
			type: <span class="hljs-string">"get"</span>,
			data: <span class="hljs-literal">undefined</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-473">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-473">&#182;</a>
              </div>
              <p>DEPRECATED</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			reloadPage: <span class="hljs-literal">false</span>,

			reload: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-474">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-474">&#182;</a>
              </div>
              <p>By default we rely on the role defined by the @data-role attribute.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			role: <span class="hljs-literal">undefined</span>,

			showLoadMsg: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-475">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-475">&#182;</a>
              </div>
              <p>This delay allows loads that pull from browser cache to
occur without showing the loading message.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			loadMsgDelay: <span class="hljs-number">50</span>
		},

		load: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, options )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-476">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-476">&#182;</a>
              </div>
              <p>This function uses deferred notifications to let callers
know when the content is done loading, or if an error has occurred.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> deferred = ( options &amp;&amp; options.deferred ) || $.Deferred(),</pre></div></div>
            
        </li>
        
        
        <li id="section-477">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-477">&#182;</a>
              </div>
              <p>The default load options with overrides specified by the caller.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				settings = $.extend( {}, <span class="hljs-keyword">this</span>._loadDefaults, options ),</pre></div></div>
            
        </li>
        
        
        <li id="section-478">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-478">&#182;</a>
              </div>
              <p>The DOM element for the content after it has been loaded.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				content = <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-479">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-479">&#182;</a>
              </div>
              <p>The absolute version of the URL passed into the function. This
version of the URL may contain dialog/subcontent params in it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				absUrl = $.mobile.path.makeUrlAbsolute( url, <span class="hljs-keyword">this</span>._findBaseWithDefault() ),
				fileUrl, dataUrl, pblEvent, triggerData;</pre></div></div>
            
        </li>
        
        
        <li id="section-480">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-480">&#182;</a>
              </div>
              <p>DEPRECATED reloadPage</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			settings.reload = settings.reloadPage;</pre></div></div>
            
        </li>
        
        
        <li id="section-481">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-481">&#182;</a>
              </div>
              <p>If the caller provided data, and we’re using “get” request,
append the data to the URL.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( settings.data &amp;&amp; settings.type === <span class="hljs-string">"get"</span> ) {
				absUrl = $.mobile.path.addSearchParams( absUrl, settings.data );
				settings.data = <span class="hljs-literal">undefined</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-482">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-482">&#182;</a>
              </div>
              <p>If the caller is using a “post” request, reload must be true</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( settings.data &amp;&amp; settings.type === <span class="hljs-string">"post"</span> ) {
				settings.reload = <span class="hljs-literal">true</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-483">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-483">&#182;</a>
              </div>
              <p>The absolute version of the URL minus any dialog/subcontent params.
In otherwords the real URL of the content to be loaded.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			fileUrl = <span class="hljs-keyword">this</span>._createFileUrl( absUrl );</pre></div></div>
            
        </li>
        
        
        <li id="section-484">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-484">&#182;</a>
              </div>
              <p>The version of the Url actually stored in the data-url attribute of
the content. For embedded content, it is just the id of the page. For
content within the same domain as the document base, it is the site
relative path. For cross-domain content (Phone Gap only) the entire
absolute Url is used to load the content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			dataUrl = <span class="hljs-keyword">this</span>._createDataUrl( absUrl );

			content = <span class="hljs-keyword">this</span>._find( absUrl );</pre></div></div>
            
        </li>
        
        
        <li id="section-485">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-485">&#182;</a>
              </div>
              <p>If it isn’t a reference to the first content and refers to missing
embedded content reject the deferred and return</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( content.length === <span class="hljs-number">0</span> &amp;&amp;
				$.mobile.path.isEmbeddedPage(fileUrl) &amp;&amp;
				!$.mobile.path.isFirstPageUrl(fileUrl) ) {
				deferred.reject( absUrl, settings );
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-486">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-486">&#182;</a>
              </div>
              <p>Reset base to the default document base
TODO figure out why we doe this</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._getBase().reset();</pre></div></div>
            
        </li>
        
        
        <li id="section-487">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-487">&#182;</a>
              </div>
              <p>If the content we are interested in is already in the DOM,
and the caller did not indicate that we should force a
reload of the file, we are done. Resolve the deferrred so that
users can bind to .done on the promise</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( content.length &amp;&amp; !settings.reload ) {
				<span class="hljs-keyword">this</span>._enhance( content, settings.role );
				deferred.resolve( absUrl, settings, content );</pre></div></div>
            
        </li>
        
        
        <li id="section-488">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-488">&#182;</a>
              </div>
              <p>if we are reloading the content make sure we update
the base if its not a prefetch</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !settings.prefetch ) {
					<span class="hljs-keyword">this</span>._getBase().set(url);
				}

				<span class="hljs-keyword">return</span>;
			}

			triggerData = {
				url: url,
				absUrl: absUrl,
				dataUrl: dataUrl,
				deferred: deferred,
				options: settings
			};</pre></div></div>
            
        </li>
        
        
        <li id="section-489">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-489">&#182;</a>
              </div>
              <p>Let listeners know we’re about to load content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			pblEvent = <span class="hljs-keyword">this</span>._triggerWithDeprecated( <span class="hljs-string">"beforeload"</span>, triggerData );</pre></div></div>
            
        </li>
        
        
        <li id="section-490">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-490">&#182;</a>
              </div>
              <p>If the default behavior is prevented, stop here!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( pblEvent.deprecatedEvent.isDefaultPrevented() ||
				pblEvent.event.isDefaultPrevented() ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">if</span> ( settings.showLoadMsg ) {
				<span class="hljs-keyword">this</span>._showLoading( settings.loadMsgDelay );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-491">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-491">&#182;</a>
              </div>
              <p>Reset base to the default document base.
only reset if we are not prefetching</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( settings.prefetch === <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>._getBase().reset();
			}

			<span class="hljs-keyword">if</span> ( !( $.mobile.allowCrossDomainPages ||
				$.mobile.path.isSameDomain($.mobile.path.documentUrl, absUrl ) ) ) {
				deferred.reject( absUrl, settings );
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-492">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-492">&#182;</a>
              </div>
              <p>Load the new content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.ajax({
				url: fileUrl,
				type: settings.type,
				data: settings.data,
				contentType: settings.contentType,
				dataType: <span class="hljs-string">"html"</span>,
				success: <span class="hljs-keyword">this</span>._loadSuccess( absUrl, triggerData, settings, deferred ),
				error: <span class="hljs-keyword">this</span>._loadError( absUrl, triggerData, settings, deferred )
			});
		},

		_loadError: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( absUrl, triggerData, settings, deferred )</span> {</span>
			<span class="hljs-keyword">return</span> $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( xhr, textStatus, errorThrown )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-493">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-493">&#182;</a>
              </div>
              <p>set base back to current path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>._getBase().set( $.mobile.path.get() );</pre></div></div>
            
        </li>
        
        
        <li id="section-494">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-494">&#182;</a>
              </div>
              <p>Add error info to our triggerData.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				triggerData.xhr = xhr;
				triggerData.textStatus = textStatus;
				triggerData.errorThrown = errorThrown;</pre></div></div>
            
        </li>
        
        
        <li id="section-495">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-495">&#182;</a>
              </div>
              <p>Let listeners know the page load failed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">var</span> plfEvent = <span class="hljs-keyword">this</span>._triggerWithDeprecated( <span class="hljs-string">"loadfailed"</span>, triggerData );</pre></div></div>
            
        </li>
        
        
        <li id="section-496">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-496">&#182;</a>
              </div>
              <p>If the default behavior is prevented, stop here!
Note that it is the responsibility of the listener/handler
that called preventDefault(), to resolve/reject the
deferred object within the triggerData.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( plfEvent.deprecatedEvent.isDefaultPrevented() ||
					plfEvent.event.isDefaultPrevented() ) {
					<span class="hljs-keyword">return</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-497">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-497">&#182;</a>
              </div>
              <p>Remove loading message.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( settings.showLoadMsg ) {
					<span class="hljs-keyword">this</span>._showError();
				}

				deferred.reject( absUrl, settings );
			}, <span class="hljs-keyword">this</span>);
		},

		_getTransitionHandler: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( transition )</span> {</span>
			transition = $.mobile._maybeDegradeTransition( transition );</pre></div></div>
            
        </li>
        
        
        <li id="section-498">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-498">&#182;</a>
              </div>
              <p>find the transition handler for the specified transition. If there
isn’t one in our transitionHandlers dictionary, use the default one.
call the handler immediately to kick-off the transition.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> $.mobile.transitionHandlers[ transition ] || $.mobile.defaultTransitionHandler;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-499">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-499">&#182;</a>
              </div>
              <p>TODO move into transition handlers?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_triggerCssTransitionEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( to, from, prefix )</span> {</span>
			<span class="hljs-keyword">var</span> samePage = <span class="hljs-literal">false</span>;

			prefix = prefix || <span class="hljs-string">""</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-500">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-500">&#182;</a>
              </div>
              <p>TODO decide if these events should in fact be triggered on the container</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( from ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-501">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-501">&#182;</a>
              </div>
              <p>Check if this is a same page transition and tell the handler in page</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span>( to[<span class="hljs-number">0</span>] === from[<span class="hljs-number">0</span>] ){
					samePage = <span class="hljs-literal">true</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-502">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-502">&#182;</a>
              </div>
              <p>trigger before show/hide events
TODO deprecate nextPage in favor of next</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>._triggerWithDeprecated( prefix + <span class="hljs-string">"hide"</span>, { nextPage: to, samePage: samePage }, from );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-503">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-503">&#182;</a>
              </div>
              <p>TODO deprecate prevPage in favor of previous</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._triggerWithDeprecated( prefix + <span class="hljs-string">"show"</span>, { prevPage: from || $( <span class="hljs-string">""</span> ) }, to );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-504">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-504">&#182;</a>
              </div>
              <p>TODO make private once change has been defined in the widget</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_cssTransition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( to, from, options )</span> {</span>
			<span class="hljs-keyword">var</span> transition = options.transition,
				reverse = options.reverse,
				deferred = options.deferred,
				TransitionHandler,
				promise;

			<span class="hljs-keyword">this</span>._triggerCssTransitionEvents( to, from, <span class="hljs-string">"before"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-505">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-505">&#182;</a>
              </div>
              <p>TODO put this in a binding to events <em>outside</em> the widget</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._hideLoading();

			TransitionHandler = <span class="hljs-keyword">this</span>._getTransitionHandler( transition );

			promise = ( <span class="hljs-keyword">new</span> TransitionHandler( transition, reverse, to, from ) ).transition();</pre></div></div>
            
        </li>
        
        
        <li id="section-506">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-506">&#182;</a>
              </div>
              <p>TODO temporary accomodation of argument deferred</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			promise.done(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				deferred.resolve.apply( deferred, <span class="hljs-built_in">arguments</span> );
			});

			promise.done($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>._triggerCssTransitionEvents( to, from );
			}, <span class="hljs-keyword">this</span>));
		},

		_releaseTransitionLock: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-507">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-507">&#182;</a>
              </div>
              <p>release transition lock so navigation is free again</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isPageTransitioning = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">if</span> ( pageTransitionQueue.length &gt; <span class="hljs-number">0</span> ) {
				$.mobile.changePage.apply( <span class="hljs-literal">null</span>, pageTransitionQueue.pop() );
			}
		},

		_removeActiveLinkClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( force )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-508">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-508">&#182;</a>
              </div>
              <p>clear out the active button state</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.mobile.removeActiveLinkClass( force );
		},

		_loadUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( to, triggerData, settings )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-509">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-509">&#182;</a>
              </div>
              <p>preserve the original target as the dataUrl value will be
simplified eg, removing ui-state, and removing query params
from the hash this is so that users who want to use query
params have access to them in the event bindings for the page
life cycle See issue #5085</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			settings.target = to;
			settings.deferred = $.Deferred();

			<span class="hljs-keyword">this</span>.load( to, settings );

			settings.deferred.done($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, options, content )</span> {</span>
				isPageTransitioning = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-510">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-510">&#182;</a>
              </div>
              <p>store the original absolute url so that it can be provided
to events in the triggerData of the subsequent changePage call</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				options.absUrl = triggerData.absUrl;

				<span class="hljs-keyword">this</span>.transition( content, triggerData, options );
			}, <span class="hljs-keyword">this</span>));

			settings.deferred.fail($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* url, options */</span>)</span> {</span>
				<span class="hljs-keyword">this</span>._removeActiveLinkClass( <span class="hljs-literal">true</span> );
				<span class="hljs-keyword">this</span>._releaseTransitionLock();
				<span class="hljs-keyword">this</span>._triggerWithDeprecated( <span class="hljs-string">"changefailed"</span>, triggerData );
			}, <span class="hljs-keyword">this</span>));
		},

		_triggerPageBeforeChange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( to, triggerData, settings )</span> {</span>
			<span class="hljs-keyword">var</span> pbcEvent = <span class="hljs-keyword">new</span> $.Event( <span class="hljs-string">"pagebeforechange"</span> );

			$.extend(triggerData, { toPage: to, options: settings });</pre></div></div>
            
        </li>
        
        
        <li id="section-511">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-511">&#182;</a>
              </div>
              <p>NOTE: preserve the original target as the dataUrl value will be
simplified eg, removing ui-state, and removing query params from
the hash this is so that users who want to use query params have
access to them in the event bindings for the page life cycle
See issue #5085</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.type(to) === <span class="hljs-string">"string"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-512">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-512">&#182;</a>
              </div>
              <p>if the toPage is a string simply convert it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				triggerData.absUrl = $.mobile.path.makeUrlAbsolute( to, <span class="hljs-keyword">this</span>._findBaseWithDefault() );
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-513">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-513">&#182;</a>
              </div>
              <p>if the toPage is a jQuery object grab the absolute url stored
in the loadPage callback where it exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				triggerData.absUrl = settings.absUrl;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-514">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-514">&#182;</a>
              </div>
              <p>Let listeners know we’re about to change the current page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element.trigger( pbcEvent, triggerData );</pre></div></div>
            
        </li>
        
        
        <li id="section-515">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-515">&#182;</a>
              </div>
              <p>If the default behavior is prevented, stop here!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( pbcEvent.isDefaultPrevented() ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}

			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},

		change: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( to, options )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-516">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-516">&#182;</a>
              </div>
              <p>If we are in the midst of a transition, queue the current request.
We’ll call changePage() once we’re done with the current transition
to service the request.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( isPageTransitioning ) {
				pageTransitionQueue.unshift( <span class="hljs-built_in">arguments</span> );
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">var</span> settings = $.extend( {}, $.mobile.changePage.defaults, options ),
				triggerData = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-517">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-517">&#182;</a>
              </div>
              <p>Make sure we have a fromPage.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			settings.fromPage = settings.fromPage || <span class="hljs-keyword">this</span>.activePage;</pre></div></div>
            
        </li>
        
        
        <li id="section-518">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-518">&#182;</a>
              </div>
              <p>if the page beforechange default is prevented return early</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._triggerPageBeforeChange(to, triggerData, settings) ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-519">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-519">&#182;</a>
              </div>
              <p>We allow “pagebeforechange” observers to modify the to in
the trigger data to allow for redirects. Make sure our to is
updated. We also need to re-evaluate whether it is a string,
because an object can also be replaced by a string</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			to = triggerData.toPage;</pre></div></div>
            
        </li>
        
        
        <li id="section-520">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-520">&#182;</a>
              </div>
              <p>If the caller passed us a url, call loadPage()
to make sure it is loaded into the DOM. We’ll listen
to the promise object it returns so we know when
it is done loading or if an error ocurred.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.type(to) === <span class="hljs-string">"string"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-521">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-521">&#182;</a>
              </div>
              <p>Set the isPageTransitioning flag to prevent any requests from
entering this method while we are in the midst of loading a page
or transitioning.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				isPageTransitioning = <span class="hljs-literal">true</span>;

				<span class="hljs-keyword">this</span>._loadUrl( to, triggerData, settings );
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.transition( to, triggerData, settings );
			}
		},

		transition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( toPage, triggerData, settings )</span> {</span>
			<span class="hljs-keyword">var</span> fromPage, url, pageUrl, fileUrl,
				active, activeIsInitialPage,
				historyDir, pageTitle, isDialog,
				alreadyThere, newPageTitle,
				params,	cssTransitionDeferred,
				beforeTransition;</pre></div></div>
            
        </li>
        
        
        <li id="section-522">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-522">&#182;</a>
              </div>
              <p>If we are in the midst of a transition, queue the current request.
We’ll call changePage() once we’re done with the current transition
to service the request.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( isPageTransitioning ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-523">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-523">&#182;</a>
              </div>
              <p>make sure to only queue the to and settings values so the arguments
work with a call to the change method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				pageTransitionQueue.unshift( [toPage, settings] );
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-524">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-524">&#182;</a>
              </div>
              <p>DEPRECATED - this call only, in favor of the before transition
if the page beforechange default is prevented return early</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._triggerPageBeforeChange(toPage, triggerData, settings) ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-525">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-525">&#182;</a>
              </div>
              <p>if the (content|page)beforetransition default is prevented return early
Note, we have to check for both the deprecated and new events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			beforeTransition = <span class="hljs-keyword">this</span>._triggerWithDeprecated( <span class="hljs-string">"beforetransition"</span>, triggerData );
			<span class="hljs-keyword">if</span> (beforeTransition.deprecatedEvent.isDefaultPrevented() ||
				beforeTransition.event.isDefaultPrevented() ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-526">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-526">&#182;</a>
              </div>
              <p>Set the isPageTransitioning flag to prevent any requests from
entering this method while we are in the midst of loading a page
or transitioning.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isPageTransitioning = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-527">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-527">&#182;</a>
              </div>
              <p>If we are going to the first-page of the application, we need to make
sure settings.dataUrl is set to the application document url. This allows
us to avoid generating a document url with an id hash in the case where the
first-page of the document has an id attribute specified.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( toPage[ <span class="hljs-number">0</span> ] === $.mobile.firstPage[ <span class="hljs-number">0</span> ] &amp;&amp; !settings.dataUrl ) {
				settings.dataUrl = $.mobile.path.documentUrl.hrefNoHash;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-528">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-528">&#182;</a>
              </div>
              <p>The caller passed us a real page DOM element. Update our
internal state and then trigger a transition to the page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			fromPage = settings.fromPage;
			url = ( settings.dataUrl &amp;&amp; $.mobile.path.convertUrlToDataUrl(settings.dataUrl) ) ||
				toPage.jqmData( <span class="hljs-string">"url"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-529">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-529">&#182;</a>
              </div>
              <p>The pageUrl var is usually the same as url, except when url is obscured
as a dialog url. pageUrl always contains the file path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			pageUrl = url;
			fileUrl = $.mobile.path.getFilePath( url );
			active = $.mobile.navigate.history.getActive();
			activeIsInitialPage = $.mobile.navigate.history.activeIndex === <span class="hljs-number">0</span>;
			historyDir = <span class="hljs-number">0</span>;
			pageTitle = document.title;
			isDialog = ( settings.role === <span class="hljs-string">"dialog"</span> ||
				toPage.jqmData( <span class="hljs-string">"role"</span> ) === <span class="hljs-string">"dialog"</span> ) &amp;&amp;
				toPage.jqmData( <span class="hljs-string">"dialog"</span> ) !== <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-530">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-530">&#182;</a>
              </div>
              <p>By default, we prevent changePage requests when the fromPage and toPage
are the same element, but folks that generate content
manually/dynamically and reuse pages want to be able to transition to
the same page. To allow this, they will need to change the default
value of allowSamePageTransition to true, <em>OR</em>, pass it in as an
option when they manually call changePage(). It should be noted that
our default transition animations assume that the formPage and toPage
are different elements, so they may behave unexpectedly. It is up to
the developer that turns on the allowSamePageTransitiona option to
either turn off transition animations, or make sure that an appropriate
animation transition is used.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( fromPage &amp;&amp; fromPage[<span class="hljs-number">0</span>] === toPage[<span class="hljs-number">0</span>] &amp;&amp;
				!settings.allowSamePageTransition ) {

				isPageTransitioning = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">this</span>._triggerWithDeprecated( <span class="hljs-string">"transition"</span>, triggerData );
				<span class="hljs-keyword">this</span>.element.trigger( <span class="hljs-string">"pagechange"</span>, triggerData );</pre></div></div>
            
        </li>
        
        
        <li id="section-531">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-531">&#182;</a>
              </div>
              <p>Even if there is no page change to be done, we should keep the
urlHistory in sync with the hash changes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( settings.fromHashChange ) {
					$.mobile.navigate.history.direct({ url: url });
				}

				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-532">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-532">&#182;</a>
              </div>
              <p>We need to make sure the page we are given has already been enhanced.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			toPage.page({ role: settings.role });</pre></div></div>
            
        </li>
        
        
        <li id="section-533">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-533">&#182;</a>
              </div>
              <p>If the changePage request was sent from a hashChange event, check to
see if the page is already within the urlHistory stack. If so, we’ll
assume the user hit the forward/back button and will try to match the
transition accordingly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( settings.fromHashChange ) {
				historyDir = settings.direction === <span class="hljs-string">"back"</span> ? -<span class="hljs-number">1</span> : <span class="hljs-number">1</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-534">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-534">&#182;</a>
              </div>
              <p>Kill the keyboard.
XXX_jblas: We need to stop crawling the entire document to kill focus.
           Instead, we should be tracking focus with a delegate()
           handler so we already have the element in hand at this
           point.
Wrap this in a try/catch block since IE9 throw “Unspecified error” if
document.activeElement is undefined when we are in an IFrame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">try</span> {
				<span class="hljs-keyword">if</span> ( document.activeElement &amp;&amp;
					document.activeElement.nodeName.toLowerCase() !== <span class="hljs-string">"body"</span> ) {

					$( document.activeElement ).blur();
				} <span class="hljs-keyword">else</span> {
					$( <span class="hljs-string">"input:focus, textarea:focus, select:focus"</span> ).blur();
				}
			} <span class="hljs-keyword">catch</span>( e ) {}</pre></div></div>
            
        </li>
        
        
        <li id="section-535">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-535">&#182;</a>
              </div>
              <p>Record whether we are at a place in history where a dialog used to be -
if so, do not add a new history entry and do not change the hash either</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			alreadyThere = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-536">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-536">&#182;</a>
              </div>
              <p>If we’re displaying the page as a dialog, we don’t want the url
for the dialog content to be used in the hash. Instead, we want
to append the dialogHashKey to the url of the current page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( isDialog &amp;&amp; active ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-537">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-537">&#182;</a>
              </div>
              <p>on the initial page load active.url is undefined and in that case
should be an empty string. Moving the undefined -&gt; empty string back
into urlHistory.addNew seemed imprudent given undefined better
represents the url state</p>

            </div>
            
        </li>
        
        
        <li id="section-538">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-538">&#182;</a>
              </div>
              <p>If we are at a place in history that once belonged to a dialog, reuse
this state without adding to urlHistory and without modifying the
hash. However, if a dialog is already displayed at this point, and
we’re about to display another dialog, then we must add another hash
and history entry on top so that one may navigate back to the
original dialog</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( active.url &amp;&amp;
					active.url.indexOf( $.mobile.dialogHashKey ) &gt; -<span class="hljs-number">1</span> &amp;&amp;
					<span class="hljs-keyword">this</span>.activePage &amp;&amp;
					!<span class="hljs-keyword">this</span>.activePage.hasClass( <span class="hljs-string">"ui-dialog"</span> ) &amp;&amp;
					$.mobile.navigate.history.activeIndex &gt; <span class="hljs-number">0</span> ) {

					settings.changeHash = <span class="hljs-literal">false</span>;
					alreadyThere = <span class="hljs-literal">true</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-539">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-539">&#182;</a>
              </div>
              <p>Normally, we tack on a dialog hash key, but if this is the location
of a stale dialog, we reuse the URL from the entry</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				url = ( active.url || <span class="hljs-string">""</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-540">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-540">&#182;</a>
              </div>
              <p>account for absolute urls instead of just relative urls use as hashes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !alreadyThere &amp;&amp; url.indexOf(<span class="hljs-string">"#"</span>) &gt; -<span class="hljs-number">1</span> ) {
					url += $.mobile.dialogHashKey;
				} <span class="hljs-keyword">else</span> {
					url += <span class="hljs-string">"#"</span> + $.mobile.dialogHashKey;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-541">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-541">&#182;</a>
              </div>
              <p>tack on another dialogHashKey if this is the same as the initial hash
this makes sure that a history entry is created for this dialog</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( $.mobile.navigate.history.activeIndex === <span class="hljs-number">0</span> &amp;&amp; url === $.mobile.navigate.history.initialDst ) {
					url += $.mobile.dialogHashKey;
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-542">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-542">&#182;</a>
              </div>
              <p>if title element wasn’t found, try the page div data attr too
If this is a deep-link or a reload ( active === undefined ) then just
use pageTitle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			newPageTitle = ( !active ) ? pageTitle : toPage.jqmData( <span class="hljs-string">"title"</span> ) ||
				toPage.children( <span class="hljs-string">":jqmData(role='header')"</span> ).find( <span class="hljs-string">".ui-title"</span> ).text();
			<span class="hljs-keyword">if</span> ( !!newPageTitle &amp;&amp; pageTitle === document.title ) {
				pageTitle = newPageTitle;
			}
			<span class="hljs-keyword">if</span> ( !toPage.jqmData( <span class="hljs-string">"title"</span> ) ) {
				toPage.jqmData( <span class="hljs-string">"title"</span>, pageTitle );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-543">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-543">&#182;</a>
              </div>
              <p>Make sure we have a transition defined.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			settings.transition = settings.transition ||
				( ( historyDir &amp;&amp; !activeIsInitialPage ) ? active.transition : <span class="hljs-literal">undefined</span> ) ||
				( isDialog ? $.mobile.defaultDialogTransition : $.mobile.defaultPageTransition );</pre></div></div>
            
        </li>
        
        
        <li id="section-544">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-544">&#182;</a>
              </div>
              <p>add page to history stack if it’s not back or forward</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !historyDir &amp;&amp; alreadyThere ) {
				$.mobile.navigate.history.getActive().pageUrl = pageUrl;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-545">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-545">&#182;</a>
              </div>
              <p>Set the location hash.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( url &amp;&amp; !settings.fromHashChange ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-546">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-546">&#182;</a>
              </div>
              <p>rebuilding the hash here since we loose it earlier on
TODO preserve the originally passed in path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !$.mobile.path.isPath( url ) &amp;&amp; url.indexOf( <span class="hljs-string">"#"</span> ) &lt; <span class="hljs-number">0</span> ) {
					url = <span class="hljs-string">"#"</span> + url;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-547">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-547">&#182;</a>
              </div>
              <p>TODO the property names here are just silly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				params = {
					transition: settings.transition,
					title: pageTitle,
					pageUrl: pageUrl,
					role: settings.role
				};

				<span class="hljs-keyword">if</span> ( settings.changeHash !== <span class="hljs-literal">false</span> &amp;&amp; $.mobile.hashListeningEnabled ) {
					$.mobile.navigate( url, params, <span class="hljs-literal">true</span>);
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( toPage[ <span class="hljs-number">0</span> ] !== $.mobile.firstPage[ <span class="hljs-number">0</span> ] ) {
					$.mobile.navigate.history.add( url, params );
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-548">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-548">&#182;</a>
              </div>
              <p>set page title</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			document.title = pageTitle;</pre></div></div>
            
        </li>
        
        
        <li id="section-549">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-549">&#182;</a>
              </div>
              <p>set “toPage” as activePage deprecated in 1.4 remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.mobile.activePage = toPage;</pre></div></div>
            
        </li>
        
        
        <li id="section-550">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-550">&#182;</a>
              </div>
              <p>new way to handle activePage</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.activePage = toPage;</pre></div></div>
            
        </li>
        
        
        <li id="section-551">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-551">&#182;</a>
              </div>
              <p>If we’re navigating back in the URL history, set reverse accordingly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			settings.reverse = settings.reverse || historyDir &lt; <span class="hljs-number">0</span>;

			cssTransitionDeferred = $.Deferred();

			<span class="hljs-keyword">this</span>._cssTransition(toPage, fromPage, {
				transition: settings.transition,
				reverse: settings.reverse,
				deferred: cssTransitionDeferred
			});

			cssTransitionDeferred.done($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( name, reverse, $to, $from, alreadyFocused )</span> {</span>
				$.mobile.removeActiveLinkClass();</pre></div></div>
            
        </li>
        
        
        <li id="section-552">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-552">&#182;</a>
              </div>
              <p>if there’s a duplicateCachedPage, remove it from the DOM now that it’s hidden</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( settings.duplicateCachedPage ) {
					settings.duplicateCachedPage.remove();
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-553">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-553">&#182;</a>
              </div>
              <p>despite visibility: hidden addresses issue #2965
<a href="https://github.com/jquery/jquery-mobile/issues/2965">https://github.com/jquery/jquery-mobile/issues/2965</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !alreadyFocused ) {
					$.mobile.focusPage( toPage );
				}

				<span class="hljs-keyword">this</span>._releaseTransitionLock();
				<span class="hljs-keyword">this</span>.element.trigger( <span class="hljs-string">"pagechange"</span>, triggerData );
				<span class="hljs-keyword">this</span>._triggerWithDeprecated( <span class="hljs-string">"transition"</span>, triggerData );
			}, <span class="hljs-keyword">this</span>));
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-554">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-554">&#182;</a>
              </div>
              <p>determine the current base url</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_findBaseWithDefault: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> closestBase = ( <span class="hljs-keyword">this</span>.activePage &amp;&amp;
			$.mobile.getClosestBaseUrl( <span class="hljs-keyword">this</span>.activePage ) );
		<span class="hljs-keyword">return</span> closestBase || $.mobile.path.documentBase.hrefNoHash;
		}
	});</pre></div></div>
            
        </li>
        
        
        <li id="section-555">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-555">&#182;</a>
              </div>
              <p>The following handlers should be bound after mobileinit has been triggered
the following deferred is resolved in the init file</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.navreadyDeferred = $.Deferred();</pre></div></div>
            
        </li>
        
        
        <li id="section-556">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-556">&#182;</a>
              </div>
              <p>these variables make all page containers use the same queue and only navigate one at a time
queue to hold simultanious page transitions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> pageTransitionQueue = [],</pre></div></div>
            
        </li>
        
        
        <li id="section-557">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-557">&#182;</a>
              </div>
              <p>indicates whether or not page is in process of transitioning</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		isPageTransitioning = <span class="hljs-literal">false</span>;

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-558">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-558">&#182;</a>
              </div>
              <p>resolved on domready</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> domreadyDeferred = $.Deferred(),</pre></div></div>
            
        </li>
        
        
        <li id="section-559">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-559">&#182;</a>
              </div>
              <p>resolved and nulled on window.load()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		loadDeferred = $.Deferred(),
		documentUrl = $.mobile.path.documentUrl,</pre></div></div>
            
        </li>
        
        
        <li id="section-560">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-560">&#182;</a>
              </div>
              <p>used to track last vclicked element to make sure its value is added to form data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$lastVClicked = <span class="hljs-literal">null</span>;

	<span class="hljs-comment">/* Event Bindings - hashchange, submit, and click */</span>
	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findClosestLink</span><span class="hljs-params">( ele )</span>	{</span>
		<span class="hljs-keyword">while</span> ( ele ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-561">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-561">&#182;</a>
              </div>
              <p>Look for the closest element with a nodeName of “a”.
Note that we are checking if we have a valid nodeName
before attempting to access it. This is because the
node we get called with could have originated from within
an embedded SVG document where some symbol instance elements
don’t have nodeName defined on them, or strings are of type
SVGAnimatedString.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ( <span class="hljs-keyword">typeof</span> ele.nodeName === <span class="hljs-string">"string"</span> ) &amp;&amp; ele.nodeName.toLowerCase() === <span class="hljs-string">"a"</span> ) {
				<span class="hljs-keyword">break</span>;
			}
			ele = ele.parentNode;
		}
		<span class="hljs-keyword">return</span> ele;
	}

	$.mobile.loadPage = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( url, opts )</span> {</span>
		<span class="hljs-keyword">var</span> container;

		opts = opts || {};
		container = ( opts.pageContainer || $.mobile.pageContainer );</pre></div></div>
            
        </li>
        
        
        <li id="section-562">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-562">&#182;</a>
              </div>
              <p>create the deferred that will be supplied to loadPage callers
and resolved by the content widget’s load method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		opts.deferred = $.Deferred();</pre></div></div>
            
        </li>
        
        
        <li id="section-563">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-563">&#182;</a>
              </div>
              <p>Preferring to allow exceptions for uninitialized opts.pageContainer
widgets so we know if we need to force init here for users</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		container.pagecontainer( <span class="hljs-string">"load"</span>, url, opts );</pre></div></div>
            
        </li>
        
        
        <li id="section-564">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-564">&#182;</a>
              </div>
              <p>provide the deferred</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> opts.deferred.promise();
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-565">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-565">&#182;</a>
              </div>
              <p>define vars for interal use</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
	<span class="hljs-comment">/* internal utility functions */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-566">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-566">&#182;</a>
              </div>
              <p>NOTE Issue #4950 Android phonegap doesn’t navigate back properly
     when a full page refresh has taken place. It appears that hashchange
     and replacestate history alterations work fine but we need to support
     both forms of history traversal in our code that uses backward history
     movement</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.back = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> nav = window.navigator;</pre></div></div>
            
        </li>
        
        
        <li id="section-567">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-567">&#182;</a>
              </div>
              <p>if the setting is on and the navigator object is
available use the phonegap navigation capability</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.phonegapNavigationEnabled &amp;&amp;
			nav &amp;&amp;
			nav.app &amp;&amp;
			nav.app.backHistory ) {
			nav.app.backHistory();
		} <span class="hljs-keyword">else</span> {
			$.mobile.pageContainer.pagecontainer( <span class="hljs-string">"back"</span> );
		}
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-568">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-568">&#182;</a>
              </div>
              <p>Direct focus to the page title, or otherwise first focusable element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.focusPage = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( page )</span> {</span>
		<span class="hljs-keyword">var</span> autofocus = page.find( <span class="hljs-string">"[autofocus]"</span> ),
			pageTitle = page.find( <span class="hljs-string">".ui-title:eq(0)"</span> );

		<span class="hljs-keyword">if</span> ( autofocus.length ) {
			autofocus.focus();
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( pageTitle.length ) {
			pageTitle.focus();
		} <span class="hljs-keyword">else</span>{
			page.focus();
		}
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-569">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-569">&#182;</a>
              </div>
              <p>No-op implementation of transition degradation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile._maybeDegradeTransition = $.mobile._maybeDegradeTransition || <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( transition )</span> {</span>
		<span class="hljs-keyword">return</span> transition;
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-570">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-570">&#182;</a>
              </div>
              <p>Exposed $.mobile methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
	$.mobile.changePage = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( to, options )</span> {</span>
		$.mobile.pageContainer.pagecontainer( <span class="hljs-string">"change"</span>, to, options );
	};

	$.mobile.changePage.defaults = {
		transition: <span class="hljs-literal">undefined</span>,
		reverse: <span class="hljs-literal">false</span>,
		changeHash: <span class="hljs-literal">true</span>,
		fromHashChange: <span class="hljs-literal">false</span>,
		role: <span class="hljs-literal">undefined</span>, <span class="hljs-comment">// By default we rely on the role defined by the @data-role attribute.</span>
		duplicateCachedPage: <span class="hljs-literal">undefined</span>,
		pageContainer: <span class="hljs-literal">undefined</span>,
		showLoadMsg: <span class="hljs-literal">true</span>, <span class="hljs-comment">//loading message shows by default when pages are being fetched during changePage</span>
		dataUrl: <span class="hljs-literal">undefined</span>,
		fromPage: <span class="hljs-literal">undefined</span>,
		allowSamePageTransition: <span class="hljs-literal">false</span>
	};

	$.mobile._registerInternalEvents = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> getAjaxFormData = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $form, calculateOnly )</span> {</span>
			<span class="hljs-keyword">var</span> url, ret = <span class="hljs-literal">true</span>, formData, vclickedName, method;
			<span class="hljs-keyword">if</span> ( !$.mobile.ajaxEnabled ||</pre></div></div>
            
        </li>
        
        
        <li id="section-571">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-571">&#182;</a>
              </div>
              <p>test that the form is, itself, ajax false</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					$form.is( <span class="hljs-string">":jqmData(ajax='false')"</span> ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-572">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-572">&#182;</a>
              </div>
              <p>test that $.mobile.ignoreContentEnabled is set and
the form or one of it’s parents is ajax=false</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					!$form.jqmHijackable().length ||
					$form.attr( <span class="hljs-string">"target"</span> ) ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}

			url = ( $lastVClicked &amp;&amp; $lastVClicked.attr( <span class="hljs-string">"formaction"</span> ) ) ||
				$form.attr( <span class="hljs-string">"action"</span> );
			method = ( $form.attr( <span class="hljs-string">"method"</span> ) || <span class="hljs-string">"get"</span> ).toLowerCase();</pre></div></div>
            
        </li>
        
        
        <li id="section-573">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-573">&#182;</a>
              </div>
              <p>If no action is specified, browsers default to using the
URL of the document containing the form. Since we dynamically
pull in pages from external documents, the form should submit
to the URL for the source document of the page containing
the form.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !url ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-574">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-574">&#182;</a>
              </div>
              <p>Get the @data-url for the page containing the form.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				url = $.mobile.getClosestBaseUrl( $form );</pre></div></div>
            
        </li>
        
        
        <li id="section-575">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-575">&#182;</a>
              </div>
              <p>NOTE: If the method is “get”, we need to strip off the query string
because it will get replaced with the new form data. See issue #5710.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( method === <span class="hljs-string">"get"</span> ) {
					url = $.mobile.path.parseUrl( url ).hrefNoSearch;
				}

				<span class="hljs-keyword">if</span> ( url === $.mobile.path.documentBase.hrefNoHash ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-576">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-576">&#182;</a>
              </div>
              <p>The url we got back matches the document base,
which means the page must be an internal/embedded page,
so default to using the actual document url as a browser
would.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					url = documentUrl.hrefNoSearch;
				}
			}

			url = $.mobile.path.makeUrlAbsolute(  url, $.mobile.getClosestBaseUrl( $form ) );

			<span class="hljs-keyword">if</span> ( ( $.mobile.path.isExternal( url ) &amp;&amp; !$.mobile.path.isPermittedCrossDomainRequest( documentUrl, url ) ) ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}

			<span class="hljs-keyword">if</span> ( !calculateOnly ) {
				formData = $form.serializeArray();

				<span class="hljs-keyword">if</span> ( $lastVClicked &amp;&amp; $lastVClicked[ <span class="hljs-number">0</span> ].form === $form[ <span class="hljs-number">0</span> ] ) {
					vclickedName = $lastVClicked.attr( <span class="hljs-string">"name"</span> );
					<span class="hljs-keyword">if</span> ( vclickedName ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-577">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-577">&#182;</a>
              </div>
              <p>Make sure the last clicked element is included in the form</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						$.each( formData, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( key, value )</span> {</span>
							<span class="hljs-keyword">if</span> ( value.name === vclickedName ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-578">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-578">&#182;</a>
              </div>
              <p>Unset vclickedName - we’ve found it in the serialized data already</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>								vclickedName = <span class="hljs-string">""</span>;
								<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
							}
						});
						<span class="hljs-keyword">if</span> ( vclickedName ) {
							formData.push( { name: vclickedName, value: $lastVClicked.attr( <span class="hljs-string">"value"</span> ) } );
						}
					}
				}

				ret = {
					url: url,
					options: {
						type:		method,
						data:		$.param( formData ),
						transition:	$form.jqmData( <span class="hljs-string">"transition"</span> ),
						reverse:	$form.jqmData( <span class="hljs-string">"direction"</span> ) === <span class="hljs-string">"reverse"</span>,
						reloadPage:	<span class="hljs-literal">true</span>
					}
				};
			}

			<span class="hljs-keyword">return</span> ret;
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-579">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-579">&#182;</a>
              </div>
              <p>bind to form submit events, handle with Ajax</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.mobile.document.delegate( <span class="hljs-string">"form"</span>, <span class="hljs-string">"submit"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> formData;

			<span class="hljs-keyword">if</span> ( !event.isDefaultPrevented() ) {
				formData = getAjaxFormData( $( <span class="hljs-keyword">this</span> ) );
				<span class="hljs-keyword">if</span> ( formData ) {
					$.mobile.changePage( formData.url, formData.options );
					event.preventDefault();
				}
			}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-580">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-580">&#182;</a>
              </div>
              <p>add active state on vclick</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.mobile.document.bind( <span class="hljs-string">"vclick"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> $btn, btnEls, target = event.target, needClosest = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-581">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-581">&#182;</a>
              </div>
              <p>if this isn’t a left click we don’t care. Its important to note
that when the virtual event is generated it will create the which attr</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( event.which &gt; <span class="hljs-number">1</span> || !$.mobile.linkBindingEnabled ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-582">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-582">&#182;</a>
              </div>
              <p>Record that this element was clicked, in case we need it for correct
form submission during the “submit” handler above</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$lastVClicked = $( target );</pre></div></div>
            
        </li>
        
        
        <li id="section-583">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-583">&#182;</a>
              </div>
              <p>Try to find a target element to which the active class will be applied</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.data( target, <span class="hljs-string">"mobile-button"</span> ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-584">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-584">&#182;</a>
              </div>
              <p>If the form will not be submitted via AJAX, do not add active class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !getAjaxFormData( $( target ).closest( <span class="hljs-string">"form"</span> ), <span class="hljs-literal">true</span> ) ) {
					<span class="hljs-keyword">return</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-585">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-585">&#182;</a>
              </div>
              <p>We will apply the active state to this button widget - the parent
of the input that was clicked will have the associated data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( target.parentNode ) {
					target = target.parentNode;
				}
			} <span class="hljs-keyword">else</span> {
				target = findClosestLink( target );
				<span class="hljs-keyword">if</span> ( !( target &amp;&amp; $.mobile.path.parseUrl( target.getAttribute( <span class="hljs-string">"href"</span> ) || <span class="hljs-string">"#"</span> ).hash !== <span class="hljs-string">"#"</span> ) ) {
					<span class="hljs-keyword">return</span>;
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-586">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-586">&#182;</a>
              </div>
              <p>TODO teach $.mobile.hijackable to operate on raw dom elements so the
link wrapping can be avoided</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !$( target ).jqmHijackable().length ) {
					<span class="hljs-keyword">return</span>;
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-587">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-587">&#182;</a>
              </div>
              <p>Avoid calling .closest by using the data set during .buttonMarkup()
List items have the button data in the parent of the element clicked</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !!~target.className.indexOf( <span class="hljs-string">"ui-link-inherit"</span> ) ) {
				<span class="hljs-keyword">if</span> ( target.parentNode ) {
					btnEls = $.data( target.parentNode, <span class="hljs-string">"buttonElements"</span> );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-588">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-588">&#182;</a>
              </div>
              <p>Otherwise, look for the data on the target itself</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			} <span class="hljs-keyword">else</span> {
				btnEls = $.data( target, <span class="hljs-string">"buttonElements"</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-589">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-589">&#182;</a>
              </div>
              <p>If found, grab the button’s outer element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( btnEls ) {
				target = btnEls.outer;
			} <span class="hljs-keyword">else</span> {
				needClosest = <span class="hljs-literal">true</span>;
			}

			$btn = $( target );</pre></div></div>
            
        </li>
        
        
        <li id="section-590">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-590">&#182;</a>
              </div>
              <p>If the outer element wasn’t found by the our heuristics, use .closest()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( needClosest ) {
				$btn = $btn.closest( <span class="hljs-string">".ui-btn"</span> );
			}

			<span class="hljs-keyword">if</span> ( $btn.length &gt; <span class="hljs-number">0</span> &amp;&amp;
				!( $btn.hasClass( <span class="hljs-string">"ui-state-disabled"</span> ||</pre></div></div>
            
        </li>
        
        
        <li id="section-591">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-591">&#182;</a>
              </div>
              <p>DEPRECATED as of 1.4.0 - remove after 1.4.0 release
only ui-state-disabled should be present thereafter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					$btn.hasClass( <span class="hljs-string">"ui-disabled"</span> ) ) ) ) {
				$.mobile.removeActiveLinkClass( <span class="hljs-literal">true</span> );
				$.mobile.activeClickedLink = $btn;
				$.mobile.activeClickedLink.addClass( $.mobile.activeBtnClass );
			}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-592">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-592">&#182;</a>
              </div>
              <p>click routing - direct to HTTP or Ajax, accordingly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.mobile.document.bind( <span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">if</span> ( !$.mobile.linkBindingEnabled || event.isDefaultPrevented() ) {
				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">var</span> link = findClosestLink( event.target ),
				$link = $( link ),</pre></div></div>
            
        </li>
        
        
        <li id="section-593">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-593">&#182;</a>
              </div>
              <p>remove active link class if external (then it won’t be there if you come back)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				httpCleanup = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					window.setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> $.mobile.removeActiveLinkClass( <span class="hljs-literal">true</span> ); }, <span class="hljs-number">200</span> );
				},
				baseUrl, href,
				useDefaultUrlHandling, isExternal,
				transition, reverse, role;</pre></div></div>
            
        </li>
        
        
        <li id="section-594">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-594">&#182;</a>
              </div>
              <p>If a button was clicked, clean up the active class added by vclick above</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.mobile.activeClickedLink &amp;&amp;
				$.mobile.activeClickedLink[ <span class="hljs-number">0</span> ] === event.target.parentNode ) {
				httpCleanup();
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-595">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-595">&#182;</a>
              </div>
              <p>If there is no link associated with the click or its not a left
click we want to ignore the click
TODO teach $.mobile.hijackable to operate on raw dom elements so the link wrapping
can be avoided</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !link || event.which &gt; <span class="hljs-number">1</span> || !$link.jqmHijackable().length ) {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-596">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-596">&#182;</a>
              </div>
              <p>if there’s a data-rel=back attr, go back in history</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $link.is( <span class="hljs-string">":jqmData(rel='back')"</span> ) ) {
				$.mobile.back();
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}

			baseUrl = $.mobile.getClosestBaseUrl( $link );</pre></div></div>
            
        </li>
        
        
        <li id="section-597">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-597">&#182;</a>
              </div>
              <p>get href, if defined, otherwise default to empty hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			href = $.mobile.path.makeUrlAbsolute( $link.attr( <span class="hljs-string">"href"</span> ) || <span class="hljs-string">"#"</span>, baseUrl );</pre></div></div>
            
        </li>
        
        
        <li id="section-598">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-598">&#182;</a>
              </div>
              <p>if ajax is disabled, exit early</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !$.mobile.ajaxEnabled &amp;&amp; !$.mobile.path.isEmbeddedPage( href ) ) {
				httpCleanup();</pre></div></div>
            
        </li>
        
        
        <li id="section-599">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-599">&#182;</a>
              </div>
              <p>use default click handling</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-600">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-600">&#182;</a>
              </div>
              <p>XXX_jblas: Ideally links to application pages should be specified as
           an url to the application document with a hash that is either
           the site relative path or id to the page. But some of the
           internal code that dynamically generates sub-pages for nested
           lists and select dialogs, just write a hash in the link they
           create. This means the actual URL path is based on whatever
           the current value of the base tag is at the time this code
           is called. For now we are just assuming that any url with a
           hash in it is an application page reference.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( href.search( <span class="hljs-string">"#"</span> ) !== -<span class="hljs-number">1</span> ) {
				href = href.replace( <span class="hljs-regexp">/[^#]*#/</span>, <span class="hljs-string">""</span> );
				<span class="hljs-keyword">if</span> ( !href ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-601">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-601">&#182;</a>
              </div>
              <p>link was an empty hash meant purely
for interaction, so we ignore it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					event.preventDefault();
					<span class="hljs-keyword">return</span>;
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( $.mobile.path.isPath( href ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-602">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-602">&#182;</a>
              </div>
              <p>we have apath so make it the href we want to load.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					href = $.mobile.path.makeUrlAbsolute( href, baseUrl );
				} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-603">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-603">&#182;</a>
              </div>
              <p>we have a simple id so use the documentUrl as its base.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					href = $.mobile.path.makeUrlAbsolute( <span class="hljs-string">"#"</span> + href, documentUrl.hrefNoHash );
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-604">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-604">&#182;</a>
              </div>
              <p>Should we handle this link, or let the browser deal with it?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			useDefaultUrlHandling = $link.is( <span class="hljs-string">"[rel='external']"</span> ) || $link.is( <span class="hljs-string">":jqmData(ajax='false')"</span> ) || $link.is( <span class="hljs-string">"[target]"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-605">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-605">&#182;</a>
              </div>
              <p>Some embedded browsers, like the web view in Phone Gap, allow cross-domain XHR
requests if the document doing the request was loaded via the file:// protocol.
This is usually to allow the application to “phone home” and fetch app specific
data. We normally let the browser handle external/cross-domain urls, but if the
allowCrossDomainPages option is true, we will allow cross-domain http/https
requests to go through our page loading logic.</p>

            </div>
            
        </li>
        
        
        <li id="section-606">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-606">&#182;</a>
              </div>
              <p>check for protocol or rel and its not an embedded page
TODO overlap in logic from isExternal, rel=external check should be
    moved into more comprehensive isExternalLink</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			isExternal = useDefaultUrlHandling || ( $.mobile.path.isExternal( href ) &amp;&amp; !$.mobile.path.isPermittedCrossDomainRequest( documentUrl, href ) );

			<span class="hljs-keyword">if</span> ( isExternal ) {
				httpCleanup();</pre></div></div>
            
        </li>
        
        
        <li id="section-607">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-607">&#182;</a>
              </div>
              <p>use default click handling</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-608">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-608">&#182;</a>
              </div>
              <p>use ajax</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			transition = $link.jqmData( <span class="hljs-string">"transition"</span> );
			reverse = $link.jqmData( <span class="hljs-string">"direction"</span> ) === <span class="hljs-string">"reverse"</span> ||</pre></div></div>
            
        </li>
        
        
        <li id="section-609">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-609">&#182;</a>
              </div>
              <p>deprecated - remove by 1.0</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						$link.jqmData( <span class="hljs-string">"back"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-610">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-610">&#182;</a>
              </div>
              <p>this may need to be more specific as we use data-rel more</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			role = $link.attr( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"rel"</span> ) || <span class="hljs-literal">undefined</span>;

			$.mobile.changePage( href, { transition: transition, reverse: reverse, role: role, link: $link } );
			event.preventDefault();
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-611">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-611">&#182;</a>
              </div>
              <p>prefetch pages when anchors with data-prefetch are encountered</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.mobile.document.delegate( <span class="hljs-string">".ui-page"</span>, <span class="hljs-string">"pageshow.prefetch"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> urls = [];
			$( <span class="hljs-keyword">this</span> ).find( <span class="hljs-string">"a:jqmData(prefetch)"</span> ).each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> $link = $( <span class="hljs-keyword">this</span> ),
					url = $link.attr( <span class="hljs-string">"href"</span> );

				<span class="hljs-keyword">if</span> ( url &amp;&amp; $.inArray( url, urls ) === -<span class="hljs-number">1</span> ) {
					urls.push( url );

					$.mobile.loadPage( url, { role: $link.attr( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"rel"</span> ),prefetch: <span class="hljs-literal">true</span> } );
				}
			});
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-612">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-612">&#182;</a>
              </div>
              <p>TODO ensure that the navigate binding in the content widget happens at the right time</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.mobile.pageContainer.pagecontainer();</pre></div></div>
            
        </li>
        
        
        <li id="section-613">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-613">&#182;</a>
              </div>
              <p>set page min-heights to be device specific</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.mobile.document.bind( <span class="hljs-string">"pageshow"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-614">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-614">&#182;</a>
              </div>
              <p>We need to wait for window.load to make sure that styles have already been rendered,
otherwise heights of external toolbars will have the wrong value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( loadDeferred ) {
				loadDeferred.done( $.mobile.resetActivePageHeight );
			} <span class="hljs-keyword">else</span> {
				$.mobile.resetActivePageHeight();
			}
		});
		$.mobile.window.bind( <span class="hljs-string">"throttledresize"</span>, $.mobile.resetActivePageHeight );

	};<span class="hljs-comment">//navreadyDeferred done callback</span>

	$( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> domreadyDeferred.resolve(); } );

	$.mobile.window.load( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-615">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-615">&#182;</a>
              </div>
              <p>Resolve and null the deferred</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		loadDeferred.resolve();
		loadDeferred = <span class="hljs-literal">null</span>;
	});

	$.when( domreadyDeferred, $.mobile.navreadyDeferred ).done( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> $.mobile._registerInternalEvents(); } );
})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-616">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-616">&#182;</a>
              </div>
              <p>TODO remove direct references to $.mobile and properties, we should
     favor injection with params to the constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.Transition = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.init.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
	};

	$.extend($.mobile.Transition.prototype, {
		toPreClass: <span class="hljs-string">" ui-page-pre-in"</span>,

		init: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( name, reverse, $to, $from )</span> {</span>
			$.extend(<span class="hljs-keyword">this</span>, {
				name: name,
				reverse: reverse,
				$to: $to,
				$from: $from,
				deferred: <span class="hljs-keyword">new</span> $.Deferred()
			});
		},

		cleanFrom: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.$from
				.removeClass( $.mobile.activePageClass + <span class="hljs-string">" out in reverse "</span> + <span class="hljs-keyword">this</span>.name )
				.height( <span class="hljs-string">""</span> );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-617">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-617">&#182;</a>
              </div>
              <p>NOTE overridden by child object prototypes, noop’d here as defaults</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		beforeDoneIn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>},
		beforeDoneOut: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>},
		beforeStartOut: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>},

		doneIn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.beforeDoneIn();

			<span class="hljs-keyword">this</span>.$to.removeClass( <span class="hljs-string">"out in reverse "</span> + <span class="hljs-keyword">this</span>.name ).height( <span class="hljs-string">""</span> );

			<span class="hljs-keyword">this</span>.toggleViewportClass();</pre></div></div>
            
        </li>
        
        
        <li id="section-618">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-618">&#182;</a>
              </div>
              <p>In some browsers (iOS5), 3D transitions block the ability to scroll to the desired location during transition
This ensures we jump to that spot after the fact, if we aren’t there already.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.mobile.window.scrollTop() !== <span class="hljs-keyword">this</span>.toScroll ) {
				<span class="hljs-keyword">this</span>.scrollPage();
			}
			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.sequential ) {
				<span class="hljs-keyword">this</span>.$to.addClass( $.mobile.activePageClass );
			}
			<span class="hljs-keyword">this</span>.deferred.resolve( <span class="hljs-keyword">this</span>.name, <span class="hljs-keyword">this</span>.reverse, <span class="hljs-keyword">this</span>.$to, <span class="hljs-keyword">this</span>.$from, <span class="hljs-literal">true</span> );
		},

		doneOut: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( screenHeight, reverseClass, none, preventFocus )</span> {</span>
			<span class="hljs-keyword">this</span>.beforeDoneOut();
			<span class="hljs-keyword">this</span>.startIn( screenHeight, reverseClass, none, preventFocus );
		},

		hideIn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( callback )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-619">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-619">&#182;</a>
              </div>
              <p>Prevent flickering in phonegap container: see comments at #4024 regarding iOS</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.$to.css( <span class="hljs-string">"z-index"</span>, -<span class="hljs-number">10</span> );
			callback.call( <span class="hljs-keyword">this</span> );
			<span class="hljs-keyword">this</span>.$to.css( <span class="hljs-string">"z-index"</span>, <span class="hljs-string">""</span> );
		},

		scrollPage: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-620">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-620">&#182;</a>
              </div>
              <p>By using scrollTo instead of silentScroll, we can keep things better in order
Just to be precautios, disable scrollstart listening like silentScroll would</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.event.special.scrollstart.enabled = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-621">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-621">&#182;</a>
              </div>
              <p>if we are hiding the url bar or the page was previously scrolled scroll to hide or return to position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.mobile.hideUrlBar || <span class="hljs-keyword">this</span>.toScroll !== $.mobile.defaultHomeScroll ) {
				window.scrollTo( <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.toScroll );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-622">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-622">&#182;</a>
              </div>
              <p>reenable scrollstart listening like silentScroll would</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$.event.special.scrollstart.enabled = <span class="hljs-literal">true</span>;
			}, <span class="hljs-number">150</span> );
		},

		startIn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( screenHeight, reverseClass, none, preventFocus )</span> {</span>
			<span class="hljs-keyword">this</span>.hideIn(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>.$to.addClass( $.mobile.activePageClass + <span class="hljs-keyword">this</span>.toPreClass );</pre></div></div>
            
        </li>
        
        
        <li id="section-623">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-623">&#182;</a>
              </div>
              <p>Send focus to page as it is now display: block</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !preventFocus ) {
					$.mobile.focusPage( <span class="hljs-keyword">this</span>.$to );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-624">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-624">&#182;</a>
              </div>
              <p>Set to page height</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.$to.height( screenHeight + <span class="hljs-keyword">this</span>.toScroll );

                <span class="hljs-keyword">if</span> ( !none ) {
                    <span class="hljs-keyword">this</span>.scrollPage();
                }
			});

			<span class="hljs-keyword">this</span>.$to
				.removeClass( <span class="hljs-keyword">this</span>.toPreClass )
				.addClass( <span class="hljs-keyword">this</span>.name + <span class="hljs-string">" in "</span> + reverseClass );

			<span class="hljs-keyword">if</span> ( !none ) {
				<span class="hljs-keyword">this</span>.$to.animationComplete( $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">this</span>.doneIn();
				}, <span class="hljs-keyword">this</span> ));
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.doneIn();
			}

		},

		startOut: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( screenHeight, reverseClass, none )</span> {</span>
			<span class="hljs-keyword">this</span>.beforeStartOut( screenHeight, reverseClass, none );</pre></div></div>
            
        </li>
        
        
        <li id="section-625">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-625">&#182;</a>
              </div>
              <p>Set the from page’s height and start it transitioning out
Note: setting an explicit height helps eliminate tiling in the transitions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.$from
				.height( screenHeight + $.mobile.window.scrollTop() )
				.addClass( <span class="hljs-keyword">this</span>.name + <span class="hljs-string">" out"</span> + reverseClass );
		},

		toggleViewportClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$.mobile.pageContainer.toggleClass( <span class="hljs-string">"ui-mobile-viewport-transitioning viewport-"</span> + <span class="hljs-keyword">this</span>.name );
		},

		transition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-626">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-626">&#182;</a>
              </div>
              <p>NOTE many of these could be calculated/recorded in the constructor, it’s my
     opinion that binding them as late as possible has value with regards to
     better transitions with fewer bugs. Ie, it’s not guaranteed that the
     object will be created and transition will be run immediately after as
     it is today. So we wait until transition is invoked to gather the following</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> none,
				reverseClass = <span class="hljs-keyword">this</span>.reverse ? <span class="hljs-string">" reverse"</span> : <span class="hljs-string">""</span>,
				screenHeight = $.mobile.getScreenHeight(),
				maxTransitionOverride = $.mobile.maxTransitionWidth !== <span class="hljs-literal">false</span> &amp;&amp;
					$.mobile.window.width() &gt; $.mobile.maxTransitionWidth;

			<span class="hljs-keyword">this</span>.toScroll = $.mobile.navigate.history.getActive().lastScroll || $.mobile.defaultHomeScroll;

			none = !$.support.cssTransitions || !$.support.cssAnimations ||
				maxTransitionOverride || !<span class="hljs-keyword">this</span>.name || <span class="hljs-keyword">this</span>.name === <span class="hljs-string">"none"</span> ||
				<span class="hljs-built_in">Math</span>.max( $.mobile.window.scrollTop(), <span class="hljs-keyword">this</span>.toScroll ) &gt;
					$.mobile.getMaxScrollForTransition();

			<span class="hljs-keyword">this</span>.toggleViewportClass();

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.$from &amp;&amp; !none ) {
				<span class="hljs-keyword">this</span>.startOut( screenHeight, reverseClass, none );
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.doneOut( screenHeight, reverseClass, none, <span class="hljs-literal">true</span> );
			}

			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.deferred.promise();
		}
	});
})( jQuery, <span class="hljs-keyword">this</span> );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $ )</span> {</span>

	$.mobile.SerialTransition = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.init.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
	};

	$.extend($.mobile.SerialTransition.prototype, $.mobile.Transition.prototype, {
		sequential: <span class="hljs-literal">true</span>,

		beforeDoneOut: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.$from ) {
				<span class="hljs-keyword">this</span>.cleanFrom();
			}
		},

		beforeStartOut: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( screenHeight, reverseClass, none )</span> {</span>
			<span class="hljs-keyword">this</span>.$from.animationComplete($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>.doneOut( screenHeight, reverseClass, none );
			}, <span class="hljs-keyword">this</span> ));
		}
	});

})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $ )</span> {</span>

	$.mobile.ConcurrentTransition = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.init.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
	};

	$.extend($.mobile.ConcurrentTransition.prototype, $.mobile.Transition.prototype, {
		sequential: <span class="hljs-literal">false</span>,

		beforeDoneIn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.$from ) {
				<span class="hljs-keyword">this</span>.cleanFrom();
			}
		},

		beforeStartOut: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( screenHeight, reverseClass, none )</span> {</span>
			<span class="hljs-keyword">this</span>.doneOut( screenHeight, reverseClass, none );
		}
	});

})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $ )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-627">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-627">&#182;</a>
              </div>
              <p>generate the handlers from the above</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> defaultGetMaxScrollForTransition = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> $.mobile.getScreenHeight() * <span class="hljs-number">3</span>;
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-628">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-628">&#182;</a>
              </div>
              <p>transition handler dictionary for 3rd party transitions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.transitionHandlers = {
		<span class="hljs-string">"sequential"</span>: $.mobile.SerialTransition,
		<span class="hljs-string">"simultaneous"</span>: $.mobile.ConcurrentTransition
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-629">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-629">&#182;</a>
              </div>
              <p>Make our transition handler the public default.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.defaultTransitionHandler = $.mobile.transitionHandlers.sequential;

	$.mobile.transitionFallbacks = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-630">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-630">&#182;</a>
              </div>
              <p>If transition is defined, check if css 3D transforms are supported, and if not, if a fallback is specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile._maybeDegradeTransition = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( transition )</span> {</span>
		<span class="hljs-keyword">if</span> ( transition &amp;&amp; !$.support.cssTransform3d &amp;&amp; $.mobile.transitionFallbacks[ transition ] ) {
			transition = $.mobile.transitionFallbacks[ transition ];
		}

		<span class="hljs-keyword">return</span> transition;
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-631">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-631">&#182;</a>
              </div>
              <p>Set the getMaxScrollForTransition to default if no implementation was set by user</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$.mobile.getMaxScrollForTransition = $.mobile.getMaxScrollForTransition || defaultGetMaxScrollForTransition;

})( jQuery );

<span class="hljs-comment">/*
* fallback transition for flip in non-3D supporting browsers (which tend to handle complex transitions poorly in general
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>

$.mobile.transitionFallbacks.flip = <span class="hljs-string">"fade"</span>;

})( jQuery, <span class="hljs-keyword">this</span> );

<span class="hljs-comment">/*
* fallback transition for flow in non-3D supporting browsers (which tend to handle complex transitions poorly in general
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>

$.mobile.transitionFallbacks.flow = <span class="hljs-string">"fade"</span>;

})( jQuery, <span class="hljs-keyword">this</span> );

<span class="hljs-comment">/*
* fallback transition for pop in non-3D supporting browsers (which tend to handle complex transitions poorly in general
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>

$.mobile.transitionFallbacks.pop = <span class="hljs-string">"fade"</span>;

})( jQuery, <span class="hljs-keyword">this</span> );

<span class="hljs-comment">/*
* fallback transition for slide in non-3D supporting browsers (which tend to handle complex transitions poorly in general
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-632">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-632">&#182;</a>
              </div>
              <p>Use the simultaneous transitions handler for slide transitions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.transitionHandlers.slide = $.mobile.transitionHandlers.simultaneous;</pre></div></div>
            
        </li>
        
        
        <li id="section-633">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-633">&#182;</a>
              </div>
              <p>Set the slide transitions’s fallback to “fade”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.transitionFallbacks.slide = <span class="hljs-string">"fade"</span>;

})( jQuery, <span class="hljs-keyword">this</span> );

<span class="hljs-comment">/*
* fallback transition for slidedown in non-3D supporting browsers (which tend to handle complex transitions poorly in general
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>

$.mobile.transitionFallbacks.slidedown = <span class="hljs-string">"fade"</span>;

})( jQuery, <span class="hljs-keyword">this</span> );

<span class="hljs-comment">/*
* fallback transition for slidefade in non-3D supporting browsers (which tend to handle complex transitions poorly in general
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-634">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-634">&#182;</a>
              </div>
              <p>Set the slide transitions’s fallback to “fade”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.transitionFallbacks.slidefade = <span class="hljs-string">"fade"</span>;

})( jQuery, <span class="hljs-keyword">this</span> );

<span class="hljs-comment">/*
* fallback transition for slideup in non-3D supporting browsers (which tend to handle complex transitions poorly in general
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>

$.mobile.transitionFallbacks.slideup = <span class="hljs-string">"fade"</span>;

})( jQuery, <span class="hljs-keyword">this</span> );

<span class="hljs-comment">/*
* fallback transition for turn in non-3D supporting browsers (which tend to handle complex transitions poorly in general
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>

$.mobile.transitionFallbacks.turn = <span class="hljs-string">"fade"</span>;

})( jQuery, <span class="hljs-keyword">this</span> );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.mobile.degradeInputs = {
	color: <span class="hljs-literal">false</span>,
	date: <span class="hljs-literal">false</span>,
	datetime: <span class="hljs-literal">false</span>,
	<span class="hljs-string">"datetime-local"</span>: <span class="hljs-literal">false</span>,
	email: <span class="hljs-literal">false</span>,
	month: <span class="hljs-literal">false</span>,
	number: <span class="hljs-literal">false</span>,
	range: <span class="hljs-string">"number"</span>,
	search: <span class="hljs-string">"text"</span>,
	tel: <span class="hljs-literal">false</span>,
	time: <span class="hljs-literal">false</span>,
	url: <span class="hljs-literal">false</span>,
	week: <span class="hljs-literal">false</span>
};</pre></div></div>
            
        </li>
        
        
        <li id="section-635">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-635">&#182;</a>
              </div>
              <p>Backcompat remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.page.prototype.options.degradeInputs = $.mobile.degradeInputs;</pre></div></div>
            
        </li>
        
        
        <li id="section-636">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-636">&#182;</a>
              </div>
              <p>Auto self-init widgets</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.degradeInputsWithin = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( target )</span> {</span>

	target = $( target );</pre></div></div>
            
        </li>
        
        
        <li id="section-637">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-637">&#182;</a>
              </div>
              <p>Degrade inputs to avoid poorly implemented native functionality</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	target.find( <span class="hljs-string">"input"</span> ).not( $.mobile.page.prototype.keepNativeSelector() ).each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> element = $( <span class="hljs-keyword">this</span> ),
			type = <span class="hljs-keyword">this</span>.getAttribute( <span class="hljs-string">"type"</span> ),
			optType = $.mobile.degradeInputs[ type ] || <span class="hljs-string">"text"</span>,
			html, hasType, findstr, repstr;

		<span class="hljs-keyword">if</span> ( $.mobile.degradeInputs[ type ] ) {
			html = $( <span class="hljs-string">"&lt;div&gt;"</span> ).html( element.clone() ).html();</pre></div></div>
            
        </li>
        
        
        <li id="section-638">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-638">&#182;</a>
              </div>
              <p>In IE browsers, the type sometimes doesn’t exist in the cloned markup, so we replace the closing tag instead</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			hasType = html.indexOf( <span class="hljs-string">" type="</span> ) &gt; -<span class="hljs-number">1</span>;
			findstr = hasType ? <span class="hljs-regexp">/\s+type=["']?\w+['"]?/</span> : <span class="hljs-regexp">/\/?&gt;/</span>;
			repstr = <span class="hljs-string">" type=\""</span> + optType + <span class="hljs-string">"\" data-"</span> + $.mobile.ns + <span class="hljs-string">"type=\""</span> + type + <span class="hljs-string">"\""</span> + ( hasType ? <span class="hljs-string">""</span> : <span class="hljs-string">"&gt;"</span> );

			element.replaceWith( html.replace( findstr, repstr ) );
		}
	});

};

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.page"</span>, $.mobile.page, {
	options: {</pre></div></div>
            
        </li>
        
        
        <li id="section-639">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-639">&#182;</a>
              </div>
              <p>Accepts left, right and none</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		closeBtn: <span class="hljs-string">"left"</span>,
		closeBtnText: <span class="hljs-string">"Close"</span>,
		overlayTheme: <span class="hljs-string">"a"</span>,
		corners: <span class="hljs-literal">true</span>,
		dialog: <span class="hljs-literal">false</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._super();
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.dialog ) {

			$.extend( <span class="hljs-keyword">this</span>, {
				_inner: <span class="hljs-keyword">this</span>.element.children(),
				_headerCloseButton: <span class="hljs-literal">null</span>
			});

			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.options.enhanced ) {
				<span class="hljs-keyword">this</span>._setCloseBtn( <span class="hljs-keyword">this</span>.options.closeBtn );
			}
		}
	},

	_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._super();</pre></div></div>
            
        </li>
        
        
        <li id="section-640">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-640">&#182;</a>
              </div>
              <p>Class the markup for dialog styling and wrap interior</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.dialog ) {
			<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-string">"ui-dialog"</span> )
				.wrapInner( $( <span class="hljs-string">"&lt;div/&gt;"</span>, {</pre></div></div>
            
        </li>
        
        
        <li id="section-641">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-641">&#182;</a>
              </div>
              <p>ARIA role</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-string">"role"</span> : <span class="hljs-string">"dialog"</span>,
					<span class="hljs-string">"class"</span> : <span class="hljs-string">"ui-dialog-contain ui-overlay-shadow"</span> +
						( <span class="hljs-keyword">this</span>.options.corners ? <span class="hljs-string">" ui-corner-all"</span> : <span class="hljs-string">""</span> )
				}));
		}
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> closeButtonLocation, closeButtonText,
			currentOpts = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">if</span> ( options.corners !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._inner.toggleClass( <span class="hljs-string">"ui-corner-all"</span>, !!options.corners );
		}

		<span class="hljs-keyword">if</span> ( options.overlayTheme !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">if</span> ( $.mobile.activePage[ <span class="hljs-number">0</span> ] === <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ] ) {
				currentOpts.overlayTheme = options.overlayTheme;
				<span class="hljs-keyword">this</span>._handlePageBeforeShow();
			}
		}

		<span class="hljs-keyword">if</span> ( options.closeBtnText !== <span class="hljs-literal">undefined</span> ) {
			closeButtonLocation = currentOpts.closeBtn;
			closeButtonText = options.closeBtnText;
		}

		<span class="hljs-keyword">if</span> ( options.closeBtn !== <span class="hljs-literal">undefined</span> ) {
			closeButtonLocation = options.closeBtn;
		}

		<span class="hljs-keyword">if</span> ( closeButtonLocation ) {
			<span class="hljs-keyword">this</span>._setCloseBtn( closeButtonLocation, closeButtonText );
		}

		<span class="hljs-keyword">this</span>._super( options );
	},

	_handlePageBeforeShow: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.overlayTheme &amp;&amp; <span class="hljs-keyword">this</span>.options.dialog ) {
			<span class="hljs-keyword">this</span>.removeContainerBackground();
			<span class="hljs-keyword">this</span>.setContainerBackground( <span class="hljs-keyword">this</span>.options.overlayTheme );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>._super();
		}
	},

	_setCloseBtn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( location, text )</span> {</span>
		<span class="hljs-keyword">var</span> dst,
			btn = <span class="hljs-keyword">this</span>._headerCloseButton;</pre></div></div>
            
        </li>
        
        
        <li id="section-642">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-642">&#182;</a>
              </div>
              <p>Sanitize value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		location = <span class="hljs-string">"left"</span> === location ? <span class="hljs-string">"left"</span> : <span class="hljs-string">"right"</span> === location ? <span class="hljs-string">"right"</span> : <span class="hljs-string">"none"</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">"none"</span> === location ) {
			<span class="hljs-keyword">if</span> ( btn ) {
				btn.remove();
				btn = <span class="hljs-literal">null</span>;
			}
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( btn ) {
			btn.removeClass( <span class="hljs-string">"ui-btn-left ui-btn-right"</span> ).addClass( <span class="hljs-string">"ui-btn-"</span> + location );
			<span class="hljs-keyword">if</span> ( text ) {
				btn.text( text );
			}
		} <span class="hljs-keyword">else</span> {
			dst = <span class="hljs-keyword">this</span>._inner.find( <span class="hljs-string">":jqmData(role='header')"</span> ).first();
			btn = $( <span class="hljs-string">"&lt;a&gt;&lt;/a&gt;"</span>, {
					<span class="hljs-string">"href"</span>: <span class="hljs-string">"#"</span>,
					<span class="hljs-string">"class"</span>: <span class="hljs-string">"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"</span> + location
				})
				.attr( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"rel"</span>, <span class="hljs-string">"back"</span> )
				.text( text || <span class="hljs-keyword">this</span>.options.closeBtnText || <span class="hljs-string">""</span> )
				.prependTo( dst );
		}

		<span class="hljs-keyword">this</span>._headerCloseButton = btn;
	}
});

})( jQuery, <span class="hljs-keyword">this</span> );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.dialog"</span>, {
	options: {</pre></div></div>
            
        </li>
        
        
        <li id="section-643">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-643">&#182;</a>
              </div>
              <p>Accepts left, right and none</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		closeBtn: <span class="hljs-string">"left"</span>,
		closeBtnText: <span class="hljs-string">"Close"</span>,
		overlayTheme: <span class="hljs-string">"a"</span>,
		corners: <span class="hljs-literal">true</span>
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-644">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-644">&#182;</a>
              </div>
              <p>Override the theme set by the page plugin on pageshow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_handlePageBeforeShow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._isCloseable = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.overlayTheme ) {
			<span class="hljs-keyword">this</span>.element
				.page( <span class="hljs-string">"removeContainerBackground"</span> )
				.page( <span class="hljs-string">"setContainerBackground"</span>, <span class="hljs-keyword">this</span>.options.overlayTheme );
		}
	},

	_handlePageBeforeHide: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._isCloseable = <span class="hljs-literal">false</span>;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-645">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-645">&#182;</a>
              </div>
              <p>click and submit events:</p>
<ul>
<li>clicks and submits should use the closing transition that the dialog
opened with unless a data-transition is specified on the link/form</li>
<li>if the click was on the close button, or the link has a data-rel=”back”
it’ll go back in history naturally</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_handleVClickSubmit: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">var</span> attrs,
			$target = $( event.target ).closest( event.type === <span class="hljs-string">"vclick"</span> ? <span class="hljs-string">"a"</span> : <span class="hljs-string">"form"</span> );

		<span class="hljs-keyword">if</span> ( $target.length &amp;&amp; !$target.jqmData( <span class="hljs-string">"transition"</span> ) ) {
			attrs = {};
			attrs[ <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"transition"</span> ] =
				( $.mobile.navigate.history.getActive() || {} )[ <span class="hljs-string">"transition"</span> ] ||
				$.mobile.defaultDialogTransition;
			attrs[ <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"direction"</span> ] = <span class="hljs-string">"reverse"</span>;
			$target.attr( attrs );
		}
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> elem = <span class="hljs-keyword">this</span>.element,
			opts = <span class="hljs-keyword">this</span>.options;</pre></div></div>
            
        </li>
        
        
        <li id="section-646">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-646">&#182;</a>
              </div>
              <p>Class the markup for dialog styling and wrap interior</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		elem.addClass( <span class="hljs-string">"ui-dialog"</span> )
			.wrapInner( $( <span class="hljs-string">"&lt;div/&gt;"</span>, {</pre></div></div>
            
        </li>
        
        
        <li id="section-647">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-647">&#182;</a>
              </div>
              <p>ARIA role</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-string">"role"</span> : <span class="hljs-string">"dialog"</span>,
				<span class="hljs-string">"class"</span> : <span class="hljs-string">"ui-dialog-contain ui-overlay-shadow"</span> +
					( !!opts.corners ? <span class="hljs-string">" ui-corner-all"</span> : <span class="hljs-string">""</span> )
			}));

		$.extend( <span class="hljs-keyword">this</span>, {
			_isCloseable: <span class="hljs-literal">false</span>,
			_inner: elem.children(),
			_headerCloseButton: <span class="hljs-literal">null</span>
		});

		<span class="hljs-keyword">this</span>._on( elem, {
			vclick: <span class="hljs-string">"_handleVClickSubmit"</span>,
			submit: <span class="hljs-string">"_handleVClickSubmit"</span>,
			pagebeforeshow: <span class="hljs-string">"_handlePageBeforeShow"</span>,
			pagebeforehide: <span class="hljs-string">"_handlePageBeforeHide"</span>
		});

		<span class="hljs-keyword">this</span>._setCloseBtn( opts.closeBtn );
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> closeButtonLocation, closeButtonText,
			currentOpts = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">if</span> ( options.corners !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._inner.toggleClass( <span class="hljs-string">"ui-corner-all"</span>, !!options.corners );
		}

		<span class="hljs-keyword">if</span> ( options.overlayTheme !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">if</span> ( $.mobile.activePage[ <span class="hljs-number">0</span> ] === <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ] ) {
				currentOpts.overlayTheme = options.overlayTheme;
				<span class="hljs-keyword">this</span>._handlePageBeforeShow();
			}
		}

		<span class="hljs-keyword">if</span> ( options.closeBtnText !== <span class="hljs-literal">undefined</span> ) {
			closeButtonLocation = currentOpts.closeBtn;
			closeButtonText = options.closeBtnText;
		}

		<span class="hljs-keyword">if</span> ( options.closeBtn !== <span class="hljs-literal">undefined</span> ) {
			closeButtonLocation = options.closeBtn;
		}

		<span class="hljs-keyword">if</span> ( closeButtonLocation ) {
			<span class="hljs-keyword">this</span>._setCloseBtn( closeButtonLocation, closeButtonText );
		}

		<span class="hljs-keyword">this</span>._super( options );
	},

	_setCloseBtn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( location, text )</span> {</span>
		<span class="hljs-keyword">var</span> dst,
			btn = <span class="hljs-keyword">this</span>._headerCloseButton;</pre></div></div>
            
        </li>
        
        
        <li id="section-648">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-648">&#182;</a>
              </div>
              <p>Sanitize value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		location = <span class="hljs-string">"left"</span> === location ? <span class="hljs-string">"left"</span> : <span class="hljs-string">"right"</span> === location ? <span class="hljs-string">"right"</span> : <span class="hljs-string">"none"</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-string">"none"</span> === location ) {
			<span class="hljs-keyword">if</span> ( btn ) {
				btn.remove();
				btn = <span class="hljs-literal">null</span>;
			}
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( btn ) {
			btn.removeClass( <span class="hljs-string">"ui-btn-left ui-btn-right"</span> ).addClass( <span class="hljs-string">"ui-btn-"</span> + location );
			<span class="hljs-keyword">if</span> ( text ) {
				btn.text( text );
			}
		} <span class="hljs-keyword">else</span> {
			dst = <span class="hljs-keyword">this</span>._inner.find( <span class="hljs-string">":jqmData(role='header')"</span> ).first();
			btn = $( <span class="hljs-string">"&lt;a&gt;&lt;/a&gt;"</span>, {
					<span class="hljs-string">"role"</span>: <span class="hljs-string">"button"</span>,
					<span class="hljs-string">"href"</span>: <span class="hljs-string">"#"</span>,
					<span class="hljs-string">"class"</span>: <span class="hljs-string">"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"</span> + location
				})
				.text( text || <span class="hljs-keyword">this</span>.options.closeBtnText || <span class="hljs-string">""</span> )
				.prependTo( dst );
			<span class="hljs-keyword">this</span>._on( btn, { click: <span class="hljs-string">"close"</span> } );
		}

		<span class="hljs-keyword">this</span>._headerCloseButton = btn;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-649">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-649">&#182;</a>
              </div>
              <p>Close method goes back in history</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	close: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> hist = $.mobile.navigate.history;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isCloseable ) {
			<span class="hljs-keyword">this</span>._isCloseable = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-650">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-650">&#182;</a>
              </div>
              <p>If the hash listening is enabled and there is at least one preceding history
entry it’s ok to go back. Initial pages with the dialog hash state are an example
where the stack check is necessary</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $.mobile.hashListeningEnabled &amp;&amp; hist.activeIndex &gt; <span class="hljs-number">0</span> ) {
				$.mobile.back();
			} <span class="hljs-keyword">else</span> {
				$.mobile.pageContainer.pagecontainer( <span class="hljs-string">"back"</span> );
			}
		}
	}
});

})( jQuery, <span class="hljs-keyword">this</span> );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> rInitialLetter = <span class="hljs-regexp">/([A-Z])/g</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-651">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-651">&#182;</a>
              </div>
              <p>Construct iconpos class from iconpos value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	iconposClass = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( iconpos )</span> {</span>
		<span class="hljs-keyword">return</span> ( <span class="hljs-string">"ui-btn-icon-"</span> + ( iconpos === <span class="hljs-literal">null</span> ? <span class="hljs-string">"left"</span> : iconpos ) );
	};

$.widget( <span class="hljs-string">"mobile.collapsible"</span>, {
	options: {
		enhanced: <span class="hljs-literal">false</span>,
		expandCueText: <span class="hljs-literal">null</span>,
		collapseCueText: <span class="hljs-literal">null</span>,
		collapsed: <span class="hljs-literal">true</span>,
		heading: <span class="hljs-string">"h1,h2,h3,h4,h5,h6,legend"</span>,
		collapsedIcon: <span class="hljs-literal">null</span>,
		expandedIcon: <span class="hljs-literal">null</span>,
		iconpos: <span class="hljs-literal">null</span>,
		theme: <span class="hljs-literal">null</span>,
		contentTheme: <span class="hljs-literal">null</span>,
		inset: <span class="hljs-literal">null</span>,
		corners: <span class="hljs-literal">null</span>,
		mini: <span class="hljs-literal">null</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> elem = <span class="hljs-keyword">this</span>.element,
			ui = {
				accordion: elem
					.closest( <span class="hljs-string">":jqmData(role='collapsible-set'),"</span> +
						<span class="hljs-string">":jqmData(role='collapsibleset')"</span> +
						( $.mobile.collapsibleset ? <span class="hljs-string">", :mobile-collapsibleset"</span> :
							<span class="hljs-string">""</span> ) )
					.addClass( <span class="hljs-string">"ui-collapsible-set"</span> )
			};

		<span class="hljs-keyword">this</span>._ui = ui;
		<span class="hljs-keyword">this</span>._renderedOptions = <span class="hljs-keyword">this</span>._getOptions( <span class="hljs-keyword">this</span>.options );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.enhanced ) {
			ui.heading = $( <span class="hljs-string">".ui-collapsible-heading"</span>, <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ] );
			ui.content = ui.heading.next();
			ui.anchor = $( <span class="hljs-string">"a"</span>, ui.heading[ <span class="hljs-number">0</span> ] ).first();
			ui.status = ui.anchor.children( <span class="hljs-string">".ui-collapsible-heading-status"</span> );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>._enhance( elem, ui );
		}

		<span class="hljs-keyword">this</span>._on( ui.heading, {
			<span class="hljs-string">"tap"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				ui.heading.find( <span class="hljs-string">"a"</span> ).first().addClass( $.mobile.activeBtnClass );
			},

			<span class="hljs-string">"click"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
				<span class="hljs-keyword">this</span>._handleExpandCollapse( !ui.heading.hasClass( <span class="hljs-string">"ui-collapsible-heading-collapsed"</span> ) );
				event.preventDefault();
				event.stopPropagation();
			}
		});
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-652">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-652">&#182;</a>
              </div>
              <p>Adjust the keys inside options for inherited values</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_getOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> key,
			accordion = <span class="hljs-keyword">this</span>._ui.accordion,
			accordionWidget = <span class="hljs-keyword">this</span>._ui.accordionWidget;</pre></div></div>
            
        </li>
        
        
        <li id="section-653">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-653">&#182;</a>
              </div>
              <p>Copy options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		options = $.extend( {}, options );

		<span class="hljs-keyword">if</span> ( accordion.length &amp;&amp; !accordionWidget ) {
			<span class="hljs-keyword">this</span>._ui.accordionWidget =
			accordionWidget = accordion.data( <span class="hljs-string">"mobile-collapsibleset"</span> );
		}

		<span class="hljs-keyword">for</span> ( key <span class="hljs-keyword">in</span> options ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-654">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-654">&#182;</a>
              </div>
              <p>Retrieve the option value first from the options object passed in and, if
null, from the parent accordion or, if that’s null too, or if there’s no
parent accordion, then from the defaults.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			options[ key ] =
				( options[ key ] != <span class="hljs-literal">null</span> ) ? options[ key ] :
				( accordionWidget ) ? accordionWidget.options[ key ] :
				accordion.length ? $.mobile.getAttribute( accordion[ <span class="hljs-number">0</span> ],
					key.replace( rInitialLetter, <span class="hljs-string">"-$1"</span> ).toLowerCase() ):
				<span class="hljs-literal">null</span>;

			<span class="hljs-keyword">if</span> ( <span class="hljs-literal">null</span> == options[ key ] ) {
				options[ key ] = $.mobile.collapsible.defaults[ key ];
			}
		}

		<span class="hljs-keyword">return</span> options;
	},

	_themeClassFromOption: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( prefix, value )</span> {</span>
		<span class="hljs-keyword">return</span> ( value ? ( value === <span class="hljs-string">"none"</span> ? <span class="hljs-string">""</span> : prefix + value ) : <span class="hljs-string">""</span> );
	},

	_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( elem, ui )</span> {</span>
		<span class="hljs-keyword">var</span> iconclass,
			opts = <span class="hljs-keyword">this</span>._renderedOptions,
			contentThemeClass = <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-body-"</span>, opts.contentTheme );

		elem.addClass( <span class="hljs-string">"ui-collapsible "</span> +
			( opts.inset ? <span class="hljs-string">"ui-collapsible-inset "</span> : <span class="hljs-string">""</span> ) +
			( opts.inset &amp;&amp; opts.corners ? <span class="hljs-string">"ui-corner-all "</span> : <span class="hljs-string">""</span> ) +
			( contentThemeClass ? <span class="hljs-string">"ui-collapsible-themed-content "</span> : <span class="hljs-string">""</span> ) );
		ui.originalHeading = elem.children( <span class="hljs-keyword">this</span>.options.heading ).first(),
		ui.content = elem
			.wrapInner( <span class="hljs-string">"&lt;div "</span> +
				<span class="hljs-string">"class='ui-collapsible-content "</span> +
				contentThemeClass + <span class="hljs-string">"'&gt;&lt;/div&gt;"</span> )
			.children( <span class="hljs-string">".ui-collapsible-content"</span> ),
		ui.heading = ui.originalHeading;</pre></div></div>
            
        </li>
        
        
        <li id="section-655">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-655">&#182;</a>
              </div>
              <p>Replace collapsibleHeading if it’s a legend</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ui.heading.is( <span class="hljs-string">"legend"</span> ) ) {
			ui.heading = $( <span class="hljs-string">"&lt;div role='heading'&gt;"</span>+ ui.heading.html() +<span class="hljs-string">"&lt;/div&gt;"</span> );
			ui.placeholder = $( <span class="hljs-string">"&lt;div&gt;&lt;!-- placeholder for legend --&gt;&lt;/div&gt;"</span> ).insertBefore( ui.originalHeading );
			ui.originalHeading.remove();
		}

		iconclass = ( opts.collapsed ? ( opts.collapsedIcon ? <span class="hljs-string">"ui-icon-"</span> + opts.collapsedIcon : <span class="hljs-string">""</span> ):
			( opts.expandedIcon ? <span class="hljs-string">"ui-icon-"</span> + opts.expandedIcon : <span class="hljs-string">""</span> ) );

		ui.status = $( <span class="hljs-string">"&lt;span class='ui-collapsible-heading-status'&gt;&lt;/span&gt;"</span> );
		ui.anchor = ui.heading
			.detach()</pre></div></div>
            
        </li>
        
        
        <li id="section-656">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-656">&#182;</a>
              </div>
              <p>modify markup &amp; attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			.addClass( <span class="hljs-string">"ui-collapsible-heading"</span> )
			.append( ui.status )
			.wrapInner( <span class="hljs-string">"&lt;a href='#' class='ui-collapsible-heading-toggle'&gt;&lt;/a&gt;"</span> )
			.find( <span class="hljs-string">"a"</span> )
				.first()
				.addClass( <span class="hljs-string">"ui-btn "</span> +
					( iconclass ? iconclass + <span class="hljs-string">" "</span> : <span class="hljs-string">""</span> ) +
					( iconclass ? iconposClass( opts.iconpos ) +
						<span class="hljs-string">" "</span> : <span class="hljs-string">""</span> ) +
					<span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-btn-"</span>, opts.theme ) + <span class="hljs-string">" "</span> +
					( opts.mini ? <span class="hljs-string">"ui-mini "</span> : <span class="hljs-string">""</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-657">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-657">&#182;</a>
              </div>
              <p>drop heading in before content</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		ui.heading.insertBefore( ui.content );

		<span class="hljs-keyword">this</span>._handleExpandCollapse( <span class="hljs-keyword">this</span>.options.collapsed );

		<span class="hljs-keyword">return</span> ui;
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._applyOptions( <span class="hljs-keyword">this</span>.options );
		<span class="hljs-keyword">this</span>._renderedOptions = <span class="hljs-keyword">this</span>._getOptions( <span class="hljs-keyword">this</span>.options );
	},

	_applyOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> isCollapsed, newTheme, oldTheme, hasCorners, hasIcon,
			elem = <span class="hljs-keyword">this</span>.element,
			currentOpts = <span class="hljs-keyword">this</span>._renderedOptions,
			ui = <span class="hljs-keyword">this</span>._ui,
			anchor = ui.anchor,
			status = ui.status,
			opts = <span class="hljs-keyword">this</span>._getOptions( options );</pre></div></div>
            
        </li>
        
        
        <li id="section-658">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-658">&#182;</a>
              </div>
              <p>First and foremost we need to make sure the collapsible is in the proper
state, in case somebody decided to change the collapsed option at the
same time as another option</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( options.collapsed !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._handleExpandCollapse( options.collapsed );
		}

		isCollapsed = elem.hasClass( <span class="hljs-string">"ui-collapsible-collapsed"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-659">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-659">&#182;</a>
              </div>
              <p>We only need to apply the cue text for the current state right away.
The cue text for the alternate state will be stored in the options
and applied the next time the collapsible’s state is toggled</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( isCollapsed ) {
			<span class="hljs-keyword">if</span> ( opts.expandCueText !== <span class="hljs-literal">undefined</span> ) {
				status.text( opts.expandCueText );
			}
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">if</span> ( opts.collapseCueText !== <span class="hljs-literal">undefined</span> ) {
				status.text( opts.collapseCueText );
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-660">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-660">&#182;</a>
              </div>
              <p>Update icon</p>

            </div>
            
        </li>
        
        
        <li id="section-661">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-661">&#182;</a>
              </div>
              <p>Is it supposed to have an icon?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		hasIcon =</pre></div></div>
            
        </li>
        
        
        <li id="section-662">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-662">&#182;</a>
              </div>
              <p>If the collapsedIcon is being set, consult that</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			( opts.collapsedIcon !== <span class="hljs-literal">undefined</span> ? opts.collapsedIcon !== <span class="hljs-literal">false</span> :</pre></div></div>
            
        </li>
        
        
        <li id="section-663">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-663">&#182;</a>
              </div>
              <p>Otherwise consult the existing option value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				currentOpts.collapsedIcon !== <span class="hljs-literal">false</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-664">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-664">&#182;</a>
              </div>
              <p>If any icon-related options have changed, make sure the new icon
state is reflected by first removing all icon-related classes
reflecting the current state and then adding all icon-related
classes for the new state</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !( opts.iconpos === <span class="hljs-literal">undefined</span> &amp;&amp;
			opts.collapsedIcon === <span class="hljs-literal">undefined</span> &amp;&amp;
			opts.expandedIcon === <span class="hljs-literal">undefined</span> ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-665">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-665">&#182;</a>
              </div>
              <p>Remove all current icon-related classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			anchor.removeClass( [ iconposClass( currentOpts.iconpos ) ]
				.concat( ( currentOpts.expandedIcon ?
					[ <span class="hljs-string">"ui-icon-"</span> + currentOpts.expandedIcon ] : [] ) )
				.concat( ( currentOpts.collapsedIcon ?
					[ <span class="hljs-string">"ui-icon-"</span> + currentOpts.collapsedIcon ] : [] ) )
				.join( <span class="hljs-string">" "</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-666">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-666">&#182;</a>
              </div>
              <p>Add new classes if an icon is supposed to be present</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( hasIcon ) {
				anchor.addClass(
					[ iconposClass( opts.iconpos !== <span class="hljs-literal">undefined</span> ?
						opts.iconpos : currentOpts.iconpos ) ]
						.concat( isCollapsed ?
							[ <span class="hljs-string">"ui-icon-"</span> + ( opts.collapsedIcon !== <span class="hljs-literal">undefined</span> ?
								opts.collapsedIcon :
								currentOpts.collapsedIcon ) ] :
							[ <span class="hljs-string">"ui-icon-"</span> + ( opts.expandedIcon !== <span class="hljs-literal">undefined</span> ?
								opts.expandedIcon :
								currentOpts.expandedIcon ) ] )
						.join( <span class="hljs-string">" "</span> ) );
			}
		}

		<span class="hljs-keyword">if</span> ( opts.theme !== <span class="hljs-literal">undefined</span> ) {
			oldTheme = <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-btn-"</span>, currentOpts.theme );
			newTheme = <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-btn-"</span>, opts.theme );
			anchor.removeClass( oldTheme ).addClass( newTheme );
		}

		<span class="hljs-keyword">if</span> ( opts.contentTheme !== <span class="hljs-literal">undefined</span> ) {
			oldTheme = <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-body-"</span>,
				currentOpts.contentTheme );
			newTheme = <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-body-"</span>,
				opts.contentTheme );
			ui.content.removeClass( oldTheme ).addClass( newTheme );
		}

		<span class="hljs-keyword">if</span> ( opts.inset !== <span class="hljs-literal">undefined</span> ) {
			elem.toggleClass( <span class="hljs-string">"ui-collapsible-inset"</span>, opts.inset );
			hasCorners = !!( opts.inset &amp;&amp; ( opts.corners || currentOpts.corners ) );
		}

		<span class="hljs-keyword">if</span> ( opts.corners !== <span class="hljs-literal">undefined</span> ) {
			hasCorners = !!( opts.corners &amp;&amp; ( opts.inset || currentOpts.inset ) );
		}

		<span class="hljs-keyword">if</span> ( hasCorners !== <span class="hljs-literal">undefined</span> ) {
			elem.toggleClass( <span class="hljs-string">"ui-corner-all"</span>, hasCorners );
		}

		<span class="hljs-keyword">if</span> ( opts.mini !== <span class="hljs-literal">undefined</span> ) {
			anchor.toggleClass( <span class="hljs-string">"ui-mini"</span>, opts.mini );
		}
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">this</span>._applyOptions( options );
		<span class="hljs-keyword">this</span>._super( options );
		<span class="hljs-keyword">this</span>._renderedOptions = <span class="hljs-keyword">this</span>._getOptions( <span class="hljs-keyword">this</span>.options );
	},

	_handleExpandCollapse: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( isCollapse )</span> {</span>
		<span class="hljs-keyword">var</span> opts = <span class="hljs-keyword">this</span>._renderedOptions,
			ui = <span class="hljs-keyword">this</span>._ui;

		ui.status.text( isCollapse ? opts.expandCueText : opts.collapseCueText );
		ui.heading
			.toggleClass( <span class="hljs-string">"ui-collapsible-heading-collapsed"</span>, isCollapse )
			.find( <span class="hljs-string">"a"</span> ).first()
			.toggleClass( <span class="hljs-string">"ui-icon-"</span> + opts.expandedIcon, !isCollapse )</pre></div></div>
            
        </li>
        
        
        <li id="section-667">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-667">&#182;</a>
              </div>
              <p>logic or cause same icon for expanded/collapsed state would remove the ui-icon-class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			.toggleClass( <span class="hljs-string">"ui-icon-"</span> + opts.collapsedIcon, ( isCollapse || opts.expandedIcon === opts.collapsedIcon ) )
			.removeClass( $.mobile.activeBtnClass );

		<span class="hljs-keyword">this</span>.element.toggleClass( <span class="hljs-string">"ui-collapsible-collapsed"</span>, isCollapse );
		ui.content
			.toggleClass( <span class="hljs-string">"ui-collapsible-content-collapsed"</span>, isCollapse )
			.attr( <span class="hljs-string">"aria-hidden"</span>, isCollapse )
			.trigger( <span class="hljs-string">"updatelayout"</span> );
		<span class="hljs-keyword">this</span>.options.collapsed = isCollapse;
		<span class="hljs-keyword">this</span>._trigger( isCollapse ? <span class="hljs-string">"collapse"</span> : <span class="hljs-string">"expand"</span> );
	},

	expand: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._handleExpandCollapse( <span class="hljs-literal">false</span> );
	},

	collapse: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._handleExpandCollapse( <span class="hljs-literal">true</span> );
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> ui = <span class="hljs-keyword">this</span>._ui,
			opts = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">if</span> ( opts.enhanced ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( ui.placeholder ) {
			ui.originalHeading.insertBefore( ui.placeholder );
			ui.placeholder.remove();
			ui.heading.remove();
		} <span class="hljs-keyword">else</span> {
			ui.status.remove();
			ui.heading
				.removeClass( <span class="hljs-string">"ui-collapsible-heading ui-collapsible-heading-collapsed"</span> )
				.children()
					.contents()
						.unwrap();
		}

		ui.anchor.contents().unwrap();
		ui.content.contents().unwrap();
		<span class="hljs-keyword">this</span>.element
			.removeClass( <span class="hljs-string">"ui-collapsible ui-collapsible-collapsed "</span> +
				<span class="hljs-string">"ui-collapsible-themed-content ui-collapsible-inset ui-corner-all"</span> );
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-668">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-668">&#182;</a>
              </div>
              <p>Defaults to be used by all instances of collapsible if per-instance values
are unset or if nothing is specified by way of inheritance from an accordion.
Note that this hash does not contain options “collapsed” or “heading”,
because those are not inheritable.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.collapsible.defaults = {
	expandCueText: <span class="hljs-string">" click to expand contents"</span>,
	collapseCueText: <span class="hljs-string">" click to collapse contents"</span>,
	collapsedIcon: <span class="hljs-string">"plus"</span>,
	contentTheme: <span class="hljs-string">"inherit"</span>,
	expandedIcon: <span class="hljs-string">"minus"</span>,
	iconpos: <span class="hljs-string">"left"</span>,
	inset: <span class="hljs-literal">true</span>,
	corners: <span class="hljs-literal">true</span>,
	theme: <span class="hljs-string">"inherit"</span>,
	mini: <span class="hljs-literal">false</span>
};

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.mobile.behaviors.addFirstLastClasses = {
	_getVisibles: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $els, create )</span> {</span>
		<span class="hljs-keyword">var</span> visibles;

		<span class="hljs-keyword">if</span> ( create ) {
			visibles = $els.not( <span class="hljs-string">".ui-screen-hidden"</span> );
		} <span class="hljs-keyword">else</span> {
			visibles = $els.filter( <span class="hljs-string">":visible"</span> );
			<span class="hljs-keyword">if</span> ( visibles.length === <span class="hljs-number">0</span> ) {
				visibles = $els.not( <span class="hljs-string">".ui-screen-hidden"</span> );
			}
		}

		<span class="hljs-keyword">return</span> visibles;
	},

	_addFirstLastClasses: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $els, $visibles, create )</span> {</span>
		$els.removeClass( <span class="hljs-string">"ui-first-child ui-last-child"</span> );
		$visibles.eq( <span class="hljs-number">0</span> ).addClass( <span class="hljs-string">"ui-first-child"</span> ).end().last().addClass( <span class="hljs-string">"ui-last-child"</span> );
		<span class="hljs-keyword">if</span> ( !create ) {
			<span class="hljs-keyword">this</span>.element.trigger( <span class="hljs-string">"updatelayout"</span> );
		}
	},

	_removeFirstLastClasses: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $els )</span> {</span>
		$els.removeClass( <span class="hljs-string">"ui-first-child ui-last-child"</span> );
	}
};

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> childCollapsiblesSelector = <span class="hljs-string">":mobile-collapsible, "</span> + $.mobile.collapsible.initSelector;

$.widget( <span class="hljs-string">"mobile.collapsibleset"</span>, $.extend( {</pre></div></div>
            
        </li>
        
        
        <li id="section-669">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-669">&#182;</a>
              </div>
              <p>The initSelector is deprecated as of 1.4.0. In 1.5.0 we will use
:jqmData(role=’collapsibleset’) which will allow us to get rid of the line
below altogether, because the autoinit will generate such an initSelector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	initSelector: <span class="hljs-string">":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')"</span>,

	options: $.extend( {
		enhanced: <span class="hljs-literal">false</span>
	}, $.mobile.collapsible.defaults ),

	_handleCollapsibleExpand: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">var</span> closestCollapsible = $( event.target ).closest( <span class="hljs-string">".ui-collapsible"</span> );

		<span class="hljs-keyword">if</span> ( closestCollapsible.parent().is( <span class="hljs-string">":mobile-collapsibleset, :jqmData(role='collapsible-set')"</span> ) ) {
			closestCollapsible
				.siblings( <span class="hljs-string">".ui-collapsible:not(.ui-collapsible-collapsed)"</span> )
				.collapsible( <span class="hljs-string">"collapse"</span> );
		}
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> elem = <span class="hljs-keyword">this</span>.element,
			opts = <span class="hljs-keyword">this</span>.options;

		$.extend( <span class="hljs-keyword">this</span>, {
			_classes: <span class="hljs-string">""</span>
		});

		<span class="hljs-keyword">if</span> ( !opts.enhanced ) {
			elem.addClass( <span class="hljs-string">"ui-collapsible-set "</span> +
				<span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-group-theme-"</span>, opts.theme ) + <span class="hljs-string">" "</span> +
				( opts.corners &amp;&amp; opts.inset ? <span class="hljs-string">"ui-corner-all "</span> : <span class="hljs-string">""</span> ) );
			<span class="hljs-keyword">this</span>.element.find( $.mobile.collapsible.initSelector ).collapsible();
		}

		<span class="hljs-keyword">this</span>._on( elem, { collapsibleexpand: <span class="hljs-string">"_handleCollapsibleExpand"</span> } );
	},

	_themeClassFromOption: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( prefix, value )</span> {</span>
		<span class="hljs-keyword">return</span> ( value ? ( value === <span class="hljs-string">"none"</span> ? <span class="hljs-string">""</span> : prefix + value ) : <span class="hljs-string">""</span> );
	},

	_init: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._refresh( <span class="hljs-literal">true</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-670">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-670">&#182;</a>
              </div>
              <p>Because the corners are handled by the collapsible itself and the default state is collapsed
That was causing <a href="https://github.com/jquery/jquery-mobile/issues/4116">https://github.com/jquery/jquery-mobile/issues/4116</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.element
			.children( childCollapsiblesSelector )
			.filter( <span class="hljs-string">":jqmData(collapsed='false')"</span> )
			.collapsible( <span class="hljs-string">"expand"</span> );
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> ret, hasCorners,
			elem = <span class="hljs-keyword">this</span>.element,
			themeClass = <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-group-theme-"</span>, options.theme );

		<span class="hljs-keyword">if</span> ( themeClass ) {
			elem
				.removeClass( <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-group-theme-"</span>, <span class="hljs-keyword">this</span>.options.theme ) )
				.addClass( themeClass );
		}

		<span class="hljs-keyword">if</span> ( options.inset !== <span class="hljs-literal">undefined</span> ) {
			hasCorners = !!( options.inset &amp;&amp; ( options.corners || <span class="hljs-keyword">this</span>.options.corners ) );
		}

		<span class="hljs-keyword">if</span> ( options.corners !== <span class="hljs-literal">undefined</span> ) {
			hasCorners = !!( options.corners &amp;&amp; ( options.inset || <span class="hljs-keyword">this</span>.options.inset ) );
		}

		<span class="hljs-keyword">if</span> ( hasCorners !== <span class="hljs-literal">undefined</span> ) {
			elem.toggleClass( <span class="hljs-string">"ui-corner-all"</span>, hasCorners );
		}

		ret = <span class="hljs-keyword">this</span>._super( options );
		<span class="hljs-keyword">this</span>.element.children( <span class="hljs-string">":mobile-collapsible"</span> ).collapsible( <span class="hljs-string">"refresh"</span> );
		<span class="hljs-keyword">return</span> ret;
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>.element;

		<span class="hljs-keyword">this</span>._removeFirstLastClasses( el.children( childCollapsiblesSelector ) );
		el
			.removeClass( <span class="hljs-string">"ui-collapsible-set ui-corner-all "</span> +
				<span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-group-theme-"</span>, <span class="hljs-keyword">this</span>.options.theme ) )
			.children( <span class="hljs-string">":mobile-collapsible"</span> )
			.collapsible( <span class="hljs-string">"destroy"</span> );
	},

	_refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( create )</span> {</span>
		<span class="hljs-keyword">var</span> collapsiblesInSet = <span class="hljs-keyword">this</span>.element.children( childCollapsiblesSelector );

		<span class="hljs-keyword">this</span>.element.find( $.mobile.collapsible.initSelector ).not( <span class="hljs-string">".ui-collapsible"</span> ).collapsible();

		<span class="hljs-keyword">this</span>._addFirstLastClasses( collapsiblesInSet, <span class="hljs-keyword">this</span>._getVisibles( collapsiblesInSet, create ), create );
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._refresh( <span class="hljs-literal">false</span> );
	}
}, $.mobile.behaviors.addFirstLastClasses ) );

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-671">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-671">&#182;</a>
              </div>
              <p>Deprecated in 1.4</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.fn.fieldcontain = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* options */</span>)</span> {</span>
	<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.addClass( <span class="hljs-string">"ui-field-contain"</span> );
};

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.fn.grid = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
	<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

		<span class="hljs-keyword">var</span> $<span class="hljs-keyword">this</span> = $( <span class="hljs-keyword">this</span> ),
			o = $.extend({
				grid: <span class="hljs-literal">null</span>
			}, options ),
			$kids = $<span class="hljs-keyword">this</span>.children(),
			gridCols = { solo:<span class="hljs-number">1</span>, a:<span class="hljs-number">2</span>, b:<span class="hljs-number">3</span>, c:<span class="hljs-number">4</span>, d:<span class="hljs-number">5</span> },
			grid = o.grid,
			iterator,
			letter;

			<span class="hljs-keyword">if</span> ( !grid ) {
				<span class="hljs-keyword">if</span> ( $kids.length &lt;= <span class="hljs-number">5</span> ) {
					<span class="hljs-keyword">for</span> ( letter <span class="hljs-keyword">in</span> gridCols ) {
						<span class="hljs-keyword">if</span> ( gridCols[ letter ] === $kids.length ) {
							grid = letter;
						}
					}
				} <span class="hljs-keyword">else</span> {
					grid = <span class="hljs-string">"a"</span>;
					$<span class="hljs-keyword">this</span>.addClass( <span class="hljs-string">"ui-grid-duo"</span> );
				}
			}
			iterator = gridCols[grid];

		$<span class="hljs-keyword">this</span>.addClass( <span class="hljs-string">"ui-grid-"</span> + grid );

		$kids.filter( <span class="hljs-string">":nth-child("</span> + iterator + <span class="hljs-string">"n+1)"</span> ).addClass( <span class="hljs-string">"ui-block-a"</span> );

		<span class="hljs-keyword">if</span> ( iterator &gt; <span class="hljs-number">1</span> ) {
			$kids.filter( <span class="hljs-string">":nth-child("</span> + iterator + <span class="hljs-string">"n+2)"</span> ).addClass( <span class="hljs-string">"ui-block-b"</span> );
		}
		<span class="hljs-keyword">if</span> ( iterator &gt; <span class="hljs-number">2</span> ) {
			$kids.filter( <span class="hljs-string">":nth-child("</span> + iterator + <span class="hljs-string">"n+3)"</span> ).addClass( <span class="hljs-string">"ui-block-c"</span> );
		}
		<span class="hljs-keyword">if</span> ( iterator &gt; <span class="hljs-number">3</span> ) {
			$kids.filter( <span class="hljs-string">":nth-child("</span> + iterator + <span class="hljs-string">"n+4)"</span> ).addClass( <span class="hljs-string">"ui-block-d"</span> );
		}
		<span class="hljs-keyword">if</span> ( iterator &gt; <span class="hljs-number">4</span> ) {
			$kids.filter( <span class="hljs-string">":nth-child("</span> + iterator + <span class="hljs-string">"n+5)"</span> ).addClass( <span class="hljs-string">"ui-block-e"</span> );
		}
	});
};
})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.navbar"</span>, {
	options: {
		iconpos: <span class="hljs-string">"top"</span>,
		grid: <span class="hljs-literal">null</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

		<span class="hljs-keyword">var</span> $navbar = <span class="hljs-keyword">this</span>.element,
			$navbtns = $navbar.find( <span class="hljs-string">"a"</span> ),
			iconpos = $navbtns.filter( <span class="hljs-string">":jqmData(icon)"</span> ).length ? <span class="hljs-keyword">this</span>.options.iconpos : <span class="hljs-literal">undefined</span>;

		$navbar.addClass( <span class="hljs-string">"ui-navbar"</span> )
			.attr( <span class="hljs-string">"role"</span>, <span class="hljs-string">"navigation"</span> )
			.find( <span class="hljs-string">"ul"</span> )
			.jqmEnhanceable()
			.grid({ grid: <span class="hljs-keyword">this</span>.options.grid });

		$navbtns
			.each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> icon = $.mobile.getAttribute( <span class="hljs-keyword">this</span>, <span class="hljs-string">"icon"</span> ),
					theme = $.mobile.getAttribute( <span class="hljs-keyword">this</span>, <span class="hljs-string">"theme"</span> ),
					classes = <span class="hljs-string">"ui-btn"</span>;

				<span class="hljs-keyword">if</span> ( theme ) {
					classes += <span class="hljs-string">" ui-btn-"</span> + theme;
				}
				<span class="hljs-keyword">if</span> ( icon ) {
					classes += <span class="hljs-string">" ui-icon-"</span> + icon + <span class="hljs-string">" ui-btn-icon-"</span> + iconpos;
				}
				$( <span class="hljs-keyword">this</span> ).addClass( classes );
			});

		$navbar.delegate( <span class="hljs-string">"a"</span>, <span class="hljs-string">"vclick"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( <span class="hljs-comment">/* event */</span> )</span> {</span>
			<span class="hljs-keyword">var</span> activeBtn = $( <span class="hljs-keyword">this</span> );

			<span class="hljs-keyword">if</span> ( !( activeBtn.hasClass( <span class="hljs-string">"ui-state-disabled"</span> ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-672">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-672">&#182;</a>
              </div>
              <p>DEPRECATED as of 1.4.0 - remove after 1.4.0 release
only ui-state-disabled should be present thereafter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				activeBtn.hasClass( <span class="hljs-string">"ui-disabled"</span> ) ||
				activeBtn.hasClass( $.mobile.activeBtnClass ) ) ) {

				$navbtns.removeClass( $.mobile.activeBtnClass );
				activeBtn.addClass( $.mobile.activeBtnClass );</pre></div></div>
            
        </li>
        
        
        <li id="section-673">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-673">&#182;</a>
              </div>
              <p>The code below is a workaround to fix #1181</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				$( document ).one( <span class="hljs-string">"pagehide"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					activeBtn.removeClass( $.mobile.activeBtnClass );
				});
			}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-674">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-674">&#182;</a>
              </div>
              <p>Buttons in the navbar with ui-state-persist class should regain their active state before page show</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$navbar.closest( <span class="hljs-string">".ui-page"</span> ).bind( <span class="hljs-string">"pagebeforeshow"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$navbtns.filter( <span class="hljs-string">".ui-state-persist"</span> ).addClass( $.mobile.activeBtnClass );
		});
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> getAttr = $.mobile.getAttribute;

$.widget( <span class="hljs-string">"mobile.listview"</span>, $.extend( {

	options: {
		theme: <span class="hljs-literal">null</span>,
		countTheme: <span class="hljs-literal">null</span>, <span class="hljs-comment">/* Deprecated in 1.4 */</span>
		dividerTheme: <span class="hljs-literal">null</span>,
		icon: <span class="hljs-string">"carat-r"</span>,
		splitIcon: <span class="hljs-string">"carat-r"</span>,
		splitTheme: <span class="hljs-literal">null</span>,
		corners: <span class="hljs-literal">true</span>,
		shadow: <span class="hljs-literal">true</span>,
		inset: <span class="hljs-literal">false</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> t = <span class="hljs-keyword">this</span>,
			listviewClasses = <span class="hljs-string">""</span>;

		listviewClasses += t.options.inset ? <span class="hljs-string">" ui-listview-inset"</span> : <span class="hljs-string">""</span>;

		<span class="hljs-keyword">if</span> ( !!t.options.inset ) {
			listviewClasses += t.options.corners ? <span class="hljs-string">" ui-corner-all"</span> : <span class="hljs-string">""</span>;
			listviewClasses += t.options.shadow ? <span class="hljs-string">" ui-shadow"</span> : <span class="hljs-string">""</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-675">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-675">&#182;</a>
              </div>
              <p>create listview markup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		t.element.addClass( <span class="hljs-string">" ui-listview"</span> + listviewClasses );

		t.refresh( <span class="hljs-literal">true</span> );
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-676">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-676">&#182;</a>
              </div>
              <p>TODO: Remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_findFirstElementByTagName: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( ele, nextProp, lcName, ucName )</span> {</span>
		<span class="hljs-keyword">var</span> dict = {};
		dict[ lcName ] = dict[ ucName ] = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">while</span> ( ele ) {
			<span class="hljs-keyword">if</span> ( dict[ ele.nodeName ] ) {
				<span class="hljs-keyword">return</span> ele;
			}
			ele = ele[ nextProp ];
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-677">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-677">&#182;</a>
              </div>
              <p>TODO: Remove in 1.5</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_addThumbClasses: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( containers )</span> {</span>
		<span class="hljs-keyword">var</span> i, img, len = containers.length;
		<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; len; i++ ) {
			img = $( <span class="hljs-keyword">this</span>._findFirstElementByTagName( containers[ i ].firstChild, <span class="hljs-string">"nextSibling"</span>, <span class="hljs-string">"img"</span>, <span class="hljs-string">"IMG"</span> ) );
			<span class="hljs-keyword">if</span> ( img.length ) {
				$( <span class="hljs-keyword">this</span>._findFirstElementByTagName( img[ <span class="hljs-number">0</span> ].parentNode, <span class="hljs-string">"parentNode"</span>, <span class="hljs-string">"li"</span>, <span class="hljs-string">"LI"</span> ) ).addClass( img.hasClass( <span class="hljs-string">"ui-li-icon"</span> ) ? <span class="hljs-string">"ui-li-has-icon"</span> : <span class="hljs-string">"ui-li-has-thumb"</span> );
			}
		}
	},

	_getChildrenByTagName: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( ele, lcName, ucName )</span> {</span>
		<span class="hljs-keyword">var</span> results = [],
			dict = {};
		dict[ lcName ] = dict[ ucName ] = <span class="hljs-literal">true</span>;
		ele = ele.firstChild;
		<span class="hljs-keyword">while</span> ( ele ) {
			<span class="hljs-keyword">if</span> ( dict[ ele.nodeName ] ) {
				results.push( ele );
			}
			ele = ele.nextSibling;
		}
		<span class="hljs-keyword">return</span> $( results );
	},

	_beforeListviewRefresh: $.noop,
	_afterListviewRefresh: $.noop,

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( create )</span> {</span>
		<span class="hljs-keyword">var</span> buttonClass, pos, numli, item, itemClass, itemTheme, itemIcon, icon, a,
			isDivider, startCount, newStartCount, value, last, splittheme, splitThemeClass, spliticon,
			altButtonClass, dividerTheme, li,
			o = <span class="hljs-keyword">this</span>.options,
			$list = <span class="hljs-keyword">this</span>.element,
			ol = !!$.nodeName( $list[ <span class="hljs-number">0</span> ], <span class="hljs-string">"ol"</span> ),
			start = $list.attr( <span class="hljs-string">"start"</span> ),
			itemClassDict = {},
			countBubbles = $list.find( <span class="hljs-string">".ui-li-count"</span> ),
			countTheme = getAttr( $list[ <span class="hljs-number">0</span> ], <span class="hljs-string">"counttheme"</span> ) || <span class="hljs-keyword">this</span>.options.countTheme,
			countThemeClass = countTheme ? <span class="hljs-string">"ui-body-"</span> + countTheme : <span class="hljs-string">"ui-body-inherit"</span>;

		<span class="hljs-keyword">if</span> ( o.theme ) {
			$list.addClass( <span class="hljs-string">"ui-group-theme-"</span> + o.theme );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-678">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-678">&#182;</a>
              </div>
              <p>Check if a start attribute has been set while taking a value of 0 into account</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( ol &amp;&amp; ( start || start === <span class="hljs-number">0</span> ) ) {
			startCount = <span class="hljs-built_in">parseInt</span>( start, <span class="hljs-number">10</span> ) - <span class="hljs-number">1</span>;
			$list.css( <span class="hljs-string">"counter-reset"</span>, <span class="hljs-string">"listnumbering "</span> + startCount );
		}

		<span class="hljs-keyword">this</span>._beforeListviewRefresh();

		li = <span class="hljs-keyword">this</span>._getChildrenByTagName( $list[ <span class="hljs-number">0</span> ], <span class="hljs-string">"li"</span>, <span class="hljs-string">"LI"</span> );

		<span class="hljs-keyword">for</span> ( pos = <span class="hljs-number">0</span>, numli = li.length; pos &lt; numli; pos++ ) {
			item = li.eq( pos );
			itemClass = <span class="hljs-string">""</span>;

			<span class="hljs-keyword">if</span> ( create || item[ <span class="hljs-number">0</span> ].className.search( <span class="hljs-regexp">/\bui-li-static\b|\bui-li-divider\b/</span> ) &lt; <span class="hljs-number">0</span> ) {
				a = <span class="hljs-keyword">this</span>._getChildrenByTagName( item[ <span class="hljs-number">0</span> ], <span class="hljs-string">"a"</span>, <span class="hljs-string">"A"</span> );
				isDivider = ( getAttr( item[ <span class="hljs-number">0</span> ], <span class="hljs-string">"role"</span> ) === <span class="hljs-string">"list-divider"</span> );
				value = item.attr( <span class="hljs-string">"value"</span> );
				itemTheme = getAttr( item[ <span class="hljs-number">0</span> ], <span class="hljs-string">"theme"</span> );

				<span class="hljs-keyword">if</span> ( a.length &amp;&amp; a[ <span class="hljs-number">0</span> ].className.search( <span class="hljs-regexp">/\bui-btn\b/</span> ) &lt; <span class="hljs-number">0</span> &amp;&amp; !isDivider ) {
					itemIcon = getAttr( item[ <span class="hljs-number">0</span> ], <span class="hljs-string">"icon"</span> );
					icon = ( itemIcon === <span class="hljs-literal">false</span> ) ? <span class="hljs-literal">false</span> : ( itemIcon || o.icon );</pre></div></div>
            
        </li>
        
        
        <li id="section-679">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-679">&#182;</a>
              </div>
              <p>TODO: Remove in 1.5 together with links.js (links.js / .ui-link deprecated in 1.4)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					a.removeClass( <span class="hljs-string">"ui-link"</span> );

					buttonClass = <span class="hljs-string">"ui-btn"</span>;

					<span class="hljs-keyword">if</span> ( itemTheme ) {
						buttonClass += <span class="hljs-string">" ui-btn-"</span> + itemTheme;
					}

					<span class="hljs-keyword">if</span> ( a.length &gt; <span class="hljs-number">1</span> ) {
						itemClass = <span class="hljs-string">"ui-li-has-alt"</span>;

						last = a.last();
						splittheme = getAttr( last[ <span class="hljs-number">0</span> ], <span class="hljs-string">"theme"</span> ) || o.splitTheme || getAttr( item[ <span class="hljs-number">0</span> ], <span class="hljs-string">"theme"</span>, <span class="hljs-literal">true</span> );
						splitThemeClass = splittheme ? <span class="hljs-string">" ui-btn-"</span> + splittheme : <span class="hljs-string">""</span>;
						spliticon = getAttr( last[ <span class="hljs-number">0</span> ], <span class="hljs-string">"icon"</span> ) || getAttr( item[ <span class="hljs-number">0</span> ], <span class="hljs-string">"icon"</span> ) || o.splitIcon;
						altButtonClass = <span class="hljs-string">"ui-btn ui-btn-icon-notext ui-icon-"</span> + spliticon + splitThemeClass;

						last
							.attr( <span class="hljs-string">"title"</span>, $.trim( last.getEncodedText() ) )
							.addClass( altButtonClass )
							.empty();
					} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( icon ) {
						buttonClass += <span class="hljs-string">" ui-btn-icon-right ui-icon-"</span> + icon;
					}

					a.first().addClass( buttonClass );
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( isDivider ) {
					dividerTheme = ( getAttr( item[ <span class="hljs-number">0</span> ], <span class="hljs-string">"theme"</span> ) || o.dividerTheme || o.theme );

					itemClass = <span class="hljs-string">"ui-li-divider ui-bar-"</span> + ( dividerTheme ? dividerTheme : <span class="hljs-string">"inherit"</span> );

					item.attr( <span class="hljs-string">"role"</span>, <span class="hljs-string">"heading"</span> );
				} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( a.length &lt;= <span class="hljs-number">0</span> ) {
					itemClass = <span class="hljs-string">"ui-li-static ui-body-"</span> + ( itemTheme ? itemTheme : <span class="hljs-string">"inherit"</span> );
				}
				<span class="hljs-keyword">if</span> ( ol &amp;&amp; value ) {
					newStartCount = <span class="hljs-built_in">parseInt</span>( value , <span class="hljs-number">10</span> ) - <span class="hljs-number">1</span>;

					item.css( <span class="hljs-string">"counter-reset"</span>, <span class="hljs-string">"listnumbering "</span> + newStartCount );
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-680">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-680">&#182;</a>
              </div>
              <p>Instead of setting item class directly on the list item
at this point in time, push the item into a dictionary
that tells us what class to set on it so we can do this after this
processing loop is finished.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
			<span class="hljs-keyword">if</span> ( !itemClassDict[ itemClass ] ) {
				itemClassDict[ itemClass ] = [];
			}

			itemClassDict[ itemClass ].push( item[ <span class="hljs-number">0</span> ] );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-681">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-681">&#182;</a>
              </div>
              <p>Set the appropriate listview item classes on each list item.
The main reason we didn’t do this
in the for-loop above is because we can eliminate per-item function overhead
by calling addClass() and children() once or twice afterwards. This
can give us a significant boost on platforms like WP7.5.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		<span class="hljs-keyword">for</span> ( itemClass <span class="hljs-keyword">in</span> itemClassDict ) {
			$( itemClassDict[ itemClass ] ).addClass( itemClass );
		}

		countBubbles.each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$( <span class="hljs-keyword">this</span> ).closest( <span class="hljs-string">"li"</span> ).addClass( <span class="hljs-string">"ui-li-has-count"</span> );
		});
		<span class="hljs-keyword">if</span> ( countThemeClass ) {
			countBubbles.addClass( countThemeClass );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-682">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-682">&#182;</a>
              </div>
              <p>Deprecated in 1.4. From 1.5 you have to add class ui-li-has-thumb or ui-li-has-icon to the LI.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._addThumbClasses( li );
		<span class="hljs-keyword">this</span>._addThumbClasses( li.find( <span class="hljs-string">".ui-btn"</span> ) );

		<span class="hljs-keyword">this</span>._afterListviewRefresh();

		<span class="hljs-keyword">this</span>._addFirstLastClasses( li, <span class="hljs-keyword">this</span>._getVisibles( li, create ), create );
	}
}, $.mobile.behaviors.addFirstLastClasses ) );

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultAutodividersSelector</span><span class="hljs-params">( elt )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-683">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-683">&#182;</a>
              </div>
              <p>look for the text in the given element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> text = $.trim( elt.text() ) || <span class="hljs-literal">null</span>;

	<span class="hljs-keyword">if</span> ( !text ) {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-684">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-684">&#182;</a>
              </div>
              <p>create the text for the divider (first uppercased letter)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	text = text.slice( <span class="hljs-number">0</span>, <span class="hljs-number">1</span> ).toUpperCase();

	<span class="hljs-keyword">return</span> text;
}

$.widget( <span class="hljs-string">"mobile.listview"</span>, $.mobile.listview, {
	options: {
		autodividers: <span class="hljs-literal">false</span>,
		autodividersSelector: defaultAutodividersSelector
	},

	_beforeListviewRefresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.autodividers ) {
			<span class="hljs-keyword">this</span>._replaceDividers();
			<span class="hljs-keyword">this</span>._superApply( <span class="hljs-built_in">arguments</span> );
		}
	},

	_replaceDividers: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> i, lis, li, dividerText,
			lastDividerText = <span class="hljs-literal">null</span>,
			list = <span class="hljs-keyword">this</span>.element,
			divider;

		list.children( <span class="hljs-string">"li:jqmData(role='list-divider')"</span> ).remove();

		lis = list.children( <span class="hljs-string">"li"</span> );

		<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; lis.length ; i++ ) {
			li = lis[ i ];
			dividerText = <span class="hljs-keyword">this</span>.options.autodividersSelector( $( li ) );

			<span class="hljs-keyword">if</span> ( dividerText &amp;&amp; lastDividerText !== dividerText ) {
				divider = document.createElement( <span class="hljs-string">"li"</span> );
				divider.appendChild( document.createTextNode( dividerText ) );
				divider.setAttribute( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"role"</span>, <span class="hljs-string">"list-divider"</span> );
				li.parentNode.insertBefore( divider, li );
			}

			lastDividerText = dividerText;
		}
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> rdivider = <span class="hljs-regexp">/(^|\s)ui-li-divider($|\s)/</span>,
	rhidden = <span class="hljs-regexp">/(^|\s)ui-screen-hidden($|\s)/</span>;

$.widget( <span class="hljs-string">"mobile.listview"</span>, $.mobile.listview, {
	options: {
		hideDividers: <span class="hljs-literal">false</span>
	},

	_afterListviewRefresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> items, idx, item, hideDivider = <span class="hljs-literal">true</span>;

		<span class="hljs-keyword">this</span>._superApply( <span class="hljs-built_in">arguments</span> );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.hideDividers ) {
			items = <span class="hljs-keyword">this</span>._getChildrenByTagName( <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ], <span class="hljs-string">"li"</span>, <span class="hljs-string">"LI"</span> );
			<span class="hljs-keyword">for</span> ( idx = items.length - <span class="hljs-number">1</span> ; idx &gt; -<span class="hljs-number">1</span> ; idx-- ) {
				item = items[ idx ];
				<span class="hljs-keyword">if</span> ( item.className.match( rdivider ) ) {
					<span class="hljs-keyword">if</span> ( hideDivider ) {
						item.className = item.className + <span class="hljs-string">" ui-screen-hidden"</span>;
					}
					hideDivider = <span class="hljs-literal">true</span>;
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">if</span> ( !item.className.match( rhidden ) ) {
						hideDivider = <span class="hljs-literal">false</span>;
					}
				}
			}
		}
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.mobile.nojs = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( target )</span> {</span>
	$( <span class="hljs-string">":jqmData(role='nojs')"</span>, target ).addClass( <span class="hljs-string">"ui-nojs"</span> );
};

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.mobile.behaviors.formReset = {
	_handleFormReset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.element.closest( <span class="hljs-string">"form"</span> ), {
			reset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>._delay( <span class="hljs-string">"_reset"</span> );
			}
		});
	}
};

})( jQuery );

<span class="hljs-comment">/*
* "checkboxradio" plugin
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> escapeId = $.mobile.path.hashToSelector;

$.widget( <span class="hljs-string">"mobile.checkboxradio"</span>, $.extend( {

	initSelector: <span class="hljs-string">"input:not( :jqmData(role='flipswitch' ) )[type='checkbox'],input[type='radio']:not( :jqmData(role='flipswitch' ))"</span>,

	options: {
		theme: <span class="hljs-string">"inherit"</span>,
		mini: <span class="hljs-literal">false</span>,
		wrapperClass: <span class="hljs-literal">null</span>,
		enhanced: <span class="hljs-literal">false</span>,
		iconpos: <span class="hljs-string">"left"</span>

	},
	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>.element,
			o = <span class="hljs-keyword">this</span>.options,
			inheritAttr = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( input, dataAttr )</span> {</span>
				<span class="hljs-keyword">return</span> input.jqmData( dataAttr ) ||
					input.closest( <span class="hljs-string">"form, fieldset"</span> ).jqmData( dataAttr );
			},</pre></div></div>
            
        </li>
        
        
        <li id="section-685">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-685">&#182;</a>
              </div>
              <p>NOTE: Windows Phone could not find the label through a selector
filter works though.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			parentLabel = input.closest( <span class="hljs-string">"label"</span> ),
			label = parentLabel.length ? parentLabel :
				input
					.closest( <span class="hljs-string">"form, fieldset, :jqmData(role='page'), :jqmData(role='dialog')"</span> )
					.find( <span class="hljs-string">"label"</span> )
					.filter( <span class="hljs-string">"[for='"</span> + escapeId( input[<span class="hljs-number">0</span>].id ) + <span class="hljs-string">"']"</span> )
					.first(),
			inputtype = input[<span class="hljs-number">0</span>].type,
			checkedClass = <span class="hljs-string">"ui-"</span> + inputtype + <span class="hljs-string">"-on"</span>,
			uncheckedClass = <span class="hljs-string">"ui-"</span> + inputtype + <span class="hljs-string">"-off"</span>;

		<span class="hljs-keyword">if</span> ( inputtype !== <span class="hljs-string">"checkbox"</span> &amp;&amp; inputtype !== <span class="hljs-string">"radio"</span> ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].disabled ) {
			<span class="hljs-keyword">this</span>.options.disabled = <span class="hljs-literal">true</span>;
		}

		o.iconpos = inheritAttr( input, <span class="hljs-string">"iconpos"</span> ) || label.attr( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"iconpos"</span> ) || o.iconpos,</pre></div></div>
            
        </li>
        
        
        <li id="section-686">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-686">&#182;</a>
              </div>
              <p>Establish options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		o.mini = inheritAttr( input, <span class="hljs-string">"mini"</span> ) || o.mini;</pre></div></div>
            
        </li>
        
        
        <li id="section-687">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-687">&#182;</a>
              </div>
              <p>Expose for other methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.extend( <span class="hljs-keyword">this</span>, {
			input: input,
			label: label,
			parentLabel: parentLabel,
			inputtype: inputtype,
			checkedClass: checkedClass,
			uncheckedClass: uncheckedClass
		});

		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.options.enhanced ) {
			<span class="hljs-keyword">this</span>._enhance();
		}

		<span class="hljs-keyword">this</span>._on( label, {
			vmouseover: <span class="hljs-string">"_handleLabelVMouseOver"</span>,
			vclick: <span class="hljs-string">"_handleLabelVClick"</span>
		});

		<span class="hljs-keyword">this</span>._on( input, {
			vmousedown: <span class="hljs-string">"_cacheVals"</span>,
			vclick: <span class="hljs-string">"_handleInputVClick"</span>,
			focus: <span class="hljs-string">"_handleInputFocus"</span>,
			blur: <span class="hljs-string">"_handleInputBlur"</span>
		});

		<span class="hljs-keyword">this</span>._handleFormReset();
		<span class="hljs-keyword">this</span>.refresh();
	},

	_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.label.addClass( <span class="hljs-string">"ui-btn ui-corner-all"</span>);

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.parentLabel.length &gt; <span class="hljs-number">0</span> ) {
			<span class="hljs-keyword">this</span>.input.add( <span class="hljs-keyword">this</span>.label ).wrapAll( <span class="hljs-keyword">this</span>._wrapper() );
		} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-688">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-688">&#182;</a>
              </div>
              <p>this.element.replaceWith( this.input.add( this.label ).wrapAll( this._wrapper() ) );</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element.wrap( <span class="hljs-keyword">this</span>._wrapper() );
			<span class="hljs-keyword">this</span>.element.parent().prepend( <span class="hljs-keyword">this</span>.label );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-689">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-689">&#182;</a>
              </div>
              <p>Wrap the input + label in a div</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		<span class="hljs-keyword">this</span>._setOptions({
			<span class="hljs-string">"theme"</span>: <span class="hljs-keyword">this</span>.options.theme,
			<span class="hljs-string">"iconpos"</span>: <span class="hljs-keyword">this</span>.options.iconpos,
			<span class="hljs-string">"mini"</span>: <span class="hljs-keyword">this</span>.options.mini
		});

	},

	_wrapper: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> $( <span class="hljs-string">"&lt;div class='"</span>  +
			( <span class="hljs-keyword">this</span>.options.wrapperClass ? <span class="hljs-keyword">this</span>.options.wrapperClass : <span class="hljs-string">""</span> ) +
			<span class="hljs-string">" ui-"</span> + <span class="hljs-keyword">this</span>.inputtype +
			( <span class="hljs-keyword">this</span>.options.disabled ? <span class="hljs-string">" ui-state-disabled"</span> : <span class="hljs-string">""</span> ) + <span class="hljs-string">"' &gt;&lt;/div&gt;"</span> );
	},

	_handleInputFocus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.label.addClass( $.mobile.focusClass );
	},

	_handleInputBlur: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.label.removeClass( $.mobile.focusClass );
	},

	_handleInputVClick: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-690">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-690">&#182;</a>
              </div>
              <p>Adds checked attribute to checked input when keyboard is used</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"checked"</span>, <span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">":checked"</span> ) );
		<span class="hljs-keyword">this</span>._getInputSet().not( <span class="hljs-keyword">this</span>.element ).prop( <span class="hljs-string">"checked"</span>, <span class="hljs-literal">false</span> );
		<span class="hljs-keyword">this</span>._updateAll();
	},

	_handleLabelVMouseOver: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.label.parent().hasClass( <span class="hljs-string">"ui-state-disabled"</span> ) ) {
			event.stopPropagation();
		}
	},

	_handleLabelVClick: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>.element;

		<span class="hljs-keyword">if</span> ( input.is( <span class="hljs-string">":disabled"</span> ) ) {
			event.preventDefault();
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>._cacheVals();

		input.prop( <span class="hljs-string">"checked"</span>, <span class="hljs-keyword">this</span>.inputtype === <span class="hljs-string">"radio"</span> &amp;&amp; <span class="hljs-literal">true</span> || !input.prop( <span class="hljs-string">"checked"</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-691">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-691">&#182;</a>
              </div>
              <p>trigger click handler’s bound directly to the input as a substitute for
how label clicks behave normally in the browsers
TODO: it would be nice to let the browser’s handle the clicks and pass them
      through to the associate input. we can swallow that click at the parent
      wrapper element level</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		input.triggerHandler( <span class="hljs-string">"click"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-692">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-692">&#182;</a>
              </div>
              <p>Input set for common radio buttons will contain all the radio
buttons, but will not for checkboxes. clearing the checked status
of other radios ensures the active button state is applied properly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._getInputSet().not( input ).prop( <span class="hljs-string">"checked"</span>, <span class="hljs-literal">false</span> );

		<span class="hljs-keyword">this</span>._updateAll();
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	},

	_cacheVals: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._getInputSet().each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$( <span class="hljs-keyword">this</span> ).attr(<span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"cacheVal"</span>, <span class="hljs-keyword">this</span>.checked );
		});
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-693">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-693">&#182;</a>
              </div>
              <p>Returns those radio buttons that are supposed to be in the same group as
this radio button. In the case of a checkbox or a radio lacking a name
attribute, it returns this.element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_getInputSet: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> selector, formId,
			radio = <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ],
			name = radio.name,
			form = radio.form,
			doc = <span class="hljs-keyword">this</span>.element.parents().last().get( <span class="hljs-number">0</span> ),</pre></div></div>
            
        </li>
        
        
        <li id="section-694">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-694">&#182;</a>
              </div>
              <p>A radio is always a member of its own group</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			radios = <span class="hljs-keyword">this</span>.element;</pre></div></div>
            
        </li>
        
        
        <li id="section-695">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-695">&#182;</a>
              </div>
              <p>Only start running selectors if this is an attached radio button with a name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( name &amp;&amp; <span class="hljs-keyword">this</span>.inputtype === <span class="hljs-string">"radio"</span> &amp;&amp; doc ) {
			selector = <span class="hljs-string">"input[type='radio'][name='"</span> + escapeId( name ) + <span class="hljs-string">"']"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-696">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-696">&#182;</a>
              </div>
              <p>If we’re inside a form</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( form ) {
				formId = form.id;</pre></div></div>
            
        </li>
        
        
        <li id="section-697">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-697">&#182;</a>
              </div>
              <p>If the form has an ID, collect radios scattered throught the document which
nevertheless are part of the form by way of the value of their form attribute</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( formId ) {
					radios = $( selector + <span class="hljs-string">"[form='"</span> + escapeId( formId ) + <span class="hljs-string">"']"</span>, doc );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-698">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-698">&#182;</a>
              </div>
              <p>Also add to those the radios in the form itself</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				radios = $( form ).find( selector ).filter( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-699">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-699">&#182;</a>
              </div>
              <p>Some radios inside the form may belong to some other form by virtue of
having a form attribute defined on them, so we must filter them out here</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">return</span> ( <span class="hljs-keyword">this</span>.form === form );
				}).add( radios );</pre></div></div>
            
        </li>
        
        
        <li id="section-700">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-700">&#182;</a>
              </div>
              <p>If we’re outside a form</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-701">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-701">&#182;</a>
              </div>
              <p>Collect all those radios which are also outside of a form and match our name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				radios = $( selector, doc ).filter( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">return</span> !<span class="hljs-keyword">this</span>.form;
				});
			}
		}
		<span class="hljs-keyword">return</span> radios;
	},

	_updateAll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">this</span>._getInputSet().each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> $<span class="hljs-keyword">this</span> = $( <span class="hljs-keyword">this</span> );

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.checked || self.inputtype === <span class="hljs-string">"checkbox"</span> ) {
				$<span class="hljs-keyword">this</span>.trigger( <span class="hljs-string">"change"</span> );
			}
		})
		.checkboxradio( <span class="hljs-string">"refresh"</span> );
	},

	_reset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.refresh();
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-702">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-702">&#182;</a>
              </div>
              <p>Is the widget supposed to display an icon?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_hasIcon: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> controlgroup, controlgroupWidget,
			controlgroupConstructor = $.mobile.controlgroup;</pre></div></div>
            
        </li>
        
        
        <li id="section-703">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-703">&#182;</a>
              </div>
              <p>If the controlgroup widget is defined …</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( controlgroupConstructor ) {
			controlgroup = <span class="hljs-keyword">this</span>.element.closest(
				<span class="hljs-string">":mobile-controlgroup,"</span> +
				controlgroupConstructor.prototype.initSelector );</pre></div></div>
            
        </li>
        
        
        <li id="section-704">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-704">&#182;</a>
              </div>
              <p>… and the checkbox is in a controlgroup …</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( controlgroup.length &gt; <span class="hljs-number">0</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-705">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-705">&#182;</a>
              </div>
              <p>… look for a controlgroup widget instance, and …</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				controlgroupWidget = $.data( controlgroup[ <span class="hljs-number">0</span> ], <span class="hljs-string">"mobile-controlgroup"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-706">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-706">&#182;</a>
              </div>
              <p>… if found, decide based on the option value, …</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> ( ( controlgroupWidget ? controlgroupWidget.options.type :</pre></div></div>
            
        </li>
        
        
        <li id="section-707">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-707">&#182;</a>
              </div>
              <p>… otherwise decide based on the “type” data attribute.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					controlgroup.attr( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"type"</span> ) ) !== <span class="hljs-string">"horizontal"</span> );
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-708">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-708">&#182;</a>
              </div>
              <p>Normally, the widget displays an icon.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> hasIcon = <span class="hljs-keyword">this</span>._hasIcon(),
			isChecked = <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ].checked,
			active = $.mobile.activeBtnClass,
			iconposClass = <span class="hljs-string">"ui-btn-icon-"</span> + <span class="hljs-keyword">this</span>.options.iconpos,
			addClasses = [],
			removeClasses = [];

		<span class="hljs-keyword">if</span> ( hasIcon ) {
			removeClasses.push( active );
			addClasses.push( iconposClass );
		} <span class="hljs-keyword">else</span> {
			removeClasses.push( iconposClass );
			( isChecked ? addClasses : removeClasses ).push( active );
		}

		<span class="hljs-keyword">if</span> ( isChecked ) {
			addClasses.push( <span class="hljs-keyword">this</span>.checkedClass );
			removeClasses.push( <span class="hljs-keyword">this</span>.uncheckedClass );
		} <span class="hljs-keyword">else</span> {
			addClasses.push( <span class="hljs-keyword">this</span>.uncheckedClass );
			removeClasses.push( <span class="hljs-keyword">this</span>.checkedClass );
		}

		<span class="hljs-keyword">this</span>.label
			.addClass( addClasses.join( <span class="hljs-string">" "</span> ) )
			.removeClass( removeClasses.join( <span class="hljs-string">" "</span> ) );
	},

	widget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.label.parent();
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> label = <span class="hljs-keyword">this</span>.label,
			currentOptions = <span class="hljs-keyword">this</span>.options,
			outer = <span class="hljs-keyword">this</span>.widget(),
			hasIcon = <span class="hljs-keyword">this</span>._hasIcon();

		<span class="hljs-keyword">if</span> ( options.disabled !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.input.prop( <span class="hljs-string">"disabled"</span>, !!options.disabled );
			outer.toggleClass( <span class="hljs-string">"ui-state-disabled"</span>, !!options.disabled );
		}
		<span class="hljs-keyword">if</span> ( options.mini !== <span class="hljs-literal">undefined</span> ) {
			outer.toggleClass( <span class="hljs-string">"ui-mini"</span>, !!options.mini );
		}
		<span class="hljs-keyword">if</span> ( options.theme !== <span class="hljs-literal">undefined</span> ) {
			label
				.removeClass( <span class="hljs-string">"ui-btn-"</span> + currentOptions.theme )
				.addClass( <span class="hljs-string">"ui-btn-"</span> + options.theme );
		}
		<span class="hljs-keyword">if</span> ( options.wrapperClass !== <span class="hljs-literal">undefined</span> ) {
			outer
				.removeClass( currentOptions.wrapperClass )
				.addClass( options.wrapperClass );
		}
		<span class="hljs-keyword">if</span> ( options.iconpos !== <span class="hljs-literal">undefined</span> &amp;&amp; hasIcon ) {
			label.removeClass( <span class="hljs-string">"ui-btn-icon-"</span> + currentOptions.iconpos ).addClass( <span class="hljs-string">"ui-btn-icon-"</span> + options.iconpos );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( !hasIcon ) {
			label.removeClass( <span class="hljs-string">"ui-btn-icon-"</span> + currentOptions.iconpos );
		}
		<span class="hljs-keyword">this</span>._super( options );
	}

}, $.mobile.behaviors.formReset ) );

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.button"</span>, {

	initSelector: <span class="hljs-string">"input[type='button'], input[type='submit'], input[type='reset']"</span>,

	options: {
		theme: <span class="hljs-literal">null</span>,
		icon: <span class="hljs-literal">null</span>,
		iconpos: <span class="hljs-string">"left"</span>,
		iconshadow: <span class="hljs-literal">false</span>, <span class="hljs-comment">/* TODO: Deprecated in 1.4, remove in 1.5. */</span>
		corners: <span class="hljs-literal">true</span>,
		shadow: <span class="hljs-literal">true</span>,
		inline: <span class="hljs-literal">null</span>,
		mini: <span class="hljs-literal">null</span>,
		wrapperClass: <span class="hljs-literal">null</span>,
		enhanced: <span class="hljs-literal">false</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">":disabled"</span> ) ) {
			<span class="hljs-keyword">this</span>.options.disabled = <span class="hljs-literal">true</span>;
		}

		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.options.enhanced ) {
			<span class="hljs-keyword">this</span>._enhance();
		}

		$.extend( <span class="hljs-keyword">this</span>, {
			wrapper: <span class="hljs-keyword">this</span>.element.parent()
		});

		<span class="hljs-keyword">this</span>._on( {
			focus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>.widget().addClass( $.mobile.focusClass );
			},

			blur: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>.widget().removeClass( $.mobile.focusClass );
			}
		});

		<span class="hljs-keyword">this</span>.refresh( <span class="hljs-literal">true</span> );
	},

	_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.element.wrap( <span class="hljs-keyword">this</span>._button() );
	},

	_button: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
			iconClasses = <span class="hljs-keyword">this</span>._getIconClasses( <span class="hljs-keyword">this</span>.options );

		<span class="hljs-keyword">return</span> $(<span class="hljs-string">"&lt;div class='ui-btn ui-input-btn"</span> +
			( options.wrapperClass ? <span class="hljs-string">" "</span> + options.wrapperClass : <span class="hljs-string">""</span> ) +
			( options.theme ? <span class="hljs-string">" ui-btn-"</span> + options.theme : <span class="hljs-string">""</span> ) +
			( options.corners ? <span class="hljs-string">" ui-corner-all"</span> : <span class="hljs-string">""</span> ) +
			( options.shadow ? <span class="hljs-string">" ui-shadow"</span> : <span class="hljs-string">""</span> ) +
			( options.inline ? <span class="hljs-string">" ui-btn-inline"</span> : <span class="hljs-string">""</span> ) +
			( options.mini ? <span class="hljs-string">" ui-mini"</span> : <span class="hljs-string">""</span> ) +
			( options.disabled ? <span class="hljs-string">" ui-state-disabled"</span> : <span class="hljs-string">""</span> ) +
			( iconClasses ? ( <span class="hljs-string">" "</span> + iconClasses ) : <span class="hljs-string">""</span> ) +
			<span class="hljs-string">"' &gt;"</span> + <span class="hljs-keyword">this</span>.element.val() + <span class="hljs-string">"&lt;/div&gt;"</span> );
	},

	widget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.wrapper;
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element.insertBefore( <span class="hljs-keyword">this</span>.button );
			<span class="hljs-keyword">this</span>.button.remove();
	},

	_getIconClasses: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">return</span> ( options.icon ? ( <span class="hljs-string">"ui-icon-"</span> + options.icon +
			( options.iconshadow ? <span class="hljs-string">" ui-shadow-icon"</span> : <span class="hljs-string">""</span> ) + <span class="hljs-comment">/* TODO: Deprecated in 1.4, remove in 1.5. */</span>
			<span class="hljs-string">" ui-btn-icon-"</span> + options.iconpos ) : <span class="hljs-string">""</span> );
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> outer = <span class="hljs-keyword">this</span>.widget();

		<span class="hljs-keyword">if</span> ( options.theme !== <span class="hljs-literal">undefined</span> ) {
			outer
				.removeClass( <span class="hljs-keyword">this</span>.options.theme )
				.addClass( <span class="hljs-string">"ui-btn-"</span> + options.theme );
		}
		<span class="hljs-keyword">if</span> ( options.corners !== <span class="hljs-literal">undefined</span> ) {
			outer.toggleClass( <span class="hljs-string">"ui-corner-all"</span>, options.corners );
		}
		<span class="hljs-keyword">if</span> ( options.shadow !== <span class="hljs-literal">undefined</span> ) {
			outer.toggleClass( <span class="hljs-string">"ui-shadow"</span>, options.shadow );
		}
		<span class="hljs-keyword">if</span> ( options.inline !== <span class="hljs-literal">undefined</span> ) {
			outer.toggleClass( <span class="hljs-string">"ui-btn-inline"</span>, options.inline );
		}
		<span class="hljs-keyword">if</span> ( options.mini !== <span class="hljs-literal">undefined</span> ) {
			outer.toggleClass( <span class="hljs-string">"ui-mini"</span>, options.mini );
		}
		<span class="hljs-keyword">if</span> ( options.disabled !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"disabled"</span>, options.disabled );
			outer.toggleClass( <span class="hljs-string">"ui-state-disabled"</span>, options.disabled );
		}

		<span class="hljs-keyword">if</span> ( options.icon !== <span class="hljs-literal">undefined</span> ||
				options.iconshadow !== <span class="hljs-literal">undefined</span> || <span class="hljs-comment">/* TODO: Deprecated in 1.4, remove in 1.5. */</span>
				options.iconpos !== <span class="hljs-literal">undefined</span> ) {
			outer
				.removeClass( <span class="hljs-keyword">this</span>._getIconClasses( <span class="hljs-keyword">this</span>.options ) )
				.addClass( <span class="hljs-keyword">this</span>._getIconClasses(
					$.extend( {}, <span class="hljs-keyword">this</span>.options, options ) ) );
		}

		<span class="hljs-keyword">this</span>._super( options );
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( create )</span> {</span>
		<span class="hljs-keyword">var</span> originalElement,
			isDisabled = <span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"disabled"</span> );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.icon &amp;&amp; <span class="hljs-keyword">this</span>.options.iconpos === <span class="hljs-string">"notext"</span> &amp;&amp; <span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"title"</span> ) ) {
			<span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"title"</span>, <span class="hljs-keyword">this</span>.element.val() );
		}
		<span class="hljs-keyword">if</span> ( !create ) {
			originalElement = <span class="hljs-keyword">this</span>.element.detach();
			$( <span class="hljs-keyword">this</span>.wrapper ).text( <span class="hljs-keyword">this</span>.element.val() ).append( originalElement );
		}
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.disabled !== isDisabled ) {
			<span class="hljs-keyword">this</span>._setOptions({ disabled: isDisabled });
		}
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $ )</span> {</span>
	<span class="hljs-keyword">var</span>	meta = $( <span class="hljs-string">"meta[name=viewport]"</span> ),
		initialContent = meta.attr( <span class="hljs-string">"content"</span> ),
		disabledZoom = initialContent + <span class="hljs-string">",maximum-scale=1, user-scalable=no"</span>,
		enabledZoom = initialContent + <span class="hljs-string">",maximum-scale=10, user-scalable=yes"</span>,
		disabledInitially = <span class="hljs-regexp">/(user-scalable[\s]*=[\s]*no)|(maximum-scale[\s]*=[\s]*1)[$,\s]/</span>.test( initialContent );

	$.mobile.zoom = $.extend( {}, {
		enabled: !disabledInitially,
		locked: <span class="hljs-literal">false</span>,
		disable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( lock )</span> {</span>
			<span class="hljs-keyword">if</span> ( !disabledInitially &amp;&amp; !$.mobile.zoom.locked ) {
				meta.attr( <span class="hljs-string">"content"</span>, disabledZoom );
				$.mobile.zoom.enabled = <span class="hljs-literal">false</span>;
				$.mobile.zoom.locked = lock || <span class="hljs-literal">false</span>;
			}
		},
		enable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( unlock )</span> {</span>
			<span class="hljs-keyword">if</span> ( !disabledInitially &amp;&amp; ( !$.mobile.zoom.locked || unlock === <span class="hljs-literal">true</span> ) ) {
				meta.attr( <span class="hljs-string">"content"</span>, enabledZoom );
				$.mobile.zoom.enabled = <span class="hljs-literal">true</span>;
				$.mobile.zoom.locked = <span class="hljs-literal">false</span>;
			}
		},
		restore: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( !disabledInitially ) {
				meta.attr( <span class="hljs-string">"content"</span>, initialContent );
				$.mobile.zoom.enabled = <span class="hljs-literal">true</span>;
			}
		}
	});

}( jQuery ));

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.textinput"</span>, {
	initSelector: <span class="hljs-string">"input[type='text'],"</span> +
		<span class="hljs-string">"input[type='search'],"</span> +
		<span class="hljs-string">":jqmData(type='search'),"</span> +
		<span class="hljs-string">"input[type='number'],"</span> +
		<span class="hljs-string">":jqmData(type='number'),"</span> +
		<span class="hljs-string">"input[type='password'],"</span> +
		<span class="hljs-string">"input[type='email'],"</span> +
		<span class="hljs-string">"input[type='url'],"</span> +
		<span class="hljs-string">"input[type='tel'],"</span> +
		<span class="hljs-string">"textarea,"</span> +
		<span class="hljs-string">"input[type='time'],"</span> +
		<span class="hljs-string">"input[type='date'],"</span> +
		<span class="hljs-string">"input[type='month'],"</span> +
		<span class="hljs-string">"input[type='week'],"</span> +
		<span class="hljs-string">"input[type='datetime'],"</span> +
		<span class="hljs-string">"input[type='datetime-local'],"</span> +
		<span class="hljs-string">"input[type='color'],"</span> +
		<span class="hljs-string">"input:not([type]),"</span> +
		<span class="hljs-string">"input[type='file']"</span>,

	options: {
		theme: <span class="hljs-literal">null</span>,
		corners: <span class="hljs-literal">true</span>,
		mini: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-709">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-709">&#182;</a>
              </div>
              <p>This option defaults to true on iOS devices.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		preventFocusZoom: <span class="hljs-regexp">/iPhone|iPad|iPod/</span>.test( navigator.platform ) &amp;&amp; navigator.userAgent.indexOf( <span class="hljs-string">"AppleWebKit"</span> ) &gt; -<span class="hljs-number">1</span>,
		wrapperClass: <span class="hljs-string">""</span>,
		enhanced: <span class="hljs-literal">false</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
			isSearch = <span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">"[type='search'], :jqmData(type='search')"</span> ),
			isTextarea = <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ].tagName === <span class="hljs-string">"TEXTAREA"</span>,
			isRange = <span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">"[data-"</span> + ( $.mobile.ns || <span class="hljs-string">""</span> ) + <span class="hljs-string">"type='range']"</span> ),
			inputNeedsWrap = ( (<span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">"input"</span> ) ||
				<span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">"[data-"</span> + ( $.mobile.ns || <span class="hljs-string">""</span> ) + <span class="hljs-string">"type='search']"</span> ) ) &amp;&amp;
					!isRange );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"disabled"</span> ) ) {
			options.disabled = <span class="hljs-literal">true</span>;
		}

		$.extend( <span class="hljs-keyword">this</span>, {
			classes: <span class="hljs-keyword">this</span>._classesFromOptions(),
			isSearch: isSearch,
			isTextarea: isTextarea,
			isRange: isRange,
			inputNeedsWrap: inputNeedsWrap
		});

		<span class="hljs-keyword">this</span>._autoCorrect();

		<span class="hljs-keyword">if</span> ( !options.enhanced ) {
			<span class="hljs-keyword">this</span>._enhance();
		}

		<span class="hljs-keyword">this</span>._on( {
			<span class="hljs-string">"focus"</span>: <span class="hljs-string">"_handleFocus"</span>,
			<span class="hljs-string">"blur"</span>: <span class="hljs-string">"_handleBlur"</span>
		});

	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.setOptions({
			<span class="hljs-string">"disabled"</span> : <span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">":disabled"</span> )
		});
	},

	_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> elementClasses = [];

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isTextarea ) {
			elementClasses.push( <span class="hljs-string">"ui-input-text"</span> );
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isTextarea || <span class="hljs-keyword">this</span>.isRange ) {
			elementClasses.push( <span class="hljs-string">"ui-shadow-inset"</span> );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-710">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-710">&#182;</a>
              </div>
              <p>“search” and “text” input widgets</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.inputNeedsWrap ) {
			<span class="hljs-keyword">this</span>.element.wrap( <span class="hljs-keyword">this</span>._wrap() );
		} <span class="hljs-keyword">else</span> {
			elementClasses = elementClasses.concat( <span class="hljs-keyword">this</span>.classes );
		}

		<span class="hljs-keyword">this</span>.element.addClass( elementClasses.join( <span class="hljs-string">" "</span> ) );
	},

	widget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> ( <span class="hljs-keyword">this</span>.inputNeedsWrap ) ? <span class="hljs-keyword">this</span>.element.parent() : <span class="hljs-keyword">this</span>.element;
	},

	_classesFromOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
			classes = [];

		classes.push( <span class="hljs-string">"ui-body-"</span> + ( ( options.theme === <span class="hljs-literal">null</span> ) ? <span class="hljs-string">"inherit"</span> : options.theme ) );
		<span class="hljs-keyword">if</span> ( options.corners ) {
			classes.push( <span class="hljs-string">"ui-corner-all"</span> );
		}
		<span class="hljs-keyword">if</span> ( options.mini ) {
			classes.push( <span class="hljs-string">"ui-mini"</span> );
		}
		<span class="hljs-keyword">if</span> ( options.disabled ) {
			classes.push( <span class="hljs-string">"ui-state-disabled"</span> );
		}
		<span class="hljs-keyword">if</span> ( options.wrapperClass ) {
			classes.push( options.wrapperClass );
		}

		<span class="hljs-keyword">return</span> classes;
	},

	_wrap: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> $( <span class="hljs-string">"&lt;div class='"</span> +
			( <span class="hljs-keyword">this</span>.isSearch ? <span class="hljs-string">"ui-input-search "</span> : <span class="hljs-string">"ui-input-text "</span> ) +
			<span class="hljs-keyword">this</span>.classes.join( <span class="hljs-string">" "</span> ) + <span class="hljs-string">" "</span> +
			<span class="hljs-string">"ui-shadow-inset'&gt;&lt;/div&gt;"</span> );
	},

	_autoCorrect: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-711">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-711">&#182;</a>
              </div>
              <p>XXX: Temporary workaround for issue 785 (Apple bug 8910589).
     Turn off autocorrect and autocomplete on non-iOS 5 devices
     since the popup they use can’t be dismissed by the user. Note
     that we test for the presence of the feature by looking for
     the autocorrect property on the input element. We currently
     have no test for iOS 5 or newer so we’re temporarily using
     the touchOverflow support flag for jQM 1.0. Yes, I feel dirty.</p>
<pre><code> - jblas
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].autocorrect !== <span class="hljs-string">"undefined"</span> &amp;&amp;
			!$.support.touchOverflow ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-712">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-712">&#182;</a>
              </div>
              <p>Set the attribute instead of the property just in case there
is code that attempts to make modifications via HTML.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].setAttribute( <span class="hljs-string">"autocorrect"</span>, <span class="hljs-string">"off"</span> );
			<span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].setAttribute( <span class="hljs-string">"autocomplete"</span>, <span class="hljs-string">"off"</span> );
		}
	},

	_handleBlur: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.widget().removeClass( $.mobile.focusClass );
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.preventFocusZoom ) {
			$.mobile.zoom.enable( <span class="hljs-literal">true</span> );
		}
	},

	_handleFocus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-713">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-713">&#182;</a>
              </div>
              <p>In many situations, iOS will zoom into the input upon tap, this
prevents that from happening</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.preventFocusZoom ) {
			$.mobile.zoom.disable( <span class="hljs-literal">true</span> );
		}
		<span class="hljs-keyword">this</span>.widget().addClass( $.mobile.focusClass );
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> outer = <span class="hljs-keyword">this</span>.widget();

		<span class="hljs-keyword">this</span>._super( options );

		<span class="hljs-keyword">if</span> ( !( options.disabled === <span class="hljs-literal">undefined</span> &amp;&amp;
			options.mini === <span class="hljs-literal">undefined</span> &amp;&amp;
			options.corners === <span class="hljs-literal">undefined</span> &amp;&amp;
			options.theme === <span class="hljs-literal">undefined</span> &amp;&amp;
			options.wrapperClass === <span class="hljs-literal">undefined</span> ) ) {

			outer.removeClass( <span class="hljs-keyword">this</span>.classes.join( <span class="hljs-string">" "</span> ) );
			<span class="hljs-keyword">this</span>.classes = <span class="hljs-keyword">this</span>._classesFromOptions();
			outer.addClass( <span class="hljs-keyword">this</span>.classes.join( <span class="hljs-string">" "</span> ) );
		}

		<span class="hljs-keyword">if</span> ( options.disabled !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"disabled"</span>, !!options.disabled );
		}
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.enhanced ) {
			<span class="hljs-keyword">return</span>;
		}
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.inputNeedsWrap ) {
			<span class="hljs-keyword">this</span>.element.unwrap();
		}
		<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-input-text "</span> + <span class="hljs-keyword">this</span>.classes.join( <span class="hljs-string">" "</span> ) );
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.slider"</span>, $.extend( {
	initSelector: <span class="hljs-string">"input[type='range'], :jqmData(type='range'), :jqmData(role='slider')"</span>,

	widgetEventPrefix: <span class="hljs-string">"slide"</span>,

	options: {
		theme: <span class="hljs-literal">null</span>,
		trackTheme: <span class="hljs-literal">null</span>,
		corners: <span class="hljs-literal">true</span>,
		mini: <span class="hljs-literal">false</span>,
		highlight: <span class="hljs-literal">false</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-714">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-714">&#182;</a>
              </div>
              <p>TODO: Each of these should have comments explain what they’re for</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
			control = <span class="hljs-keyword">this</span>.element,
			trackTheme = <span class="hljs-keyword">this</span>.options.trackTheme || $.mobile.getAttribute( control[ <span class="hljs-number">0</span> ], <span class="hljs-string">"theme"</span> ),
			trackThemeClass = trackTheme ? <span class="hljs-string">" ui-bar-"</span> + trackTheme : <span class="hljs-string">" ui-bar-inherit"</span>,
			cornerClass = ( <span class="hljs-keyword">this</span>.options.corners || control.jqmData( <span class="hljs-string">"corners"</span> ) ) ? <span class="hljs-string">" ui-corner-all"</span> : <span class="hljs-string">""</span>,
			miniClass = ( <span class="hljs-keyword">this</span>.options.mini || control.jqmData( <span class="hljs-string">"mini"</span> ) ) ? <span class="hljs-string">" ui-mini"</span> : <span class="hljs-string">""</span>,
			cType = control[ <span class="hljs-number">0</span> ].nodeName.toLowerCase(),
			isToggleSwitch = ( cType === <span class="hljs-string">"select"</span> ),
			isRangeslider = control.parent().is( <span class="hljs-string">":jqmData(role='rangeslider')"</span> ),
			selectClass = ( isToggleSwitch ) ? <span class="hljs-string">"ui-slider-switch"</span> : <span class="hljs-string">""</span>,
			controlID = control.attr( <span class="hljs-string">"id"</span> ),
			$label = $( <span class="hljs-string">"[for='"</span> + controlID + <span class="hljs-string">"']"</span> ),
			labelID = $label.attr( <span class="hljs-string">"id"</span> ) || controlID + <span class="hljs-string">"-label"</span>,
			min = !isToggleSwitch ? <span class="hljs-built_in">parseFloat</span>( control.attr( <span class="hljs-string">"min"</span> ) ) : <span class="hljs-number">0</span>,
			max =  !isToggleSwitch ? <span class="hljs-built_in">parseFloat</span>( control.attr( <span class="hljs-string">"max"</span> ) ) : control.find( <span class="hljs-string">"option"</span> ).length-<span class="hljs-number">1</span>,
			step = window.parseFloat( control.attr( <span class="hljs-string">"step"</span> ) || <span class="hljs-number">1</span> ),
			domHandle = document.createElement( <span class="hljs-string">"a"</span> ),
			handle = $( domHandle ),
			domSlider = document.createElement( <span class="hljs-string">"div"</span> ),
			slider = $( domSlider ),
			valuebg = <span class="hljs-keyword">this</span>.options.highlight &amp;&amp; !isToggleSwitch ? (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> bg = document.createElement( <span class="hljs-string">"div"</span> );
				bg.className = <span class="hljs-string">"ui-slider-bg "</span> + $.mobile.activeBtnClass;
				<span class="hljs-keyword">return</span> $( bg ).prependTo( slider );
			})() : <span class="hljs-literal">false</span>,
			options,
			wrapper,
			j, length,
			i, optionsCount, origTabIndex,
			side, activeClass, sliderImg;

		$label.attr( <span class="hljs-string">"id"</span>, labelID );
		<span class="hljs-keyword">this</span>.isToggleSwitch = isToggleSwitch;

		domHandle.setAttribute( <span class="hljs-string">"href"</span>, <span class="hljs-string">"#"</span> );
		domSlider.setAttribute( <span class="hljs-string">"role"</span>, <span class="hljs-string">"application"</span> );
		domSlider.className = [ <span class="hljs-keyword">this</span>.isToggleSwitch ? <span class="hljs-string">"ui-slider ui-slider-track ui-shadow-inset "</span> : <span class="hljs-string">"ui-slider-track ui-shadow-inset "</span>, selectClass, trackThemeClass, cornerClass, miniClass ].join( <span class="hljs-string">""</span> );
		domHandle.className = <span class="hljs-string">"ui-slider-handle"</span>;
		domSlider.appendChild( domHandle );

		handle.attr({
			<span class="hljs-string">"role"</span>: <span class="hljs-string">"slider"</span>,
			<span class="hljs-string">"aria-valuemin"</span>: min,
			<span class="hljs-string">"aria-valuemax"</span>: max,
			<span class="hljs-string">"aria-valuenow"</span>: <span class="hljs-keyword">this</span>._value(),
			<span class="hljs-string">"aria-valuetext"</span>: <span class="hljs-keyword">this</span>._value(),
			<span class="hljs-string">"title"</span>: <span class="hljs-keyword">this</span>._value(),
			<span class="hljs-string">"aria-labelledby"</span>: labelID
		});

		$.extend( <span class="hljs-keyword">this</span>, {
			slider: slider,
			handle: handle,
			control: control,
			type: cType,
			step: step,
			max: max,
			min: min,
			valuebg: valuebg,
			isRangeslider: isRangeslider,
			dragging: <span class="hljs-literal">false</span>,
			beforeStart: <span class="hljs-literal">null</span>,
			userModified: <span class="hljs-literal">false</span>,
			mouseMoved: <span class="hljs-literal">false</span>
		});

		<span class="hljs-keyword">if</span> ( isToggleSwitch ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-715">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-715">&#182;</a>
              </div>
              <p>TODO: restore original tabindex (if any) in a destroy method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			origTabIndex = control.attr( <span class="hljs-string">"tabindex"</span> );
			<span class="hljs-keyword">if</span> ( origTabIndex ) {
				handle.attr( <span class="hljs-string">"tabindex"</span>, origTabIndex );
			}
			control.attr( <span class="hljs-string">"tabindex"</span>, <span class="hljs-string">"-1"</span> ).focus(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( <span class="hljs-keyword">this</span> ).blur();
				handle.focus();
			});

			wrapper = document.createElement( <span class="hljs-string">"div"</span> );
			wrapper.className = <span class="hljs-string">"ui-slider-inneroffset"</span>;

			<span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>, length = domSlider.childNodes.length; j &lt; length; j++ ) {
				wrapper.appendChild( domSlider.childNodes[j] );
			}

			domSlider.appendChild( wrapper );</pre></div></div>
            
        </li>
        
        
        <li id="section-716">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-716">&#182;</a>
              </div>
              <p>slider.wrapInner( “<div class='ui-slider-inneroffset'></div>“ );</p>

            </div>
            
        </li>
        
        
        <li id="section-717">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-717">&#182;</a>
              </div>
              <p>make the handle move with a smooth transition</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			handle.addClass( <span class="hljs-string">"ui-slider-handle-snapping"</span> );

			options = control.find( <span class="hljs-string">"option"</span> );

			<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>, optionsCount = options.length; i &lt; optionsCount; i++ ) {
				side = !i ? <span class="hljs-string">"b"</span> : <span class="hljs-string">"a"</span>;
				activeClass = !i ? <span class="hljs-string">""</span> : <span class="hljs-string">" "</span> + $.mobile.activeBtnClass;
				sliderImg = document.createElement( <span class="hljs-string">"span"</span> );

				sliderImg.className = [ <span class="hljs-string">"ui-slider-label ui-slider-label-"</span>, side, activeClass ].join( <span class="hljs-string">""</span> );
				sliderImg.setAttribute( <span class="hljs-string">"role"</span>, <span class="hljs-string">"img"</span> );
				sliderImg.appendChild( document.createTextNode( options[i].innerHTML ) );
				$( sliderImg ).prependTo( slider );
			}

			self._labels = $( <span class="hljs-string">".ui-slider-label"</span>, slider );

		}</pre></div></div>
            
        </li>
        
        
        <li id="section-718">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-718">&#182;</a>
              </div>
              <p>monitor the input for updated values</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		control.addClass( isToggleSwitch ? <span class="hljs-string">"ui-slider-switch"</span> : <span class="hljs-string">"ui-slider-input"</span> );

		<span class="hljs-keyword">this</span>._on( control, {
			<span class="hljs-string">"change"</span>: <span class="hljs-string">"_controlChange"</span>,
			<span class="hljs-string">"keyup"</span>: <span class="hljs-string">"_controlKeyup"</span>,
			<span class="hljs-string">"blur"</span>: <span class="hljs-string">"_controlBlur"</span>,
			<span class="hljs-string">"vmouseup"</span>: <span class="hljs-string">"_controlVMouseUp"</span>
		});

		slider.bind( <span class="hljs-string">"vmousedown"</span>, $.proxy( <span class="hljs-keyword">this</span>._sliderVMouseDown, <span class="hljs-keyword">this</span> ) )
			.bind( <span class="hljs-string">"vclick"</span>, <span class="hljs-literal">false</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-719">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-719">&#182;</a>
              </div>
              <p>We have to instantiate a new function object for the unbind to work properly
since the method itself is defined in the prototype (causing it to unbind everything)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._on( document, { <span class="hljs-string">"vmousemove"</span>: <span class="hljs-string">"_preventDocumentDrag"</span> });
		<span class="hljs-keyword">this</span>._on( slider.add( document ), { <span class="hljs-string">"vmouseup"</span>: <span class="hljs-string">"_sliderVMouseUp"</span> });

		slider.insertAfter( control );</pre></div></div>
            
        </li>
        
        
        <li id="section-720">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-720">&#182;</a>
              </div>
              <p>wrap in a div for styling purposes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !isToggleSwitch &amp;&amp; !isRangeslider ) {
			wrapper = <span class="hljs-keyword">this</span>.options.mini ? <span class="hljs-string">"&lt;div class='ui-slider ui-mini'&gt;"</span> : <span class="hljs-string">"&lt;div class='ui-slider'&gt;"</span>;

			control.add( slider ).wrapAll( wrapper );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-721">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-721">&#182;</a>
              </div>
              <p>bind the handle event callbacks and set the context to the widget instance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.handle, {
			<span class="hljs-string">"vmousedown"</span>: <span class="hljs-string">"_handleVMouseDown"</span>,
			<span class="hljs-string">"keydown"</span>: <span class="hljs-string">"_handleKeydown"</span>,
			<span class="hljs-string">"keyup"</span>: <span class="hljs-string">"_handleKeyup"</span>
		});

		<span class="hljs-keyword">this</span>.handle.bind( <span class="hljs-string">"vclick"</span>, <span class="hljs-literal">false</span> );

		<span class="hljs-keyword">this</span>._handleFormReset();

		<span class="hljs-keyword">this</span>.refresh( <span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">true</span> );
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">if</span> ( options.theme !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._setTheme( options.theme );
		}

		<span class="hljs-keyword">if</span> ( options.trackTheme !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._setTrackTheme( options.trackTheme );
		}

		<span class="hljs-keyword">if</span> ( options.corners !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._setCorners( options.corners );
		}

		<span class="hljs-keyword">if</span> ( options.mini !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._setMini( options.mini );
		}

		<span class="hljs-keyword">if</span> ( options.highlight !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._setHighlight( options.highlight );
		}

		<span class="hljs-keyword">if</span> ( options.disabled !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._setDisabled( options.disabled );
		}
		<span class="hljs-keyword">this</span>._super( options );
	},

	_controlChange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-722">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-722">&#182;</a>
              </div>
              <p>if the user dragged the handle, the “change” event was triggered from inside refresh(); don’t call refresh() again</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"controlchange"</span>, event ) === <span class="hljs-literal">false</span> ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.mouseMoved ) {
			<span class="hljs-keyword">this</span>.refresh( <span class="hljs-keyword">this</span>._value(), <span class="hljs-literal">true</span> );
		}
	},

	_controlKeyup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* event */</span>)</span> {</span> <span class="hljs-comment">// necessary?</span>
		<span class="hljs-keyword">this</span>.refresh( <span class="hljs-keyword">this</span>._value(), <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span> );
	},

	_controlBlur: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* event */</span>)</span> {</span>
		<span class="hljs-keyword">this</span>.refresh( <span class="hljs-keyword">this</span>._value(), <span class="hljs-literal">true</span> );
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-723">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-723">&#182;</a>
              </div>
              <p>it appears the clicking the up and down buttons in chrome on
range/number inputs doesn’t trigger a change until the field is
blurred. Here we check thif the value has changed and refresh</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_controlVMouseUp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* event */</span>)</span> {</span>
		<span class="hljs-keyword">this</span>._checkedRefresh();
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-724">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-724">&#182;</a>
              </div>
              <p>NOTE force focus on handle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_handleVMouseDown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* event */</span>)</span> {</span>
		<span class="hljs-keyword">this</span>.handle.focus();
	},

	_handleKeydown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">var</span> index = <span class="hljs-keyword">this</span>._value();
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.disabled ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-725">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-725">&#182;</a>
              </div>
              <p>In all cases prevent the default and mark the handle as active</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">switch</span> ( event.keyCode ) {
			<span class="hljs-keyword">case</span> $.mobile.keyCode.HOME:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.END:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.PAGE_UP:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.PAGE_DOWN:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.UP:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.RIGHT:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.DOWN:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.LEFT:
				event.preventDefault();

				<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._keySliding ) {
					<span class="hljs-keyword">this</span>._keySliding = <span class="hljs-literal">true</span>;
					<span class="hljs-keyword">this</span>.handle.addClass( <span class="hljs-string">"ui-state-active"</span> ); <span class="hljs-comment">/* TODO: We don't use this class for styling. Do we need to add it? */</span>
				}

				<span class="hljs-keyword">break</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-726">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-726">&#182;</a>
              </div>
              <p>move the slider according to the keypress</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">switch</span> ( event.keyCode ) {
			<span class="hljs-keyword">case</span> $.mobile.keyCode.HOME:
				<span class="hljs-keyword">this</span>.refresh( <span class="hljs-keyword">this</span>.min );
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> $.mobile.keyCode.END:
				<span class="hljs-keyword">this</span>.refresh( <span class="hljs-keyword">this</span>.max );
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> $.mobile.keyCode.PAGE_UP:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.UP:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.RIGHT:
				<span class="hljs-keyword">this</span>.refresh( index + <span class="hljs-keyword">this</span>.step );
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> $.mobile.keyCode.PAGE_DOWN:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.DOWN:
			<span class="hljs-keyword">case</span> $.mobile.keyCode.LEFT:
				<span class="hljs-keyword">this</span>.refresh( index - <span class="hljs-keyword">this</span>.step );
				<span class="hljs-keyword">break</span>;
		}
	}, <span class="hljs-comment">// remove active mark</span>

	_handleKeyup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* event */</span>)</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._keySliding ) {
			<span class="hljs-keyword">this</span>._keySliding = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">this</span>.handle.removeClass( <span class="hljs-string">"ui-state-active"</span> ); <span class="hljs-comment">/* See comment above. */</span>
		}
	},

	_sliderVMouseDown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-727">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-727">&#182;</a>
              </div>
              <p>NOTE: we don’t do this in refresh because we still want to
      support programmatic alteration of disabled inputs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.disabled || !( event.which === <span class="hljs-number">1</span> || event.which === <span class="hljs-number">0</span> || event.which === <span class="hljs-literal">undefined</span> ) ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"beforestart"</span>, event ) === <span class="hljs-literal">false</span> ) {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
		<span class="hljs-keyword">this</span>.dragging = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">this</span>.userModified = <span class="hljs-literal">false</span>;
		<span class="hljs-keyword">this</span>.mouseMoved = <span class="hljs-literal">false</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isToggleSwitch ) {
			<span class="hljs-keyword">this</span>.beforeStart = <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].selectedIndex;
		}

		<span class="hljs-keyword">this</span>.refresh( event );
		<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"start"</span> );
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	},

	_sliderVMouseUp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.dragging ) {
			<span class="hljs-keyword">this</span>.dragging = <span class="hljs-literal">false</span>;

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isToggleSwitch ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-728">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-728">&#182;</a>
              </div>
              <p>make the handle move with a smooth transition</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.handle.addClass( <span class="hljs-string">"ui-slider-handle-snapping"</span> );

				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.mouseMoved ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-729">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-729">&#182;</a>
              </div>
              <p>this is a drag, change the value only if user dragged enough</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.userModified ) {
						<span class="hljs-keyword">this</span>.refresh( <span class="hljs-keyword">this</span>.beforeStart === <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span> );
					} <span class="hljs-keyword">else</span> {
						<span class="hljs-keyword">this</span>.refresh( <span class="hljs-keyword">this</span>.beforeStart );
					}
				} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-730">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-730">&#182;</a>
              </div>
              <p>this is just a click, change the value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">this</span>.refresh( <span class="hljs-keyword">this</span>.beforeStart === <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span> );
				}
			}

			<span class="hljs-keyword">this</span>.mouseMoved = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"stop"</span> );
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
	},

	_preventDocumentDrag: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-731">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-731">&#182;</a>
              </div>
              <p>NOTE: we don’t do this in refresh because we still want to
      support programmatic alteration of disabled inputs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"drag"</span>, event ) === <span class="hljs-literal">false</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.dragging &amp;&amp; !<span class="hljs-keyword">this</span>.options.disabled ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-732">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-732">&#182;</a>
              </div>
              <p>this.mouseMoved must be updated before refresh() because it will be used in the control “change” event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.mouseMoved = <span class="hljs-literal">true</span>;

				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isToggleSwitch ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-733">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-733">&#182;</a>
              </div>
              <p>make the handle move in sync with the mouse</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">this</span>.handle.removeClass( <span class="hljs-string">"ui-slider-handle-snapping"</span> );
				}

				<span class="hljs-keyword">this</span>.refresh( event );</pre></div></div>
            
        </li>
        
        
        <li id="section-734">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-734">&#182;</a>
              </div>
              <p>only after refresh() you can calculate this.userModified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.userModified = <span class="hljs-keyword">this</span>.beforeStart !== <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].selectedIndex;
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
		},

	_checkedRefresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.value !== <span class="hljs-keyword">this</span>._value() ) {
			<span class="hljs-keyword">this</span>.refresh( <span class="hljs-keyword">this</span>._value() );
		}
	},

	_value: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span>  <span class="hljs-keyword">this</span>.isToggleSwitch ? <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].selectedIndex : <span class="hljs-built_in">parseFloat</span>( <span class="hljs-keyword">this</span>.element.val() ) ;
	},

	_reset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.refresh( <span class="hljs-literal">undefined</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span> );
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( val, isfromControl, preventInputUpdate )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-735">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-735">&#182;</a>
              </div>
              <p>NOTE: we don’t return here because we want to support programmatic
      alteration of the input value, which should still update the slider</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
			parentTheme = $.mobile.getAttribute( <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ], <span class="hljs-string">"theme"</span> ),
			theme = <span class="hljs-keyword">this</span>.options.theme || parentTheme,
			themeClass =  theme ? <span class="hljs-string">" ui-btn-"</span> + theme : <span class="hljs-string">""</span>,
			trackTheme = <span class="hljs-keyword">this</span>.options.trackTheme || parentTheme,
			trackThemeClass = trackTheme ? <span class="hljs-string">" ui-bar-"</span> + trackTheme : <span class="hljs-string">" ui-bar-inherit"</span>,
			cornerClass = <span class="hljs-keyword">this</span>.options.corners ? <span class="hljs-string">" ui-corner-all"</span> : <span class="hljs-string">""</span>,
			miniClass = <span class="hljs-keyword">this</span>.options.mini ? <span class="hljs-string">" ui-mini"</span> : <span class="hljs-string">""</span>,
			left, width, data, tol,
			pxStep, percent,
			control, isInput, optionElements, min, max, step,
			newval, valModStep, alignValue, percentPerStep,
			handlePercent, aPercent, bPercent,
			valueChanged;

		self.slider[<span class="hljs-number">0</span>].className = [ <span class="hljs-keyword">this</span>.isToggleSwitch ? <span class="hljs-string">"ui-slider ui-slider-switch ui-slider-track ui-shadow-inset"</span> : <span class="hljs-string">"ui-slider-track ui-shadow-inset"</span>, trackThemeClass, cornerClass, miniClass ].join( <span class="hljs-string">""</span> );
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.disabled || <span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"disabled"</span> ) ) {
			<span class="hljs-keyword">this</span>.disable();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-736">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-736">&#182;</a>
              </div>
              <p>set the stored value for comparison later</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.value = <span class="hljs-keyword">this</span>._value();
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.highlight &amp;&amp; !<span class="hljs-keyword">this</span>.isToggleSwitch &amp;&amp; <span class="hljs-keyword">this</span>.slider.find( <span class="hljs-string">".ui-slider-bg"</span> ).length === <span class="hljs-number">0</span> ) {
			<span class="hljs-keyword">this</span>.valuebg = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> bg = document.createElement( <span class="hljs-string">"div"</span> );
				bg.className = <span class="hljs-string">"ui-slider-bg "</span> + $.mobile.activeBtnClass;
				<span class="hljs-keyword">return</span> $( bg ).prependTo( self.slider );
			})();
		}
		<span class="hljs-keyword">this</span>.handle.addClass( <span class="hljs-string">"ui-btn"</span> + themeClass + <span class="hljs-string">" ui-shadow"</span> );

		control = <span class="hljs-keyword">this</span>.element;
		isInput = !<span class="hljs-keyword">this</span>.isToggleSwitch;
		optionElements = isInput ? [] : control.find( <span class="hljs-string">"option"</span> );
		min =  isInput ? <span class="hljs-built_in">parseFloat</span>( control.attr( <span class="hljs-string">"min"</span> ) ) : <span class="hljs-number">0</span>;
		max = isInput ? <span class="hljs-built_in">parseFloat</span>( control.attr( <span class="hljs-string">"max"</span> ) ) : optionElements.length - <span class="hljs-number">1</span>;
		step = ( isInput &amp;&amp; <span class="hljs-built_in">parseFloat</span>( control.attr( <span class="hljs-string">"step"</span> ) ) &gt; <span class="hljs-number">0</span> ) ? <span class="hljs-built_in">parseFloat</span>( control.attr( <span class="hljs-string">"step"</span> ) ) : <span class="hljs-number">1</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">"object"</span> ) {
			data = val;</pre></div></div>
            
        </li>
        
        
        <li id="section-737">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-737">&#182;</a>
              </div>
              <p>a slight tolerance helped get to the ends of the slider</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			tol = <span class="hljs-number">8</span>;

			left = <span class="hljs-keyword">this</span>.slider.offset().left;
			width = <span class="hljs-keyword">this</span>.slider.width();
			pxStep = width/((max-min)/step);
			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.dragging ||
					data.pageX &lt; left - tol ||
					data.pageX &gt; left + width + tol ) {
				<span class="hljs-keyword">return</span>;
			}
			<span class="hljs-keyword">if</span> ( pxStep &gt; <span class="hljs-number">1</span> ) {
				percent = ( ( data.pageX - left ) / width ) * <span class="hljs-number">100</span>;
			} <span class="hljs-keyword">else</span> {
				percent = <span class="hljs-built_in">Math</span>.round( ( ( data.pageX - left ) / width ) * <span class="hljs-number">100</span> );
			}
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">if</span> ( val == <span class="hljs-literal">null</span> ) {
				val = isInput ? <span class="hljs-built_in">parseFloat</span>( control.val() || <span class="hljs-number">0</span> ) : control[<span class="hljs-number">0</span>].selectedIndex;
			}
			percent = ( <span class="hljs-built_in">parseFloat</span>( val ) - min ) / ( max - min ) * <span class="hljs-number">100</span>;
		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">isNaN</span>( percent ) ) {
			<span class="hljs-keyword">return</span>;
		}

		newval = ( percent / <span class="hljs-number">100</span> ) * ( max - min ) + min;</pre></div></div>
            
        </li>
        
        
        <li id="section-738">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-738">&#182;</a>
              </div>
              <p>from jQuery UI slider, the following source will round to the nearest step</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		valModStep = ( newval - min ) % step;
		alignValue = newval - valModStep;

		<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">Math</span>.abs( valModStep ) * <span class="hljs-number">2</span> &gt;= step ) {
			alignValue += ( valModStep &gt; <span class="hljs-number">0</span> ) ? step : ( -step );
		}

		percentPerStep = <span class="hljs-number">100</span>/((max-min)/step);</pre></div></div>
            
        </li>
        
        
        <li id="section-739">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-739">&#182;</a>
              </div>
              <p>Since JavaScript has problems with large floats, round
the final value to 5 digits after the decimal point (see jQueryUI: #4124)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		newval = <span class="hljs-built_in">parseFloat</span>( alignValue.toFixed(<span class="hljs-number">5</span>) );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> pxStep === <span class="hljs-string">"undefined"</span> ) {
			pxStep = width / ( (max-min) / step );
		}
		<span class="hljs-keyword">if</span> ( pxStep &gt; <span class="hljs-number">1</span> &amp;&amp; isInput ) {
			percent = ( newval - min ) * percentPerStep * ( <span class="hljs-number">1</span> / step );
		}
		<span class="hljs-keyword">if</span> ( percent &lt; <span class="hljs-number">0</span> ) {
			percent = <span class="hljs-number">0</span>;
		}

		<span class="hljs-keyword">if</span> ( percent &gt; <span class="hljs-number">100</span> ) {
			percent = <span class="hljs-number">100</span>;
		}

		<span class="hljs-keyword">if</span> ( newval &lt; min ) {
			newval = min;
		}

		<span class="hljs-keyword">if</span> ( newval &gt; max ) {
			newval = max;
		}

		<span class="hljs-keyword">this</span>.handle.css( <span class="hljs-string">"left"</span>, percent + <span class="hljs-string">"%"</span> );

		<span class="hljs-keyword">this</span>.handle[<span class="hljs-number">0</span>].setAttribute( <span class="hljs-string">"aria-valuenow"</span>, isInput ? newval : optionElements.eq( newval ).attr( <span class="hljs-string">"value"</span> ) );

		<span class="hljs-keyword">this</span>.handle[<span class="hljs-number">0</span>].setAttribute( <span class="hljs-string">"aria-valuetext"</span>, isInput ? newval : optionElements.eq( newval ).getEncodedText() );

		<span class="hljs-keyword">this</span>.handle[<span class="hljs-number">0</span>].setAttribute( <span class="hljs-string">"title"</span>, isInput ? newval : optionElements.eq( newval ).getEncodedText() );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.valuebg ) {
			<span class="hljs-keyword">this</span>.valuebg.css( <span class="hljs-string">"width"</span>, percent + <span class="hljs-string">"%"</span> );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-740">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-740">&#182;</a>
              </div>
              <p>drag the label widths</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._labels ) {
			handlePercent = <span class="hljs-keyword">this</span>.handle.width() / <span class="hljs-keyword">this</span>.slider.width() * <span class="hljs-number">100</span>;
			aPercent = percent &amp;&amp; handlePercent + ( <span class="hljs-number">100</span> - handlePercent ) * percent / <span class="hljs-number">100</span>;
			bPercent = percent === <span class="hljs-number">100</span> ? <span class="hljs-number">0</span> : <span class="hljs-built_in">Math</span>.min( handlePercent + <span class="hljs-number">100</span> - aPercent, <span class="hljs-number">100</span> );

			<span class="hljs-keyword">this</span>._labels.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> ab = $( <span class="hljs-keyword">this</span> ).hasClass( <span class="hljs-string">"ui-slider-label-a"</span> );
				$( <span class="hljs-keyword">this</span> ).width( ( ab ? aPercent : bPercent  ) + <span class="hljs-string">"%"</span> );
			});
		}

		<span class="hljs-keyword">if</span> ( !preventInputUpdate ) {
			valueChanged = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-741">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-741">&#182;</a>
              </div>
              <p>update control”s value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( isInput ) {
				valueChanged = control.val() !== newval;
				control.val( newval );
			} <span class="hljs-keyword">else</span> {
				valueChanged = control[ <span class="hljs-number">0</span> ].selectedIndex !== newval;
				control[ <span class="hljs-number">0</span> ].selectedIndex = newval;
			}
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"beforechange"</span>, val ) === <span class="hljs-literal">false</span>) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span> ( !isfromControl &amp;&amp; valueChanged ) {
				control.trigger( <span class="hljs-string">"change"</span> );
			}
		}
	},

	_setHighlight: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		value = !!value;
		<span class="hljs-keyword">if</span> ( value ) {
			<span class="hljs-keyword">this</span>.options.highlight = !!value;
			<span class="hljs-keyword">this</span>.refresh();
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.valuebg ) {
			<span class="hljs-keyword">this</span>.valuebg.remove();
			<span class="hljs-keyword">this</span>.valuebg = <span class="hljs-literal">false</span>;
		}
	},

	_setTheme: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		<span class="hljs-keyword">this</span>.handle
			.removeClass( <span class="hljs-string">"ui-btn-"</span> + <span class="hljs-keyword">this</span>.options.theme )
			.addClass( <span class="hljs-string">"ui-btn-"</span> + value );

		<span class="hljs-keyword">var</span> currentTheme = <span class="hljs-keyword">this</span>.options.theme ? <span class="hljs-keyword">this</span>.options.theme : <span class="hljs-string">"inherit"</span>,
			newTheme = value ? value : <span class="hljs-string">"inherit"</span>;

		<span class="hljs-keyword">this</span>.control
			.removeClass( <span class="hljs-string">"ui-body-"</span> + currentTheme )
			.addClass( <span class="hljs-string">"ui-body-"</span> + newTheme );
	},

	_setTrackTheme: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		<span class="hljs-keyword">var</span> currentTrackTheme = <span class="hljs-keyword">this</span>.options.trackTheme ? <span class="hljs-keyword">this</span>.options.trackTheme : <span class="hljs-string">"inherit"</span>,
			newTrackTheme = value ? value : <span class="hljs-string">"inherit"</span>;

		<span class="hljs-keyword">this</span>.slider
			.removeClass( <span class="hljs-string">"ui-body-"</span> + currentTrackTheme )
			.addClass( <span class="hljs-string">"ui-body-"</span> + newTrackTheme );
	},

	_setMini: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		value = !!value;
		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.isToggleSwitch &amp;&amp; !<span class="hljs-keyword">this</span>.isRangeslider ) {
			<span class="hljs-keyword">this</span>.slider.parent().toggleClass( <span class="hljs-string">"ui-mini"</span>, value );
			<span class="hljs-keyword">this</span>.element.toggleClass( <span class="hljs-string">"ui-mini"</span>, value );
		}
		<span class="hljs-keyword">this</span>.slider.toggleClass( <span class="hljs-string">"ui-mini"</span>, value );
	},

	_setCorners: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		<span class="hljs-keyword">this</span>.slider.toggleClass( <span class="hljs-string">"ui-corner-all"</span>, value );

		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.isToggleSwitch ) {
			<span class="hljs-keyword">this</span>.control.toggleClass( <span class="hljs-string">"ui-corner-all"</span>, value );
		}
	},

	_setDisabled: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		value = !!value;
		<span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"disabled"</span>, value );
		<span class="hljs-keyword">this</span>.slider
			.toggleClass( <span class="hljs-string">"ui-state-disabled"</span>, value )
			.attr( <span class="hljs-string">"aria-disabled"</span>, value );
	}

}, $.mobile.behaviors.formReset ) );

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> popup;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPopup</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">if</span> ( !popup ) {
		popup = $( <span class="hljs-string">"&lt;div&gt;&lt;/div&gt;"</span>, {
			<span class="hljs-string">"class"</span>: <span class="hljs-string">"ui-slider-popup ui-shadow ui-corner-all"</span>
		});
	}
	<span class="hljs-keyword">return</span> popup.clone();
}

$.widget( <span class="hljs-string">"mobile.slider"</span>, $.mobile.slider, {
	options: {
		popupEnabled: <span class="hljs-literal">false</span>,
		showValue: <span class="hljs-literal">false</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._super();

		$.extend( <span class="hljs-keyword">this</span>, {
			_currentValue: <span class="hljs-literal">null</span>,
			_popup: <span class="hljs-literal">null</span>,
			_popupVisible: <span class="hljs-literal">false</span>
		});

		<span class="hljs-keyword">this</span>._setOption( <span class="hljs-string">"popupEnabled"</span>, <span class="hljs-keyword">this</span>.options.popupEnabled );

		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.handle, { <span class="hljs-string">"vmousedown"</span> : <span class="hljs-string">"_showPopup"</span> } );
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.slider.add( <span class="hljs-keyword">this</span>.document ), { <span class="hljs-string">"vmouseup"</span> : <span class="hljs-string">"_hidePopup"</span> } );
		<span class="hljs-keyword">this</span>._refresh();
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-742">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-742">&#182;</a>
              </div>
              <p>position the popup centered 5px above the handle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_positionPopup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> dstOffset = <span class="hljs-keyword">this</span>.handle.offset();

		<span class="hljs-keyword">this</span>._popup.offset( {
			left: dstOffset.left + ( <span class="hljs-keyword">this</span>.handle.width() - <span class="hljs-keyword">this</span>._popup.width() ) / <span class="hljs-number">2</span>,
			top: dstOffset.top - <span class="hljs-keyword">this</span>._popup.outerHeight() - <span class="hljs-number">5</span>
		});
	},

	_setOption: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( key, value )</span> {</span>
		<span class="hljs-keyword">this</span>._super( key, value );

		<span class="hljs-keyword">if</span> ( key === <span class="hljs-string">"showValue"</span> ) {
			<span class="hljs-keyword">this</span>.handle.html( value &amp;&amp; !<span class="hljs-keyword">this</span>.options.mini ? <span class="hljs-keyword">this</span>._value() : <span class="hljs-string">""</span> );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( key === <span class="hljs-string">"popupEnabled"</span> ) {
			<span class="hljs-keyword">if</span> ( value &amp;&amp; !<span class="hljs-keyword">this</span>._popup ) {
				<span class="hljs-keyword">this</span>._popup = getPopup()
					.addClass( <span class="hljs-string">"ui-body-"</span> + ( <span class="hljs-keyword">this</span>.options.theme || <span class="hljs-string">"a"</span> ) )
					.hide()
					.insertBefore( <span class="hljs-keyword">this</span>.element );
			}
		}
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-743">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-743">&#182;</a>
              </div>
              <p>show value on the handle and in popup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._super.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
		<span class="hljs-keyword">this</span>._refresh();
	},

	_refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> o = <span class="hljs-keyword">this</span>.options, newValue;

		<span class="hljs-keyword">if</span> ( o.popupEnabled ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-744">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-744">&#182;</a>
              </div>
              <p>remove the title attribute from the handle (which is
responsible for the annoying tooltip); NB we have
to do it here as the jqm slider sets it every time
the slider’s value changes :(</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.handle.removeAttr( <span class="hljs-string">"title"</span> );
		}

		newValue = <span class="hljs-keyword">this</span>._value();
		<span class="hljs-keyword">if</span> ( newValue === <span class="hljs-keyword">this</span>._currentValue ) {
			<span class="hljs-keyword">return</span>;
		}
		<span class="hljs-keyword">this</span>._currentValue = newValue;

		<span class="hljs-keyword">if</span> ( o.popupEnabled &amp;&amp; <span class="hljs-keyword">this</span>._popup ) {
			<span class="hljs-keyword">this</span>._positionPopup();
			<span class="hljs-keyword">this</span>._popup.html( newValue );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( o.showValue &amp;&amp; !<span class="hljs-keyword">this</span>.options.mini ) {
			<span class="hljs-keyword">this</span>.handle.html( newValue );
		}
	},

	_showPopup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.popupEnabled &amp;&amp; !<span class="hljs-keyword">this</span>._popupVisible ) {
			<span class="hljs-keyword">this</span>.handle.html( <span class="hljs-string">""</span> );
			<span class="hljs-keyword">this</span>._popup.show();
			<span class="hljs-keyword">this</span>._positionPopup();
			<span class="hljs-keyword">this</span>._popupVisible = <span class="hljs-literal">true</span>;
		}
	},

	_hidePopup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> o = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">if</span> ( o.popupEnabled &amp;&amp; <span class="hljs-keyword">this</span>._popupVisible ) {
			<span class="hljs-keyword">if</span> ( o.showValue &amp;&amp; !o.mini ) {
				<span class="hljs-keyword">this</span>.handle.html( <span class="hljs-keyword">this</span>._value() );
			}
			<span class="hljs-keyword">this</span>._popup.hide();
			<span class="hljs-keyword">this</span>._popupVisible = <span class="hljs-literal">false</span>;
		}
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.flipswitch"</span>, $.extend({

	options: {
		onText: <span class="hljs-string">"On"</span>,
		offText: <span class="hljs-string">"Off"</span>,
		theme: <span class="hljs-literal">null</span>,
		enhanced: <span class="hljs-literal">false</span>,
		wrapperClass: <span class="hljs-literal">null</span>,
		corners: <span class="hljs-literal">true</span>,
		mini: <span class="hljs-literal">false</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.options.enhanced ) {
				<span class="hljs-keyword">this</span>._enhance();
			} <span class="hljs-keyword">else</span> {
				$.extend( <span class="hljs-keyword">this</span>, {
					flipswitch: <span class="hljs-keyword">this</span>.element.parent(),
					on: <span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">".ui-flipswitch-on"</span> ).eq( <span class="hljs-number">0</span> ),
					off: <span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">".ui-flipswitch-off"</span> ).eq(<span class="hljs-number">0</span>),
					type: <span class="hljs-keyword">this</span>.element.get( <span class="hljs-number">0</span> ).tagName
				});
			}

			<span class="hljs-keyword">this</span>._handleFormReset();</pre></div></div>
            
        </li>
        
        
        <li id="section-745">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-745">&#182;</a>
              </div>
              <p>Transfer tabindex to “on” element and make input unfocusable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._originalTabIndex = <span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"tabindex"</span> );
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._originalTabIndex != <span class="hljs-literal">null</span> ) {
				<span class="hljs-keyword">this</span>.on.attr( <span class="hljs-string">"tabindex"</span>, <span class="hljs-keyword">this</span>._originalTabIndex );
			}
			<span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"tabindex"</span>, <span class="hljs-string">"-1"</span> );
			<span class="hljs-keyword">this</span>._on({
				<span class="hljs-string">"focus"</span> : <span class="hljs-string">"_handleInputFocus"</span>
			});

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">":disabled"</span> ) ) {
				<span class="hljs-keyword">this</span>._setOptions({
					<span class="hljs-string">"disabled"</span>: <span class="hljs-literal">true</span>
				});
			}

			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.flipswitch, {
				<span class="hljs-string">"click"</span>: <span class="hljs-string">"_toggle"</span>,
				<span class="hljs-string">"swipeleft"</span>: <span class="hljs-string">"_left"</span>,
				<span class="hljs-string">"swiperight"</span>: <span class="hljs-string">"_right"</span>
			});

			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.on, {
				<span class="hljs-string">"keydown"</span>: <span class="hljs-string">"_keydown"</span>
			});

			<span class="hljs-keyword">this</span>._on( {
				<span class="hljs-string">"change"</span>: <span class="hljs-string">"refresh"</span>
			});
	},

	_handleInputFocus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.on.focus();
	},

	widget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.flipswitch;
	},

	_left: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.flipswitch.removeClass( <span class="hljs-string">"ui-flipswitch-active"</span> );
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.type === <span class="hljs-string">"SELECT"</span> ) {
			<span class="hljs-keyword">this</span>.element.get( <span class="hljs-number">0</span> ).selectedIndex = <span class="hljs-number">0</span>;
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"checked"</span>, <span class="hljs-literal">false</span> );
		}
		<span class="hljs-keyword">this</span>.element.trigger( <span class="hljs-string">"change"</span> );
	},

	_right: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.flipswitch.addClass( <span class="hljs-string">"ui-flipswitch-active"</span> );
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.type === <span class="hljs-string">"SELECT"</span> ) {
			<span class="hljs-keyword">this</span>.element.get( <span class="hljs-number">0</span> ).selectedIndex = <span class="hljs-number">1</span>;
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"checked"</span>, <span class="hljs-literal">true</span> );
		}
		<span class="hljs-keyword">this</span>.element.trigger( <span class="hljs-string">"change"</span> );
	},

	_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> flipswitch = $( <span class="hljs-string">"&lt;div&gt;"</span> ),
			options = <span class="hljs-keyword">this</span>.options,
			element = <span class="hljs-keyword">this</span>.element,
			theme = options.theme ? options.theme : <span class="hljs-string">"inherit"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-746">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-746">&#182;</a>
              </div>
              <p>The “on” button is an anchor so it’s focusable</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			on = $( <span class="hljs-string">"&lt;a&gt;&lt;/a&gt;"</span>, {
				<span class="hljs-string">"href"</span>: <span class="hljs-string">"#"</span>
			}),
			off = $( <span class="hljs-string">"&lt;span&gt;&lt;/span&gt;"</span> ),
			type = element.get( <span class="hljs-number">0</span> ).tagName,
			onText = ( type === <span class="hljs-string">"INPUT"</span> ) ?
				options.onText : element.find( <span class="hljs-string">"option"</span> ).eq( <span class="hljs-number">1</span> ).text(),
			offText = ( type === <span class="hljs-string">"INPUT"</span> ) ?
				options.offText : element.find( <span class="hljs-string">"option"</span> ).eq( <span class="hljs-number">0</span> ).text();

			on
				.addClass( <span class="hljs-string">"ui-flipswitch-on ui-btn ui-shadow ui-btn-inherit"</span> )
				.text( onText );
			off
				.addClass( <span class="hljs-string">"ui-flipswitch-off"</span> )
				.text( offText );

			flipswitch
				.addClass( <span class="hljs-string">"ui-flipswitch ui-shadow-inset "</span> +
					<span class="hljs-string">"ui-bar-"</span> + theme + <span class="hljs-string">" "</span> +
					( options.wrapperClass ? options.wrapperClass : <span class="hljs-string">""</span> ) + <span class="hljs-string">" "</span> +
					( ( element.is( <span class="hljs-string">":checked"</span> ) ||
						element
							.find( <span class="hljs-string">"option"</span> )
							.eq( <span class="hljs-number">1</span> )
							.is( <span class="hljs-string">":selected"</span> ) ) ? <span class="hljs-string">"ui-flipswitch-active"</span> : <span class="hljs-string">""</span> ) +
					( element.is(<span class="hljs-string">":disabled"</span>) ? <span class="hljs-string">" ui-state-disabled"</span>: <span class="hljs-string">""</span>) +
					( options.corners ? <span class="hljs-string">" ui-corner-all"</span>: <span class="hljs-string">""</span> ) +
					( options.mini ? <span class="hljs-string">" ui-mini"</span>: <span class="hljs-string">""</span> ) )
				.append( on, off );

			element
				.addClass( <span class="hljs-string">"ui-flipswitch-input"</span> )
				.after( flipswitch )
				.appendTo( flipswitch );

		$.extend( <span class="hljs-keyword">this</span>, {
			flipswitch: flipswitch,
			on: on,
			off: off,
			type: type
		});
	},

	_reset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.refresh();
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> direction,
			existingDirection = <span class="hljs-keyword">this</span>.flipswitch.hasClass( <span class="hljs-string">"ui-flipswitch-active"</span> ) ? <span class="hljs-string">"_right"</span> : <span class="hljs-string">"_left"</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.type === <span class="hljs-string">"SELECT"</span> ) {
			direction = ( <span class="hljs-keyword">this</span>.element.get( <span class="hljs-number">0</span> ).selectedIndex &gt; <span class="hljs-number">0</span> ) ? <span class="hljs-string">"_right"</span>: <span class="hljs-string">"_left"</span>;
		} <span class="hljs-keyword">else</span> {
			direction = <span class="hljs-keyword">this</span>.element.prop( <span class="hljs-string">"checked"</span> ) ? <span class="hljs-string">"_right"</span>: <span class="hljs-string">"_left"</span>;
		}

		<span class="hljs-keyword">if</span> ( direction !== existingDirection ) {
			<span class="hljs-keyword">this</span>[ direction ]();
		}
	},

	_toggle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> direction = <span class="hljs-keyword">this</span>.flipswitch.hasClass( <span class="hljs-string">"ui-flipswitch-active"</span> ) ? <span class="hljs-string">"_left"</span> : <span class="hljs-string">"_right"</span>;

		<span class="hljs-keyword">this</span>[ direction ]();
	},

	_keydown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> {</span>
		<span class="hljs-keyword">if</span> ( e.which === $.mobile.keyCode.LEFT ) {
			<span class="hljs-keyword">this</span>._left();
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( e.which === $.mobile.keyCode.RIGHT ) {
			<span class="hljs-keyword">this</span>._right();
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( e.which === $.mobile.keyCode.SPACE ) {
			<span class="hljs-keyword">this</span>._toggle();
			e.preventDefault();
		}
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">if</span> ( options.theme !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">var</span> currentTheme = options.theme ? options.theme : <span class="hljs-string">"inherit"</span>,
				newTheme = options.theme ? options.theme : <span class="hljs-string">"inherit"</span>;

			<span class="hljs-keyword">this</span>.widget()
				.removeClass( <span class="hljs-string">"ui-bar-"</span> + currentTheme )
				.addClass( <span class="hljs-string">"ui-bar-"</span> + newTheme );
		}
		<span class="hljs-keyword">if</span> ( options.onText !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.on.text( options.onText );
		}
		<span class="hljs-keyword">if</span> ( options.offText !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.off.text( options.offText );
		}
		<span class="hljs-keyword">if</span> ( options.disabled !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.widget().toggleClass( <span class="hljs-string">"ui-state-disabled"</span>, options.disabled );
		}
		<span class="hljs-keyword">if</span> ( options.mini !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.widget().toggleClass( <span class="hljs-string">"ui-mini"</span>, options.mini );
		}
		<span class="hljs-keyword">if</span> ( options.corners !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.widget().toggleClass( <span class="hljs-string">"ui-corner-all"</span>, options.corners );
		}

		<span class="hljs-keyword">this</span>._super( options );
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.enhanced ) {
			<span class="hljs-keyword">return</span>;
		}
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._originalTabIndex != <span class="hljs-literal">null</span> ) {
			<span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"tabindex"</span>, <span class="hljs-keyword">this</span>._originalTabIndex );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.element.removeAttr( <span class="hljs-string">"tabindex"</span> );
		}
		<span class="hljs-keyword">this</span>.on.remove();
		<span class="hljs-keyword">this</span>.off.remove();
		<span class="hljs-keyword">this</span>.element.unwrap();
		<span class="hljs-keyword">this</span>.flipswitch.remove();
		<span class="hljs-keyword">this</span>.removeClass( <span class="hljs-string">"ui-flipswitch-input"</span> );
	}

}, $.mobile.behaviors.formReset ) );

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
	$.widget( <span class="hljs-string">"mobile.rangeslider"</span>, $.extend( {

		options: {
			theme: <span class="hljs-literal">null</span>,
			trackTheme: <span class="hljs-literal">null</span>,
			corners: <span class="hljs-literal">true</span>,
			mini: <span class="hljs-literal">false</span>,
			highlight: <span class="hljs-literal">true</span>
		},

		_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> $el = <span class="hljs-keyword">this</span>.element,
			elClass = <span class="hljs-keyword">this</span>.options.mini ? <span class="hljs-string">"ui-rangeslider ui-mini"</span> : <span class="hljs-string">"ui-rangeslider"</span>,
			_inputFirst = $el.find( <span class="hljs-string">"input"</span> ).first(),
			_inputLast = $el.find( <span class="hljs-string">"input"</span> ).last(),
			_label = $el.find( <span class="hljs-string">"label"</span> ).first(),
			_sliderWidgetFirst = $.data( _inputFirst.get( <span class="hljs-number">0</span> ), <span class="hljs-string">"mobile-slider"</span> ) ||
				$.data( _inputFirst.slider().get( <span class="hljs-number">0</span> ), <span class="hljs-string">"mobile-slider"</span> ),
			_sliderWidgetLast = $.data( _inputLast.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ) ||
				$.data( _inputLast.slider().get( <span class="hljs-number">0</span> ), <span class="hljs-string">"mobile-slider"</span> ),
			_sliderFirst = _sliderWidgetFirst.slider,
			_sliderLast = _sliderWidgetLast.slider,
			firstHandle = _sliderWidgetFirst.handle,
			_sliders = $( <span class="hljs-string">"&lt;div class='ui-rangeslider-sliders' /&gt;"</span> ).appendTo( $el );

			_inputFirst.addClass( <span class="hljs-string">"ui-rangeslider-first"</span> );
			_inputLast.addClass( <span class="hljs-string">"ui-rangeslider-last"</span> );
			$el.addClass( elClass );

			_sliderFirst.appendTo( _sliders );
			_sliderLast.appendTo( _sliders );
			_label.insertBefore( $el );
			firstHandle.prependTo( _sliderLast );

			$.extend( <span class="hljs-keyword">this</span>, {
				_inputFirst: _inputFirst,
				_inputLast: _inputLast,
				_sliderFirst: _sliderFirst,
				_sliderLast: _sliderLast,
				_label: _label,
				_targetVal: <span class="hljs-literal">null</span>,
				_sliderTarget: <span class="hljs-literal">false</span>,
				_sliders: _sliders,
				_proxy: <span class="hljs-literal">false</span>
			});

			<span class="hljs-keyword">this</span>.refresh();
			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"input.ui-slider-input"</span> ), {
				<span class="hljs-string">"slidebeforestart"</span>: <span class="hljs-string">"_slidebeforestart"</span>,
				<span class="hljs-string">"slidestop"</span>: <span class="hljs-string">"_slidestop"</span>,
				<span class="hljs-string">"slidedrag"</span>: <span class="hljs-string">"_slidedrag"</span>,
				<span class="hljs-string">"slidebeforechange"</span>: <span class="hljs-string">"_change"</span>,
				<span class="hljs-string">"blur"</span>: <span class="hljs-string">"_change"</span>,
				<span class="hljs-string">"keyup"</span>: <span class="hljs-string">"_change"</span>
			});
			<span class="hljs-keyword">this</span>._on({
				<span class="hljs-string">"mousedown"</span>:<span class="hljs-string">"_change"</span>
			});
			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.element.closest( <span class="hljs-string">"form"</span> ), {
				<span class="hljs-string">"reset"</span>:<span class="hljs-string">"_handleReset"</span>
			});
			<span class="hljs-keyword">this</span>._on( firstHandle, {
				<span class="hljs-string">"vmousedown"</span>: <span class="hljs-string">"_dragFirstHandle"</span>
			});
		},
		_handleReset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-747">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-747">&#182;</a>
              </div>
              <p>we must wait for the stack to unwind before updateing other wise sliders will not have updated yet</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				self._updateHighlight();
			},<span class="hljs-number">0</span>);
		},

		_dragFirstHandle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-748">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-748">&#182;</a>
              </div>
              <p>if the first handle is dragged send the event to the first slider</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.data( <span class="hljs-keyword">this</span>._inputFirst.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).dragging = <span class="hljs-literal">true</span>;
			$.data( <span class="hljs-keyword">this</span>._inputFirst.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).refresh( event );
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		},

		_slidedrag: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> first = $( event.target ).is( <span class="hljs-keyword">this</span>._inputFirst ),
				otherSlider = ( first ) ? <span class="hljs-keyword">this</span>._inputLast : <span class="hljs-keyword">this</span>._inputFirst;

			<span class="hljs-keyword">this</span>._sliderTarget = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-749">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-749">&#182;</a>
              </div>
              <p>if the drag was initiated on an extreme and the other handle is focused send the events to
the closest handle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ( <span class="hljs-keyword">this</span>._proxy === <span class="hljs-string">"first"</span> &amp;&amp; first ) || ( <span class="hljs-keyword">this</span>._proxy === <span class="hljs-string">"last"</span> &amp;&amp; !first ) ) {
				$.data( otherSlider.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).dragging = <span class="hljs-literal">true</span>;
				$.data( otherSlider.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).refresh( event );
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
		},

		_slidestop: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">var</span> first = $( event.target ).is( <span class="hljs-keyword">this</span>._inputFirst );

			<span class="hljs-keyword">this</span>._proxy = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-750">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-750">&#182;</a>
              </div>
              <p>this stops dragging of the handle and brings the active track to the front
this makes clicks on the track go the the last handle used</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"input"</span> ).trigger( <span class="hljs-string">"vmouseup"</span> );
			<span class="hljs-keyword">this</span>._sliderFirst.css( <span class="hljs-string">"z-index"</span>, first ? <span class="hljs-number">1</span> : <span class="hljs-string">""</span> );
		},

		_slidebeforestart: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">this</span>._sliderTarget = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-751">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-751">&#182;</a>
              </div>
              <p>if the track is the target remember this and the original value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $( event.originalEvent.target ).hasClass( <span class="hljs-string">"ui-slider-track"</span> ) ) {
				<span class="hljs-keyword">this</span>._sliderTarget = <span class="hljs-literal">true</span>;
				<span class="hljs-keyword">this</span>._targetVal = $( event.target ).val();
			}
		},

		_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
			<span class="hljs-keyword">if</span> ( options.theme !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>._setTheme( options.theme );
			}

			<span class="hljs-keyword">if</span> ( options.trackTheme !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>._setTrackTheme( options.trackTheme );
			}

			<span class="hljs-keyword">if</span> ( options.mini !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>._setMini( options.mini );
			}

			<span class="hljs-keyword">if</span> ( options.highlight !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>._setHighlight( options.highlight );
			}
			<span class="hljs-keyword">this</span>._super( options );
			<span class="hljs-keyword">this</span>.refresh();
		},

		refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> $el = <span class="hljs-keyword">this</span>.element,
				o = <span class="hljs-keyword">this</span>.options;

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._inputFirst.is( <span class="hljs-string">":disabled"</span> ) || <span class="hljs-keyword">this</span>._inputLast.is( <span class="hljs-string">":disabled"</span> ) ) {
				<span class="hljs-keyword">this</span>.options.disabled = <span class="hljs-literal">true</span>;
			}

			$el.find( <span class="hljs-string">"input"</span> ).slider({
				theme: o.theme,
				trackTheme: o.trackTheme,
				disabled: o.disabled,
				corners: o.corners,
				mini: o.mini,
				highlight: o.highlight
			}).slider( <span class="hljs-string">"refresh"</span> );
			<span class="hljs-keyword">this</span>._updateHighlight();
		},

		_change: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">if</span> ( event.type === <span class="hljs-string">"keyup"</span> ) {
				<span class="hljs-keyword">this</span>._updateHighlight();
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}

			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
				min = <span class="hljs-built_in">parseFloat</span>( <span class="hljs-keyword">this</span>._inputFirst.val(), <span class="hljs-number">10</span> ),
				max = <span class="hljs-built_in">parseFloat</span>( <span class="hljs-keyword">this</span>._inputLast.val(), <span class="hljs-number">10</span> ),
				first = $( event.target ).hasClass( <span class="hljs-string">"ui-rangeslider-first"</span> ),
				thisSlider = first ? <span class="hljs-keyword">this</span>._inputFirst : <span class="hljs-keyword">this</span>._inputLast,
				otherSlider = first ? <span class="hljs-keyword">this</span>._inputLast : <span class="hljs-keyword">this</span>._inputFirst;

			<span class="hljs-keyword">if</span> ( ( <span class="hljs-keyword">this</span>._inputFirst.val() &gt; <span class="hljs-keyword">this</span>._inputLast.val() &amp;&amp; event.type === <span class="hljs-string">"mousedown"</span> &amp;&amp; !$(event.target).hasClass(<span class="hljs-string">"ui-slider-handle"</span>)) ) {
				thisSlider.blur();
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( event.type === <span class="hljs-string">"mousedown"</span> ) {
				<span class="hljs-keyword">return</span>;
			}
			<span class="hljs-keyword">if</span> ( min &gt; max &amp;&amp; !<span class="hljs-keyword">this</span>._sliderTarget ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-752">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-752">&#182;</a>
              </div>
              <p>this prevents min from being greater then max</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				thisSlider.val( first ? max: min ).slider( <span class="hljs-string">"refresh"</span> );
				<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"normalize"</span> );
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( min &gt; max ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-753">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-753">&#182;</a>
              </div>
              <p>this makes it so clicks on the target on either extreme go to the closest handle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				thisSlider.val( <span class="hljs-keyword">this</span>._targetVal ).slider( <span class="hljs-string">"refresh"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-754">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-754">&#182;</a>
              </div>
              <p>You must wait for the stack to unwind so first slider is updated before updating second</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					otherSlider.val( first ? min: max ).slider( <span class="hljs-string">"refresh"</span> );
					$.data( otherSlider.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).handle.focus();
					self._sliderFirst.css( <span class="hljs-string">"z-index"</span>, first ? <span class="hljs-string">""</span> : <span class="hljs-number">1</span> );
					self._trigger( <span class="hljs-string">"normalize"</span> );
				}, <span class="hljs-number">0</span> );
				<span class="hljs-keyword">this</span>._proxy = ( first ) ? <span class="hljs-string">"first"</span> : <span class="hljs-string">"last"</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-755">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-755">&#182;</a>
              </div>
              <p>fixes issue where when both _sliders are at min they cannot be adjusted</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( min === max ) {
				$.data( thisSlider.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).handle.css( <span class="hljs-string">"z-index"</span>, <span class="hljs-number">1</span> );
				$.data( otherSlider.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).handle.css( <span class="hljs-string">"z-index"</span>, <span class="hljs-number">0</span> );
			} <span class="hljs-keyword">else</span> {
				$.data( otherSlider.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).handle.css( <span class="hljs-string">"z-index"</span>, <span class="hljs-string">""</span> );
				$.data( thisSlider.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).handle.css( <span class="hljs-string">"z-index"</span>, <span class="hljs-string">""</span> );
			}

			<span class="hljs-keyword">this</span>._updateHighlight();

			<span class="hljs-keyword">if</span> ( min &gt;= max ) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
		},

		_updateHighlight: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> min = <span class="hljs-built_in">parseInt</span>( $.data( <span class="hljs-keyword">this</span>._inputFirst.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).handle.get(<span class="hljs-number">0</span>).style.left, <span class="hljs-number">10</span> ),
				max = <span class="hljs-built_in">parseInt</span>( $.data( <span class="hljs-keyword">this</span>._inputLast.get(<span class="hljs-number">0</span>), <span class="hljs-string">"mobile-slider"</span> ).handle.get(<span class="hljs-number">0</span>).style.left, <span class="hljs-number">10</span> ),
				width = (max - min);

			<span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">".ui-slider-bg"</span> ).css({
				<span class="hljs-string">"margin-left"</span>: min + <span class="hljs-string">"%"</span>,
				<span class="hljs-string">"width"</span>: width + <span class="hljs-string">"%"</span>
			});
		},

		_setTheme: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
			<span class="hljs-keyword">this</span>._inputFirst.slider( <span class="hljs-string">"option"</span>, <span class="hljs-string">"theme"</span>, value );
			<span class="hljs-keyword">this</span>._inputLast.slider( <span class="hljs-string">"option"</span>, <span class="hljs-string">"theme"</span>, value );
		},

		_setTrackTheme: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
			<span class="hljs-keyword">this</span>._inputFirst.slider( <span class="hljs-string">"option"</span>, <span class="hljs-string">"trackTheme"</span>, value );
			<span class="hljs-keyword">this</span>._inputLast.slider( <span class="hljs-string">"option"</span>, <span class="hljs-string">"trackTheme"</span>, value );
		},

		_setMini: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
			<span class="hljs-keyword">this</span>._inputFirst.slider( <span class="hljs-string">"option"</span>, <span class="hljs-string">"mini"</span>, value );
			<span class="hljs-keyword">this</span>._inputLast.slider( <span class="hljs-string">"option"</span>, <span class="hljs-string">"mini"</span>, value );
			<span class="hljs-keyword">this</span>.element.toggleClass( <span class="hljs-string">"ui-mini"</span>, !!value );
		},

		_setHighlight: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
			<span class="hljs-keyword">this</span>._inputFirst.slider( <span class="hljs-string">"option"</span>, <span class="hljs-string">"highlight"</span>, value );
			<span class="hljs-keyword">this</span>._inputLast.slider( <span class="hljs-string">"option"</span>, <span class="hljs-string">"highlight"</span>, value );
		},

		_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._label.prependTo( <span class="hljs-keyword">this</span>.element );
			<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-rangeslider ui-mini"</span> );
			<span class="hljs-keyword">this</span>._inputFirst.after( <span class="hljs-keyword">this</span>._sliderFirst );
			<span class="hljs-keyword">this</span>._inputLast.after( <span class="hljs-keyword">this</span>._sliderLast );
			<span class="hljs-keyword">this</span>._sliders.remove();
			<span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"input"</span> ).removeClass( <span class="hljs-string">"ui-rangeslider-first ui-rangeslider-last"</span> ).slider( <span class="hljs-string">"destroy"</span> );
		}

	}, $.mobile.behaviors.formReset ) );

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

	$.widget( <span class="hljs-string">"mobile.textinput"</span>, $.mobile.textinput, {
		options: {
			clearBtn: <span class="hljs-literal">false</span>,
			clearBtnText: <span class="hljs-string">"Clear text"</span>
		},

		_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._super();

			<span class="hljs-keyword">if</span> ( !!<span class="hljs-keyword">this</span>.options.clearBtn || <span class="hljs-keyword">this</span>.isSearch ) {
				<span class="hljs-keyword">this</span>._addClearBtn();
			}
		},

		clearButton: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

			<span class="hljs-keyword">return</span> $( <span class="hljs-string">"&lt;a href='#' class='ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all"</span> +
    <span class="hljs-string">"' title='"</span> + <span class="hljs-keyword">this</span>.options.clearBtnText + <span class="hljs-string">"'&gt;"</span> + <span class="hljs-keyword">this</span>.options.clearBtnText + <span class="hljs-string">"&lt;/a&gt;"</span> );

		},

		_clearBtnClick: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">this</span>.element.val( <span class="hljs-string">""</span> )
					.focus()
					.trigger( <span class="hljs-string">"change"</span> );

			<span class="hljs-keyword">this</span>._clearBtn.addClass( <span class="hljs-string">"ui-input-clear-hidden"</span> );
			event.preventDefault();
		},

		_addClearBtn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.options.enhanced ) {
				<span class="hljs-keyword">this</span>._enhanceClear();
			}

			$.extend( <span class="hljs-keyword">this</span>, {
				_clearBtn: <span class="hljs-keyword">this</span>.widget().find(<span class="hljs-string">"a.ui-input-clear"</span>)
			});

			<span class="hljs-keyword">this</span>._bindClearEvents();

			<span class="hljs-keyword">this</span>._toggleClear();

		},

		_enhanceClear: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

			<span class="hljs-keyword">this</span>.clearButton().appendTo( <span class="hljs-keyword">this</span>.widget() );
			<span class="hljs-keyword">this</span>.widget().addClass( <span class="hljs-string">"ui-input-has-clear"</span> );

		},

		_bindClearEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>._clearBtn, {
				<span class="hljs-string">"click"</span>: <span class="hljs-string">"_clearBtnClick"</span>
			});

			<span class="hljs-keyword">this</span>._on({
				<span class="hljs-string">"keyup"</span>: <span class="hljs-string">"_toggleClear"</span>,
				<span class="hljs-string">"change"</span>: <span class="hljs-string">"_toggleClear"</span>,
				<span class="hljs-string">"input"</span>: <span class="hljs-string">"_toggleClear"</span>,
				<span class="hljs-string">"focus"</span>: <span class="hljs-string">"_toggleClear"</span>,
				<span class="hljs-string">"blur"</span>: <span class="hljs-string">"_toggleClear"</span>,
				<span class="hljs-string">"cut"</span>: <span class="hljs-string">"_toggleClear"</span>,
				<span class="hljs-string">"paste"</span>: <span class="hljs-string">"_toggleClear"</span>

			});

		},

		_unbindClear: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._off( <span class="hljs-keyword">this</span>._clearBtn, <span class="hljs-string">"click"</span>);
			<span class="hljs-keyword">this</span>._off( <span class="hljs-keyword">this</span>.element, <span class="hljs-string">"keyup change input focus blur cut paste"</span> );
		},

		_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
			<span class="hljs-keyword">this</span>._super( options );

			<span class="hljs-keyword">if</span> ( options.clearBtn !== <span class="hljs-literal">undefined</span> &amp;&amp;
				!<span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">"textarea, :jqmData(type='range')"</span> ) ) {
				<span class="hljs-keyword">if</span> ( options.clearBtn ) {
					<span class="hljs-keyword">this</span>._addClearBtn();
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">this</span>._destroyClear();
				}
			}

			<span class="hljs-keyword">if</span> ( options.clearBtnText !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>._clearBtn !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>._clearBtn.text( options.clearBtnText )
					.attr(<span class="hljs-string">"title"</span>, options.clearBtnText);
			}
		},

		_toggleClear: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._delay( <span class="hljs-string">"_toggleClearClass"</span>, <span class="hljs-number">0</span> );
		},

		_toggleClearClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._clearBtn.toggleClass( <span class="hljs-string">"ui-input-clear-hidden"</span>, !<span class="hljs-keyword">this</span>.element.val() );
		},

		_destroyClear: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.widget().removeClass( <span class="hljs-string">"ui-input-has-clear"</span> );
			<span class="hljs-keyword">this</span>._unbindClear();
			<span class="hljs-keyword">this</span>._clearBtn.remove();
		},

		_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._super();
			<span class="hljs-keyword">this</span>._destroyClear();
		}

	});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

	$.widget( <span class="hljs-string">"mobile.textinput"</span>, $.mobile.textinput, {
		options: {
			autogrow:<span class="hljs-literal">true</span>,
			keyupTimeoutBuffer: <span class="hljs-number">100</span>
		},

		_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._super();

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.autogrow &amp;&amp; <span class="hljs-keyword">this</span>.isTextarea ) {
				<span class="hljs-keyword">this</span>._autogrow();
			}
		},

		_autogrow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-string">"ui-textinput-autogrow"</span> );

			<span class="hljs-keyword">this</span>._on({
				<span class="hljs-string">"keyup"</span>: <span class="hljs-string">"_timeout"</span>,
				<span class="hljs-string">"change"</span>: <span class="hljs-string">"_timeout"</span>,
				<span class="hljs-string">"input"</span>: <span class="hljs-string">"_timeout"</span>,
				<span class="hljs-string">"paste"</span>: <span class="hljs-string">"_timeout"</span>
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-756">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-756">&#182;</a>
              </div>
              <p>Attach to the various you-have-become-visible notifications that the
various framework elements emit.
TODO: Remove all but the updatelayout handler once #6426 is fixed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._on( <span class="hljs-literal">true</span>, <span class="hljs-keyword">this</span>.document, {</pre></div></div>
            
        </li>
        
        
        <li id="section-757">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-757">&#182;</a>
              </div>
              <p>TODO: Move to non-deprecated event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-string">"pageshow"</span>: <span class="hljs-string">"_handleShow"</span>,
				<span class="hljs-string">"popupbeforeposition"</span>: <span class="hljs-string">"_handleShow"</span>,
				<span class="hljs-string">"updatelayout"</span>: <span class="hljs-string">"_handleShow"</span>,
				<span class="hljs-string">"panelopen"</span>: <span class="hljs-string">"_handleShow"</span>
			});
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-758">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-758">&#182;</a>
              </div>
              <p>Synchronously fix the widget height if this widget’s parents are such
that they show/hide content at runtime. We still need to check whether
the widget is actually visible in case it is contained inside multiple
such containers. For example: panel contains collapsible contains
autogrow textinput. The panel may emit “panelopen” indicating that its
content has become visible, but the collapsible is still collapsed, so
the autogrow textarea is still not visible.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_handleShow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
			<span class="hljs-keyword">if</span> ( $.contains( event.target, <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ] ) &amp;&amp;
				<span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">":visible"</span> ) ) {

				<span class="hljs-keyword">if</span> ( event.type !== <span class="hljs-string">"popupbeforeposition"</span> ) {
					<span class="hljs-keyword">this</span>.element
						.addClass( <span class="hljs-string">"ui-textinput-autogrow-resize"</span> )
						.animationComplete(
							$.proxy( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
								<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-textinput-autogrow-resize"</span> );
							}, <span class="hljs-keyword">this</span> ),
						<span class="hljs-string">"transition"</span> );
				}
				<span class="hljs-keyword">this</span>._timeout();
			}
		},

		_unbindAutogrow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-textinput-autogrow"</span> );
			<span class="hljs-keyword">this</span>._off( <span class="hljs-keyword">this</span>.element, <span class="hljs-string">"keyup change input paste"</span> );
			<span class="hljs-keyword">this</span>._off( <span class="hljs-keyword">this</span>.document,
				<span class="hljs-string">"pageshow popupbeforeposition updatelayout panelopen"</span> );
		},

		keyupTimeout: <span class="hljs-literal">null</span>,

		_prepareHeightUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( delay )</span> {</span>
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.keyupTimeout ) {
				clearTimeout( <span class="hljs-keyword">this</span>.keyupTimeout );
			}
			<span class="hljs-keyword">if</span> ( delay === <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>._updateHeight();
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.keyupTimeout = <span class="hljs-keyword">this</span>._delay( <span class="hljs-string">"_updateHeight"</span>, delay );
			}
		},

		_timeout: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._prepareHeightUpdate( <span class="hljs-keyword">this</span>.options.keyupTimeoutBuffer );
		},

		_updateHeight: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> paddingTop, paddingBottom, paddingHeight, scrollHeight, clientHeight,
				borderTop, borderBottom, borderHeight, height,
				scrollTop = <span class="hljs-keyword">this</span>.window.scrollTop();
			<span class="hljs-keyword">this</span>.keyupTimeout = <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-759">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-759">&#182;</a>
              </div>
              <p>IE8 textareas have the onpage property - others do not</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !( <span class="hljs-string">"onpage"</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ] ) ) {
				<span class="hljs-keyword">this</span>.element.css({
					<span class="hljs-string">"height"</span>: <span class="hljs-number">0</span>,
					<span class="hljs-string">"min-height"</span>: <span class="hljs-number">0</span>,
					<span class="hljs-string">"max-height"</span>: <span class="hljs-number">0</span>
				});
			}

			scrollHeight = <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ].scrollHeight;
			clientHeight = <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ].clientHeight;
			borderTop = <span class="hljs-built_in">parseFloat</span>( <span class="hljs-keyword">this</span>.element.css( <span class="hljs-string">"border-top-width"</span> ) );
			borderBottom = <span class="hljs-built_in">parseFloat</span>( <span class="hljs-keyword">this</span>.element.css( <span class="hljs-string">"border-bottom-width"</span> ) );
			borderHeight = borderTop + borderBottom;
			height = scrollHeight + borderHeight + <span class="hljs-number">15</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-760">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-760">&#182;</a>
              </div>
              <p>Issue 6179: Padding is not included in scrollHeight and
clientHeight by Firefox if no scrollbar is visible. Because
textareas use the border-box box-sizing model, padding should be
included in the new (assigned) height. Because the height is set
to 0, clientHeight == 0 in Firefox. Therefore, we can use this to
check if padding must be added.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( clientHeight === <span class="hljs-number">0</span> ) {
				paddingTop = <span class="hljs-built_in">parseFloat</span>( <span class="hljs-keyword">this</span>.element.css( <span class="hljs-string">"padding-top"</span> ) );
				paddingBottom = <span class="hljs-built_in">parseFloat</span>( <span class="hljs-keyword">this</span>.element.css( <span class="hljs-string">"padding-bottom"</span> ) );
				paddingHeight = paddingTop + paddingBottom;

				height += paddingHeight;
			}

			<span class="hljs-keyword">this</span>.element.css({
				<span class="hljs-string">"height"</span>: height,
				<span class="hljs-string">"min-height"</span>: <span class="hljs-string">""</span>,
				<span class="hljs-string">"max-height"</span>: <span class="hljs-string">""</span>
			});

			<span class="hljs-keyword">this</span>.window.scrollTop( scrollTop );
		},

		refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.autogrow &amp;&amp; <span class="hljs-keyword">this</span>.isTextarea ) {
				<span class="hljs-keyword">this</span>._updateHeight();
			}
		},

		_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>

			<span class="hljs-keyword">this</span>._super( options );

			<span class="hljs-keyword">if</span> ( options.autogrow !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>.isTextarea ) {
				<span class="hljs-keyword">if</span> ( options.autogrow ) {
					<span class="hljs-keyword">this</span>._autogrow();
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">this</span>._unbindAutogrow();
				}
			}
		}

	});
})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.selectmenu"</span>, $.extend( {
	initSelector: <span class="hljs-string">"select:not( :jqmData(role='slider')):not( :jqmData(role='flipswitch') )"</span>,

	options: {
		theme: <span class="hljs-literal">null</span>,
		icon: <span class="hljs-string">"carat-d"</span>,
		iconpos: <span class="hljs-string">"right"</span>,
		inline: <span class="hljs-literal">false</span>,
		corners: <span class="hljs-literal">true</span>,
		shadow: <span class="hljs-literal">true</span>,
		iconshadow: <span class="hljs-literal">false</span>, <span class="hljs-comment">/* TODO: Deprecated in 1.4, remove in 1.5. */</span>
		overlayTheme: <span class="hljs-literal">null</span>,
		dividerTheme: <span class="hljs-literal">null</span>,
		hidePlaceholderMenuItems: <span class="hljs-literal">true</span>,
		closeText: <span class="hljs-string">"Close"</span>,
		nativeMenu: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-761">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-761">&#182;</a>
              </div>
              <p>This option defaults to true on iOS devices.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		preventFocusZoom: <span class="hljs-regexp">/iPhone|iPad|iPod/</span>.test( navigator.platform ) &amp;&amp; navigator.userAgent.indexOf( <span class="hljs-string">"AppleWebKit"</span> ) &gt; -<span class="hljs-number">1</span>,
		mini: <span class="hljs-literal">false</span>
	},

	_button: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> $( <span class="hljs-string">"&lt;div/&gt;"</span> );
	},

	_setDisabled: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		<span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"disabled"</span>, value );
		<span class="hljs-keyword">this</span>.button.attr( <span class="hljs-string">"aria-disabled"</span>, value );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._setOption( <span class="hljs-string">"disabled"</span>, value );
	},

	_focusButton : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

		setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			self.button.focus();
		}, <span class="hljs-number">40</span>);
	},

	_selectOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.select.find( <span class="hljs-string">"option"</span> );
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-762">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-762">&#182;</a>
              </div>
              <p>setup items that are generally necessary for select menu extension</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_preExtension: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> inline = <span class="hljs-keyword">this</span>.options.inline || <span class="hljs-keyword">this</span>.element.jqmData( <span class="hljs-string">"inline"</span> ),
			mini = <span class="hljs-keyword">this</span>.options.mini || <span class="hljs-keyword">this</span>.element.jqmData( <span class="hljs-string">"mini"</span> ),
			classes = <span class="hljs-string">""</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-763">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-763">&#182;</a>
              </div>
              <p>TODO: Post 1.1—once we have time to test thoroughly—any classes manually applied to the original element should be carried over to the enhanced element, with an <code>-enhanced</code> suffix. See <a href="https://github.com/jquery/jquery-mobile/issues/3577">https://github.com/jquery/jquery-mobile/issues/3577</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-comment">/* if ( $el[0].className.length ) {
			classes = $el[0].className;
		} */</span>
		<span class="hljs-keyword">if</span> ( !!~<span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].className.indexOf( <span class="hljs-string">"ui-btn-left"</span> ) ) {
			classes = <span class="hljs-string">" ui-btn-left"</span>;
		}

		<span class="hljs-keyword">if</span> (  !!~<span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].className.indexOf( <span class="hljs-string">"ui-btn-right"</span> ) ) {
			classes = <span class="hljs-string">" ui-btn-right"</span>;
		}

		<span class="hljs-keyword">if</span> ( inline ) {
			classes += <span class="hljs-string">" ui-btn-inline"</span>;
		}
		<span class="hljs-keyword">if</span> ( mini ) {
			classes += <span class="hljs-string">" ui-mini"</span>;
		}

		<span class="hljs-keyword">this</span>.select = <span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-btn-left ui-btn-right"</span> ).wrap( <span class="hljs-string">"&lt;div class='ui-select"</span> + classes + <span class="hljs-string">"'&gt;"</span> );
		<span class="hljs-keyword">this</span>.selectId  = <span class="hljs-keyword">this</span>.select.attr( <span class="hljs-string">"id"</span> ) || ( <span class="hljs-string">"select-"</span> + <span class="hljs-keyword">this</span>.uuid );
		<span class="hljs-keyword">this</span>.buttonId = <span class="hljs-keyword">this</span>.selectId + <span class="hljs-string">"-button"</span>;
		<span class="hljs-keyword">this</span>.label = $( <span class="hljs-string">"label[for='"</span>+ <span class="hljs-keyword">this</span>.selectId +<span class="hljs-string">"']"</span> );
		<span class="hljs-keyword">this</span>.isMultiple = <span class="hljs-keyword">this</span>.select[ <span class="hljs-number">0</span> ].multiple;
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> wrapper = <span class="hljs-keyword">this</span>.element.parents( <span class="hljs-string">".ui-select"</span> );
		<span class="hljs-keyword">if</span> ( wrapper.length &gt; <span class="hljs-number">0</span> ) {
			<span class="hljs-keyword">if</span> ( wrapper.is( <span class="hljs-string">".ui-btn-left, .ui-btn-right"</span> ) ) {
				<span class="hljs-keyword">this</span>.element.addClass( wrapper.hasClass( <span class="hljs-string">"ui-btn-left"</span> ) ? <span class="hljs-string">"ui-btn-left"</span> : <span class="hljs-string">"ui-btn-right"</span> );
			}
			<span class="hljs-keyword">this</span>.element.insertAfter( wrapper );
			wrapper.remove();
		}
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._preExtension();

		<span class="hljs-keyword">this</span>.button = <span class="hljs-keyword">this</span>._button();

		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,

			options = <span class="hljs-keyword">this</span>.options,

			iconpos = options.icon ? ( options.iconpos || <span class="hljs-keyword">this</span>.select.jqmData( <span class="hljs-string">"iconpos"</span> ) ) : <span class="hljs-literal">false</span>,

			button = <span class="hljs-keyword">this</span>.button
				.insertBefore( <span class="hljs-keyword">this</span>.select )
				.attr( <span class="hljs-string">"id"</span>, <span class="hljs-keyword">this</span>.buttonId )
				.addClass( <span class="hljs-string">"ui-btn"</span> +
					( options.icon ? ( <span class="hljs-string">" ui-icon-"</span> + options.icon + <span class="hljs-string">" ui-btn-icon-"</span> + iconpos +
					( options.iconshadow ? <span class="hljs-string">" ui-shadow-icon"</span> : <span class="hljs-string">""</span> ) ) :	<span class="hljs-string">""</span> ) + <span class="hljs-comment">/* TODO: Remove in 1.5. */</span>
					( options.theme ? <span class="hljs-string">" ui-btn-"</span> + options.theme : <span class="hljs-string">""</span> ) +
					( options.corners ? <span class="hljs-string">" ui-corner-all"</span> : <span class="hljs-string">""</span> ) +
					( options.shadow ? <span class="hljs-string">" ui-shadow"</span> : <span class="hljs-string">""</span> ) );

		<span class="hljs-keyword">this</span>.setButtonText();</pre></div></div>
            
        </li>
        
        
        <li id="section-764">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-764">&#182;</a>
              </div>
              <p>Opera does not properly support opacity on select elements
In Mini, it hides the element, but not its text
On the desktop,it seems to do the opposite
for these reasons, using the nativeMenu option results in a full native select in Opera</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( options.nativeMenu &amp;&amp; window.opera &amp;&amp; window.opera.version ) {
			button.addClass( <span class="hljs-string">"ui-select-nativeonly"</span> );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-765">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-765">&#182;</a>
              </div>
              <p>Add counter for multi selects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isMultiple ) {
			<span class="hljs-keyword">this</span>.buttonCount = $( <span class="hljs-string">"&lt;span&gt;"</span> )
				.addClass( <span class="hljs-string">"ui-li-count ui-body-inherit"</span> )
				.hide()
				.appendTo( button.addClass( <span class="hljs-string">"ui-li-has-count"</span> ) );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-766">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-766">&#182;</a>
              </div>
              <p>Disable if specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( options.disabled || <span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"disabled"</span> )) {
			<span class="hljs-keyword">this</span>.disable();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-767">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-767">&#182;</a>
              </div>
              <p>Events on native select</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.select.change(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			self.refresh();

			<span class="hljs-keyword">if</span> ( !!options.nativeMenu ) {
				<span class="hljs-keyword">this</span>.blur();
			}
		});

		<span class="hljs-keyword">this</span>._handleFormReset();

		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.button, {
			keydown: <span class="hljs-string">"_handleKeydown"</span>
		});

		<span class="hljs-keyword">this</span>.build();
	},

	build: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">this</span>.select
			.appendTo( self.button )
			.bind( <span class="hljs-string">"vmousedown"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-768">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-768">&#182;</a>
              </div>
              <p>Add active class to button</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				self.button.addClass( $.mobile.activeBtnClass );
			})
			.bind( <span class="hljs-string">"focus"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				self.button.addClass( $.mobile.focusClass );
			})
			.bind( <span class="hljs-string">"blur"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				self.button.removeClass( $.mobile.focusClass );
			})
			.bind( <span class="hljs-string">"focus vmouseover"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				self.button.trigger( <span class="hljs-string">"vmouseover"</span> );
			})
			.bind( <span class="hljs-string">"vmousemove"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-769">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-769">&#182;</a>
              </div>
              <p>Remove active class on scroll/touchmove</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				self.button.removeClass( $.mobile.activeBtnClass );
			})
			.bind( <span class="hljs-string">"change blur vmouseout"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				self.button.trigger( <span class="hljs-string">"vmouseout"</span> )
					.removeClass( $.mobile.activeBtnClass );
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-770">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-770">&#182;</a>
              </div>
              <p>In many situations, iOS will zoom into the select upon tap, this prevents that from happening</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		self.button.bind( <span class="hljs-string">"vmousedown"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( self.options.preventFocusZoom ) {
					$.mobile.zoom.disable( <span class="hljs-literal">true</span> );
			}
		});
		self.label.bind( <span class="hljs-string">"click focus"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( self.options.preventFocusZoom ) {
					$.mobile.zoom.disable( <span class="hljs-literal">true</span> );
			}
		});
		self.select.bind( <span class="hljs-string">"focus"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( self.options.preventFocusZoom ) {
					$.mobile.zoom.disable( <span class="hljs-literal">true</span> );
			}
		});
		self.button.bind( <span class="hljs-string">"mouseup"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( self.options.preventFocusZoom ) {
				setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					$.mobile.zoom.enable( <span class="hljs-literal">true</span> );
				}, <span class="hljs-number">0</span> );
			}
		});
		self.select.bind( <span class="hljs-string">"blur"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( self.options.preventFocusZoom ) {
				$.mobile.zoom.enable( <span class="hljs-literal">true</span> );
			}
		});

	},

	selected: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._selectOptions().filter( <span class="hljs-string">":selected"</span> );
	},

	selectedIndices: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.selected().map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> self._selectOptions().index( <span class="hljs-keyword">this</span> );
		}).get();
	},

	setButtonText: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
			selected = <span class="hljs-keyword">this</span>.selected(),
			text = <span class="hljs-keyword">this</span>.placeholder,
			span = $( document.createElement( <span class="hljs-string">"span"</span> ) );

		<span class="hljs-keyword">this</span>.button.children( <span class="hljs-string">"span"</span> ).not( <span class="hljs-string">".ui-li-count"</span> ).remove().end().end().prepend( (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( selected.length ) {
				text = selected.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">return</span> $( <span class="hljs-keyword">this</span> ).text();
				}).get().join( <span class="hljs-string">", "</span> );
			} <span class="hljs-keyword">else</span> {
				text = self.placeholder;
			}

			<span class="hljs-keyword">if</span> ( text ) {
				span.text( text );
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-771">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-771">&#182;</a>
              </div>
              <p>Set the contents to &nbsp; which we write as &#160; to be XHTML compliant - see gh-6699</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				span.html( <span class="hljs-string">"&amp;#160;"</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-772">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-772">&#182;</a>
              </div>
              <p>TODO possibly aggregate multiple select option classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">return</span> span
				.addClass( self.select.attr( <span class="hljs-string">"class"</span> ) )
				.addClass( selected.attr( <span class="hljs-string">"class"</span> ) )
				.removeClass( <span class="hljs-string">"ui-screen-hidden"</span> );
		})());
	},

	setButtonCount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> selected = <span class="hljs-keyword">this</span>.selected();</pre></div></div>
            
        </li>
        
        
        <li id="section-773">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-773">&#182;</a>
              </div>
              <p>multiple count inside button</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isMultiple ) {
			<span class="hljs-keyword">this</span>.buttonCount[ selected.length &gt; <span class="hljs-number">1</span> ? <span class="hljs-string">"show"</span> : <span class="hljs-string">"hide"</span> ]().text( selected.length );
		}
	},

	_handleKeydown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( <span class="hljs-comment">/* event */</span> )</span> {</span>
		<span class="hljs-keyword">this</span>._delay( <span class="hljs-string">"_refreshButton"</span> );
	},

	_reset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.refresh();
	},

	_refreshButton: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.setButtonText();
		<span class="hljs-keyword">this</span>.setButtonCount();
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._refreshButton();
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-774">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-774">&#182;</a>
              </div>
              <p>open and close preserved in native selects
to simplify users code when looping over selects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	open: $.noop,
	close: $.noop,

	disable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._setDisabled( <span class="hljs-literal">true</span> );
		<span class="hljs-keyword">this</span>.button.addClass( <span class="hljs-string">"ui-state-disabled"</span> );
	},

	enable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._setDisabled( <span class="hljs-literal">false</span> );
		<span class="hljs-keyword">this</span>.button.removeClass( <span class="hljs-string">"ui-state-disabled"</span> );
	}
}, $.mobile.behaviors.formReset ) );

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.mobile.links = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( target )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-775">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-775">&#182;</a>
              </div>
              <p>links within content areas, tests included with page</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$( target )
		.find( <span class="hljs-string">"a"</span> )
		.jqmEnhanceable()
		.filter( <span class="hljs-string">":jqmData(rel='popup')[href][href!='']"</span> )
		.each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-776">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-776">&#182;</a>
              </div>
              <p>Accessibility info for popups</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> element = <span class="hljs-keyword">this</span>,
				idref = element.getAttribute( <span class="hljs-string">"href"</span> ).substring( <span class="hljs-number">1</span> );

			<span class="hljs-keyword">if</span> ( idref ) {
				element.setAttribute( <span class="hljs-string">"aria-haspopup"</span>, <span class="hljs-literal">true</span> );
				element.setAttribute( <span class="hljs-string">"aria-owns"</span>, idref );
				element.setAttribute( <span class="hljs-string">"aria-expanded"</span>, <span class="hljs-literal">false</span> );
			}
		})
		.end()
		.not( <span class="hljs-string">".ui-btn, :jqmData(role='none'), :jqmData(role='nojs')"</span> )
		.addClass( <span class="hljs-string">"ui-link"</span> );

};

})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fitSegmentInsideSegment</span><span class="hljs-params">( windowSize, segmentSize, offset, desired )</span> {</span>
	<span class="hljs-keyword">var</span> returnValue = desired;

	<span class="hljs-keyword">if</span> ( windowSize &lt; segmentSize ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-777">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-777">&#182;</a>
              </div>
              <p>Center segment if it’s bigger than the window</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		returnValue = offset + ( windowSize - segmentSize ) / <span class="hljs-number">2</span>;
	} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-778">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-778">&#182;</a>
              </div>
              <p>Otherwise center it at the desired coordinate while keeping it completely inside the window</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		returnValue = <span class="hljs-built_in">Math</span>.min( <span class="hljs-built_in">Math</span>.max( offset, desired - segmentSize / <span class="hljs-number">2</span> ), offset + windowSize - segmentSize );
	}

	<span class="hljs-keyword">return</span> returnValue;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getWindowCoordinates</span><span class="hljs-params">( theWindow )</span> {</span>
	<span class="hljs-keyword">return</span> {
		x: theWindow.scrollLeft(),
		y: theWindow.scrollTop(),
		cx: ( theWindow[ <span class="hljs-number">0</span> ].innerWidth || theWindow.width() ),
		cy: ( theWindow[ <span class="hljs-number">0</span> ].innerHeight || theWindow.height() )
	};
}

$.widget( <span class="hljs-string">"mobile.popup"</span>, {
	options: {
		wrapperClass: <span class="hljs-literal">null</span>,
		theme: <span class="hljs-literal">null</span>,
		overlayTheme: <span class="hljs-literal">null</span>,
		shadow: <span class="hljs-literal">true</span>,
		corners: <span class="hljs-literal">true</span>,
		transition: <span class="hljs-string">"none"</span>,
		positionTo: <span class="hljs-string">"origin"</span>,
		tolerance: <span class="hljs-literal">null</span>,
		closeLinkSelector: <span class="hljs-string">"a:jqmData(rel='back')"</span>,
		closeLinkEvents: <span class="hljs-string">"click.popup"</span>,
		navigateEvents: <span class="hljs-string">"navigate.popup"</span>,
		closeEvents: <span class="hljs-string">"navigate.popup pagebeforechange.popup"</span>,
		dismissible: <span class="hljs-literal">true</span>,
		enhanced: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-779">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-779">&#182;</a>
              </div>
              <p>NOTE Windows Phone 7 has a scroll position caching issue that
     requires us to disable popup history management by default
     <a href="https://github.com/jquery/jquery-mobile/issues/4784">https://github.com/jquery/jquery-mobile/issues/4784</a></p>
<p>NOTE this option is modified in _create!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		history: !$.mobile.browser.oldIE
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> theElement = <span class="hljs-keyword">this</span>.element,
			myId = theElement.attr( <span class="hljs-string">"id"</span> ),
			currentOptions = <span class="hljs-keyword">this</span>.options;</pre></div></div>
            
        </li>
        
        
        <li id="section-780">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-780">&#182;</a>
              </div>
              <p>We need to adjust the history option to be false if there’s no AJAX nav.
We can’t do it in the option declarations because those are run before
it is determined whether there shall be AJAX nav.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		currentOptions.history = currentOptions.history &amp;&amp; $.mobile.ajaxEnabled &amp;&amp; $.mobile.hashListeningEnabled;</pre></div></div>
            
        </li>
        
        
        <li id="section-781">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-781">&#182;</a>
              </div>
              <p>Define instance variables</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.extend( <span class="hljs-keyword">this</span>, {
			_scrollTop: <span class="hljs-number">0</span>,
			_page: theElement.closest( <span class="hljs-string">".ui-page"</span> ),
			_ui: <span class="hljs-literal">null</span>,
			_fallbackTransition: <span class="hljs-string">""</span>,
			_currentTransition: <span class="hljs-literal">false</span>,
			_prerequisites: <span class="hljs-literal">null</span>,
			_isOpen: <span class="hljs-literal">false</span>,
			_tolerance: <span class="hljs-literal">null</span>,
			_resizeData: <span class="hljs-literal">null</span>,
			_ignoreResizeTo: <span class="hljs-number">0</span>,
			_orientationchangeInProgress: <span class="hljs-literal">false</span>
		});

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._page.length === <span class="hljs-number">0</span> ) {
			<span class="hljs-keyword">this</span>._page = $( <span class="hljs-string">"body"</span> );
		}

		<span class="hljs-keyword">if</span> ( currentOptions.enhanced ) {
			<span class="hljs-keyword">this</span>._ui = {
				container: theElement.parent(),
				screen: theElement.parent().prev(),
				placeholder: $( <span class="hljs-keyword">this</span>.document[ <span class="hljs-number">0</span> ].getElementById( myId + <span class="hljs-string">"-placeholder"</span> ) )
			};
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>._ui = <span class="hljs-keyword">this</span>._enhance( theElement, myId );
			<span class="hljs-keyword">this</span>._applyTransition( currentOptions.transition );
		}
		<span class="hljs-keyword">this</span>
			._setTolerance( currentOptions.tolerance )
			._ui.focusElement = <span class="hljs-keyword">this</span>._ui.container;</pre></div></div>
            
        </li>
        
        
        <li id="section-782">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-782">&#182;</a>
              </div>
              <p>Event handlers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>._ui.screen, { <span class="hljs-string">"vclick"</span>: <span class="hljs-string">"_eatEventAndClose"</span> } );
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.window, {
			orientationchange: $.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_handleWindowOrientationchange"</span> ),
			resize: $.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_handleWindowResize"</span> ),
			keyup: $.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_handleWindowKeyUp"</span> )
		});
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.document, { <span class="hljs-string">"focusin"</span>: <span class="hljs-string">"_handleDocumentFocusIn"</span> } );
	},

	_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theElement, myId )</span> {</span>
		<span class="hljs-keyword">var</span> currentOptions = <span class="hljs-keyword">this</span>.options,
			wrapperClass = currentOptions.wrapperClass,
			ui = {
				screen: $( <span class="hljs-string">"&lt;div class='ui-screen-hidden ui-popup-screen "</span> +
				<span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-overlay-"</span>, currentOptions.overlayTheme ) + <span class="hljs-string">"'&gt;&lt;/div&gt;"</span> ),
				placeholder: $( <span class="hljs-string">"&lt;div style='display: none;'&gt;&lt;!-- placeholder --&gt;&lt;/div&gt;"</span> ),
				container: $( <span class="hljs-string">"&lt;div class='ui-popup-container ui-popup-hidden ui-popup-truncate"</span> +
					( wrapperClass ? ( <span class="hljs-string">" "</span> + wrapperClass ) : <span class="hljs-string">""</span> ) + <span class="hljs-string">"'&gt;&lt;/div&gt;"</span> )
			},
			fragment = <span class="hljs-keyword">this</span>.document[ <span class="hljs-number">0</span> ].createDocumentFragment();

		fragment.appendChild( ui.screen[ <span class="hljs-number">0</span> ] );
		fragment.appendChild( ui.container[ <span class="hljs-number">0</span> ] );

		<span class="hljs-keyword">if</span> ( myId ) {
			ui.screen.attr( <span class="hljs-string">"id"</span>, myId + <span class="hljs-string">"-screen"</span> );
			ui.container.attr( <span class="hljs-string">"id"</span>, myId + <span class="hljs-string">"-popup"</span> );
			ui.placeholder
				.attr( <span class="hljs-string">"id"</span>, myId + <span class="hljs-string">"-placeholder"</span> )
				.html( <span class="hljs-string">"&lt;!-- placeholder for "</span> + myId + <span class="hljs-string">" --&gt;"</span> );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-783">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-783">&#182;</a>
              </div>
              <p>Apply the proto</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._page[ <span class="hljs-number">0</span> ].appendChild( fragment );</pre></div></div>
            
        </li>
        
        
        <li id="section-784">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-784">&#182;</a>
              </div>
              <p>Leave a placeholder where the element used to be</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		ui.placeholder.insertAfter( theElement );
		theElement
			.detach()
			.addClass( <span class="hljs-string">"ui-popup "</span> +
				<span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-body-"</span>, currentOptions.theme ) + <span class="hljs-string">" "</span> +
				( currentOptions.shadow ? <span class="hljs-string">"ui-overlay-shadow "</span> : <span class="hljs-string">""</span> ) +
				( currentOptions.corners ? <span class="hljs-string">"ui-corner-all "</span> : <span class="hljs-string">""</span> ) )
			.appendTo( ui.container );

		<span class="hljs-keyword">return</span> ui;
	},

	_eatEventAndClose: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theEvent )</span> {</span>
		theEvent.preventDefault();
		theEvent.stopImmediatePropagation();
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.dismissible ) {
			<span class="hljs-keyword">this</span>.close();
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-785">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-785">&#182;</a>
              </div>
              <p>Make sure the screen covers the entire document - CSS is sometimes not
enough to accomplish this.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_resizeScreen: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> screen = <span class="hljs-keyword">this</span>._ui.screen,
			popupHeight = <span class="hljs-keyword">this</span>._ui.container.outerHeight( <span class="hljs-literal">true</span> ),
			screenHeight = screen.removeAttr( <span class="hljs-string">"style"</span> ).height(),</pre></div></div>
            
        </li>
        
        
        <li id="section-786">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-786">&#182;</a>
              </div>
              <p>Subtracting 1 here is necessary for an obscure Andrdoid 4.0 bug where
the browser hangs if the screen covers the entire document :/</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			documentHeight = <span class="hljs-keyword">this</span>.document.height() - <span class="hljs-number">1</span>;

		<span class="hljs-keyword">if</span> ( screenHeight &lt; documentHeight ) {
			screen.height( documentHeight );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( popupHeight &gt; screenHeight ) {
			screen.height( popupHeight );
		}
	},

	_handleWindowKeyUp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theEvent )</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isOpen &amp;&amp; theEvent.keyCode === $.mobile.keyCode.ESCAPE ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._eatEventAndClose( theEvent );
		}
	},

	_expectResizeEvent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> windowCoordinates = getWindowCoordinates( <span class="hljs-keyword">this</span>.window );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._resizeData ) {
			<span class="hljs-keyword">if</span> ( windowCoordinates.x === <span class="hljs-keyword">this</span>._resizeData.windowCoordinates.x &amp;&amp;
				windowCoordinates.y === <span class="hljs-keyword">this</span>._resizeData.windowCoordinates.y &amp;&amp;
				windowCoordinates.cx === <span class="hljs-keyword">this</span>._resizeData.windowCoordinates.cx &amp;&amp;
				windowCoordinates.cy === <span class="hljs-keyword">this</span>._resizeData.windowCoordinates.cy ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-787">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-787">&#182;</a>
              </div>
              <p>timeout not refreshed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-788">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-788">&#182;</a>
              </div>
              <p>clear existing timeout - it will be refreshed below</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				clearTimeout( <span class="hljs-keyword">this</span>._resizeData.timeoutId );
			}
		}

		<span class="hljs-keyword">this</span>._resizeData = {
			timeoutId: <span class="hljs-keyword">this</span>._delay( <span class="hljs-string">"_resizeTimeout"</span>, <span class="hljs-number">200</span> ),
			windowCoordinates: windowCoordinates
		};

		<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
	},

	_resizeTimeout: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isOpen ) {
			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._expectResizeEvent() ) {
				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._ui.container.hasClass( <span class="hljs-string">"ui-popup-hidden"</span> ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-789">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-789">&#182;</a>
              </div>
              <p>effectively rapid-open the popup while leaving the screen intact</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">this</span>._ui.container.removeClass( <span class="hljs-string">"ui-popup-hidden ui-popup-truncate"</span> );
					<span class="hljs-keyword">this</span>.reposition( { positionTo: <span class="hljs-string">"window"</span> } );
					<span class="hljs-keyword">this</span>._ignoreResizeEvents();
				}

				<span class="hljs-keyword">this</span>._resizeScreen();
				<span class="hljs-keyword">this</span>._resizeData = <span class="hljs-literal">null</span>;
				<span class="hljs-keyword">this</span>._orientationchangeInProgress = <span class="hljs-literal">false</span>;
			}
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>._resizeData = <span class="hljs-literal">null</span>;
			<span class="hljs-keyword">this</span>._orientationchangeInProgress = <span class="hljs-literal">false</span>;
		}
	},

	_stopIgnoringResizeEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._ignoreResizeTo = <span class="hljs-number">0</span>;
	},

	_ignoreResizeEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._ignoreResizeTo ) {
			clearTimeout( <span class="hljs-keyword">this</span>._ignoreResizeTo );
		}
		<span class="hljs-keyword">this</span>._ignoreResizeTo = <span class="hljs-keyword">this</span>._delay( <span class="hljs-string">"_stopIgnoringResizeEvents"</span>, <span class="hljs-number">1000</span> );
	},

	_handleWindowResize: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* theEvent */</span>)</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isOpen &amp;&amp; <span class="hljs-keyword">this</span>._ignoreResizeTo === <span class="hljs-number">0</span> ) {
			<span class="hljs-keyword">if</span> ( ( <span class="hljs-keyword">this</span>._expectResizeEvent() || <span class="hljs-keyword">this</span>._orientationchangeInProgress ) &amp;&amp;
				!<span class="hljs-keyword">this</span>._ui.container.hasClass( <span class="hljs-string">"ui-popup-hidden"</span> ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-790">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-790">&#182;</a>
              </div>
              <p>effectively rapid-close the popup while leaving the screen intact</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>._ui.container
					.addClass( <span class="hljs-string">"ui-popup-hidden ui-popup-truncate"</span> )
					.removeAttr( <span class="hljs-string">"style"</span> );
			}
		}
	},

	_handleWindowOrientationchange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* theEvent */</span>)</span> {</span>
		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._orientationchangeInProgress &amp;&amp; <span class="hljs-keyword">this</span>._isOpen &amp;&amp; <span class="hljs-keyword">this</span>._ignoreResizeTo === <span class="hljs-number">0</span> ) {
			<span class="hljs-keyword">this</span>._expectResizeEvent();
			<span class="hljs-keyword">this</span>._orientationchangeInProgress = <span class="hljs-literal">true</span>;
		}
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-791">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-791">&#182;</a>
              </div>
              <p>When the popup is open, attempting to focus on an element that is not a
child of the popup will redirect focus to the popup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_handleDocumentFocusIn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theEvent )</span> {</span>
		<span class="hljs-keyword">var</span> target,
			targetElement = theEvent.target,
			ui = <span class="hljs-keyword">this</span>._ui;

		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._isOpen ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( targetElement !== ui.container[ <span class="hljs-number">0</span> ] ) {
			target = $( targetElement );
			<span class="hljs-keyword">if</span> ( <span class="hljs-number">0</span> === target.parents().filter( ui.container[ <span class="hljs-number">0</span> ] ).length ) {
				$( <span class="hljs-keyword">this</span>.document[ <span class="hljs-number">0</span> ].activeElement ).one( <span class="hljs-string">"focus"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* theEvent */</span>)</span> {</span>
					target.blur();
				});
				ui.focusElement.focus();
				theEvent.preventDefault();
				theEvent.stopImmediatePropagation();
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( ui.focusElement[ <span class="hljs-number">0</span> ] === ui.container[ <span class="hljs-number">0</span> ] ) {
				ui.focusElement = target;
			}
		}

		<span class="hljs-keyword">this</span>._ignoreResizeEvents();
	},

	_themeClassFromOption: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( prefix, value )</span> {</span>
		<span class="hljs-keyword">return</span> ( value ? ( value === <span class="hljs-string">"none"</span> ? <span class="hljs-string">""</span> : ( prefix + value ) ) : ( prefix + <span class="hljs-string">"inherit"</span> ) );
	},

	_applyTransition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		<span class="hljs-keyword">if</span> ( value ) {
			<span class="hljs-keyword">this</span>._ui.container.removeClass( <span class="hljs-keyword">this</span>._fallbackTransition );
			<span class="hljs-keyword">if</span> ( value !== <span class="hljs-string">"none"</span> ) {
				<span class="hljs-keyword">this</span>._fallbackTransition = $.mobile._maybeDegradeTransition( value );
				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._fallbackTransition === <span class="hljs-string">"none"</span> ) {
					<span class="hljs-keyword">this</span>._fallbackTransition = <span class="hljs-string">""</span>;
				}
				<span class="hljs-keyword">this</span>._ui.container.addClass( <span class="hljs-keyword">this</span>._fallbackTransition );
			}
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( newOptions )</span> {</span>
		<span class="hljs-keyword">var</span> currentOptions = <span class="hljs-keyword">this</span>.options,
			theElement = <span class="hljs-keyword">this</span>.element,
			screen = <span class="hljs-keyword">this</span>._ui.screen;

		<span class="hljs-keyword">if</span> ( newOptions.wrapperClass !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._ui.container
				.removeClass( currentOptions.wrapperClass )
				.addClass( newOptions.wrapperClass );
		}

		<span class="hljs-keyword">if</span> ( newOptions.theme !== <span class="hljs-literal">undefined</span> ) {
			theElement
				.removeClass( <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-body-"</span>, currentOptions.theme ) )
				.addClass( <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-body-"</span>, newOptions.theme ) );
		}

		<span class="hljs-keyword">if</span> ( newOptions.overlayTheme !== <span class="hljs-literal">undefined</span> ) {
			screen
				.removeClass( <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-overlay-"</span>, currentOptions.overlayTheme ) )
				.addClass( <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-overlay-"</span>, newOptions.overlayTheme ) );

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isOpen ) {
				screen.addClass( <span class="hljs-string">"in"</span> );
			}
		}

		<span class="hljs-keyword">if</span> ( newOptions.shadow !== <span class="hljs-literal">undefined</span> ) {
			theElement.toggleClass( <span class="hljs-string">"ui-overlay-shadow"</span>, newOptions.shadow );
		}

		<span class="hljs-keyword">if</span> ( newOptions.corners !== <span class="hljs-literal">undefined</span> ) {
			theElement.toggleClass( <span class="hljs-string">"ui-corner-all"</span>, newOptions.corners );
		}

		<span class="hljs-keyword">if</span> ( newOptions.transition !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._currentTransition ) {
				<span class="hljs-keyword">this</span>._applyTransition( newOptions.transition );
			}
		}

		<span class="hljs-keyword">if</span> ( newOptions.tolerance !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._setTolerance( newOptions.tolerance );
		}

		<span class="hljs-keyword">if</span> ( newOptions.disabled !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">if</span> ( newOptions.disabled ) {
				<span class="hljs-keyword">this</span>.close();
			}
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._super( newOptions );
	},

	_setTolerance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		<span class="hljs-keyword">var</span> tol = { t: <span class="hljs-number">30</span>, r: <span class="hljs-number">15</span>, b: <span class="hljs-number">30</span>, l: <span class="hljs-number">15</span> },
			ar;

		<span class="hljs-keyword">if</span> ( value !== <span class="hljs-literal">undefined</span> ) {
			ar = <span class="hljs-built_in">String</span>( value ).split( <span class="hljs-string">","</span> );

			$.each( ar, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( idx, val )</span> {</span> ar[ idx ] = <span class="hljs-built_in">parseInt</span>( val, <span class="hljs-number">10</span> ); } );

			<span class="hljs-keyword">switch</span>( ar.length ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-792">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-792">&#182;</a>
              </div>
              <p>All values are to be the same</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
					<span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">isNaN</span>( ar[ <span class="hljs-number">0</span> ] ) ) {
						tol.t = tol.r = tol.b = tol.l = ar[ <span class="hljs-number">0</span> ];
					}
					<span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-793">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-793">&#182;</a>
              </div>
              <p>The first value denotes top/bottom tolerance, and the second value denotes left/right tolerance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
					<span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">isNaN</span>( ar[ <span class="hljs-number">0</span> ] ) ) {
						tol.t = tol.b = ar[ <span class="hljs-number">0</span> ];
					}
					<span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">isNaN</span>( ar[ <span class="hljs-number">1</span> ] ) ) {
						tol.l = tol.r = ar[ <span class="hljs-number">1</span> ];
					}
					<span class="hljs-keyword">break</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-794">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-794">&#182;</a>
              </div>
              <p>The array contains values in the order top, right, bottom, left</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:
					<span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">isNaN</span>( ar[ <span class="hljs-number">0</span> ] ) ) {
						tol.t = ar[ <span class="hljs-number">0</span> ];
					}
					<span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">isNaN</span>( ar[ <span class="hljs-number">1</span> ] ) ) {
						tol.r = ar[ <span class="hljs-number">1</span> ];
					}
					<span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">isNaN</span>( ar[ <span class="hljs-number">2</span> ] ) ) {
						tol.b = ar[ <span class="hljs-number">2</span> ];
					}
					<span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">isNaN</span>( ar[ <span class="hljs-number">3</span> ] ) ) {
						tol.l = ar[ <span class="hljs-number">3</span> ];
					}
					<span class="hljs-keyword">break</span>;

				<span class="hljs-keyword">default</span>:
					<span class="hljs-keyword">break</span>;
			}
		}

		<span class="hljs-keyword">this</span>._tolerance = tol;
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	_clampPopupWidth: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( infoOnly )</span> {</span>
		<span class="hljs-keyword">var</span> menuSize,
			windowCoordinates = getWindowCoordinates( <span class="hljs-keyword">this</span>.window ),</pre></div></div>
            
        </li>
        
        
        <li id="section-795">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-795">&#182;</a>
              </div>
              <p>rectangle within which the popup must fit</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			rectangle = {
				x: <span class="hljs-keyword">this</span>._tolerance.l,
				y: windowCoordinates.y + <span class="hljs-keyword">this</span>._tolerance.t,
				cx: windowCoordinates.cx - <span class="hljs-keyword">this</span>._tolerance.l - <span class="hljs-keyword">this</span>._tolerance.r,
				cy: windowCoordinates.cy - <span class="hljs-keyword">this</span>._tolerance.t - <span class="hljs-keyword">this</span>._tolerance.b
			};

		<span class="hljs-keyword">if</span> ( !infoOnly ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-796">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-796">&#182;</a>
              </div>
              <p>Clamp the width of the menu before grabbing its size</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._ui.container.css( <span class="hljs-string">"max-width"</span>, rectangle.cx );
		}

		menuSize = {
			cx: <span class="hljs-keyword">this</span>._ui.container.outerWidth( <span class="hljs-literal">true</span> ),
			cy: <span class="hljs-keyword">this</span>._ui.container.outerHeight( <span class="hljs-literal">true</span> )
		};

		<span class="hljs-keyword">return</span> { rc: rectangle, menuSize: menuSize };
	},

	_calculateFinalLocation: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( desired, clampInfo )</span> {</span>
		<span class="hljs-keyword">var</span> returnValue,
			rectangle = clampInfo.rc,
			menuSize = clampInfo.menuSize;</pre></div></div>
            
        </li>
        
        
        <li id="section-797">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-797">&#182;</a>
              </div>
              <p>Center the menu over the desired coordinates, while not going outside
the window tolerances. This will center wrt. the window if the popup is
too large.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		returnValue = {
			left: fitSegmentInsideSegment( rectangle.cx, menuSize.cx, rectangle.x, desired.x ),
			top: fitSegmentInsideSegment( rectangle.cy, menuSize.cy, rectangle.y, desired.y )
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-798">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-798">&#182;</a>
              </div>
              <p>Make sure the top of the menu is visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		returnValue.top = <span class="hljs-built_in">Math</span>.max( <span class="hljs-number">0</span>, returnValue.top );</pre></div></div>
            
        </li>
        
        
        <li id="section-799">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-799">&#182;</a>
              </div>
              <p>If the height of the menu is smaller than the height of the document
align the bottom with the bottom of the document</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		returnValue.top -= <span class="hljs-built_in">Math</span>.min( returnValue.top,
			<span class="hljs-built_in">Math</span>.max( <span class="hljs-number">0</span>, returnValue.top + menuSize.cy - <span class="hljs-keyword">this</span>.document.height() ) );

		<span class="hljs-keyword">return</span> returnValue;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-800">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-800">&#182;</a>
              </div>
              <p>Try and center the overlay over the given coordinates</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_placementCoords: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( desired )</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._calculateFinalLocation( desired, <span class="hljs-keyword">this</span>._clampPopupWidth() );
	},

	_createPrerequisites: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( screenPrerequisite, containerPrerequisite, whenDone )</span> {</span>
		<span class="hljs-keyword">var</span> prerequisites,
			self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-801">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-801">&#182;</a>
              </div>
              <p>It is important to maintain both the local variable prerequisites and
self._prerequisites. The local variable remains in the closure of the
functions which call the callbacks passed in. The comparison between the
local variable and self._prerequisites is necessary, because once a
function has been passed to .animationComplete() it will be called next
time an animation completes, even if that’s not the animation whose end
the function was supposed to catch (for example, if an abort happens
during the opening animation, the .animationComplete handler is not
called for that animation anymore, but the handler remains attached, so
it is called the next time the popup is opened - making it stale.
Comparing the local variable prerequisites to the widget-level variable
self._prerequisites ensures that callbacks triggered by a stale
.animationComplete will be ignored.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
		prerequisites = {
			screen: $.Deferred(),
			container: $.Deferred()
		};

		prerequisites.screen.then( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( prerequisites === self._prerequisites ) {
				screenPrerequisite();
			}
		});

		prerequisites.container.then( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( prerequisites === self._prerequisites ) {
				containerPrerequisite();
			}
		});

		$.when( prerequisites.screen, prerequisites.container ).done( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( prerequisites === self._prerequisites ) {
				self._prerequisites = <span class="hljs-literal">null</span>;
				whenDone();
			}
		});

		self._prerequisites = prerequisites;
	},

	_animate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( args )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-802">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-802">&#182;</a>
              </div>
              <p>NOTE before removing the default animation of the screen
     this had an animate callback that would resolve the deferred
     now the deferred is resolved immediately
TODO remove the dependency on the screen deferred</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._ui.screen
			.removeClass( args.classToRemove )
			.addClass( args.screenClassToAdd );

		args.prerequisites.screen.resolve();

		<span class="hljs-keyword">if</span> ( args.transition &amp;&amp; args.transition !== <span class="hljs-string">"none"</span> ) {
			<span class="hljs-keyword">if</span> ( args.applyTransition ) {
				<span class="hljs-keyword">this</span>._applyTransition( args.transition );
			}
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._fallbackTransition ) {
				<span class="hljs-keyword">this</span>._ui.container
					.addClass( args.containerClassToAdd )
					.removeClass( args.classToRemove )
					.animationComplete( $.proxy( args.prerequisites.container, <span class="hljs-string">"resolve"</span> ) );
				<span class="hljs-keyword">return</span>;
			}
		}
		<span class="hljs-keyword">this</span>._ui.container.removeClass( args.classToRemove );
		args.prerequisites.container.resolve();
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-803">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-803">&#182;</a>
              </div>
              <p>The desired coordinates passed in will be returned untouched if no reference element can be identified via
desiredPosition.positionTo. Nevertheless, this function ensures that its return value always contains valid
x and y coordinates by specifying the center middle of the window if the coordinates are absent.
options: { x: coordinate, y: coordinate, positionTo: string: “origin”, “window”, or jQuery selector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_desiredCoords: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( openOptions )</span> {</span>
		<span class="hljs-keyword">var</span> offset,
			dst = <span class="hljs-literal">null</span>,
			windowCoordinates = getWindowCoordinates( <span class="hljs-keyword">this</span>.window ),
			x = openOptions.x,
			y = openOptions.y,
			pTo = openOptions.positionTo;</pre></div></div>
            
        </li>
        
        
        <li id="section-804">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-804">&#182;</a>
              </div>
              <p>Establish which element will serve as the reference</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( pTo &amp;&amp; pTo !== <span class="hljs-string">"origin"</span> ) {
			<span class="hljs-keyword">if</span> ( pTo === <span class="hljs-string">"window"</span> ) {
				x = windowCoordinates.cx / <span class="hljs-number">2</span> + windowCoordinates.x;
				y = windowCoordinates.cy / <span class="hljs-number">2</span> + windowCoordinates.y;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">try</span> {
					dst = $( pTo );
				} <span class="hljs-keyword">catch</span>( err ) {
					dst = <span class="hljs-literal">null</span>;
				}
				<span class="hljs-keyword">if</span> ( dst ) {
					dst.filter( <span class="hljs-string">":visible"</span> );
					<span class="hljs-keyword">if</span> ( dst.length === <span class="hljs-number">0</span> ) {
						dst = <span class="hljs-literal">null</span>;
					}
				}
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-805">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-805">&#182;</a>
              </div>
              <p>If an element was found, center over it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( dst ) {
			offset = dst.offset();
			x = offset.left + dst.outerWidth() / <span class="hljs-number">2</span>;
			y = offset.top + dst.outerHeight() / <span class="hljs-number">2</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-806">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-806">&#182;</a>
              </div>
              <p>Make sure x and y are valid numbers - center over the window</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.type( x ) !== <span class="hljs-string">"number"</span> || <span class="hljs-built_in">isNaN</span>( x ) ) {
			x = windowCoordinates.cx / <span class="hljs-number">2</span> + windowCoordinates.x;
		}
		<span class="hljs-keyword">if</span> ( $.type( y ) !== <span class="hljs-string">"number"</span> || <span class="hljs-built_in">isNaN</span>( y ) ) {
			y = windowCoordinates.cy / <span class="hljs-number">2</span> + windowCoordinates.y;
		}

		<span class="hljs-keyword">return</span> { x: x, y: y };
	},

	_reposition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( openOptions )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-807">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-807">&#182;</a>
              </div>
              <p>We only care about position-related parameters for repositioning</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		openOptions = {
			x: openOptions.x,
			y: openOptions.y,
			positionTo: openOptions.positionTo
		};
		<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"beforeposition"</span>, <span class="hljs-literal">undefined</span>, openOptions );
		<span class="hljs-keyword">this</span>._ui.container.offset( <span class="hljs-keyword">this</span>._placementCoords( <span class="hljs-keyword">this</span>._desiredCoords( openOptions ) ) );
	},

	reposition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( openOptions )</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isOpen ) {
			<span class="hljs-keyword">this</span>._reposition( openOptions );
		}
	},

	_openPrerequisitesComplete: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> id = <span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"id"</span> );

		<span class="hljs-keyword">this</span>._ui.container.addClass( <span class="hljs-string">"ui-popup-active"</span> );
		<span class="hljs-keyword">this</span>._isOpen = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">this</span>._resizeScreen();
		<span class="hljs-keyword">this</span>._ui.container.attr( <span class="hljs-string">"tabindex"</span>, <span class="hljs-string">"0"</span> ).focus();
		<span class="hljs-keyword">this</span>._ignoreResizeEvents();
		<span class="hljs-keyword">if</span> ( id ) {
			<span class="hljs-keyword">this</span>.document.find( <span class="hljs-string">"[aria-haspopup='true'][aria-owns='"</span> +  id + <span class="hljs-string">"']"</span> ).attr( <span class="hljs-string">"aria-expanded"</span>, <span class="hljs-literal">true</span> );
		}
		<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"afteropen"</span> );
	},

	_open: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> openOptions = $.extend( {}, <span class="hljs-keyword">this</span>.options, options ),</pre></div></div>
            
        </li>
        
        
        <li id="section-808">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-808">&#182;</a>
              </div>
              <p>TODO move blacklist to private method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			androidBlacklist = ( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> ua = navigator.userAgent,</pre></div></div>
            
        </li>
        
        
        <li id="section-809">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-809">&#182;</a>
              </div>
              <p>Rendering engine is Webkit, and capture major version</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					wkmatch = ua.match( <span class="hljs-regexp">/AppleWebKit\/([0-9\.]+)/</span> ),
					wkversion = !!wkmatch &amp;&amp; wkmatch[ <span class="hljs-number">1</span> ],
					androidmatch = ua.match( <span class="hljs-regexp">/Android (\d+(?:\.\d+))/</span> ),
					andversion = !!androidmatch &amp;&amp; androidmatch[ <span class="hljs-number">1</span> ],
					chromematch = ua.indexOf( <span class="hljs-string">"Chrome"</span> ) &gt; -<span class="hljs-number">1</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-810">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-810">&#182;</a>
              </div>
              <p>Platform is Android, WebKit version is greater than 534.13 ( Android 3.2.1 ) and not Chrome.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( androidmatch !== <span class="hljs-literal">null</span> &amp;&amp; andversion === <span class="hljs-string">"4.0"</span> &amp;&amp; wkversion &amp;&amp; wkversion &gt; <span class="hljs-number">534.13</span> &amp;&amp; !chromematch ) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}());</pre></div></div>
            
        </li>
        
        
        <li id="section-811">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-811">&#182;</a>
              </div>
              <p>Count down to triggering “popupafteropen” - we have two prerequisites:</p>
<ol>
<li>The popup window animation completes (container())</li>
<li>The screen opacity animation completes (screen())</li>
</ol>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._createPrerequisites(
			$.noop,
			$.noop,
			$.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_openPrerequisitesComplete"</span> ) );

		<span class="hljs-keyword">this</span>._currentTransition = openOptions.transition;
		<span class="hljs-keyword">this</span>._applyTransition( openOptions.transition );

		<span class="hljs-keyword">this</span>._ui.screen.removeClass( <span class="hljs-string">"ui-screen-hidden"</span> );
		<span class="hljs-keyword">this</span>._ui.container.removeClass( <span class="hljs-string">"ui-popup-truncate"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-812">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-812">&#182;</a>
              </div>
              <p>Give applications a chance to modify the contents of the container before it appears</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._reposition( openOptions );

		<span class="hljs-keyword">this</span>._ui.container.removeClass( <span class="hljs-string">"ui-popup-hidden"</span> );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.overlayTheme &amp;&amp; androidBlacklist ) {
			<span class="hljs-comment">/* TODO: The native browser on Android 4.0.X ("Ice Cream Sandwich") suffers from an issue where the popup overlay appears to be z-indexed above the popup itself when certain other styles exist on the same page -- namely, any element set to `position: fixed` and certain types of input. These issues are reminiscent of previously uncovered bugs in older versions of Android's native browser: https://github.com/scottjehl/Device-Bugs/issues/3
			This fix closes the following bugs ( I use "closes" with reluctance, and stress that this issue should be revisited as soon as possible ):
			https://github.com/jquery/jquery-mobile/issues/4816
			https://github.com/jquery/jquery-mobile/issues/4844
			https://github.com/jquery/jquery-mobile/issues/4874
			*/</span></pre></div></div>
            
        </li>
        
        
        <li id="section-813">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-813">&#182;</a>
              </div>
              <p>TODO sort out why this._page isn’t working</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element.closest( <span class="hljs-string">".ui-page"</span> ).addClass( <span class="hljs-string">"ui-popup-open"</span> );
		}
		<span class="hljs-keyword">this</span>._animate({
			additionalCondition: <span class="hljs-literal">true</span>,
			transition: openOptions.transition,
			classToRemove: <span class="hljs-string">""</span>,
			screenClassToAdd: <span class="hljs-string">"in"</span>,
			containerClassToAdd: <span class="hljs-string">"in"</span>,
			applyTransition: <span class="hljs-literal">false</span>,
			prerequisites: <span class="hljs-keyword">this</span>._prerequisites
		});
	},

	_closePrerequisiteScreen: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._ui.screen
			.removeClass( <span class="hljs-string">"out"</span> )
			.addClass( <span class="hljs-string">"ui-screen-hidden"</span> );
	},

	_closePrerequisiteContainer: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._ui.container
			.removeClass( <span class="hljs-string">"reverse out"</span> )
			.addClass( <span class="hljs-string">"ui-popup-hidden ui-popup-truncate"</span> )
			.removeAttr( <span class="hljs-string">"style"</span> );
	},

	_closePrerequisitesDone: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> container = <span class="hljs-keyword">this</span>._ui.container,
			id = <span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"id"</span> );

		container.removeAttr( <span class="hljs-string">"tabindex"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-814">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-814">&#182;</a>
              </div>
              <p>remove the global mutex for popups</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.mobile.popup.active = <span class="hljs-literal">undefined</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-815">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-815">&#182;</a>
              </div>
              <p>Blur elements inside the container, including the container</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$( <span class="hljs-string">":focus"</span>, container[ <span class="hljs-number">0</span> ] ).add( container[ <span class="hljs-number">0</span> ] ).blur();

		<span class="hljs-keyword">if</span> ( id ) {
			<span class="hljs-keyword">this</span>.document.find( <span class="hljs-string">"[aria-haspopup='true'][aria-owns='"</span> +  id + <span class="hljs-string">"']"</span> ).attr( <span class="hljs-string">"aria-expanded"</span>, <span class="hljs-literal">false</span> );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-816">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-816">&#182;</a>
              </div>
              <p>alert users that the popup is closed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"afterclose"</span> );
	},

	_close: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( immediate )</span> {</span>
		<span class="hljs-keyword">this</span>._ui.container.removeClass( <span class="hljs-string">"ui-popup-active"</span> );
		<span class="hljs-keyword">this</span>._page.removeClass( <span class="hljs-string">"ui-popup-open"</span> );

		<span class="hljs-keyword">this</span>._isOpen = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-817">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-817">&#182;</a>
              </div>
              <p>Count down to triggering “popupafterclose” - we have two prerequisites:</p>
<ol>
<li>The popup window reverse animation completes (container())</li>
<li>The screen opacity animation completes (screen())</li>
</ol>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._createPrerequisites(
			$.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_closePrerequisiteScreen"</span> ),
			$.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_closePrerequisiteContainer"</span> ),
			$.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_closePrerequisitesDone"</span> ) );

		<span class="hljs-keyword">this</span>._animate( {
			additionalCondition: <span class="hljs-keyword">this</span>._ui.screen.hasClass( <span class="hljs-string">"in"</span> ),
			transition: ( immediate ? <span class="hljs-string">"none"</span> : ( <span class="hljs-keyword">this</span>._currentTransition ) ),
			classToRemove: <span class="hljs-string">"in"</span>,
			screenClassToAdd: <span class="hljs-string">"out"</span>,
			containerClassToAdd: <span class="hljs-string">"reverse out"</span>,
			applyTransition: <span class="hljs-literal">true</span>,
			prerequisites: <span class="hljs-keyword">this</span>._prerequisites
		});
	},

	_unenhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.enhanced ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-818">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-818">&#182;</a>
              </div>
              <p>Put the element back to where the placeholder was and remove the “ui-popup” class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._setOptions( { theme: $.mobile.popup.prototype.options.theme } );
		<span class="hljs-keyword">this</span>.element</pre></div></div>
            
        </li>
        
        
        <li id="section-819">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-819">&#182;</a>
              </div>
              <p>Cannot directly insertAfter() - we need to detach() first, because
insertAfter() will do nothing if the payload div was not attached
to the DOM at the time the widget was created, and so the payload
will remain inside the container even after we call insertAfter().
If that happens and we remove the container a few lines below, we
will cause an infinite recursion - #5244</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			.detach()
			.insertAfter( <span class="hljs-keyword">this</span>._ui.placeholder )
			.removeClass( <span class="hljs-string">"ui-popup ui-overlay-shadow ui-corner-all ui-body-inherit"</span> );
		<span class="hljs-keyword">this</span>._ui.screen.remove();
		<span class="hljs-keyword">this</span>._ui.container.remove();
		<span class="hljs-keyword">this</span>._ui.placeholder.remove();
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( $.mobile.popup.active === <span class="hljs-keyword">this</span> ) {
			<span class="hljs-keyword">this</span>.element.one( <span class="hljs-string">"popupafterclose"</span>, $.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_unenhance"</span> ) );
			<span class="hljs-keyword">this</span>.close();
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>._unenhance();
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	_closePopup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theEvent, data )</span> {</span>
		<span class="hljs-keyword">var</span> parsedDst, toUrl,
			currentOptions = <span class="hljs-keyword">this</span>.options,
			immediate = <span class="hljs-literal">false</span>;

		<span class="hljs-keyword">if</span> ( ( theEvent &amp;&amp; theEvent.isDefaultPrevented() ) || $.mobile.popup.active !== <span class="hljs-keyword">this</span> ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-820">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-820">&#182;</a>
              </div>
              <p>restore location on screen</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		window.scrollTo( <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>._scrollTop );

		<span class="hljs-keyword">if</span> ( theEvent &amp;&amp; theEvent.type === <span class="hljs-string">"pagebeforechange"</span> &amp;&amp; data ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-821">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-821">&#182;</a>
              </div>
              <p>Determine whether we need to rapid-close the popup, or whether we can
take the time to run the closing transition</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> data.toPage === <span class="hljs-string">"string"</span> ) {
				parsedDst = data.toPage;
			} <span class="hljs-keyword">else</span> {
				parsedDst = data.toPage.jqmData( <span class="hljs-string">"url"</span> );
			}
			parsedDst = $.mobile.path.parseUrl( parsedDst );
			toUrl = parsedDst.pathname + parsedDst.search + parsedDst.hash;

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._myUrl !== $.mobile.path.makeUrlAbsolute( toUrl ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-822">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-822">&#182;</a>
              </div>
              <p>Going to a different page - close immediately</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				immediate = <span class="hljs-literal">true</span>;
			} <span class="hljs-keyword">else</span> {
				theEvent.preventDefault();
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-823">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-823">&#182;</a>
              </div>
              <p>remove nav bindings</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.window.off( currentOptions.closeEvents );</pre></div></div>
            
        </li>
        
        
        <li id="section-824">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-824">&#182;</a>
              </div>
              <p>unbind click handlers added when history is disabled</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.element.undelegate( currentOptions.closeLinkSelector, currentOptions.closeLinkEvents );

		<span class="hljs-keyword">this</span>._close( immediate );
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-825">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-825">&#182;</a>
              </div>
              <p>any navigation event after a popup is opened should close the popup
NOTE the pagebeforechange is bound to catch navigation events that don’t
     alter the url (eg, dialogs from popups)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_bindContainerClose: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.window
			.on( <span class="hljs-keyword">this</span>.options.closeEvents, $.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_closePopup"</span> ) );
	},

	widget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._ui.container;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-826">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-826">&#182;</a>
              </div>
              <p>TODO no clear deliniation of what should be here and
what should be in _open. Seems to be “visual” vs “history” for now</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	open: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> url, hashkey, activePage, currentIsDialog, hasHash, urlHistory,
			self = <span class="hljs-keyword">this</span>,
			currentOptions = <span class="hljs-keyword">this</span>.options;</pre></div></div>
            
        </li>
        
        
        <li id="section-827">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-827">&#182;</a>
              </div>
              <p>make sure open is idempotent</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.mobile.popup.active || currentOptions.disabled ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-828">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-828">&#182;</a>
              </div>
              <p>set the global popup mutex</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.mobile.popup.active = <span class="hljs-keyword">this</span>;
		<span class="hljs-keyword">this</span>._scrollTop = <span class="hljs-keyword">this</span>.window.scrollTop();</pre></div></div>
            
        </li>
        
        
        <li id="section-829">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-829">&#182;</a>
              </div>
              <p>if history alteration is disabled close on navigate events
and leave the url as is</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !( currentOptions.history ) ) {
			self._open( options );
			self._bindContainerClose();</pre></div></div>
            
        </li>
        
        
        <li id="section-830">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-830">&#182;</a>
              </div>
              <p>When histoy is disabled we have to grab the data-rel
back link clicks so we can close the popup instead of
relying on history to do it for us</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			self.element
				.delegate( currentOptions.closeLinkSelector, currentOptions.closeLinkEvents, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theEvent )</span> {</span>
					self.close();
					theEvent.preventDefault();
				});

			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-831">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-831">&#182;</a>
              </div>
              <p>cache some values for min/readability</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		urlHistory = $.mobile.navigate.history;
		hashkey = $.mobile.dialogHashKey;
		activePage = $.mobile.activePage;
		currentIsDialog = ( activePage ? activePage.hasClass( <span class="hljs-string">"ui-dialog"</span> ) : <span class="hljs-literal">false</span> );
		<span class="hljs-keyword">this</span>._myUrl = url = urlHistory.getActive().url;
		hasHash = ( url.indexOf( hashkey ) &gt; -<span class="hljs-number">1</span> ) &amp;&amp; !currentIsDialog &amp;&amp; ( urlHistory.activeIndex &gt; <span class="hljs-number">0</span> );

		<span class="hljs-keyword">if</span> ( hasHash ) {
			self._open( options );
			self._bindContainerClose();
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-832">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-832">&#182;</a>
              </div>
              <p>if the current url has no dialog hash key proceed as normal
otherwise, if the page is a dialog simply tack on the hash key</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( url.indexOf( hashkey ) === -<span class="hljs-number">1</span> &amp;&amp; !currentIsDialog ) {
			url = url + (url.indexOf( <span class="hljs-string">"#"</span> ) &gt; -<span class="hljs-number">1</span> ? hashkey : <span class="hljs-string">"#"</span> + hashkey);
		} <span class="hljs-keyword">else</span> {
			url = $.mobile.path.parseLocation().hash + hashkey;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-833">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-833">&#182;</a>
              </div>
              <p>Tack on an extra hashkey if this is the first page and we’ve just reconstructed the initial hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( urlHistory.activeIndex === <span class="hljs-number">0</span> &amp;&amp; url === urlHistory.initialDst ) {
			url += hashkey;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-834">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-834">&#182;</a>
              </div>
              <p>swallow the the initial navigation event, and bind for the next</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.window.one( <span class="hljs-string">"beforenavigate"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theEvent )</span> {</span>
			theEvent.preventDefault();
			self._open( options );
			self._bindContainerClose();
		});

		<span class="hljs-keyword">this</span>.urlAltered = <span class="hljs-literal">true</span>;
		$.mobile.navigate( url, { role: <span class="hljs-string">"dialog"</span> } );

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	close: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-835">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-835">&#182;</a>
              </div>
              <p>make sure close is idempotent</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.mobile.popup.active !== <span class="hljs-keyword">this</span> ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		<span class="hljs-keyword">this</span>._scrollTop = <span class="hljs-keyword">this</span>.window.scrollTop();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.history &amp;&amp; <span class="hljs-keyword">this</span>.urlAltered ) {
			$.mobile.back();
			<span class="hljs-keyword">this</span>.urlAltered = <span class="hljs-literal">false</span>;
		} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-836">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-836">&#182;</a>
              </div>
              <p>simulate the nav bindings having fired</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._closePopup();
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	}
});</pre></div></div>
            
        </li>
        
        
        <li id="section-837">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-837">&#182;</a>
              </div>
              <p>TODO this can be moved inside the widget</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.popup.handleLink = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $link )</span> {</span>
	<span class="hljs-keyword">var</span> offset,
		path = $.mobile.path,</pre></div></div>
            
        </li>
        
        
        <li id="section-838">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-838">&#182;</a>
              </div>
              <p>NOTE make sure to get only the hash from the href because ie7 (wp7)
     returns the absolute href in this case ruining the element selection</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		popup = $( path.hashToSelector( path.parseUrl( $link.attr( <span class="hljs-string">"href"</span> ) ).hash ) ).first();

	<span class="hljs-keyword">if</span> ( popup.length &gt; <span class="hljs-number">0</span> &amp;&amp; popup.data( <span class="hljs-string">"mobile-popup"</span> ) ) {
		offset = $link.offset();
		popup.popup( <span class="hljs-string">"open"</span>, {
			x: offset.left + $link.outerWidth() / <span class="hljs-number">2</span>,
			y: offset.top + $link.outerHeight() / <span class="hljs-number">2</span>,
			transition: $link.jqmData( <span class="hljs-string">"transition"</span> ),
			positionTo: $link.jqmData( <span class="hljs-string">"position-to"</span> )
		});
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-839">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-839">&#182;</a>
              </div>
              <p>remove after delay</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		$link.removeClass( $.mobile.activeBtnClass );
	}, <span class="hljs-number">300</span> );
};</pre></div></div>
            
        </li>
        
        
        <li id="section-840">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-840">&#182;</a>
              </div>
              <p>TODO move inside _create</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.document.on( <span class="hljs-string">"pagebeforechange"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( theEvent, data )</span> {</span>
	<span class="hljs-keyword">if</span> ( data.options.role === <span class="hljs-string">"popup"</span> ) {
		$.mobile.popup.handleLink( data.options.link );
		theEvent.preventDefault();
	}
});

})( jQuery );

<span class="hljs-comment">/*
* custom "selectmenu" plugin
*/</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> unfocusableItemSelector = <span class="hljs-string">".ui-disabled,.ui-state-disabled,.ui-li-divider,.ui-screen-hidden,:jqmData(role='placeholder')"</span>,
	goToAdjacentItem = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( item, target, direction )</span> {</span>
		<span class="hljs-keyword">var</span> adjacent = item[ direction + <span class="hljs-string">"All"</span> ]()
			.not( unfocusableItemSelector )
			.first();</pre></div></div>
            
        </li>
        
        
        <li id="section-841">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-841">&#182;</a>
              </div>
              <p>if there’s a previous option, focus it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( adjacent.length ) {
			target
				.blur()
				.attr( <span class="hljs-string">"tabindex"</span>, <span class="hljs-string">"-1"</span> );

			adjacent.find( <span class="hljs-string">"a"</span> ).first().focus();
		}
	};

$.widget( <span class="hljs-string">"mobile.selectmenu"</span>, $.mobile.selectmenu, {
	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> o = <span class="hljs-keyword">this</span>.options;</pre></div></div>
            
        </li>
        
        
        <li id="section-842">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-842">&#182;</a>
              </div>
              <p>Custom selects cannot exist inside popups, so revert the “nativeMenu”
option to true if a parent is a popup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		o.nativeMenu = o.nativeMenu || ( <span class="hljs-keyword">this</span>.element.parents( <span class="hljs-string">":jqmData(role='popup'),:mobile-popup"</span> ).length &gt; <span class="hljs-number">0</span> );

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._super();
	},

	_handleSelectFocus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.element.blur();
		<span class="hljs-keyword">this</span>.button.focus();
	},

	_handleKeydown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">this</span>._super( event );
		<span class="hljs-keyword">this</span>._handleButtonVclickKeydown( event );
	},

	_handleButtonVclickKeydown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.disabled || <span class="hljs-keyword">this</span>.isOpen ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> (event.type === <span class="hljs-string">"vclick"</span> ||
				event.keyCode &amp;&amp; (event.keyCode === $.mobile.keyCode.ENTER || event.keyCode === $.mobile.keyCode.SPACE)) {

			<span class="hljs-keyword">this</span>._decideFormat();
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.menuType === <span class="hljs-string">"overlay"</span> ) {
				<span class="hljs-keyword">this</span>.button.attr( <span class="hljs-string">"href"</span>, <span class="hljs-string">"#"</span> + <span class="hljs-keyword">this</span>.popupId ).attr( <span class="hljs-string">"data-"</span> + ( $.mobile.ns || <span class="hljs-string">""</span> ) + <span class="hljs-string">"rel"</span>, <span class="hljs-string">"popup"</span> );
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.button.attr( <span class="hljs-string">"href"</span>, <span class="hljs-string">"#"</span> + <span class="hljs-keyword">this</span>.dialogId ).attr( <span class="hljs-string">"data-"</span> + ( $.mobile.ns || <span class="hljs-string">""</span> ) + <span class="hljs-string">"rel"</span>, <span class="hljs-string">"dialog"</span> );
			}
			<span class="hljs-keyword">this</span>.isOpen = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-843">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-843">&#182;</a>
              </div>
              <p>Do not prevent default, so the navigation may have a chance to actually open the chosen format</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		}
	},

	_handleListFocus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> {</span>
		<span class="hljs-keyword">var</span> params = ( e.type === <span class="hljs-string">"focusin"</span> ) ?
			{ tabindex: <span class="hljs-string">"0"</span>, event: <span class="hljs-string">"vmouseover"</span> }:
			{ tabindex: <span class="hljs-string">"-1"</span>, event: <span class="hljs-string">"vmouseout"</span> };

		$( e.target )
			.attr( <span class="hljs-string">"tabindex"</span>, params.tabindex )
			.trigger( params.event );
	},

	_handleListKeydown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">var</span> target = $( event.target ),
			li = target.closest( <span class="hljs-string">"li"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-844">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-844">&#182;</a>
              </div>
              <p>switch logic based on which key was pressed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">switch</span> ( event.keyCode ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-845">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-845">&#182;</a>
              </div>
              <p>up or left arrow keys</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">case</span> <span class="hljs-number">38</span>:
			goToAdjacentItem( li, target, <span class="hljs-string">"prev"</span> );
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-846">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-846">&#182;</a>
              </div>
              <p>down or right arrow keys</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">case</span> <span class="hljs-number">40</span>:
			goToAdjacentItem( li, target, <span class="hljs-string">"next"</span> );
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-847">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-847">&#182;</a>
              </div>
              <p>If enter or space is pressed, trigger click</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">case</span> <span class="hljs-number">13</span>:
		<span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:
			target.trigger( <span class="hljs-string">"click"</span> );
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
	},

	_handleMenuPageHide: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-848">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-848">&#182;</a>
              </div>
              <p>TODO centralize page removal binding / handling in the page plugin.
Suggestion from @jblas to do refcounting</p>
<p>TODO extremely confusing dependency on the open method where the pagehide.remove
bindings are stripped to prevent the parent page from disappearing. The way
we’re keeping pages in the DOM right now sucks</p>
<p>rebind the page remove that was unbound in the open function
to allow for the parent page removal from actions other than the use
of a dialog sized custom select</p>
<p>doing this here provides for the back button on the custom select dialog</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.thisPage.page( <span class="hljs-string">"bindRemove"</span> );
	},

	_handleHeaderCloseClick: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.menuType === <span class="hljs-string">"overlay"</span> ) {
			<span class="hljs-keyword">this</span>.close();
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
	},

	build: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> selectId, popupId, dialogId, label, thisPage, isMultiple, menuId,
			themeAttr, overlayTheme, overlayThemeAttr, dividerThemeAttr,
			menuPage, listbox, list, header, headerTitle, menuPageContent,
			menuPageClose, headerClose, self,
			o = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">if</span> ( o.nativeMenu ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._super();
		}

		self = <span class="hljs-keyword">this</span>;
		selectId = <span class="hljs-keyword">this</span>.selectId;
		popupId = selectId + <span class="hljs-string">"-listbox"</span>;
		dialogId = selectId + <span class="hljs-string">"-dialog"</span>;
		label = <span class="hljs-keyword">this</span>.label;
		thisPage = <span class="hljs-keyword">this</span>.element.closest( <span class="hljs-string">".ui-page"</span> );
		isMultiple = <span class="hljs-keyword">this</span>.element[ <span class="hljs-number">0</span> ].multiple;
		menuId = selectId + <span class="hljs-string">"-menu"</span>;
		themeAttr = o.theme ? ( <span class="hljs-string">" data-"</span> + $.mobile.ns + <span class="hljs-string">"theme='"</span> + o.theme + <span class="hljs-string">"'"</span> ) : <span class="hljs-string">""</span>;
		overlayTheme = o.overlayTheme || o.theme || <span class="hljs-literal">null</span>;
		overlayThemeAttr = overlayTheme ? ( <span class="hljs-string">" data-"</span> + $.mobile.ns +
			<span class="hljs-string">"overlay-theme='"</span> + overlayTheme + <span class="hljs-string">"'"</span> ) : <span class="hljs-string">""</span>;
		dividerThemeAttr = ( o.dividerTheme &amp;&amp; isMultiple ) ? ( <span class="hljs-string">" data-"</span> + $.mobile.ns + <span class="hljs-string">"divider-theme='"</span> + o.dividerTheme + <span class="hljs-string">"'"</span> ) : <span class="hljs-string">""</span>;
		menuPage = $( <span class="hljs-string">"&lt;div data-"</span> + $.mobile.ns + <span class="hljs-string">"role='dialog' class='ui-selectmenu' id='"</span> + dialogId + <span class="hljs-string">"'"</span> + themeAttr + overlayThemeAttr + <span class="hljs-string">"&gt;"</span> +
			<span class="hljs-string">"&lt;div data-"</span> + $.mobile.ns + <span class="hljs-string">"role='header'&gt;"</span> +
			<span class="hljs-string">"&lt;div class='ui-title'&gt;"</span> + label.getEncodedText() + <span class="hljs-string">"&lt;/div&gt;"</span>+
			<span class="hljs-string">"&lt;/div&gt;"</span>+
			<span class="hljs-string">"&lt;div data-"</span> + $.mobile.ns + <span class="hljs-string">"role='content'&gt;&lt;/div&gt;"</span>+
			<span class="hljs-string">"&lt;/div&gt;"</span> );
		listbox = $( <span class="hljs-string">"&lt;div id='"</span> + popupId + <span class="hljs-string">"' class='ui-selectmenu'&gt;&lt;/div&gt;"</span> ).insertAfter( <span class="hljs-keyword">this</span>.select ).popup({ theme: o.overlayTheme });
		list = $( <span class="hljs-string">"&lt;ul class='ui-selectmenu-list' id='"</span> + menuId + <span class="hljs-string">"' role='listbox' aria-labelledby='"</span> + <span class="hljs-keyword">this</span>.buttonId + <span class="hljs-string">"'"</span> + themeAttr + dividerThemeAttr + <span class="hljs-string">"&gt;&lt;/ul&gt;"</span> ).appendTo( listbox );
		header = $( <span class="hljs-string">"&lt;div class='ui-header ui-bar-"</span> + ( o.theme ? o.theme : <span class="hljs-string">"inherit"</span> ) + <span class="hljs-string">"'&gt;&lt;/div&gt;"</span> ).prependTo( listbox );
		headerTitle = $( <span class="hljs-string">"&lt;h1 class='ui-title'&gt;&lt;/h1&gt;"</span> ).appendTo( header );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isMultiple ) {
			headerClose = $( <span class="hljs-string">"&lt;a&gt;"</span>, {
				<span class="hljs-string">"role"</span>: <span class="hljs-string">"button"</span>,
				<span class="hljs-string">"text"</span>: o.closeText,
				<span class="hljs-string">"href"</span>: <span class="hljs-string">"#"</span>,
				<span class="hljs-string">"class"</span>: <span class="hljs-string">"ui-btn ui-corner-all ui-btn-left ui-btn-icon-notext ui-icon-delete"</span>
			}).appendTo( header );
		}

		$.extend( <span class="hljs-keyword">this</span>, {
			selectId: selectId,
			menuId: menuId,
			popupId: popupId,
			dialogId: dialogId,
			thisPage: thisPage,
			menuPage: menuPage,
			label: label,
			isMultiple: isMultiple,
			theme: o.theme,
			listbox: listbox,
			list: list,
			header: header,
			headerTitle: headerTitle,
			headerClose: headerClose,
			menuPageContent: menuPageContent,
			menuPageClose: menuPageClose,
			placeholder: <span class="hljs-string">""</span>
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-849">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-849">&#182;</a>
              </div>
              <p>Create list from select, update state</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.refresh();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._origTabIndex === <span class="hljs-literal">undefined</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-850">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-850">&#182;</a>
              </div>
              <p>Map undefined to false, because this._origTabIndex === undefined
indicates that we have not yet checked whether the select has
originally had a tabindex attribute, whereas false indicates that
we have checked the select for such an attribute, and have found
none present.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._origTabIndex = ( <span class="hljs-keyword">this</span>.select[ <span class="hljs-number">0</span> ].getAttribute( <span class="hljs-string">"tabindex"</span> ) === <span class="hljs-literal">null</span> ) ? <span class="hljs-literal">false</span> : <span class="hljs-keyword">this</span>.select.attr( <span class="hljs-string">"tabindex"</span> );
		}
		<span class="hljs-keyword">this</span>.select.attr( <span class="hljs-string">"tabindex"</span>, <span class="hljs-string">"-1"</span> );
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.select, { focus : <span class="hljs-string">"_handleSelectFocus"</span> } );</pre></div></div>
            
        </li>
        
        
        <li id="section-851">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-851">&#182;</a>
              </div>
              <p>Button events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.button, {
			vclick: <span class="hljs-string">"_handleButtonVclickKeydown"</span>
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-852">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-852">&#182;</a>
              </div>
              <p>Events for list items</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.list.attr( <span class="hljs-string">"role"</span>, <span class="hljs-string">"listbox"</span> );
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.list, {
			focusin : <span class="hljs-string">"_handleListFocus"</span>,
			focusout : <span class="hljs-string">"_handleListFocus"</span>,
			keydown: <span class="hljs-string">"_handleListKeydown"</span>
		});
		<span class="hljs-keyword">this</span>.list
			.delegate( <span class="hljs-string">"li:not(.ui-disabled,.ui-state-disabled,.ui-li-divider)"</span>, <span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-853">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-853">&#182;</a>
              </div>
              <p>index of option tag to be selected</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">var</span> oldIndex = self.select[ <span class="hljs-number">0</span> ].selectedIndex,
					newIndex = $.mobile.getAttribute( <span class="hljs-keyword">this</span>, <span class="hljs-string">"option-index"</span> ),
					option = self._selectOptions().eq( newIndex )[ <span class="hljs-number">0</span> ];</pre></div></div>
            
        </li>
        
        
        <li id="section-854">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-854">&#182;</a>
              </div>
              <p>toggle selected status on the tag for multi selects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				option.selected = self.isMultiple ? !option.selected : <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-855">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-855">&#182;</a>
              </div>
              <p>toggle checkbox class for multiple selects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( self.isMultiple ) {
					$( <span class="hljs-keyword">this</span> ).find( <span class="hljs-string">"a"</span> )
						.toggleClass( <span class="hljs-string">"ui-checkbox-on"</span>, option.selected )
						.toggleClass( <span class="hljs-string">"ui-checkbox-off"</span>, !option.selected );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-856">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-856">&#182;</a>
              </div>
              <p>trigger change if value changed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( self.isMultiple || oldIndex !== newIndex ) {
					self.select.trigger( <span class="hljs-string">"change"</span> );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-857">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-857">&#182;</a>
              </div>
              <p>hide custom select for single selects only - otherwise focus clicked item
We need to grab the clicked item the hard way, because the list may have been rebuilt</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( self.isMultiple ) {
					self.list.find( <span class="hljs-string">"li:not(.ui-li-divider)"</span> ).eq( newIndex )
						.find( <span class="hljs-string">"a"</span> ).first().focus();
				}
				<span class="hljs-keyword">else</span> {
					self.close();
				}

				event.preventDefault();
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-858">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-858">&#182;</a>
              </div>
              <p>button refocus ensures proper height calculation
by removing the inline style and ensuring page inclusion</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.menuPage, { pagehide: <span class="hljs-string">"_handleMenuPageHide"</span> } );</pre></div></div>
            
        </li>
        
        
        <li id="section-859">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-859">&#182;</a>
              </div>
              <p>Events on the popup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.listbox, { popupafterclose: <span class="hljs-string">"close"</span> } );</pre></div></div>
            
        </li>
        
        
        <li id="section-860">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-860">&#182;</a>
              </div>
              <p>Close button on small overlays</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isMultiple ) {
			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.headerClose, { click: <span class="hljs-string">"_handleHeaderCloseClick"</span> } );
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
	},

	_isRebuildRequired: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> list = <span class="hljs-keyword">this</span>.list.find( <span class="hljs-string">"li"</span> ),
			options = <span class="hljs-keyword">this</span>._selectOptions().not( <span class="hljs-string">".ui-screen-hidden"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-861">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-861">&#182;</a>
              </div>
              <p>TODO exceedingly naive method to determine difference
ignores value changes etc in favor of a forcedRebuild
from the user in the refresh method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> options.text() !== list.text();
	},

	selected: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._selectOptions().filter( <span class="hljs-string">":selected:not( :jqmData(placeholder='true') )"</span> );
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( force )</span> {</span>
		<span class="hljs-keyword">var</span> self, indices;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.nativeMenu ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._super( force );
		}

		self = <span class="hljs-keyword">this</span>;
		<span class="hljs-keyword">if</span> ( force || <span class="hljs-keyword">this</span>._isRebuildRequired() ) {
			self._buildList();
		}

		indices = <span class="hljs-keyword">this</span>.selectedIndices();

		self.setButtonText();
		self.setButtonCount();

		self.list.find( <span class="hljs-string">"li:not(.ui-li-divider)"</span> )
			.find( <span class="hljs-string">"a"</span> ).removeClass( $.mobile.activeBtnClass ).end()
			.attr( <span class="hljs-string">"aria-selected"</span>, <span class="hljs-literal">false</span> )
			.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( i )</span> {</span>

				<span class="hljs-keyword">if</span> ( $.inArray( i, indices ) &gt; -<span class="hljs-number">1</span> ) {
					<span class="hljs-keyword">var</span> item = $( <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-862">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-862">&#182;</a>
              </div>
              <p>Aria selected attr</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					item.attr( <span class="hljs-string">"aria-selected"</span>, <span class="hljs-literal">true</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-863">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-863">&#182;</a>
              </div>
              <p>Multiple selects: add the “on” checkbox state to the icon</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( self.isMultiple ) {
						item.find( <span class="hljs-string">"a"</span> ).removeClass( <span class="hljs-string">"ui-checkbox-off"</span> ).addClass( <span class="hljs-string">"ui-checkbox-on"</span> );
					} <span class="hljs-keyword">else</span> {
						<span class="hljs-keyword">if</span> ( item.hasClass( <span class="hljs-string">"ui-screen-hidden"</span> ) ) {
							item.next().find( <span class="hljs-string">"a"</span> ).addClass( $.mobile.activeBtnClass );
						} <span class="hljs-keyword">else</span> {
							item.find( <span class="hljs-string">"a"</span> ).addClass( $.mobile.activeBtnClass );
						}
					}
				}
			});
	},

	close: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.disabled || !<span class="hljs-keyword">this</span>.isOpen ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">if</span> ( self.menuType === <span class="hljs-string">"page"</span> ) {
			self.menuPage.dialog( <span class="hljs-string">"close"</span> );
			self.list.appendTo( self.listbox );
		} <span class="hljs-keyword">else</span> {
			self.listbox.popup( <span class="hljs-string">"close"</span> );
		}

		self._focusButton();</pre></div></div>
            
        </li>
        
        
        <li id="section-864">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-864">&#182;</a>
              </div>
              <p>allow the dialog to be closed again</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		self.isOpen = <span class="hljs-literal">false</span>;
	},

	open: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.button.click();
	},

	_focusMenuItem: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> selector = <span class="hljs-keyword">this</span>.list.find( <span class="hljs-string">"a."</span> + $.mobile.activeBtnClass );
		<span class="hljs-keyword">if</span> ( selector.length === <span class="hljs-number">0</span> ) {
			selector = <span class="hljs-keyword">this</span>.list.find( <span class="hljs-string">"li:not("</span> + unfocusableItemSelector + <span class="hljs-string">") a.ui-btn"</span> );
		}
		selector.first().focus();
	},

	_decideFormat: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
			$window = <span class="hljs-keyword">this</span>.window,
			selfListParent = self.list.parent(),
			menuHeight = selfListParent.outerHeight(),
			scrollTop = $window.scrollTop(),
			btnOffset = self.button.offset().top,
			screenHeight = $window.height();

		<span class="hljs-keyword">if</span> ( menuHeight &gt; screenHeight - <span class="hljs-number">80</span> || !$.support.scrollTop ) {

			self.menuPage.appendTo( $.mobile.pageContainer ).page();
			self.menuPageContent = self.menuPage.find( <span class="hljs-string">".ui-content"</span> );
			self.menuPageClose = self.menuPage.find( <span class="hljs-string">".ui-header a"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-865">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-865">&#182;</a>
              </div>
              <p>prevent the parent page from being removed from the DOM,
otherwise the results of selecting a list item in the dialog
fall into a black hole</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			self.thisPage.unbind( <span class="hljs-string">"pagehide.remove"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-866">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-866">&#182;</a>
              </div>
              <p>for WebOS/Opera Mini (set lastscroll using button offset)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( scrollTop === <span class="hljs-number">0</span> &amp;&amp; btnOffset &gt; screenHeight ) {
				self.thisPage.one( <span class="hljs-string">"pagehide"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					$( <span class="hljs-keyword">this</span> ).jqmData( <span class="hljs-string">"lastScroll"</span>, btnOffset );
				});
			}

			self.menuPage.one( {
				pageshow: $.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_focusMenuItem"</span> ),
				pagehide: $.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"close"</span> )
			});

			self.menuType = <span class="hljs-string">"page"</span>;
			self.menuPageContent.append( self.list );
			self.menuPage.find( <span class="hljs-string">"div .ui-title"</span> ).text( self.label.text() );
		} <span class="hljs-keyword">else</span> {
			self.menuType = <span class="hljs-string">"overlay"</span>;

			self.listbox.one( { popupafteropen: $.proxy( <span class="hljs-keyword">this</span>, <span class="hljs-string">"_focusMenuItem"</span> ) } );
		}
	},

	_buildList: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
			o = <span class="hljs-keyword">this</span>.options,
			placeholder = <span class="hljs-keyword">this</span>.placeholder,
			needPlaceholder = <span class="hljs-literal">true</span>,
			dataIcon = <span class="hljs-string">"false"</span>,
			$options, numOptions, select,
			dataPrefix = <span class="hljs-string">"data-"</span> + $.mobile.ns,
			dataIndexAttr = dataPrefix + <span class="hljs-string">"option-index"</span>,
			dataIconAttr = dataPrefix + <span class="hljs-string">"icon"</span>,
			dataRoleAttr = dataPrefix + <span class="hljs-string">"role"</span>,
			dataPlaceholderAttr = dataPrefix + <span class="hljs-string">"placeholder"</span>,
			fragment = document.createDocumentFragment(),
			isPlaceholderItem = <span class="hljs-literal">false</span>,
			optGroup,
			i,
			option, $option, parent, text, anchor, classes,
			optLabel, divider, item;

		self.list.empty().filter( <span class="hljs-string">".ui-listview"</span> ).listview( <span class="hljs-string">"destroy"</span> );
		$options = <span class="hljs-keyword">this</span>._selectOptions();
		numOptions = $options.length;
		select = <span class="hljs-keyword">this</span>.select[ <span class="hljs-number">0</span> ];

		<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; numOptions;i++, isPlaceholderItem = <span class="hljs-literal">false</span>) {
			option = $options[i];
			$option = $( option );</pre></div></div>
            
        </li>
        
        
        <li id="section-867">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-867">&#182;</a>
              </div>
              <p>Do not create options based on ui-screen-hidden select options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( $option.hasClass( <span class="hljs-string">"ui-screen-hidden"</span> ) ) {
				<span class="hljs-keyword">continue</span>;
			}

			parent = option.parentNode;
			text = $option.text();
			anchor  = document.createElement( <span class="hljs-string">"a"</span> );
			classes = [];

			anchor.setAttribute( <span class="hljs-string">"href"</span>, <span class="hljs-string">"#"</span> );
			anchor.appendChild( document.createTextNode( text ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-868">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-868">&#182;</a>
              </div>
              <p>Are we inside an optgroup?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( parent !== select &amp;&amp; parent.nodeName.toLowerCase() === <span class="hljs-string">"optgroup"</span> ) {
				optLabel = parent.getAttribute( <span class="hljs-string">"label"</span> );
				<span class="hljs-keyword">if</span> ( optLabel !== optGroup ) {
					divider = document.createElement( <span class="hljs-string">"li"</span> );
					divider.setAttribute( dataRoleAttr, <span class="hljs-string">"list-divider"</span> );
					divider.setAttribute( <span class="hljs-string">"role"</span>, <span class="hljs-string">"option"</span> );
					divider.setAttribute( <span class="hljs-string">"tabindex"</span>, <span class="hljs-string">"-1"</span> );
					divider.appendChild( document.createTextNode( optLabel ) );
					fragment.appendChild( divider );
					optGroup = optLabel;
				}
			}

			<span class="hljs-keyword">if</span> ( needPlaceholder &amp;&amp; ( !option.getAttribute( <span class="hljs-string">"value"</span> ) || text.length === <span class="hljs-number">0</span> || $option.jqmData( <span class="hljs-string">"placeholder"</span> ) ) ) {
				needPlaceholder = <span class="hljs-literal">false</span>;
				isPlaceholderItem = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-869">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-869">&#182;</a>
              </div>
              <p>If we have identified a placeholder, record the fact that it was
us who have added the placeholder to the option and mark it
retroactively in the select as well</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( <span class="hljs-literal">null</span> === option.getAttribute( dataPlaceholderAttr ) ) {
					<span class="hljs-keyword">this</span>._removePlaceholderAttr = <span class="hljs-literal">true</span>;
				}
				option.setAttribute( dataPlaceholderAttr, <span class="hljs-literal">true</span> );
				<span class="hljs-keyword">if</span> ( o.hidePlaceholderMenuItems ) {
					classes.push( <span class="hljs-string">"ui-screen-hidden"</span> );
				}
				<span class="hljs-keyword">if</span> ( placeholder !== text ) {
					placeholder = self.placeholder = text;
				}
			}

			item = document.createElement( <span class="hljs-string">"li"</span> );
			<span class="hljs-keyword">if</span> ( option.disabled ) {
				classes.push( <span class="hljs-string">"ui-state-disabled"</span> );
				item.setAttribute( <span class="hljs-string">"aria-disabled"</span>, <span class="hljs-literal">true</span> );
			}
			item.setAttribute( dataIndexAttr, i );
			item.setAttribute( dataIconAttr, dataIcon );
			<span class="hljs-keyword">if</span> ( isPlaceholderItem ) {
				item.setAttribute( dataPlaceholderAttr, <span class="hljs-literal">true</span> );
			}
			item.className = classes.join( <span class="hljs-string">" "</span> );
			item.setAttribute( <span class="hljs-string">"role"</span>, <span class="hljs-string">"option"</span> );
			anchor.setAttribute( <span class="hljs-string">"tabindex"</span>, <span class="hljs-string">"-1"</span> );
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.isMultiple ) {
				$( anchor ).addClass( <span class="hljs-string">"ui-btn ui-checkbox-off ui-btn-icon-right"</span> );
			}

			item.appendChild( anchor );
			fragment.appendChild( item );
		}

		self.list[<span class="hljs-number">0</span>].appendChild( fragment );</pre></div></div>
            
        </li>
        
        
        <li id="section-870">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-870">&#182;</a>
              </div>
              <p>Hide header if it’s not a multiselect and there’s no placeholder</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.isMultiple &amp;&amp; !placeholder.length ) {
			<span class="hljs-keyword">this</span>.header.addClass( <span class="hljs-string">"ui-screen-hidden"</span> );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.headerTitle.text( <span class="hljs-keyword">this</span>.placeholder );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-871">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-871">&#182;</a>
              </div>
              <p>Now populated, create listview</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		self.list.listview();
	},

	_button: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.options.nativeMenu ?
			<span class="hljs-keyword">this</span>._super() :
			$( <span class="hljs-string">"&lt;a&gt;"</span>, {
				<span class="hljs-string">"href"</span>: <span class="hljs-string">"#"</span>,
				<span class="hljs-string">"role"</span>: <span class="hljs-string">"button"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-872">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-872">&#182;</a>
              </div>
              <p>TODO value is undefined at creation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-string">"id"</span>: <span class="hljs-keyword">this</span>.buttonId,
				<span class="hljs-string">"aria-haspopup"</span>: <span class="hljs-string">"true"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-873">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-873">&#182;</a>
              </div>
              <p>TODO value is undefined at creation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-string">"aria-owns"</span>: <span class="hljs-keyword">this</span>.menuId
			});
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.options.nativeMenu ) {
			<span class="hljs-keyword">this</span>.close();</pre></div></div>
            
        </li>
        
        
        <li id="section-874">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-874">&#182;</a>
              </div>
              <p>Restore the tabindex attribute to its original value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._origTabIndex !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._origTabIndex !== <span class="hljs-literal">false</span> ) {
					<span class="hljs-keyword">this</span>.select.attr( <span class="hljs-string">"tabindex"</span>, <span class="hljs-keyword">this</span>._origTabIndex );
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">this</span>.select.removeAttr( <span class="hljs-string">"tabindex"</span> );
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-875">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-875">&#182;</a>
              </div>
              <p>Remove the placeholder attribute if we were the ones to add it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._removePlaceholderAttr ) {
				<span class="hljs-keyword">this</span>._selectOptions().removeAttr( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"placeholder"</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-876">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-876">&#182;</a>
              </div>
              <p>Remove the popup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.listbox.remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-877">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-877">&#182;</a>
              </div>
              <p>Remove the dialog</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.menuPage.remove();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-878">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-878">&#182;</a>
              </div>
              <p>Chain up</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._super();
	}
});

})( jQuery );</pre></div></div>
            
        </li>
        
        
        <li id="section-879">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-879">&#182;</a>
              </div>
              <p>buttonMarkup is deprecated as of 1.4.0 and will be removed in 1.5.0.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-880">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-880">&#182;</a>
              </div>
              <p>General policy: Do not access data-* attributes except during enhancement.
In all other cases we determine the state of the button exclusively from its
className. That’s why optionsToClasses expects a full complement of options,
and the jQuery plugin completes the set of options from the default values.</p>

            </div>
            
        </li>
        
        
        <li id="section-881">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-881">&#182;</a>
              </div>
              <p>Map classes to buttonMarkup boolean options - used in classNameToOptions()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> reverseBoolOptionMap = {
		<span class="hljs-string">"ui-shadow"</span> : <span class="hljs-string">"shadow"</span>,
		<span class="hljs-string">"ui-corner-all"</span> : <span class="hljs-string">"corners"</span>,
		<span class="hljs-string">"ui-btn-inline"</span> : <span class="hljs-string">"inline"</span>,
		<span class="hljs-string">"ui-shadow-icon"</span> : <span class="hljs-string">"iconshadow"</span>, <span class="hljs-comment">/* TODO: Remove in 1.5 */</span>
		<span class="hljs-string">"ui-mini"</span> : <span class="hljs-string">"mini"</span>
	},
	getAttrFixed = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> ret = $.mobile.getAttribute.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );

		<span class="hljs-keyword">return</span> ( ret == <span class="hljs-literal">null</span> ? <span class="hljs-literal">undefined</span> : ret );
	},
	capitalLettersRE = <span class="hljs-regexp">/[A-Z]/g</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-882">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-882">&#182;</a>
              </div>
              <p>optionsToClasses:
@options: A complete set of options to convert to class names.
@existingClasses: extra classes to add to the result</p>
<p>Converts @options to buttonMarkup classes and returns the result as an array
that can be converted to an element’s className with .join( “ “ ). All
possible options must be set inside @options. Use $.fn.buttonMarkup.defaults
to get a complete set and use $.extend to override your choice of options
from that set.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">optionsToClasses</span><span class="hljs-params">( options, existingClasses )</span> {</span>
	<span class="hljs-keyword">var</span> classes = existingClasses ? existingClasses : [];</pre></div></div>
            
        </li>
        
        
        <li id="section-883">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-883">&#182;</a>
              </div>
              <p>Add classes to the array - first ui-btn</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	classes.push( <span class="hljs-string">"ui-btn"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-884">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-884">&#182;</a>
              </div>
              <p>If there is a theme</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( options.theme ) {
		classes.push( <span class="hljs-string">"ui-btn-"</span> + options.theme );
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-885">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-885">&#182;</a>
              </div>
              <p>If there’s an icon, add the icon-related classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( options.icon ) {
		classes = classes.concat([
			<span class="hljs-string">"ui-icon-"</span> + options.icon,
			<span class="hljs-string">"ui-btn-icon-"</span> + options.iconpos
		]);
		<span class="hljs-keyword">if</span> ( options.iconshadow ) {
			classes.push( <span class="hljs-string">"ui-shadow-icon"</span> ); <span class="hljs-comment">/* TODO: Remove in 1.5 */</span>
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-886">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-886">&#182;</a>
              </div>
              <p>Add the appropriate class for each boolean option</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( options.inline ) {
		classes.push( <span class="hljs-string">"ui-btn-inline"</span> );
	}
	<span class="hljs-keyword">if</span> ( options.shadow ) {
		classes.push( <span class="hljs-string">"ui-shadow"</span> );
	}
	<span class="hljs-keyword">if</span> ( options.corners ) {
		classes.push( <span class="hljs-string">"ui-corner-all"</span> );
	}
	<span class="hljs-keyword">if</span> ( options.mini ) {
		classes.push( <span class="hljs-string">"ui-mini"</span> );
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-887">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-887">&#182;</a>
              </div>
              <p>Create a string from the array and return it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">return</span> classes;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-888">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-888">&#182;</a>
              </div>
              <p>classNameToOptions:
@classes: A string containing a .className-style space-separated class list</p>
<p>Loops over @classes and calculates an options object based on the
buttonMarkup-related classes it finds. It records unrecognized classes in an
array.</p>
<p>Returns: An object containing the following items:</p>
<p>“options”: buttonMarkup options found to be present because of the
presence/absence of corresponding classes</p>
<p>“unknownClasses”: a string containing all the non-buttonMarkup-related
classes found in @classes</p>
<p>“alreadyEnhanced”: A boolean indicating whether the ui-btn class was among
those found to be present</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">classNameToOptions</span><span class="hljs-params">( classes )</span> {</span>
	<span class="hljs-keyword">var</span> idx, map, unknownClass,
		alreadyEnhanced = <span class="hljs-literal">false</span>,
		noIcon = <span class="hljs-literal">true</span>,
		o = {
			icon: <span class="hljs-string">""</span>,
			inline: <span class="hljs-literal">false</span>,
			shadow: <span class="hljs-literal">false</span>,
			corners: <span class="hljs-literal">false</span>,
			iconshadow: <span class="hljs-literal">false</span>,
			mini: <span class="hljs-literal">false</span>
		},
		unknownClasses = [];

	classes = classes.split( <span class="hljs-string">" "</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-889">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-889">&#182;</a>
              </div>
              <p>Loop over the classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">for</span> ( idx = <span class="hljs-number">0</span> ; idx &lt; classes.length ; idx++ ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-890">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-890">&#182;</a>
              </div>
              <p>Assume it’s an unrecognized class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		unknownClass = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-891">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-891">&#182;</a>
              </div>
              <p>Recognize boolean options from the presence of classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		map = reverseBoolOptionMap[ classes[ idx ] ];
		<span class="hljs-keyword">if</span> ( map !== <span class="hljs-literal">undefined</span> ) {
			unknownClass = <span class="hljs-literal">false</span>;
			o[ map ] = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-892">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-892">&#182;</a>
              </div>
              <p>Recognize the presence of an icon and establish the icon position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( classes[ idx ].indexOf( <span class="hljs-string">"ui-btn-icon-"</span> ) === <span class="hljs-number">0</span> ) {
			unknownClass = <span class="hljs-literal">false</span>;
			noIcon = <span class="hljs-literal">false</span>;
			o.iconpos = classes[ idx ].substring( <span class="hljs-number">12</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-893">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-893">&#182;</a>
              </div>
              <p>Establish which icon is present</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( classes[ idx ].indexOf( <span class="hljs-string">"ui-icon-"</span> ) === <span class="hljs-number">0</span> ) {
			unknownClass = <span class="hljs-literal">false</span>;
			o.icon = classes[ idx ].substring( <span class="hljs-number">8</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-894">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-894">&#182;</a>
              </div>
              <p>Establish the theme - this recognizes one-letter theme swatch names</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( classes[ idx ].indexOf( <span class="hljs-string">"ui-btn-"</span> ) === <span class="hljs-number">0</span> &amp;&amp; classes[ idx ].length === <span class="hljs-number">8</span> ) {
			unknownClass = <span class="hljs-literal">false</span>;
			o.theme = classes[ idx ].substring( <span class="hljs-number">7</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-895">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-895">&#182;</a>
              </div>
              <p>Recognize that this element has already been buttonMarkup-enhanced</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( classes[ idx ] === <span class="hljs-string">"ui-btn"</span> ) {
			unknownClass = <span class="hljs-literal">false</span>;
			alreadyEnhanced = <span class="hljs-literal">true</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-896">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-896">&#182;</a>
              </div>
              <p>If this class has not been recognized, add it to the list</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( unknownClass ) {
			unknownClasses.push( classes[ idx ] );
		}
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-897">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-897">&#182;</a>
              </div>
              <p>If a “ui-btn-icon-*” icon position class is absent there cannot be an icon</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( noIcon ) {
		o.icon = <span class="hljs-string">""</span>;
	}

	<span class="hljs-keyword">return</span> {
		options: o,
		unknownClasses: unknownClasses,
		alreadyEnhanced: alreadyEnhanced
	};
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">camelCase2Hyphenated</span><span class="hljs-params">( c )</span> {</span>
	<span class="hljs-keyword">return</span> <span class="hljs-string">"-"</span> + c.toLowerCase();
}</pre></div></div>
            
        </li>
        
        
        <li id="section-898">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-898">&#182;</a>
              </div>
              <p>$.fn.buttonMarkup:
DOM: gets/sets .className</p>
<p>@options: options to apply to the elements in the jQuery object
@overwriteClasses: boolean indicating whether to honour existing classes</p>
<p>Calculates the classes to apply to the elements in the jQuery object based on
the options passed in. If @overwriteClasses is true, it sets the className
property of each element in the jQuery object to the buttonMarkup classes
it calculates based on the options passed in.</p>
<p>If you wish to preserve any classes that are already present on the elements
inside the jQuery object, including buttonMarkup-related classes that were
added by a previous call to $.fn.buttonMarkup() or during page enhancement
then you should omit @overwriteClasses or set it to false.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.fn.buttonMarkup = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options, overwriteClasses )</span> {</span>
	<span class="hljs-keyword">var</span> idx, data, el, retrievedOptions, optionKey,
		defaults = $.fn.buttonMarkup.defaults;

	<span class="hljs-keyword">for</span> ( idx = <span class="hljs-number">0</span> ; idx &lt; <span class="hljs-keyword">this</span>.length ; idx++ ) {
		el = <span class="hljs-keyword">this</span>[ idx ];
		data = overwriteClasses ?</pre></div></div>
            
        </li>
        
        
        <li id="section-899">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-899">&#182;</a>
              </div>
              <p>Assume this element is not enhanced and ignore its classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			{ alreadyEnhanced: <span class="hljs-literal">false</span>, unknownClasses: [] } :</pre></div></div>
            
        </li>
        
        
        <li id="section-900">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-900">&#182;</a>
              </div>
              <p>Otherwise analyze existing classes to establish existing options and
classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			classNameToOptions( el.className );

		retrievedOptions = $.extend( {},</pre></div></div>
            
        </li>
        
        
        <li id="section-901">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-901">&#182;</a>
              </div>
              <p>If the element already has the class ui-btn, then we assume that
it has passed through buttonMarkup before - otherwise, the options
returned by classNameToOptions do not correctly reflect the state of
the element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			( data.alreadyEnhanced ? data.options : {} ),</pre></div></div>
            
        </li>
        
        
        <li id="section-902">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-902">&#182;</a>
              </div>
              <p>Finally, apply the options passed in</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			options );</pre></div></div>
            
        </li>
        
        
        <li id="section-903">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-903">&#182;</a>
              </div>
              <p>If this is the first call on this element, retrieve remaining options
from the data-attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !data.alreadyEnhanced ) {
			<span class="hljs-keyword">for</span> ( optionKey <span class="hljs-keyword">in</span> defaults ) {
				<span class="hljs-keyword">if</span> ( retrievedOptions[ optionKey ] === <span class="hljs-literal">undefined</span> ) {
					retrievedOptions[ optionKey ] = getAttrFixed( el,
						optionKey.replace( capitalLettersRE, camelCase2Hyphenated )
					);
				}
			}
		}

		el.className = optionsToClasses(</pre></div></div>
            
        </li>
        
        
        <li id="section-904">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-904">&#182;</a>
              </div>
              <p>Merge all the options and apply them as classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.extend( {},</pre></div></div>
            
        </li>
        
        
        <li id="section-905">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-905">&#182;</a>
              </div>
              <p>The defaults form the basis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				defaults,</pre></div></div>
            
        </li>
        
        
        <li id="section-906">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-906">&#182;</a>
              </div>
              <p>Add the computed options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				retrievedOptions
			),</pre></div></div>
            
        </li>
        
        
        <li id="section-907">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-907">&#182;</a>
              </div>
              <p>… and re-apply any unrecognized classes that were found</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			data.unknownClasses ).join( <span class="hljs-string">" "</span> );
		<span class="hljs-keyword">if</span> ( el.tagName.toLowerCase() !== <span class="hljs-string">"button"</span> ) {
			el.setAttribute( <span class="hljs-string">"role"</span>, <span class="hljs-string">"button"</span> );
		}
	}

	<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-908">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-908">&#182;</a>
              </div>
              <p>buttonMarkup defaults. This must be a complete set, i.e., a value must be
given here for all recognized options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.fn.buttonMarkup.defaults = {
	icon: <span class="hljs-string">""</span>,
	iconpos: <span class="hljs-string">"left"</span>,
	theme: <span class="hljs-literal">null</span>,
	inline: <span class="hljs-literal">false</span>,
	shadow: <span class="hljs-literal">true</span>,
	corners: <span class="hljs-literal">true</span>,
	iconshadow: <span class="hljs-literal">false</span>, <span class="hljs-comment">/* TODO: Remove in 1.5. Option deprecated in 1.4. */</span>
	mini: <span class="hljs-literal">false</span>
};

$.extend( $.fn.buttonMarkup, {
	initSelector: <span class="hljs-string">"a:jqmData(role='button'), .ui-bar &gt; a, .ui-bar &gt; :jqmData(role='controlgroup') &gt; a, button"</span>
});

})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.controlgroup"</span>, $.extend( {
	options: {
		enhanced: <span class="hljs-literal">false</span>,
		theme: <span class="hljs-literal">null</span>,
		shadow: <span class="hljs-literal">false</span>,
		corners: <span class="hljs-literal">true</span>,
		excludeInvisible: <span class="hljs-literal">true</span>,
		type: <span class="hljs-string">"vertical"</span>,
		mini: <span class="hljs-literal">false</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> elem = <span class="hljs-keyword">this</span>.element,
			opts = <span class="hljs-keyword">this</span>.options;</pre></div></div>
            
        </li>
        
        
        <li id="section-909">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-909">&#182;</a>
              </div>
              <p>Run buttonmarkup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.fn.buttonMarkup ) {
			<span class="hljs-keyword">this</span>.element.find( $.fn.buttonMarkup.initSelector ).buttonMarkup();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-910">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-910">&#182;</a>
              </div>
              <p>Enhance child widgets</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.each( <span class="hljs-keyword">this</span>._childWidgets, $.proxy( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( number, widgetName )</span> {</span>
			<span class="hljs-keyword">if</span> ( $.mobile[ widgetName ] ) {
				<span class="hljs-keyword">this</span>.element.find( $.mobile[ widgetName ].initSelector ).not( $.mobile.page.prototype.keepNativeSelector() )[ widgetName ]();
			}
		}, <span class="hljs-keyword">this</span> ));

		$.extend( <span class="hljs-keyword">this</span>, {
			_ui: <span class="hljs-literal">null</span>,
			_initialRefresh: <span class="hljs-literal">true</span>
		});

		<span class="hljs-keyword">if</span> ( opts.enhanced ) {
			<span class="hljs-keyword">this</span>._ui = {
				groupLegend: elem.children( <span class="hljs-string">".ui-controlgroup-label"</span> ).children(),
				childWrapper: elem.children( <span class="hljs-string">".ui-controlgroup-controls"</span> )
			};
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>._ui = <span class="hljs-keyword">this</span>._enhance();
		}

	},

	_childWidgets: [ <span class="hljs-string">"checkboxradio"</span>, <span class="hljs-string">"selectmenu"</span>, <span class="hljs-string">"button"</span> ],

	_themeClassFromOption: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( value )</span> {</span>
		<span class="hljs-keyword">return</span> ( value ? ( value === <span class="hljs-string">"none"</span> ? <span class="hljs-string">""</span> : <span class="hljs-string">"ui-group-theme-"</span> + value ) : <span class="hljs-string">""</span> );
	},

	_enhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> elem = <span class="hljs-keyword">this</span>.element,
			opts = <span class="hljs-keyword">this</span>.options,
			ui = {
				groupLegend: elem.children( <span class="hljs-string">"legend"</span> ),
				childWrapper: elem
					.addClass( <span class="hljs-string">"ui-controlgroup "</span> +
						<span class="hljs-string">"ui-controlgroup-"</span> +
							( opts.type === <span class="hljs-string">"horizontal"</span> ? <span class="hljs-string">"horizontal"</span> : <span class="hljs-string">"vertical"</span> ) + <span class="hljs-string">" "</span> +
						<span class="hljs-keyword">this</span>._themeClassFromOption( opts.theme ) + <span class="hljs-string">" "</span> +
						( opts.corners ? <span class="hljs-string">"ui-corner-all "</span> : <span class="hljs-string">""</span> ) +
						( opts.mini ? <span class="hljs-string">"ui-mini "</span> : <span class="hljs-string">""</span> ) )
					.wrapInner( <span class="hljs-string">"&lt;div "</span> +
						<span class="hljs-string">"class='ui-controlgroup-controls "</span> +
							( opts.shadow === <span class="hljs-literal">true</span> ? <span class="hljs-string">"ui-shadow"</span> : <span class="hljs-string">""</span> ) + <span class="hljs-string">"'&gt;&lt;/div&gt;"</span> )
					.children()
			};

		<span class="hljs-keyword">if</span> ( ui.groupLegend.length &gt; <span class="hljs-number">0</span> ) {
			$( <span class="hljs-string">"&lt;div role='heading' class='ui-controlgroup-label'&gt;&lt;/div&gt;"</span> )
				.append( ui.groupLegend )
				.prependTo( elem );
		}

		<span class="hljs-keyword">return</span> ui;
	},

	_init: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.refresh();
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> callRefresh, returnValue,
			elem = <span class="hljs-keyword">this</span>.element;</pre></div></div>
            
        </li>
        
        
        <li id="section-911">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-911">&#182;</a>
              </div>
              <p>Must have one of horizontal or vertical</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( options.type !== <span class="hljs-literal">undefined</span> ) {
			elem
				.removeClass( <span class="hljs-string">"ui-controlgroup-horizontal ui-controlgroup-vertical"</span> )
				.addClass( <span class="hljs-string">"ui-controlgroup-"</span> + ( options.type === <span class="hljs-string">"horizontal"</span> ? <span class="hljs-string">"horizontal"</span> : <span class="hljs-string">"vertical"</span> ) );
			callRefresh = <span class="hljs-literal">true</span>;
		}

		<span class="hljs-keyword">if</span> ( options.theme !== <span class="hljs-literal">undefined</span> ) {
			elem
				.removeClass( <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-keyword">this</span>.options.theme ) )
				.addClass( <span class="hljs-keyword">this</span>._themeClassFromOption( options.theme ) );
		}

		<span class="hljs-keyword">if</span> ( options.corners !== <span class="hljs-literal">undefined</span> ) {
			elem.toggleClass( <span class="hljs-string">"ui-corner-all"</span>, options.corners );
		}

		<span class="hljs-keyword">if</span> ( options.mini !== <span class="hljs-literal">undefined</span> ) {
			elem.toggleClass( <span class="hljs-string">"ui-mini"</span>, options.mini );
		}

		<span class="hljs-keyword">if</span> ( options.shadow !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._ui.childWrapper.toggleClass( <span class="hljs-string">"ui-shadow"</span>, options.shadow );
		}

		<span class="hljs-keyword">if</span> ( options.excludeInvisible !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>.options.excludeInvisible = options.excludeInvisible;
			callRefresh = <span class="hljs-literal">true</span>;
		}

		returnValue = <span class="hljs-keyword">this</span>._super( options );

		<span class="hljs-keyword">if</span> ( callRefresh ) {
			<span class="hljs-keyword">this</span>.refresh();
		}

		<span class="hljs-keyword">return</span> returnValue;
	},

	container: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._ui.childWrapper;
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> $el = <span class="hljs-keyword">this</span>.container(),
			els = $el.find( <span class="hljs-string">".ui-btn"</span> ).not( <span class="hljs-string">".ui-slider-handle"</span> ),
			create = <span class="hljs-keyword">this</span>._initialRefresh;
		<span class="hljs-keyword">if</span> ( $.mobile.checkboxradio ) {
			$el.find( <span class="hljs-string">":mobile-checkboxradio"</span> ).checkboxradio( <span class="hljs-string">"refresh"</span> );
		}
		<span class="hljs-keyword">this</span>._addFirstLastClasses( els,
			<span class="hljs-keyword">this</span>.options.excludeInvisible ? <span class="hljs-keyword">this</span>._getVisibles( els, create ) : els,
			create );
		<span class="hljs-keyword">this</span>._initialRefresh = <span class="hljs-literal">false</span>;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-912">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-912">&#182;</a>
              </div>
              <p>Caveat: If the legend is not the first child of the controlgroup at enhance
time, it will be after _destroy().</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> ui, buttons,
			opts = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">if</span> ( opts.enhanced ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		}

		ui = <span class="hljs-keyword">this</span>._ui;
		buttons = <span class="hljs-keyword">this</span>.element
			.removeClass( <span class="hljs-string">"ui-controlgroup "</span> +
				<span class="hljs-string">"ui-controlgroup-horizontal ui-controlgroup-vertical ui-corner-all ui-mini "</span> +
				<span class="hljs-keyword">this</span>._themeClassFromOption( opts.theme ) )
			.find( <span class="hljs-string">".ui-btn"</span> )
			.not( <span class="hljs-string">".ui-slider-handle"</span> );

		<span class="hljs-keyword">this</span>._removeFirstLastClasses( buttons );

		ui.groupLegend.unwrap();
		ui.childWrapper.children().unwrap();
	}
}, $.mobile.behaviors.addFirstLastClasses ) );

})(jQuery);

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

	$.widget( <span class="hljs-string">"mobile.toolbar"</span>, {
		initSelector: <span class="hljs-string">":jqmData(role='footer'), :jqmData(role='header')"</span>,

		options: {
			theme: <span class="hljs-literal">null</span>,
			addBackBtn: <span class="hljs-literal">false</span>,
			backBtnTheme: <span class="hljs-literal">null</span>,
			backBtnText: <span class="hljs-string">"Back"</span>
		},

		_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> leftbtn, rightbtn,
				role =  <span class="hljs-keyword">this</span>.element.is( <span class="hljs-string">":jqmData(role='header')"</span> ) ? <span class="hljs-string">"header"</span> : <span class="hljs-string">"footer"</span>,
				page = <span class="hljs-keyword">this</span>.element.closest( <span class="hljs-string">".ui-page"</span> );
			<span class="hljs-keyword">if</span> ( page.length === <span class="hljs-number">0</span> ) {
				page = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.document, {
					<span class="hljs-string">"pageshow"</span>: <span class="hljs-string">"refresh"</span>
				});
			}
			$.extend( <span class="hljs-keyword">this</span>, {
				role: role,
				page: page,
				leftbtn: leftbtn,
				rightbtn: rightbtn
			});
			<span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"role"</span>, role === <span class="hljs-string">"header"</span> ? <span class="hljs-string">"banner"</span> : <span class="hljs-string">"contentinfo"</span> ).addClass( <span class="hljs-string">"ui-"</span> + role );
			<span class="hljs-keyword">this</span>.refresh();
			<span class="hljs-keyword">this</span>._setOptions( <span class="hljs-keyword">this</span>.options );
		},
		_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( o )</span> {</span>
			<span class="hljs-keyword">if</span> ( o.addBackBtn !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.addBackBtn &amp;&amp;
					<span class="hljs-keyword">this</span>.role === <span class="hljs-string">"header"</span> &amp;&amp;
					$( <span class="hljs-string">".ui-page"</span> ).length &gt; <span class="hljs-number">1</span> &amp;&amp;
					<span class="hljs-keyword">this</span>.page[ <span class="hljs-number">0</span> ].getAttribute( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"url"</span> ) !== $.mobile.path.stripHash( location.hash ) &amp;&amp;
					!<span class="hljs-keyword">this</span>.leftbtn ) {
						<span class="hljs-keyword">this</span>._addBackButton();
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">".ui-toolbar-back-btn"</span> ).remove();
				}
			}
			<span class="hljs-keyword">if</span> ( o.backBtnTheme != <span class="hljs-literal">null</span> ) {
				<span class="hljs-keyword">this</span>.element
					.find( <span class="hljs-string">".ui-toolbar-back-btn"</span> )
					.addClass( <span class="hljs-string">"ui-btn ui-btn-"</span> + o.backBtnTheme );
			}
			<span class="hljs-keyword">if</span> ( o.backBtnText !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">".ui-toolbar-back-btn .ui-btn-text"</span> ).text( o.backBtnText );
			}
			<span class="hljs-keyword">if</span> ( o.theme !== <span class="hljs-literal">undefined</span> ) {
				<span class="hljs-keyword">var</span> currentTheme = <span class="hljs-keyword">this</span>.options.theme ? <span class="hljs-keyword">this</span>.options.theme : <span class="hljs-string">"inherit"</span>,
					newTheme = o.theme ? o.theme : <span class="hljs-string">"inherit"</span>;

				<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-bar-"</span> + currentTheme ).addClass( <span class="hljs-string">"ui-bar-"</span> + newTheme );
			}

			<span class="hljs-keyword">this</span>._super( o );
		},
		refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.role === <span class="hljs-string">"header"</span> ) {
				<span class="hljs-keyword">this</span>._addHeaderButtonClasses();
			}
			<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.page ) {
				<span class="hljs-keyword">this</span>._setRelative();
				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.role === <span class="hljs-string">"footer"</span> ) {
					<span class="hljs-keyword">this</span>.element.appendTo( <span class="hljs-string">"body"</span> );
				}
			}
			<span class="hljs-keyword">this</span>._addHeadingClasses();
			<span class="hljs-keyword">this</span>._btnMarkup();
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-913">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-913">&#182;</a>
              </div>
              <p>we only want this to run on non fixed toolbars so make it easy to override</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_setRelative: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			$( <span class="hljs-string">"[data-"</span>+ $.mobile.ns + <span class="hljs-string">"role='page']"</span> ).css({ <span class="hljs-string">"position"</span>: <span class="hljs-string">"relative"</span> });
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-914">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-914">&#182;</a>
              </div>
              <p>Deprecated in 1.4. As from 1.5 button classes have to be present in the markup.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_btnMarkup: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element
				.children( <span class="hljs-string">"a"</span> )
				.filter( <span class="hljs-string">":not([data-"</span> + $.mobile.ns + <span class="hljs-string">"role='none'])"</span> )
				.attr( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"role"</span>, <span class="hljs-string">"button"</span> );
			<span class="hljs-keyword">this</span>.element.trigger( <span class="hljs-string">"create"</span> );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-915">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-915">&#182;</a>
              </div>
              <p>Deprecated in 1.4. As from 1.5 ui-btn-left/right classes have to be present in the markup.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_addHeaderButtonClasses: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> $headeranchors = <span class="hljs-keyword">this</span>.element.children( <span class="hljs-string">"a, button"</span> );
			<span class="hljs-keyword">this</span>.leftbtn = $headeranchors.hasClass( <span class="hljs-string">"ui-btn-left"</span> );
			<span class="hljs-keyword">this</span>.rightbtn = $headeranchors.hasClass( <span class="hljs-string">"ui-btn-right"</span> );

			<span class="hljs-keyword">this</span>.leftbtn = <span class="hljs-keyword">this</span>.leftbtn || $headeranchors.eq( <span class="hljs-number">0</span> ).not( <span class="hljs-string">".ui-btn-right"</span> ).addClass( <span class="hljs-string">"ui-btn-left"</span> ).length;

			<span class="hljs-keyword">this</span>.rightbtn = <span class="hljs-keyword">this</span>.rightbtn || $headeranchors.eq( <span class="hljs-number">1</span> ).addClass( <span class="hljs-string">"ui-btn-right"</span> ).length;

		},
		_addBackButton: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
				theme = options.backBtnTheme || options.theme;

			$( <span class="hljs-string">"&lt;a role='button' href='javascript:void(0);' "</span> +
				<span class="hljs-string">"class='ui-btn ui-corner-all ui-shadow ui-btn-left "</span> +
					( theme ? <span class="hljs-string">"ui-btn-"</span> + theme + <span class="hljs-string">" "</span> : <span class="hljs-string">""</span> ) +
					<span class="hljs-string">"ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' "</span> +
				<span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"rel='back'&gt;"</span> + options.backBtnText + <span class="hljs-string">"&lt;/a&gt;"</span> )
					.prependTo( <span class="hljs-keyword">this</span>.element );
		},
		_addHeadingClasses: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element.children( <span class="hljs-string">"h1, h2, h3, h4, h5, h6"</span> )
				.addClass( <span class="hljs-string">"ui-title"</span> )</pre></div></div>
            
        </li>
        
        
        <li id="section-916">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-916">&#182;</a>
              </div>
              <p>Regardless of h element number in src, it becomes h1 for the enhanced page</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				.attr({
					<span class="hljs-string">"role"</span>: <span class="hljs-string">"heading"</span>,
					<span class="hljs-string">"aria-level"</span>: <span class="hljs-string">"1"</span>
				});
		}
	});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

	$.widget( <span class="hljs-string">"mobile.toolbar"</span>, $.mobile.toolbar, {
		options: {
			position:<span class="hljs-literal">null</span>,
			visibleOnPageShow: <span class="hljs-literal">true</span>,
			disablePageZoom: <span class="hljs-literal">true</span>,
			transition: <span class="hljs-string">"slide"</span>, <span class="hljs-comment">//can be none, fade, slide (slide maps to slideup or slidedown)</span>
			fullscreen: <span class="hljs-literal">false</span>,
			tapToggle: <span class="hljs-literal">true</span>,
			tapToggleBlacklist: <span class="hljs-string">"a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-flipswitch, .ui-popup, .ui-panel, .ui-panel-dismiss-open"</span>,
			hideDuringFocus: <span class="hljs-string">"input, textarea, select"</span>,
			updatePagePadding: <span class="hljs-literal">true</span>,
			trackPersistentToolbars: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-917">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-917">&#182;</a>
              </div>
              <p>Browser detection! Weeee, here we go…
Unfortunately, position:fixed is costly, not to mention probably impossible, to feature-detect accurately.
Some tests exist, but they currently return false results in critical devices and browsers, which could lead to a broken experience.
Testing fixed positioning is also pretty obtrusive to page load, requiring injected elements and scrolling the window
The following function serves to rule out some popular browsers with known fixed-positioning issues
This is a plugin option like any other, so feel free to improve or overwrite it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			supportBlacklist: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">return</span> !$.support.fixedPosition;
			}
		},

		_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._super();
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.position === <span class="hljs-string">"fixed"</span> &amp;&amp; !<span class="hljs-keyword">this</span>.options.supportBlacklist() ) {
				<span class="hljs-keyword">this</span>._makeFixed();
			}
		},

		_makeFixed: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-string">"ui-"</span>+ <span class="hljs-keyword">this</span>.role +<span class="hljs-string">"-fixed"</span> );
			<span class="hljs-keyword">this</span>.updatePagePadding();
			<span class="hljs-keyword">this</span>._addTransitionClass();
			<span class="hljs-keyword">this</span>._bindPageEvents();
			<span class="hljs-keyword">this</span>._bindToggleHandlers();
		},

		_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( o )</span> {</span>
			<span class="hljs-keyword">if</span> ( o.position === <span class="hljs-string">"fixed"</span> &amp;&amp; <span class="hljs-keyword">this</span>.options.position !== <span class="hljs-string">"fixed"</span> ) {
				<span class="hljs-keyword">this</span>._makeFixed();
			}
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.position === <span class="hljs-string">"fixed"</span> &amp;&amp; !<span class="hljs-keyword">this</span>.options.supportBlacklist() ) {
				<span class="hljs-keyword">var</span> $page = ( !!<span class="hljs-keyword">this</span>.page )? <span class="hljs-keyword">this</span>.page: ( $(<span class="hljs-string">".ui-page-active"</span>).length &gt; <span class="hljs-number">0</span> )? $(<span class="hljs-string">".ui-page-active"</span>): $(<span class="hljs-string">".ui-page"</span>).eq(<span class="hljs-number">0</span>);

				<span class="hljs-keyword">if</span> ( o.fullscreen !== <span class="hljs-literal">undefined</span>) {
					<span class="hljs-keyword">if</span> ( o.fullscreen ) {
						<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-string">"ui-"</span>+ <span class="hljs-keyword">this</span>.role +<span class="hljs-string">"-fullscreen"</span> );
						$page.addClass( <span class="hljs-string">"ui-page-"</span> + <span class="hljs-keyword">this</span>.role + <span class="hljs-string">"-fullscreen"</span> );
					}</pre></div></div>
            
        </li>
        
        
        <li id="section-918">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-918">&#182;</a>
              </div>
              <p>If not fullscreen, add class to page to set top or bottom padding</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">else</span> {
						<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-"</span>+ <span class="hljs-keyword">this</span>.role +<span class="hljs-string">"-fullscreen"</span> );
						$page.removeClass( <span class="hljs-string">"ui-page-"</span> + <span class="hljs-keyword">this</span>.role + <span class="hljs-string">"-fullscreen"</span> ).addClass( <span class="hljs-string">"ui-page-"</span> + <span class="hljs-keyword">this</span>.role+ <span class="hljs-string">"-fixed"</span> );
					}
				}
			}
			<span class="hljs-keyword">this</span>._super(o);
		},

		_addTransitionClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> tclass = <span class="hljs-keyword">this</span>.options.transition;

			<span class="hljs-keyword">if</span> ( tclass &amp;&amp; tclass !== <span class="hljs-string">"none"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-919">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-919">&#182;</a>
              </div>
              <p>use appropriate slide for header or footer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( tclass === <span class="hljs-string">"slide"</span> ) {
					tclass = <span class="hljs-keyword">this</span>.element.hasClass( <span class="hljs-string">"ui-header"</span> ) ? <span class="hljs-string">"slidedown"</span> : <span class="hljs-string">"slideup"</span>;
				}

				<span class="hljs-keyword">this</span>.element.addClass( tclass );
			}
		},

		_bindPageEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> page = ( !!<span class="hljs-keyword">this</span>.page )? <span class="hljs-keyword">this</span>.element.closest( <span class="hljs-string">".ui-page"</span> ): <span class="hljs-keyword">this</span>.document;</pre></div></div>
            
        </li>
        
        
        <li id="section-920">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-920">&#182;</a>
              </div>
              <p>page event bindings
Fixed toolbars require page zoom to be disabled, otherwise usability issues crop up
This method is meant to disable zoom while a fixed-positioned toolbar page is visible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._on( page , {
				<span class="hljs-string">"pagebeforeshow"</span>: <span class="hljs-string">"_handlePageBeforeShow"</span>,
				<span class="hljs-string">"webkitAnimationStart"</span>:<span class="hljs-string">"_handleAnimationStart"</span>,
				<span class="hljs-string">"animationstart"</span>:<span class="hljs-string">"_handleAnimationStart"</span>,
				<span class="hljs-string">"updatelayout"</span>: <span class="hljs-string">"_handleAnimationStart"</span>,
				<span class="hljs-string">"pageshow"</span>: <span class="hljs-string">"_handlePageShow"</span>,
				<span class="hljs-string">"pagebeforehide"</span>: <span class="hljs-string">"_handlePageBeforeHide"</span>
			});
		},

		_handlePageBeforeShow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( )</span> {</span>
			<span class="hljs-keyword">var</span> o = <span class="hljs-keyword">this</span>.options;
			<span class="hljs-keyword">if</span> ( o.disablePageZoom ) {
				$.mobile.zoom.disable( <span class="hljs-literal">true</span> );
			}
			<span class="hljs-keyword">if</span> ( !o.visibleOnPageShow ) {
				<span class="hljs-keyword">this</span>.hide( <span class="hljs-literal">true</span> );
			}
		},

		_handleAnimationStart: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.updatePagePadding ) {
				<span class="hljs-keyword">this</span>.updatePagePadding( ( !!<span class="hljs-keyword">this</span>.page )? <span class="hljs-keyword">this</span>.page: <span class="hljs-string">".ui-page-active"</span> );
			}
		},

		_handlePageShow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.updatePagePadding( ( !!<span class="hljs-keyword">this</span>.page )? <span class="hljs-keyword">this</span>.page: <span class="hljs-string">".ui-page-active"</span> );
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.updatePagePadding ) {
				<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.window, { <span class="hljs-string">"throttledresize"</span>: <span class="hljs-string">"updatePagePadding"</span> } );
			}
		},

		_handlePageBeforeHide: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e, ui )</span> {</span>
			<span class="hljs-keyword">var</span> o = <span class="hljs-keyword">this</span>.options,
				thisFooter, thisHeader, nextFooter, nextHeader;

			<span class="hljs-keyword">if</span> ( o.disablePageZoom ) {
				$.mobile.zoom.enable( <span class="hljs-literal">true</span> );
			}
			<span class="hljs-keyword">if</span> ( o.updatePagePadding ) {
				<span class="hljs-keyword">this</span>._off( <span class="hljs-keyword">this</span>.window, <span class="hljs-string">"throttledresize"</span> );
			}

			<span class="hljs-keyword">if</span> ( o.trackPersistentToolbars ) {
				thisFooter = $( <span class="hljs-string">".ui-footer-fixed:jqmData(id)"</span>, <span class="hljs-keyword">this</span>.page );
				thisHeader = $( <span class="hljs-string">".ui-header-fixed:jqmData(id)"</span>, <span class="hljs-keyword">this</span>.page );
				nextFooter = thisFooter.length &amp;&amp; ui.nextPage &amp;&amp; $( <span class="hljs-string">".ui-footer-fixed:jqmData(id='"</span> + thisFooter.jqmData( <span class="hljs-string">"id"</span> ) + <span class="hljs-string">"')"</span>, ui.nextPage ) || $();
				nextHeader = thisHeader.length &amp;&amp; ui.nextPage &amp;&amp; $( <span class="hljs-string">".ui-header-fixed:jqmData(id='"</span> + thisHeader.jqmData( <span class="hljs-string">"id"</span> ) + <span class="hljs-string">"')"</span>, ui.nextPage ) || $();

				<span class="hljs-keyword">if</span> ( nextFooter.length || nextHeader.length ) {

					nextFooter.add( nextHeader ).appendTo( $.mobile.pageContainer );

					ui.nextPage.one( <span class="hljs-string">"pageshow"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
						nextHeader.prependTo( <span class="hljs-keyword">this</span> );
						nextFooter.appendTo( <span class="hljs-keyword">this</span> );
					});
				}
			}
		},

		_visible: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-921">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-921">&#182;</a>
              </div>
              <p>This will set the content element’s top or bottom padding equal to the toolbar’s height</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		updatePagePadding: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( tbPage )</span> {</span>
			<span class="hljs-keyword">var</span> $el = <span class="hljs-keyword">this</span>.element,
				header = ( <span class="hljs-keyword">this</span>.role ===<span class="hljs-string">"header"</span> ),
				pos = <span class="hljs-built_in">parseFloat</span>( $el.css( header ? <span class="hljs-string">"top"</span> : <span class="hljs-string">"bottom"</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-922">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-922">&#182;</a>
              </div>
              <p>This behavior only applies to “fixed”, not “fullscreen”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.fullscreen ) { <span class="hljs-keyword">return</span>; }</pre></div></div>
            
        </li>
        
        
        <li id="section-923">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-923">&#182;</a>
              </div>
              <p>tbPage argument can be a Page object or an event, if coming from throttled resize.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			tbPage = ( tbPage &amp;&amp; tbPage.type === <span class="hljs-literal">undefined</span> &amp;&amp; tbPage ) || <span class="hljs-keyword">this</span>.page || $el.closest( <span class="hljs-string">".ui-page"</span> );
			tbPage = ( !!<span class="hljs-keyword">this</span>.page )? <span class="hljs-keyword">this</span>.page: <span class="hljs-string">".ui-page-active"</span>;
			$( tbPage ).css( <span class="hljs-string">"padding-"</span> + ( header ? <span class="hljs-string">"top"</span> : <span class="hljs-string">"bottom"</span> ), $el.outerHeight() + pos );
		},

		_useTransition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( notransition )</span> {</span>
			<span class="hljs-keyword">var</span> $win = <span class="hljs-keyword">this</span>.window,
				$el = <span class="hljs-keyword">this</span>.element,
				scroll = $win.scrollTop(),
				elHeight = $el.height(),
				pHeight = ( !!<span class="hljs-keyword">this</span>.page )? $el.closest( <span class="hljs-string">".ui-page"</span> ).height():$(<span class="hljs-string">".ui-page-active"</span>).height(),
				viewportHeight = $.mobile.getScreenHeight();

			<span class="hljs-keyword">return</span> !notransition &amp;&amp;
				( <span class="hljs-keyword">this</span>.options.transition &amp;&amp; <span class="hljs-keyword">this</span>.options.transition !== <span class="hljs-string">"none"</span> &amp;&amp;
				(
					( <span class="hljs-keyword">this</span>.role === <span class="hljs-string">"header"</span> &amp;&amp; !<span class="hljs-keyword">this</span>.options.fullscreen &amp;&amp; scroll &gt; elHeight ) ||
					( <span class="hljs-keyword">this</span>.role === <span class="hljs-string">"footer"</span> &amp;&amp; !<span class="hljs-keyword">this</span>.options.fullscreen &amp;&amp; scroll + viewportHeight &lt; pHeight - elHeight )
				) || <span class="hljs-keyword">this</span>.options.fullscreen
				);
		},

		show: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( notransition )</span> {</span>
			<span class="hljs-keyword">var</span> hideClass = <span class="hljs-string">"ui-fixed-hidden"</span>,
				$el = <span class="hljs-keyword">this</span>.element;

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._useTransition( notransition ) ) {
				$el
					.removeClass( <span class="hljs-string">"out "</span> + hideClass )
					.addClass( <span class="hljs-string">"in"</span> )
					.animationComplete(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						$el.removeClass( <span class="hljs-string">"in"</span> );
					});
			}
			<span class="hljs-keyword">else</span> {
				$el.removeClass( hideClass );
			}
			<span class="hljs-keyword">this</span>._visible = <span class="hljs-literal">true</span>;
		},

		hide: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( notransition )</span> {</span>
			<span class="hljs-keyword">var</span> hideClass = <span class="hljs-string">"ui-fixed-hidden"</span>,
				$el = <span class="hljs-keyword">this</span>.element,</pre></div></div>
            
        </li>
        
        
        <li id="section-924">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-924">&#182;</a>
              </div>
              <p>if it’s a slide transition, our new transitions need the reverse class as well to slide outward</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				outclass = <span class="hljs-string">"out"</span> + ( <span class="hljs-keyword">this</span>.options.transition === <span class="hljs-string">"slide"</span> ? <span class="hljs-string">" reverse"</span> : <span class="hljs-string">""</span> );

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._useTransition( notransition ) ) {
				$el
					.addClass( outclass )
					.removeClass( <span class="hljs-string">"in"</span> )
					.animationComplete(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
						$el.addClass( hideClass ).removeClass( outclass );
					});
			}
			<span class="hljs-keyword">else</span> {
				$el.addClass( hideClass ).removeClass( outclass );
			}
			<span class="hljs-keyword">this</span>._visible = <span class="hljs-literal">false</span>;
		},

		toggle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>[ <span class="hljs-keyword">this</span>._visible ? <span class="hljs-string">"hide"</span> : <span class="hljs-string">"show"</span> ]();
		},

		_bindToggleHandlers: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
				o = self.options,
				delayShow, delayHide,
				isVisible = <span class="hljs-literal">true</span>,
				page = ( !!<span class="hljs-keyword">this</span>.page )? <span class="hljs-keyword">this</span>.page: $(<span class="hljs-string">".ui-page"</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-925">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-925">&#182;</a>
              </div>
              <p>tap toggle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			page
				.bind( <span class="hljs-string">"vclick"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> {</span>
					<span class="hljs-keyword">if</span> ( o.tapToggle &amp;&amp; !$( e.target ).closest( o.tapToggleBlacklist ).length ) {
						self.toggle();
					}
				})
				.bind( <span class="hljs-string">"focusin focusout"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-926">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-926">&#182;</a>
              </div>
              <p>this hides the toolbars on a keyboard pop to give more screen room and prevent ios bug which
positions fixed toolbars in the middle of the screen on pop if the input is near the top or
bottom of the screen addresses issues #4410 Footer navbar moves up when clicking on a textbox in an Android environment
and issue #4113 Header and footer change their position after keyboard popup - iOS
and issue #4410 Footer navbar moves up when clicking on a textbox in an Android environment</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> ( screen.width &lt; <span class="hljs-number">1025</span> &amp;&amp; $( e.target ).is( o.hideDuringFocus ) &amp;&amp; !$( e.target ).closest( <span class="hljs-string">".ui-header-fixed, .ui-footer-fixed"</span> ).length ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-927">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-927">&#182;</a>
              </div>
              <p>Fix for issue #4724 Moving through form in Mobile Safari with “Next” and “Previous” system
controls causes fixed position, tap-toggle false Header to reveal itself
isVisible instead of self._visible because the focusin and focusout events fire twice at the same time
Also use a delay for hiding the toolbars because on Android native browser focusin is direclty followed
by a focusout when a native selects opens and the other way around when it closes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">if</span> ( e.type === <span class="hljs-string">"focusout"</span> &amp;&amp; !isVisible ) {
							isVisible = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-928">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-928">&#182;</a>
              </div>
              <p>wait for the stack to unwind and see if we have jumped to another input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>							clearTimeout( delayHide );
							delayShow = setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
								self.show();
							}, <span class="hljs-number">0</span> );
						} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( e.type === <span class="hljs-string">"focusin"</span> &amp;&amp; !!isVisible ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-929">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-929">&#182;</a>
              </div>
              <p>if we have jumped to another input clear the time out to cancel the show.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>							clearTimeout( delayShow );
							isVisible = <span class="hljs-literal">false</span>;
							delayHide = setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
								self.hide();
							}, <span class="hljs-number">0</span> );
						}
					}
				});
		},

		_setRelative: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span>( <span class="hljs-keyword">this</span>.options.position !== <span class="hljs-string">"fixed"</span> ){
				$( <span class="hljs-string">"[data-"</span>+ $.mobile.ns + <span class="hljs-string">"role='page']"</span> ).css({ <span class="hljs-string">"position"</span>: <span class="hljs-string">"relative"</span> });
			}
		},

		_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> $el = <span class="hljs-keyword">this</span>.element,
				header = $el.hasClass( <span class="hljs-string">"ui-header"</span> );

			$el.closest( <span class="hljs-string">".ui-page"</span> ).css( <span class="hljs-string">"padding-"</span> + ( header ? <span class="hljs-string">"top"</span> : <span class="hljs-string">"bottom"</span> ), <span class="hljs-string">""</span> );
			$el.removeClass( <span class="hljs-string">"ui-header-fixed ui-footer-fixed ui-header-fullscreen ui-footer-fullscreen in out fade slidedown slideup ui-fixed-hidden"</span> );
			$el.closest( <span class="hljs-string">".ui-page"</span> ).removeClass( <span class="hljs-string">"ui-page-header-fixed ui-page-footer-fixed ui-page-header-fullscreen ui-page-footer-fullscreen"</span> );
		}

	});
})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>
	$.widget( <span class="hljs-string">"mobile.toolbar"</span>, $.mobile.toolbar, {

		_makeFixed: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._super();
			<span class="hljs-keyword">this</span>._workarounds();
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-930">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-930">&#182;</a>
              </div>
              <p>check the browser and version and run needed workarounds</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_workarounds: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> ua = navigator.userAgent,
			platform = navigator.platform,</pre></div></div>
            
        </li>
        
        
        <li id="section-931">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-931">&#182;</a>
              </div>
              <p>Rendering engine is Webkit, and capture major version</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			wkmatch = ua.match( <span class="hljs-regexp">/AppleWebKit\/([0-9]+)/</span> ),
			wkversion = !!wkmatch &amp;&amp; wkmatch[ <span class="hljs-number">1</span> ],
			os = <span class="hljs-literal">null</span>,
			self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-932">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-932">&#182;</a>
              </div>
              <p>set the os we are working in if it dosent match one with workarounds return</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( platform.indexOf( <span class="hljs-string">"iPhone"</span> ) &gt; -<span class="hljs-number">1</span> || platform.indexOf( <span class="hljs-string">"iPad"</span> ) &gt; -<span class="hljs-number">1</span>  || platform.indexOf( <span class="hljs-string">"iPod"</span> ) &gt; -<span class="hljs-number">1</span> ) {
				os = <span class="hljs-string">"ios"</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( ua.indexOf( <span class="hljs-string">"Android"</span> ) &gt; -<span class="hljs-number">1</span> ) {
				os = <span class="hljs-string">"android"</span>;
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-933">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-933">&#182;</a>
              </div>
              <p>check os version if it dosent match one with workarounds return</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( os === <span class="hljs-string">"ios"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-934">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-934">&#182;</a>
              </div>
              <p>iOS  workarounds</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				self._bindScrollWorkaround();
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( os === <span class="hljs-string">"android"</span> &amp;&amp; wkversion &amp;&amp; wkversion &lt; <span class="hljs-number">534</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-935">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-935">&#182;</a>
              </div>
              <p>Android 2.3 run all Android 2.3 workaround</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				self._bindScrollWorkaround();
				self._bindListThumbWorkaround();
			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">return</span>;
			}
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-936">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-936">&#182;</a>
              </div>
              <p>Utility class for checking header and footer positions relative to viewport</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_viewportOffset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> $el = <span class="hljs-keyword">this</span>.element,
				header = $el.hasClass( <span class="hljs-string">"ui-header"</span> ),
				offset = <span class="hljs-built_in">Math</span>.abs( $el.offset().top - <span class="hljs-keyword">this</span>.window.scrollTop() );
			<span class="hljs-keyword">if</span> ( !header ) {
				offset = <span class="hljs-built_in">Math</span>.round( offset - <span class="hljs-keyword">this</span>.window.height() + $el.outerHeight() ) - <span class="hljs-number">60</span>;
			}
			<span class="hljs-keyword">return</span> offset;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-937">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-937">&#182;</a>
              </div>
              <p>bind events for _triggerRedraw() function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_bindScrollWorkaround: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-938">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-938">&#182;</a>
              </div>
              <p>bind to scrollstop and check if the toolbars are correctly positioned</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.window, { scrollstop: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> viewportOffset = self._viewportOffset();</pre></div></div>
            
        </li>
        
        
        <li id="section-939">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-939">&#182;</a>
              </div>
              <p>check if the header is visible and if its in the right place</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( viewportOffset &gt; <span class="hljs-number">2</span> &amp;&amp; self._visible ) {
					self._triggerRedraw();
				}
			}});
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-940">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-940">&#182;</a>
              </div>
              <p>this addresses issue #4250 Persistent footer instability in v1.1 with long select lists in Android 2.3.3
and issue #3748 Android 2.x: Page transitions broken when fixed toolbars used
the absolutely positioned thumbnail in a list view causes problems with fixed position buttons above in a nav bar
setting the li’s to -webkit-transform:translate3d(0,0,0); solves this problem to avoide potential issues in other
platforms we scope this with the class ui-android-2x-fix</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_bindListThumbWorkaround: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element.closest( <span class="hljs-string">".ui-page"</span> ).addClass( <span class="hljs-string">"ui-android-2x-fixed"</span> );
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-941">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-941">&#182;</a>
              </div>
              <p>this addresses issues #4337 Fixed header problem after scrolling content on iOS and Android
and device bugs project issue #1 Form elements can lose click hit area in position: fixed containers.
this also addresses not on fixed toolbars page in docs
adding 1px of padding to the bottom then removing it causes a “redraw”
which positions the toolbars correctly (they will always be visually correct)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		_triggerRedraw: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> paddingBottom = <span class="hljs-built_in">parseFloat</span>( $( <span class="hljs-string">".ui-page-active"</span> ).css( <span class="hljs-string">"padding-bottom"</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-942">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-942">&#182;</a>
              </div>
              <p>trigger page redraw to fix incorrectly positioned fixed elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$( <span class="hljs-string">".ui-page-active"</span> ).css( <span class="hljs-string">"padding-bottom"</span>, ( paddingBottom + <span class="hljs-number">1</span> ) + <span class="hljs-string">"px"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-943">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-943">&#182;</a>
              </div>
              <p>if the padding is reset with out a timeout the reposition will not occure.
this is independant of JQM the browser seems to need the time to react.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			setTimeout( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( <span class="hljs-string">".ui-page-active"</span> ).css( <span class="hljs-string">"padding-bottom"</span>, paddingBottom + <span class="hljs-string">"px"</span> );
			}, <span class="hljs-number">0</span> );
		},

		destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._super();</pre></div></div>
            
        </li>
        
        
        <li id="section-944">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-944">&#182;</a>
              </div>
              <p>Remove the class we added to the page previously in android 2.x</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>.element.closest( <span class="hljs-string">".ui-page-active"</span> ).removeClass( <span class="hljs-string">"ui-android-2x-fix"</span> );
		}
	});

})( jQuery );


( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> ieHack = ( $.mobile.browser.oldIE &amp;&amp; $.mobile.browser.oldIE &lt;= <span class="hljs-number">8</span> ),
	uiTemplate = $(
		<span class="hljs-string">"&lt;div class='ui-popup-arrow-guide'&gt;&lt;/div&gt;"</span> +
		<span class="hljs-string">"&lt;div class='ui-popup-arrow-container"</span> + ( ieHack ? <span class="hljs-string">" ie"</span> : <span class="hljs-string">""</span> ) + <span class="hljs-string">"'&gt;"</span> +
			<span class="hljs-string">"&lt;div class='ui-popup-arrow'&gt;&lt;/div&gt;"</span> +
		<span class="hljs-string">"&lt;/div&gt;"</span>
	);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getArrow</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">var</span> clone = uiTemplate.clone(),
		gd = clone.eq( <span class="hljs-number">0</span> ),
		ct = clone.eq( <span class="hljs-number">1</span> ),
		ar = ct.children();

	<span class="hljs-keyword">return</span> { arEls: ct.add( gd ), gd: gd, ct: ct, ar: ar };
}

$.widget( <span class="hljs-string">"mobile.popup"</span>, $.mobile.popup, {
	options: {

		arrow: <span class="hljs-string">""</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> ar,
			ret = <span class="hljs-keyword">this</span>._super();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.arrow ) {
			<span class="hljs-keyword">this</span>._ui.arrow = ar = <span class="hljs-keyword">this</span>._addArrow();
		}

		<span class="hljs-keyword">return</span> ret;
	},

	_addArrow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> theme,
			opts = <span class="hljs-keyword">this</span>.options,
			ar = getArrow();

		theme = <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-body-"</span>, opts.theme );
		ar.ar.addClass( theme + ( opts.shadow ? <span class="hljs-string">" ui-overlay-shadow"</span> : <span class="hljs-string">""</span> ) );
		ar.arEls.hide().appendTo( <span class="hljs-keyword">this</span>.element );

		<span class="hljs-keyword">return</span> ar;
	},

	_unenhance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> ar = <span class="hljs-keyword">this</span>._ui.arrow;

		<span class="hljs-keyword">if</span> ( ar ) {
			ar.arEls.remove();
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._super();
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-945">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-945">&#182;</a>
              </div>
              <p>Pretend to show an arrow described by @p and @dir and calculate the
distance from the desired point. If a best-distance is passed in, return
the minimum of the one passed in and the one calculated.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_tryAnArrow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( p, dir, desired, s, best )</span> {</span>
		<span class="hljs-keyword">var</span> result, r, diff, desiredForArrow = {}, tip = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-946">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-946">&#182;</a>
              </div>
              <p>If the arrow has no wiggle room along the edge of the popup, it cannot
be displayed along the requested edge without it sticking out.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( s.arFull[ p.dimKey ] &gt; s.guideDims[ p.dimKey ] ) {
			<span class="hljs-keyword">return</span> best;
		}

		desiredForArrow[ p.fst ] = desired[ p.fst ] +
			( s.arHalf[ p.oDimKey ] + s.menuHalf[ p.oDimKey ] ) * p.offsetFactor -
			s.contentBox[ p.fst ] + ( s.clampInfo.menuSize[ p.oDimKey ] - s.contentBox[ p.oDimKey ] ) * p.arrowOffsetFactor;
		desiredForArrow[ p.snd ] = desired[ p.snd ];

		result = s.result || <span class="hljs-keyword">this</span>._calculateFinalLocation( desiredForArrow, s.clampInfo );
		r = { x: result.left, y: result.top };

		tip[ p.fst ] = r[ p.fst ] + s.contentBox[ p.fst ] + p.tipOffset;
		tip[ p.snd ] = <span class="hljs-built_in">Math</span>.max( result[ p.prop ] + s.guideOffset[ p.prop ] + s.arHalf[ p.dimKey ],
			<span class="hljs-built_in">Math</span>.min( result[ p.prop ] + s.guideOffset[ p.prop ] + s.guideDims[ p.dimKey ] - s.arHalf[ p.dimKey ],
				desired[ p.snd ] ) );

		diff = <span class="hljs-built_in">Math</span>.abs( desired.x - tip.x ) + <span class="hljs-built_in">Math</span>.abs( desired.y - tip.y );
		<span class="hljs-keyword">if</span> ( !best || diff &lt; best.diff ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-947">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-947">&#182;</a>
              </div>
              <p>Convert tip offset to coordinates inside the popup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			tip[ p.snd ] -= s.arHalf[ p.dimKey ] + result[ p.prop ] + s.contentBox[ p.snd ];
			best = { dir: dir, diff: diff, result: result, posProp: p.prop, posVal: tip[ p.snd ] };
		}

		<span class="hljs-keyword">return</span> best;
	},

	_getPlacementState: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( clamp )</span> {</span>
		<span class="hljs-keyword">var</span> offset, gdOffset,
			ar = <span class="hljs-keyword">this</span>._ui.arrow,
			state = {
				clampInfo: <span class="hljs-keyword">this</span>._clampPopupWidth( !clamp ),
				arFull: { cx: ar.ct.width(), cy: ar.ct.height() },
				guideDims: { cx: ar.gd.width(), cy: ar.gd.height() },
				guideOffset: ar.gd.offset()
			};

		offset = <span class="hljs-keyword">this</span>.element.offset();

		ar.gd.css( { left: <span class="hljs-number">0</span>, top: <span class="hljs-number">0</span>, right: <span class="hljs-number">0</span>, bottom: <span class="hljs-number">0</span> } );
		gdOffset = ar.gd.offset();
		state.contentBox = {
			x: gdOffset.left - offset.left,
			y: gdOffset.top - offset.top,
			cx: ar.gd.width(),
			cy: ar.gd.height()
		};
		ar.gd.removeAttr( <span class="hljs-string">"style"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-948">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-948">&#182;</a>
              </div>
              <p>The arrow box moves between guideOffset and guideOffset + guideDims - arFull</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		state.guideOffset = { left: state.guideOffset.left - offset.left, top: state.guideOffset.top - offset.top };
		state.arHalf = { cx: state.arFull.cx / <span class="hljs-number">2</span>, cy: state.arFull.cy / <span class="hljs-number">2</span> };
		state.menuHalf = { cx: state.clampInfo.menuSize.cx / <span class="hljs-number">2</span>, cy: state.clampInfo.menuSize.cy / <span class="hljs-number">2</span> };

		<span class="hljs-keyword">return</span> state;
	},

	_placementCoords: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( desired )</span> {</span>
		<span class="hljs-keyword">var</span> state, best, params, elOffset, bgRef,
			optionValue = <span class="hljs-keyword">this</span>.options.arrow,
			ar = <span class="hljs-keyword">this</span>._ui.arrow;

		<span class="hljs-keyword">if</span> ( !ar ) {
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._super( desired );
		}

		ar.arEls.show();

		bgRef = {};
		state = <span class="hljs-keyword">this</span>._getPlacementState( <span class="hljs-literal">true</span> );
		params = {
			<span class="hljs-string">"l"</span>: { fst: <span class="hljs-string">"x"</span>, snd: <span class="hljs-string">"y"</span>, prop: <span class="hljs-string">"top"</span>, dimKey: <span class="hljs-string">"cy"</span>, oDimKey: <span class="hljs-string">"cx"</span>, offsetFactor: <span class="hljs-number">1</span>, tipOffset:  -state.arHalf.cx, arrowOffsetFactor: <span class="hljs-number">0</span> },
			<span class="hljs-string">"r"</span>: { fst: <span class="hljs-string">"x"</span>, snd: <span class="hljs-string">"y"</span>, prop: <span class="hljs-string">"top"</span>, dimKey: <span class="hljs-string">"cy"</span>, oDimKey: <span class="hljs-string">"cx"</span>, offsetFactor: -<span class="hljs-number">1</span>, tipOffset: state.arHalf.cx + state.contentBox.cx, arrowOffsetFactor: <span class="hljs-number">1</span> },
			<span class="hljs-string">"b"</span>: { fst: <span class="hljs-string">"y"</span>, snd: <span class="hljs-string">"x"</span>, prop: <span class="hljs-string">"left"</span>, dimKey: <span class="hljs-string">"cx"</span>, oDimKey: <span class="hljs-string">"cy"</span>, offsetFactor: -<span class="hljs-number">1</span>, tipOffset: state.arHalf.cy + state.contentBox.cy, arrowOffsetFactor: <span class="hljs-number">1</span> },
			<span class="hljs-string">"t"</span>: { fst: <span class="hljs-string">"y"</span>, snd: <span class="hljs-string">"x"</span>, prop: <span class="hljs-string">"left"</span>, dimKey: <span class="hljs-string">"cx"</span>, oDimKey: <span class="hljs-string">"cy"</span>, offsetFactor: <span class="hljs-number">1</span>, tipOffset: -state.arHalf.cy, arrowOffsetFactor: <span class="hljs-number">0</span> }
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-949">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-949">&#182;</a>
              </div>
              <p>Try each side specified in the options to see on which one the arrow
should be placed such that the distance between the tip of the arrow and
the desired coordinates is the shortest.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.each( ( optionValue === <span class="hljs-literal">true</span> ? <span class="hljs-string">"l,t,r,b"</span> : optionValue ).split( <span class="hljs-string">","</span> ),
			$.proxy( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( key, value )</span> {</span>
				best = <span class="hljs-keyword">this</span>._tryAnArrow( params[ value ], value, desired, state, best );
			}, <span class="hljs-keyword">this</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-950">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-950">&#182;</a>
              </div>
              <p>Could not place the arrow along any of the edges - behave as if showing
the arrow was turned off.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !best ) {
			ar.arEls.hide();
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._super( desired );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-951">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-951">&#182;</a>
              </div>
              <p>Move the arrow into place</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		ar.ct
			.removeClass( <span class="hljs-string">"ui-popup-arrow-l ui-popup-arrow-t ui-popup-arrow-r ui-popup-arrow-b"</span> )
			.addClass( <span class="hljs-string">"ui-popup-arrow-"</span> + best.dir )
			.removeAttr( <span class="hljs-string">"style"</span> ).css( best.posProp, best.posVal )
			.show();</pre></div></div>
            
        </li>
        
        
        <li id="section-952">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-952">&#182;</a>
              </div>
              <p>Do not move/size the background div on IE, because we use the arrow div for background as well.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !ieHack ) {
			elOffset = <span class="hljs-keyword">this</span>.element.offset();
			bgRef[ params[ best.dir ].fst ] = ar.ct.offset();
			bgRef[ params[ best.dir ].snd ] = {
				left: elOffset.left + state.contentBox.x,
				top: elOffset.top + state.contentBox.y
			};
		}

		<span class="hljs-keyword">return</span> best.result;
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( opts )</span> {</span>
		<span class="hljs-keyword">var</span> newTheme,
			oldTheme = <span class="hljs-keyword">this</span>.options.theme,
			ar = <span class="hljs-keyword">this</span>._ui.arrow,
			ret = <span class="hljs-keyword">this</span>._super( opts );

		<span class="hljs-keyword">if</span> ( opts.arrow !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">if</span> ( !ar &amp;&amp; opts.arrow ) {
				<span class="hljs-keyword">this</span>._ui.arrow = <span class="hljs-keyword">this</span>._addArrow();</pre></div></div>
            
        </li>
        
        
        <li id="section-953">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-953">&#182;</a>
              </div>
              <p>Important to return here so we don’t set the same options all over
again below.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( ar &amp;&amp; !opts.arrow ) {
				ar.arEls.remove();
				<span class="hljs-keyword">this</span>._ui.arrow = <span class="hljs-literal">null</span>;
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-954">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-954">&#182;</a>
              </div>
              <p>Reassign with potentially new arrow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		ar = <span class="hljs-keyword">this</span>._ui.arrow;

		<span class="hljs-keyword">if</span> ( ar ) {
			<span class="hljs-keyword">if</span> ( opts.theme !== <span class="hljs-literal">undefined</span> ) {
				oldTheme = <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-body-"</span>, oldTheme );
				newTheme = <span class="hljs-keyword">this</span>._themeClassFromOption( <span class="hljs-string">"ui-body-"</span>, opts.theme );
				ar.ar.removeClass( oldTheme ).addClass( newTheme );
			}

			<span class="hljs-keyword">if</span> ( opts.shadow !== <span class="hljs-literal">undefined</span> ) {
				ar.ar.toggleClass( <span class="hljs-string">"ui-overlay-shadow"</span>, opts.shadow );
			}
		}

		<span class="hljs-keyword">return</span> ret;
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> ar = <span class="hljs-keyword">this</span>._ui.arrow;

		<span class="hljs-keyword">if</span> ( ar ) {
			ar.arEls.remove();
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._super();
	}
});

})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.panel"</span>, {
	options: {
		classes: {
			panel: <span class="hljs-string">"ui-panel"</span>,
			panelOpen: <span class="hljs-string">"ui-panel-open"</span>,
			panelClosed: <span class="hljs-string">"ui-panel-closed"</span>,
			panelFixed: <span class="hljs-string">"ui-panel-fixed"</span>,
			panelInner: <span class="hljs-string">"ui-panel-inner"</span>,
			modal: <span class="hljs-string">"ui-panel-dismiss"</span>,
			modalOpen: <span class="hljs-string">"ui-panel-dismiss-open"</span>,
			pageContainer: <span class="hljs-string">"ui-panel-page-container"</span>,
			pageWrapper: <span class="hljs-string">"ui-panel-wrapper"</span>,
			pageFixedToolbar: <span class="hljs-string">"ui-panel-fixed-toolbar"</span>,
			pageContentPrefix: <span class="hljs-string">"ui-panel-page-content"</span>, <span class="hljs-comment">/* Used for wrapper and fixed toolbars position, display and open classes. */</span>
			animate: <span class="hljs-string">"ui-panel-animate"</span>
		},
		animate: <span class="hljs-literal">true</span>,
		theme: <span class="hljs-literal">null</span>,
		position: <span class="hljs-string">"left"</span>,
		dismissible: <span class="hljs-literal">true</span>,
		display: <span class="hljs-string">"reveal"</span>, <span class="hljs-comment">//accepts reveal, push, overlay</span>
		swipeClose: <span class="hljs-literal">true</span>,
		positionFixed: <span class="hljs-literal">false</span>
	},

	_closeLink: <span class="hljs-literal">null</span>,
	_parentPage: <span class="hljs-literal">null</span>,
	_page: <span class="hljs-literal">null</span>,
	_modal: <span class="hljs-literal">null</span>,
	_panelInner: <span class="hljs-literal">null</span>,
	_wrapper: <span class="hljs-literal">null</span>,
	_fixedToolbars: <span class="hljs-literal">null</span>,

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>.element,
			parentPage = el.closest( <span class="hljs-string">".ui-page, :jqmData(role='page')"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-955">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-955">&#182;</a>
              </div>
              <p>expose some private props to other methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.extend( <span class="hljs-keyword">this</span>, {
			_closeLink: el.find( <span class="hljs-string">":jqmData(rel='close')"</span> ),
			_parentPage: ( parentPage.length &gt; <span class="hljs-number">0</span> ) ? parentPage : <span class="hljs-literal">false</span>,
			_openedPage: <span class="hljs-literal">null</span>,
			_page: <span class="hljs-keyword">this</span>._getPage,
			_panelInner: <span class="hljs-keyword">this</span>._getPanelInner(),
			_fixedToolbars: <span class="hljs-keyword">this</span>._getFixedToolbars
		});
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.display !== <span class="hljs-string">"overlay"</span> ){
			<span class="hljs-keyword">this</span>._getWrapper();
		}
		<span class="hljs-keyword">this</span>._addPanelClasses();</pre></div></div>
            
        </li>
        
        
        <li id="section-956">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-956">&#182;</a>
              </div>
              <p>if animating, add the class to do so</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.support.cssTransform3d &amp;&amp; !!<span class="hljs-keyword">this</span>.options.animate ) {
			<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-keyword">this</span>.options.classes.animate );
		}

		<span class="hljs-keyword">this</span>._bindUpdateLayout();
		<span class="hljs-keyword">this</span>._bindCloseEvents();
		<span class="hljs-keyword">this</span>._bindLinkListeners();
		<span class="hljs-keyword">this</span>._bindPageEvents();

		<span class="hljs-keyword">if</span> ( !!<span class="hljs-keyword">this</span>.options.dismissible ) {
			<span class="hljs-keyword">this</span>._createModal();
		}

		<span class="hljs-keyword">this</span>._bindSwipeEvents();
	},

	_getPanelInner: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> panelInner = <span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"."</span> + <span class="hljs-keyword">this</span>.options.classes.panelInner );

		<span class="hljs-keyword">if</span> ( panelInner.length === <span class="hljs-number">0</span> ) {
			panelInner = <span class="hljs-keyword">this</span>.element.children().wrapAll( <span class="hljs-string">"&lt;div class='"</span> + <span class="hljs-keyword">this</span>.options.classes.panelInner + <span class="hljs-string">"' /&gt;"</span> ).parent();
		}

		<span class="hljs-keyword">return</span> panelInner;
	},

	_createModal: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
			target = self._parentPage ? self._parentPage.parent() : self.element.parent();

		self._modal = $( <span class="hljs-string">"&lt;div class='"</span> + self.options.classes.modal + <span class="hljs-string">"'&gt;&lt;/div&gt;"</span> )
			.on( <span class="hljs-string">"mousedown"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				self.close();
			})
			.appendTo( target );
	},

	_getPage: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> page = <span class="hljs-keyword">this</span>._openedPage || <span class="hljs-keyword">this</span>._parentPage || $( <span class="hljs-string">"."</span> + $.mobile.activePageClass );

		<span class="hljs-keyword">return</span> page;
	},

	_getWrapper: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> wrapper = <span class="hljs-keyword">this</span>._page().find( <span class="hljs-string">"."</span> + <span class="hljs-keyword">this</span>.options.classes.pageWrapper );
		<span class="hljs-keyword">if</span> ( wrapper.length === <span class="hljs-number">0</span> ) {
			wrapper = <span class="hljs-keyword">this</span>._page().children( <span class="hljs-string">".ui-header:not(.ui-header-fixed), .ui-content:not(.ui-popup), .ui-footer:not(.ui-footer-fixed)"</span> )
				.wrapAll( <span class="hljs-string">"&lt;div class='"</span> + <span class="hljs-keyword">this</span>.options.classes.pageWrapper + <span class="hljs-string">"'&gt;&lt;/div&gt;"</span> )
				.parent();
		}

		<span class="hljs-keyword">this</span>._wrapper = wrapper;
	},

	_getFixedToolbars: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> extFixedToolbars = $( <span class="hljs-string">"body"</span> ).children( <span class="hljs-string">".ui-header-fixed, .ui-footer-fixed"</span> ),
			intFixedToolbars = <span class="hljs-keyword">this</span>._page().find( <span class="hljs-string">".ui-header-fixed, .ui-footer-fixed"</span> ),
			fixedToolbars = extFixedToolbars.add( intFixedToolbars ).addClass( <span class="hljs-keyword">this</span>.options.classes.pageFixedToolbar );

		<span class="hljs-keyword">return</span> fixedToolbars;
	},

	_getPosDisplayClasses: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( prefix )</span> {</span>
		<span class="hljs-keyword">return</span> prefix + <span class="hljs-string">"-position-"</span> + <span class="hljs-keyword">this</span>.options.position + <span class="hljs-string">" "</span> + prefix + <span class="hljs-string">"-display-"</span> + <span class="hljs-keyword">this</span>.options.display;
	},

	_getPanelClasses: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> panelClasses = <span class="hljs-keyword">this</span>.options.classes.panel +
			<span class="hljs-string">" "</span> + <span class="hljs-keyword">this</span>._getPosDisplayClasses( <span class="hljs-keyword">this</span>.options.classes.panel ) +
			<span class="hljs-string">" "</span> + <span class="hljs-keyword">this</span>.options.classes.panelClosed +
			<span class="hljs-string">" "</span> + <span class="hljs-string">"ui-body-"</span> + ( <span class="hljs-keyword">this</span>.options.theme ? <span class="hljs-keyword">this</span>.options.theme : <span class="hljs-string">"inherit"</span> );

		<span class="hljs-keyword">if</span> ( !!<span class="hljs-keyword">this</span>.options.positionFixed ) {
			panelClasses += <span class="hljs-string">" "</span> + <span class="hljs-keyword">this</span>.options.classes.panelFixed;
		}

		<span class="hljs-keyword">return</span> panelClasses;
	},

	_addPanelClasses: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-keyword">this</span>._getPanelClasses() );
	},

	_handleCloseClickAndEatEvent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">if</span> ( !event.isDefaultPrevented() ) {
			event.preventDefault();
			<span class="hljs-keyword">this</span>.close();
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
	},

	_handleCloseClick: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">if</span> ( !event.isDefaultPrevented() ) {
			<span class="hljs-keyword">this</span>.close();
		}
	},

	_bindCloseEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>._closeLink, {
			<span class="hljs-string">"click"</span>: <span class="hljs-string">"_handleCloseClick"</span>
		});

		<span class="hljs-keyword">this</span>._on({
			<span class="hljs-string">"click a:jqmData(ajax='false')"</span>: <span class="hljs-string">"_handleCloseClick"</span>
		});
	},

	_positionPanel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( scrollToTop )</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
			panelInnerHeight = self._panelInner.outerHeight(),
			expand = panelInnerHeight &gt; $.mobile.getScreenHeight();

		<span class="hljs-keyword">if</span> ( expand || !self.options.positionFixed ) {
			<span class="hljs-keyword">if</span> ( expand ) {
				self._unfixPanel();
				$.mobile.resetActivePageHeight( panelInnerHeight );
			}
			<span class="hljs-keyword">if</span> ( scrollToTop ) {
				<span class="hljs-keyword">this</span>.window[ <span class="hljs-number">0</span> ].scrollTo( <span class="hljs-number">0</span>, $.mobile.defaultHomeScroll );
			}
		} <span class="hljs-keyword">else</span> {
			self._fixPanel();
		}
	},

	_bindFixListener: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._on( $( window ), { <span class="hljs-string">"throttledresize"</span>: <span class="hljs-string">"_positionPanel"</span> });
	},

	_unbindFixListener: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._off( $( window ), <span class="hljs-string">"throttledresize"</span> );
	},

	_unfixPanel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( !!<span class="hljs-keyword">this</span>.options.positionFixed &amp;&amp; $.support.fixedPosition ) {
			<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-keyword">this</span>.options.classes.panelFixed );
		}
	},

	_fixPanel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( !!<span class="hljs-keyword">this</span>.options.positionFixed &amp;&amp; $.support.fixedPosition ) {
			<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-keyword">this</span>.options.classes.panelFixed );
		}
	},

	_bindUpdateLayout: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

		self.element.on( <span class="hljs-string">"updatelayout"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* e */</span>)</span> {</span>
			<span class="hljs-keyword">if</span> ( self._open ) {
				self._positionPanel();
			}
		});
	},

	_bindLinkListeners: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._on( <span class="hljs-string">"body"</span>, {
			<span class="hljs-string">"click a"</span>: <span class="hljs-string">"_handleClick"</span>
		});

	},

	_handleClick: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> {</span>
		<span class="hljs-keyword">var</span> link,
			panelId = <span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"id"</span> );

		<span class="hljs-keyword">if</span> ( e.currentTarget.href.split( <span class="hljs-string">"#"</span> )[ <span class="hljs-number">1</span> ] === panelId &amp;&amp; panelId !== <span class="hljs-literal">undefined</span> ) {

			e.preventDefault();
			link = $( e.target );
			<span class="hljs-keyword">if</span> ( link.hasClass( <span class="hljs-string">"ui-btn"</span> ) ) {
				link.addClass( $.mobile.activeBtnClass );
				<span class="hljs-keyword">this</span>.element.one( <span class="hljs-string">"panelopen panelclose"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					link.removeClass( $.mobile.activeBtnClass );
				});
			}
			<span class="hljs-keyword">this</span>.toggle();
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		}
	},

	_bindSwipeEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
			area = self._modal ? self.element.add( self._modal ) : self.element;</pre></div></div>
            
        </li>
        
        
        <li id="section-957">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-957">&#182;</a>
              </div>
              <p>on swipe, close the panel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !!self.options.swipeClose ) {
			<span class="hljs-keyword">if</span> ( self.options.position === <span class="hljs-string">"left"</span> ) {
				area.on( <span class="hljs-string">"swipeleft.panel"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* e */</span>)</span> {</span>
					self.close();
				});
			} <span class="hljs-keyword">else</span> {
				area.on( <span class="hljs-string">"swiperight.panel"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-comment">/* e */</span>)</span> {</span>
					self.close();
				});
			}
		}
	},

	_bindPageEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">this</span>.document</pre></div></div>
            
        </li>
        
        
        <li id="section-958">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-958">&#182;</a>
              </div>
              <p>Close the panel if another panel on the page opens</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			.on( <span class="hljs-string">"panelbeforeopen"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> {</span>
				<span class="hljs-keyword">if</span> ( self._open &amp;&amp; e.target !== self.element[ <span class="hljs-number">0</span> ] ) {
					self.close();
				}
			})</pre></div></div>
            
        </li>
        
        
        <li id="section-959">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-959">&#182;</a>
              </div>
              <p>On escape, close? might need to have a target check too…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			.on( <span class="hljs-string">"keyup.panel"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> {</span>
				<span class="hljs-keyword">if</span> ( e.keyCode === <span class="hljs-number">27</span> &amp;&amp; self._open ) {
					self.close();
				}
			});
		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._parentPage &amp;&amp; <span class="hljs-keyword">this</span>.options.display !== <span class="hljs-string">"overlay"</span> ) {
			<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.document, {
				<span class="hljs-string">"pageshow"</span>: <span class="hljs-string">"_getWrapper"</span>
			});
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-960">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-960">&#182;</a>
              </div>
              <p>Clean up open panels after page hide</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( self._parentPage ) {
			<span class="hljs-keyword">this</span>.document.on( <span class="hljs-string">"pagehide"</span>, <span class="hljs-string">":jqmData(role='page')"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">if</span> ( self._open ) {
					self.close( <span class="hljs-literal">true</span> );
				}
			});
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.document.on( <span class="hljs-string">"pagebeforehide"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">if</span> ( self._open ) {
					self.close( <span class="hljs-literal">true</span> );
				}
			});
		}
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-961">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-961">&#182;</a>
              </div>
              <p>state storage of open or closed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_open: <span class="hljs-literal">false</span>,
	_pageContentOpenClasses: <span class="hljs-literal">null</span>,
	_modalOpenClasses: <span class="hljs-literal">null</span>,

	open: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( immediate )</span> {</span>
		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._open ) {
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
				o = self.options,

				_openPanel = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					self.document.off( <span class="hljs-string">"panelclose"</span> );
					self._page().jqmData( <span class="hljs-string">"panel"</span>, <span class="hljs-string">"open"</span> );

					<span class="hljs-keyword">if</span> ( $.support.cssTransform3d &amp;&amp; !!o.animate &amp;&amp; o.display !== <span class="hljs-string">"overlay"</span> ) {
						self._wrapper.addClass( o.classes.animate );
						self._fixedToolbars().addClass( o.classes.animate );
					}

					<span class="hljs-keyword">if</span> ( !immediate &amp;&amp; $.support.cssTransform3d &amp;&amp; !!o.animate ) {
						self.element.animationComplete( complete, <span class="hljs-string">"transition"</span> );
					} <span class="hljs-keyword">else</span> {
						setTimeout( complete, <span class="hljs-number">0</span> );
					}

					<span class="hljs-keyword">if</span> ( o.theme &amp;&amp; o.display !== <span class="hljs-string">"overlay"</span> ) {
						self._page().parent()
							.addClass( o.classes.pageContainer + <span class="hljs-string">"-themed "</span> + o.classes.pageContainer + <span class="hljs-string">"-"</span> + o.theme );
					}

					self.element
						.removeClass( o.classes.panelClosed )
						.addClass( o.classes.panelOpen );

					self._positionPanel( <span class="hljs-literal">true</span> );

					self._pageContentOpenClasses = self._getPosDisplayClasses( o.classes.pageContentPrefix );

					<span class="hljs-keyword">if</span> ( o.display !== <span class="hljs-string">"overlay"</span> ) {
						self._page().parent().addClass( o.classes.pageContainer );
						self._wrapper.addClass( self._pageContentOpenClasses );
						self._fixedToolbars().addClass( self._pageContentOpenClasses );
					}

					self._modalOpenClasses = self._getPosDisplayClasses( o.classes.modal ) + <span class="hljs-string">" "</span> + o.classes.modalOpen;
					<span class="hljs-keyword">if</span> ( self._modal ) {
						self._modal
							.addClass( self._modalOpenClasses )
							.height( <span class="hljs-built_in">Math</span>.max( self._modal.height(), self.document.height() ) );
					}
				},
				complete = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

					<span class="hljs-keyword">if</span> ( o.display !== <span class="hljs-string">"overlay"</span> ) {
						self._wrapper.addClass( o.classes.pageContentPrefix + <span class="hljs-string">"-open"</span> );
						self._fixedToolbars().addClass( o.classes.pageContentPrefix + <span class="hljs-string">"-open"</span> );
					}

					self._bindFixListener();

					self._trigger( <span class="hljs-string">"open"</span> );

					self._openedPage = self._page();
				};

			self._trigger( <span class="hljs-string">"beforeopen"</span> );

			<span class="hljs-keyword">if</span> ( self._page().jqmData( <span class="hljs-string">"panel"</span> ) === <span class="hljs-string">"open"</span> ) {
				self.document.on( <span class="hljs-string">"panelclose"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					_openPanel();
				});
			} <span class="hljs-keyword">else</span> {
				_openPanel();
			}

			self._open = <span class="hljs-literal">true</span>;
		}
	},

	close: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( immediate )</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._open ) {
			<span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
				o = <span class="hljs-keyword">this</span>.options,

				_closePanel = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>

					self.element.removeClass( o.classes.panelOpen );

					<span class="hljs-keyword">if</span> ( o.display !== <span class="hljs-string">"overlay"</span> ) {
						self._wrapper.removeClass( self._pageContentOpenClasses );
						self._fixedToolbars().removeClass( self._pageContentOpenClasses );
					}

					<span class="hljs-keyword">if</span> ( !immediate &amp;&amp; $.support.cssTransform3d &amp;&amp; !!o.animate ) {
						self.element.animationComplete( complete, <span class="hljs-string">"transition"</span> );
					} <span class="hljs-keyword">else</span> {
						setTimeout( complete, <span class="hljs-number">0</span> );
					}

					<span class="hljs-keyword">if</span> ( self._modal ) {
						self._modal.removeClass( self._modalOpenClasses );
					}
				},
				complete = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">if</span> ( o.theme &amp;&amp; o.display !== <span class="hljs-string">"overlay"</span> ) {
						self._page().parent().removeClass( o.classes.pageContainer + <span class="hljs-string">"-themed "</span> + o.classes.pageContainer + <span class="hljs-string">"-"</span> + o.theme );
					}

					self.element.addClass( o.classes.panelClosed );

					<span class="hljs-keyword">if</span> ( o.display !== <span class="hljs-string">"overlay"</span> ) {
						self._page().parent().removeClass( o.classes.pageContainer );
						self._wrapper.removeClass( o.classes.pageContentPrefix + <span class="hljs-string">"-open"</span> );
						self._fixedToolbars().removeClass( o.classes.pageContentPrefix + <span class="hljs-string">"-open"</span> );
					}

					<span class="hljs-keyword">if</span> ( $.support.cssTransform3d &amp;&amp; !!o.animate &amp;&amp; o.display !== <span class="hljs-string">"overlay"</span> ) {
						self._wrapper.removeClass( o.classes.animate );
						self._fixedToolbars().removeClass( o.classes.animate );
					}

					self._fixPanel();
					self._unbindFixListener();
					$.mobile.resetActivePageHeight();

					self._page().jqmRemoveData( <span class="hljs-string">"panel"</span> );

					self._trigger( <span class="hljs-string">"close"</span> );

					self._openedPage = <span class="hljs-literal">null</span>;
				};

			self._trigger( <span class="hljs-string">"beforeclose"</span> );

			_closePanel();

			self._open = <span class="hljs-literal">false</span>;
		}
	},

	toggle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>[ <span class="hljs-keyword">this</span>._open ? <span class="hljs-string">"close"</span> : <span class="hljs-string">"open"</span> ]();
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> otherPanels,
		o = <span class="hljs-keyword">this</span>.options,
		multiplePanels = ( $( <span class="hljs-string">"body &gt; :mobile-panel"</span> ).length + $.mobile.activePage.find( <span class="hljs-string">":mobile-panel"</span> ).length ) &gt; <span class="hljs-number">1</span>;

		<span class="hljs-keyword">if</span> ( o.display !== <span class="hljs-string">"overlay"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-962">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-962">&#182;</a>
              </div>
              <p> remove the wrapper if not in use by another panel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			otherPanels = $( <span class="hljs-string">"body &gt; :mobile-panel"</span> ).add( $.mobile.activePage.find( <span class="hljs-string">":mobile-panel"</span> ) );
			<span class="hljs-keyword">if</span> ( otherPanels.not( <span class="hljs-string">".ui-panel-display-overlay"</span> ).not( <span class="hljs-keyword">this</span>.element ).length === <span class="hljs-number">0</span> ) {
				<span class="hljs-keyword">this</span>._wrapper.children().unwrap();
			}

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._open ) {

				<span class="hljs-keyword">this</span>._fixedToolbars().removeClass( o.classes.pageContentPrefix + <span class="hljs-string">"-open"</span> );

				<span class="hljs-keyword">if</span> ( $.support.cssTransform3d &amp;&amp; !!o.animate ) {
					<span class="hljs-keyword">this</span>._fixedToolbars().removeClass( o.classes.animate );
				}

				<span class="hljs-keyword">this</span>._page().parent().removeClass( o.classes.pageContainer );

				<span class="hljs-keyword">if</span> ( o.theme ) {
					<span class="hljs-keyword">this</span>._page().parent().removeClass( o.classes.pageContainer + <span class="hljs-string">"-themed "</span> + o.classes.pageContainer + <span class="hljs-string">"-"</span> + o.theme );
				}
			}
		}

		<span class="hljs-keyword">if</span> ( !multiplePanels ) {

			<span class="hljs-keyword">this</span>.document.off( <span class="hljs-string">"panelopen panelclose"</span> );

		}

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._open ) {
			<span class="hljs-keyword">this</span>._page().jqmRemoveData( <span class="hljs-string">"panel"</span> );
		}

		<span class="hljs-keyword">this</span>._panelInner.children().unwrap();

		<span class="hljs-keyword">this</span>.element
			.removeClass( [ <span class="hljs-keyword">this</span>._getPanelClasses(), o.classes.panelOpen, o.classes.animate ].join( <span class="hljs-string">" "</span> ) )
			.off( <span class="hljs-string">"swipeleft.panel swiperight.panel"</span> )
			.off( <span class="hljs-string">"panelbeforeopen"</span> )
			.off( <span class="hljs-string">"panelhide"</span> )
			.off( <span class="hljs-string">"keyup.panel"</span> )
			.off( <span class="hljs-string">"updatelayout"</span> );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._modal ) {
			<span class="hljs-keyword">this</span>._modal.remove();
		}
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.table"</span>, {
	options: {
		classes: {
			table: <span class="hljs-string">"ui-table"</span>
		},
		enhanced: <span class="hljs-literal">false</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.options.enhanced ) {
			<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-keyword">this</span>.options.classes.table );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-963">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-963">&#182;</a>
              </div>
              <p>extend here, assign on refresh &gt; _setHeaders</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.extend( <span class="hljs-keyword">this</span>, {</pre></div></div>
            
        </li>
        
        
        <li id="section-964">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-964">&#182;</a>
              </div>
              <p>Expose headers and allHeaders properties on the widget
headers references the THs within the first TR in the table</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			headers: <span class="hljs-literal">undefined</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-965">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-965">&#182;</a>
              </div>
              <p>allHeaders references headers, plus all THs in the thead, which may
include several rows, or not</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			allHeaders: <span class="hljs-literal">undefined</span>
		});

		<span class="hljs-keyword">this</span>._refresh( <span class="hljs-literal">true</span> );
	},

	_setHeaders: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> trs = <span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"thead tr"</span> );

		<span class="hljs-keyword">this</span>.headers = <span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"tr:eq(0)"</span> ).children();
		<span class="hljs-keyword">this</span>.allHeaders = <span class="hljs-keyword">this</span>.headers.add( trs.children() );
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._refresh();
	},

	rebuild: $.noop,

	_refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( <span class="hljs-comment">/* create */</span> )</span> {</span>
		<span class="hljs-keyword">var</span> table = <span class="hljs-keyword">this</span>.element,
			trs = table.find( <span class="hljs-string">"thead tr"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-966">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-966">&#182;</a>
              </div>
              <p>updating headers on refresh (fixes #5880)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._setHeaders();</pre></div></div>
            
        </li>
        
        
        <li id="section-967">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-967">&#182;</a>
              </div>
              <p>Iterate over the trs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		trs.each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> columnCount = <span class="hljs-number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-968">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-968">&#182;</a>
              </div>
              <p>Iterate over the children of the tr</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$( <span class="hljs-keyword">this</span> ).children().each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> span = <span class="hljs-built_in">parseInt</span>( <span class="hljs-keyword">this</span>.getAttribute( <span class="hljs-string">"colspan"</span> ), <span class="hljs-number">10</span> ),
					selector = <span class="hljs-string">":nth-child("</span> + ( columnCount + <span class="hljs-number">1</span> ) + <span class="hljs-string">")"</span>,
					j;

				<span class="hljs-keyword">this</span>.setAttribute( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"colstart"</span>, columnCount + <span class="hljs-number">1</span> );

				<span class="hljs-keyword">if</span> ( span ) {
					<span class="hljs-keyword">for</span>( j = <span class="hljs-number">0</span>; j &lt; span - <span class="hljs-number">1</span>; j++ ) {
						columnCount++;
						selector += <span class="hljs-string">", :nth-child("</span> + ( columnCount + <span class="hljs-number">1</span> ) + <span class="hljs-string">")"</span>;
					}
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-969">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-969">&#182;</a>
              </div>
              <p>Store “cells” data on header as a reference to all cells in the
same column as this TH</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				$( <span class="hljs-keyword">this</span> ).jqmData( <span class="hljs-string">"cells"</span>, table.find( <span class="hljs-string">"tr"</span> ).not( trs.eq( <span class="hljs-number">0</span> ) ).not( <span class="hljs-keyword">this</span> ).children( selector ) );

				columnCount++;
			});
		});
	}
});

})( jQuery );


(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.table"</span>, $.mobile.table, {
	options: {
		mode: <span class="hljs-string">"columntoggle"</span>,
		columnBtnTheme: <span class="hljs-literal">null</span>,
		columnPopupTheme: <span class="hljs-literal">null</span>,
		columnBtnText: <span class="hljs-string">"Columns..."</span>,
		classes: $.extend( $.mobile.table.prototype.options.classes, {
			popup: <span class="hljs-string">"ui-table-columntoggle-popup"</span>,
			columnBtn: <span class="hljs-string">"ui-table-columntoggle-btn"</span>,
			priorityPrefix: <span class="hljs-string">"ui-table-priority-"</span>,
			columnToggleTable: <span class="hljs-string">"ui-table-columntoggle"</span>
		})
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._super();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.mode !== <span class="hljs-string">"columntoggle"</span> ) {
			<span class="hljs-keyword">return</span>;
		}

		$.extend( <span class="hljs-keyword">this</span>, {
			_menu: <span class="hljs-literal">null</span>
		});

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.enhanced ) {
			<span class="hljs-keyword">this</span>._menu = $( <span class="hljs-keyword">this</span>.document[ <span class="hljs-number">0</span> ].getElementById( <span class="hljs-keyword">this</span>._id() + <span class="hljs-string">"-popup"</span> ) ).children().first();
			<span class="hljs-keyword">this</span>._addToggles( <span class="hljs-keyword">this</span>._menu, <span class="hljs-literal">true</span> );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>._menu = <span class="hljs-keyword">this</span>._enhanceColToggle();
			<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-keyword">this</span>.options.classes.columnToggleTable );
		}

		<span class="hljs-keyword">this</span>._setupEvents();

		<span class="hljs-keyword">this</span>._setToggleState();
	},

	_id: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> ( <span class="hljs-keyword">this</span>.element.attr( <span class="hljs-string">"id"</span> ) || ( <span class="hljs-keyword">this</span>.widgetName + <span class="hljs-keyword">this</span>.uuid ) );
	},

	_setupEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-970">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-970">&#182;</a>
              </div>
              <p>NOTE: inputs are bound in bindToggles,
so it can be called on refresh, too</p>

            </div>
            
        </li>
        
        
        <li id="section-971">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-971">&#182;</a>
              </div>
              <p>update column toggles on resize</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.window, {
			throttledresize: <span class="hljs-string">"_setToggleState"</span>
		});
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>._menu, {
			<span class="hljs-string">"change input"</span>: <span class="hljs-string">"_menuInputChange"</span>
		});
	},

	_addToggles: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( menu, keep )</span> {</span>
		<span class="hljs-keyword">var</span> inputs,
			checkboxIndex = <span class="hljs-number">0</span>,
			opts = <span class="hljs-keyword">this</span>.options,
			container = menu.controlgroup( <span class="hljs-string">"container"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-972">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-972">&#182;</a>
              </div>
              <p>allow update of menu on refresh (fixes #5880)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( keep ) {
			inputs = menu.find( <span class="hljs-string">"input"</span> );
		} <span class="hljs-keyword">else</span> {
			container.empty();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-973">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-973">&#182;</a>
              </div>
              <p>create the hide/show toggles</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>.headers.not( <span class="hljs-string">"td"</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> header = $( <span class="hljs-keyword">this</span> ),
				priority = $.mobile.getAttribute( <span class="hljs-keyword">this</span>, <span class="hljs-string">"priority"</span> ),
				cells = header.add( header.jqmData( <span class="hljs-string">"cells"</span> ) );

			<span class="hljs-keyword">if</span> ( priority ) {
				cells.addClass( opts.classes.priorityPrefix + priority );

				( keep ? inputs.eq( checkboxIndex++ ) :
					$(<span class="hljs-string">"&lt;label&gt;&lt;input type='checkbox' checked /&gt;"</span> +
						( header.children( <span class="hljs-string">"abbr"</span> ).first().attr( <span class="hljs-string">"title"</span> ) ||
							header.text() ) +
						<span class="hljs-string">"&lt;/label&gt;"</span> )
						.appendTo( container )
						.children( <span class="hljs-number">0</span> )
						.checkboxradio( {
							theme: opts.columnPopupTheme
						}) )
					.jqmData( <span class="hljs-string">"cells"</span>, cells );
			}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-974">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-974">&#182;</a>
              </div>
              <p>set bindings here</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !keep ) {
			menu.controlgroup( <span class="hljs-string">"refresh"</span> );
		}
	},

	_menuInputChange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( evt )</span> {</span>
		<span class="hljs-keyword">var</span> input = $( evt.target ),
			checked = input[ <span class="hljs-number">0</span> ].checked;

		input.jqmData( <span class="hljs-string">"cells"</span> )
			.toggleClass( <span class="hljs-string">"ui-table-cell-hidden"</span>, !checked )
			.toggleClass( <span class="hljs-string">"ui-table-cell-visible"</span>, checked );

		<span class="hljs-keyword">if</span> ( input[ <span class="hljs-number">0</span> ].getAttribute( <span class="hljs-string">"locked"</span> ) ) {
			input.removeAttr( <span class="hljs-string">"locked"</span> );

			<span class="hljs-keyword">this</span>._unlockCells( input.jqmData( <span class="hljs-string">"cells"</span> ) );
		} <span class="hljs-keyword">else</span> {
			input.attr( <span class="hljs-string">"locked"</span>, <span class="hljs-literal">true</span> );
		}
	},

	_unlockCells: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( cells )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-975">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-975">&#182;</a>
              </div>
              <p>allow hide/show via CSS only = remove all toggle-locks</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		cells.removeClass( <span class="hljs-string">"ui-table-cell-hidden ui-table-cell-visible"</span>);
	},

	_enhanceColToggle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> id , menuButton, popup, menu,
			table = <span class="hljs-keyword">this</span>.element,
			opts = <span class="hljs-keyword">this</span>.options,
			ns = $.mobile.ns,
			fragment = <span class="hljs-keyword">this</span>.document[ <span class="hljs-number">0</span> ].createDocumentFragment();

		id = <span class="hljs-keyword">this</span>._id() + <span class="hljs-string">"-popup"</span>;
		menuButton = $( <span class="hljs-string">"&lt;a href='#"</span> + id + <span class="hljs-string">"' "</span> +
			<span class="hljs-string">"class='"</span> + opts.classes.columnBtn + <span class="hljs-string">" ui-btn "</span> +
			<span class="hljs-string">"ui-btn-"</span> + ( opts.columnBtnTheme || <span class="hljs-string">"a"</span> ) +
			<span class="hljs-string">" ui-corner-all ui-shadow ui-mini' "</span> +
			<span class="hljs-string">"data-"</span> + ns + <span class="hljs-string">"rel='popup'&gt;"</span> + opts.columnBtnText + <span class="hljs-string">"&lt;/a&gt;"</span> );
		popup = $( <span class="hljs-string">"&lt;div class='"</span> + opts.classes.popup + <span class="hljs-string">"' id='"</span> + id + <span class="hljs-string">"'&gt;&lt;/div&gt;"</span> );
		menu = $( <span class="hljs-string">"&lt;fieldset&gt;&lt;/fieldset&gt;"</span> ).controlgroup();</pre></div></div>
            
        </li>
        
        
        <li id="section-976">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-976">&#182;</a>
              </div>
              <p>set extension here, send “false” to trigger build/rebuild</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">this</span>._addToggles( menu, <span class="hljs-literal">false</span> );

		menu.appendTo( popup );

		fragment.appendChild( popup[ <span class="hljs-number">0</span> ] );
		fragment.appendChild( menuButton[ <span class="hljs-number">0</span> ] );
		table.before( fragment );

		popup.popup();

		<span class="hljs-keyword">return</span> menu;
	},

	rebuild: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._super();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.mode === <span class="hljs-string">"columntoggle"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-977">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-977">&#182;</a>
              </div>
              <p>NOTE: rebuild passes “false”, while refresh passes “undefined”
both refresh the table, but inside addToggles, !false will be true,
so a rebuild call can be indentified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._refresh( <span class="hljs-literal">false</span> );
		}
	},

	_refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( create )</span> {</span>
		<span class="hljs-keyword">this</span>._super( create );

		<span class="hljs-keyword">if</span> ( !create &amp;&amp; <span class="hljs-keyword">this</span>.options.mode === <span class="hljs-string">"columntoggle"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-978">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-978">&#182;</a>
              </div>
              <p>columns not being replaced must be cleared from input toggle-locks</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._unlockCells( <span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">".ui-table-cell-hidden, "</span> +
				<span class="hljs-string">".ui-table-cell-visible"</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-979">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-979">&#182;</a>
              </div>
              <p>update columntoggles and cells</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._addToggles( <span class="hljs-keyword">this</span>._menu, create );</pre></div></div>
            
        </li>
        
        
        <li id="section-980">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-980">&#182;</a>
              </div>
              <p>check/uncheck</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._setToggleState();
		}
	},

	_setToggleState: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._menu.find( <span class="hljs-string">"input"</span> ).each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> checkbox = $( <span class="hljs-keyword">this</span> );

			<span class="hljs-keyword">this</span>.checked = checkbox.jqmData( <span class="hljs-string">"cells"</span> ).eq( <span class="hljs-number">0</span> ).css( <span class="hljs-string">"display"</span> ) === <span class="hljs-string">"table-cell"</span>;
			checkbox.checkboxradio( <span class="hljs-string">"refresh"</span> );
		});
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._super();
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

$.widget( <span class="hljs-string">"mobile.table"</span>, $.mobile.table, {
	options: {
		mode: <span class="hljs-string">"reflow"</span>,
		classes: $.extend( $.mobile.table.prototype.options.classes, {
			reflowTable: <span class="hljs-string">"ui-table-reflow"</span>,
			cellLabels: <span class="hljs-string">"ui-table-cell-label"</span>
		})
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._super();</pre></div></div>
            
        </li>
        
        
        <li id="section-981">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-981">&#182;</a>
              </div>
              <p>If it’s not reflow mode, return here.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.mode !== <span class="hljs-string">"reflow"</span> ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.options.enhanced ) {
			<span class="hljs-keyword">this</span>.element.addClass( <span class="hljs-keyword">this</span>.options.classes.reflowTable );

			<span class="hljs-keyword">this</span>._updateReflow();
		}
	},

	rebuild: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._super();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.mode === <span class="hljs-string">"reflow"</span> ) {
			<span class="hljs-keyword">this</span>._refresh( <span class="hljs-literal">false</span> );
		}
	},

	_refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( create )</span> {</span>
		<span class="hljs-keyword">this</span>._super( create );
		<span class="hljs-keyword">if</span> ( !create &amp;&amp; <span class="hljs-keyword">this</span>.options.mode === <span class="hljs-string">"reflow"</span> ) {
			<span class="hljs-keyword">this</span>._updateReflow( );
		}
	},

	_updateReflow: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> table = <span class="hljs-keyword">this</span>,
			opts = <span class="hljs-keyword">this</span>.options;</pre></div></div>
            
        </li>
        
        
        <li id="section-982">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-982">&#182;</a>
              </div>
              <p>get headers in reverse order so that top-level headers are appended last</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$( table.allHeaders.get().reverse() ).each( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> cells = $( <span class="hljs-keyword">this</span> ).jqmData( <span class="hljs-string">"cells"</span> ),
				colstart = $.mobile.getAttribute( <span class="hljs-keyword">this</span>, <span class="hljs-string">"colstart"</span> ),
				hierarchyClass = cells.not( <span class="hljs-keyword">this</span> ).filter( <span class="hljs-string">"thead th"</span> ).length &amp;&amp; <span class="hljs-string">" ui-table-cell-label-top"</span>,
				text = $( <span class="hljs-keyword">this</span> ).text(),
				iteration, filter;

				<span class="hljs-keyword">if</span> ( text !== <span class="hljs-string">""</span>  ) {

					<span class="hljs-keyword">if</span> ( hierarchyClass ) {
						iteration = <span class="hljs-built_in">parseInt</span>( <span class="hljs-keyword">this</span>.getAttribute( <span class="hljs-string">"colspan"</span> ), <span class="hljs-number">10</span> );
						filter = <span class="hljs-string">""</span>;

						<span class="hljs-keyword">if</span> ( iteration ) {
							filter = <span class="hljs-string">"td:nth-child("</span>+ iteration +<span class="hljs-string">"n + "</span> + ( colstart ) +<span class="hljs-string">")"</span>;
						}

						table._addLabels( cells.filter( filter ), opts.classes.cellLabels + hierarchyClass, text );
					} <span class="hljs-keyword">else</span> {
						table._addLabels( cells, opts.classes.cellLabels, text );
					}

				}
		});
	},

	_addLabels: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( cells, label, text )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-983">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-983">&#182;</a>
              </div>
              <p>.not fixes #6006</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		cells.not( <span class="hljs-string">":has(b."</span> + label + <span class="hljs-string">")"</span> ).prepend( <span class="hljs-string">"&lt;b class='"</span> + label + <span class="hljs-string">"'&gt;"</span> + text + <span class="hljs-string">"&lt;/b&gt;"</span>  );
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-984">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-984">&#182;</a>
              </div>
              <p>TODO rename filterCallback/deprecate and default to the item itself as the first argument</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> defaultFilterCallback = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index, searchValue )</span> {</span>
	<span class="hljs-keyword">return</span> ( ( <span class="hljs-string">""</span> + ( $.mobile.getAttribute( <span class="hljs-keyword">this</span>, <span class="hljs-string">"filtertext"</span> ) || $( <span class="hljs-keyword">this</span> ).text() ) )
		.toLowerCase().indexOf( searchValue ) === -<span class="hljs-number">1</span> );
};

$.widget( <span class="hljs-string">"mobile.filterable"</span>, {

	initSelector: <span class="hljs-string">":jqmData(filter='true')"</span>,

	options: {
		filterReveal: <span class="hljs-literal">false</span>,
		filterCallback: defaultFilterCallback,
		enhanced: <span class="hljs-literal">false</span>,
		input: <span class="hljs-literal">null</span>,
		children: <span class="hljs-string">"&gt; li, &gt; option, &gt; optgroup option, &gt; tbody tr, &gt; .ui-controlgroup-controls &gt; .ui-btn, &gt; .ui-controlgroup-controls &gt; .ui-checkbox, &gt; .ui-controlgroup-controls &gt; .ui-radio"</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> opts = <span class="hljs-keyword">this</span>.options;

		$.extend( <span class="hljs-keyword">this</span>, {
			_search: <span class="hljs-literal">null</span>,
			_timer: <span class="hljs-number">0</span>
		});

		<span class="hljs-keyword">this</span>._setInput( opts.input );
		<span class="hljs-keyword">if</span> ( !opts.enhanced ) {
			<span class="hljs-keyword">this</span>._filterItems( ( ( <span class="hljs-keyword">this</span>._search &amp;&amp; <span class="hljs-keyword">this</span>._search.val() ) || <span class="hljs-string">""</span> ).toLowerCase() );
		}
	},

	_onKeyUp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> val, lastval,
			search = <span class="hljs-keyword">this</span>._search;

		<span class="hljs-keyword">if</span> ( search ) {
			val = search.val().toLowerCase(),
			lastval = $.mobile.getAttribute( search[ <span class="hljs-number">0</span> ], <span class="hljs-string">"lastval"</span> ) + <span class="hljs-string">""</span>;

			<span class="hljs-keyword">if</span> ( lastval &amp;&amp; lastval === val ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-985">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-985">&#182;</a>
              </div>
              <p>Execute the handler only once per value change</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span>;
			}

			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._timer ) {
				window.clearTimeout( <span class="hljs-keyword">this</span>._timer );
				<span class="hljs-keyword">this</span>._timer = <span class="hljs-number">0</span>;
			}

			<span class="hljs-keyword">this</span>._timer = <span class="hljs-keyword">this</span>._delay( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"beforefilter"</span>, <span class="hljs-literal">null</span>, { input: search } );</pre></div></div>
            
        </li>
        
        
        <li id="section-986">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-986">&#182;</a>
              </div>
              <p>Change val as lastval for next execution</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				search[ <span class="hljs-number">0</span> ].setAttribute( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"lastval"</span>, val );

				<span class="hljs-keyword">this</span>._filterItems( val );
				<span class="hljs-keyword">this</span>._timer = <span class="hljs-number">0</span>;
			}, <span class="hljs-number">250</span> );
		}
	},

	_getFilterableItems: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> elem = <span class="hljs-keyword">this</span>.element,
			children = <span class="hljs-keyword">this</span>.options.children,
			items = !children ? { length: <span class="hljs-number">0</span> }:
				$.isFunction( children ) ? children():
				children.nodeName ? $( children ):
				children.jquery ? children:
				<span class="hljs-keyword">this</span>.element.find( children );

		<span class="hljs-keyword">if</span> ( items.length === <span class="hljs-number">0</span> ) {
			items = elem.children();
		}

		<span class="hljs-keyword">return</span> items;
	},

	_filterItems: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( val )</span> {</span>
		<span class="hljs-keyword">var</span> idx, callback, length, dst,
			show = [],
			hide = [],
			opts = <span class="hljs-keyword">this</span>.options,
			filterItems = <span class="hljs-keyword">this</span>._getFilterableItems();

		<span class="hljs-keyword">if</span> ( val != <span class="hljs-literal">null</span> ) {
			callback = opts.filterCallback || defaultFilterCallback;
			length = filterItems.length;</pre></div></div>
            
        </li>
        
        
        <li id="section-987">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-987">&#182;</a>
              </div>
              <p>Partition the items into those to be hidden and those to be shown</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">for</span> ( idx = <span class="hljs-number">0</span> ; idx &lt; length ; idx++ ) {
				dst = ( callback.call( filterItems[ idx ], idx, val ) ) ? hide : show;
				dst.push( filterItems[ idx ] );
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-988">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-988">&#182;</a>
              </div>
              <p>If nothing is hidden, then the decision whether to hide or show the items
is based on the “filterReveal” option.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( hide.length === <span class="hljs-number">0</span> ) {
			filterItems[ opts.filterReveal ? <span class="hljs-string">"addClass"</span> : <span class="hljs-string">"removeClass"</span> ]( <span class="hljs-string">"ui-screen-hidden"</span> );
		} <span class="hljs-keyword">else</span> {
			$( hide ).addClass( <span class="hljs-string">"ui-screen-hidden"</span> );
			$( show ).removeClass( <span class="hljs-string">"ui-screen-hidden"</span> );
		}

		<span class="hljs-keyword">this</span>._refreshChildWidget();

		<span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"filter"</span>, <span class="hljs-literal">null</span>, {
			items: filterItems
		});
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-989">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-989">&#182;</a>
              </div>
              <p>The Default implementation of _refreshChildWidget attempts to call
refresh on collapsibleset, controlgroup, selectmenu, or listview</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_refreshChildWidget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> widget, idx,
			recognizedWidgets = [ <span class="hljs-string">"collapsibleset"</span>, <span class="hljs-string">"selectmenu"</span>, <span class="hljs-string">"controlgroup"</span>, <span class="hljs-string">"listview"</span> ];

		<span class="hljs-keyword">for</span> ( idx = recognizedWidgets.length - <span class="hljs-number">1</span> ; idx &gt; -<span class="hljs-number">1</span> ; idx-- ) {
			widget = recognizedWidgets[ idx ];
			<span class="hljs-keyword">if</span> ( $.mobile[ widget ] ) {
				widget = <span class="hljs-keyword">this</span>.element.data( <span class="hljs-string">"mobile-"</span> + widget );
				<span class="hljs-keyword">if</span> ( widget &amp;&amp; $.isFunction( widget.refresh ) ) {
					widget.refresh();
				}
			}
		}
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-990">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-990">&#182;</a>
              </div>
              <p>TODO: When the input is not internal, do not even store it in this._search</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_setInput: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( selector )</span> {</span>
		<span class="hljs-keyword">var</span> search = <span class="hljs-keyword">this</span>._search;</pre></div></div>
            
        </li>
        
        
        <li id="section-991">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-991">&#182;</a>
              </div>
              <p>Stop a pending filter operation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._timer ) {
			window.clearTimeout( <span class="hljs-keyword">this</span>._timer );
			<span class="hljs-keyword">this</span>._timer = <span class="hljs-number">0</span>;
		}

		<span class="hljs-keyword">if</span> ( search ) {
			<span class="hljs-keyword">this</span>._off( search, <span class="hljs-string">"keyup change input"</span> );
			search = <span class="hljs-literal">null</span>;
		}

		<span class="hljs-keyword">if</span> ( selector ) {
			search = selector.jquery ? selector:
				selector.nodeName ? $( selector ):
				<span class="hljs-keyword">this</span>.document.find( selector );

			<span class="hljs-keyword">this</span>._on( search, {
				keyup: <span class="hljs-string">"_onKeyUp"</span>,
				change: <span class="hljs-string">"_onKeyUp"</span>,
				input: <span class="hljs-string">"_onKeyUp"</span>
			});
		}

		<span class="hljs-keyword">this</span>._search = search;
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> refilter = !( ( options.filterReveal === <span class="hljs-literal">undefined</span> ) &amp;&amp;
				( options.filterCallback === <span class="hljs-literal">undefined</span> ) &amp;&amp;
				( options.children === <span class="hljs-literal">undefined</span> ) );

		<span class="hljs-keyword">this</span>._super( options );

		<span class="hljs-keyword">if</span> ( options.input !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">this</span>._setInput( options.input );
			refilter = <span class="hljs-literal">true</span>;
		}

		<span class="hljs-keyword">if</span> ( refilter ) {
			<span class="hljs-keyword">this</span>.refresh();
		}
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> opts = <span class="hljs-keyword">this</span>.options,
			items = <span class="hljs-keyword">this</span>._getFilterableItems();

		<span class="hljs-keyword">if</span> ( opts.enhanced ) {
			items.toggleClass( <span class="hljs-string">"ui-screen-hidden"</span>, opts.filterReveal );
		} <span class="hljs-keyword">else</span> {
			items.removeClass( <span class="hljs-string">"ui-screen-hidden"</span> );
		}
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._timer ) {
			window.clearTimeout( <span class="hljs-keyword">this</span>._timer );
			<span class="hljs-keyword">this</span>._timer = <span class="hljs-number">0</span>;
		}
		<span class="hljs-keyword">this</span>._filterItems( ( ( <span class="hljs-keyword">this</span>._search &amp;&amp; <span class="hljs-keyword">this</span>._search.val() ) || <span class="hljs-string">""</span> ).toLowerCase() );
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-992">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-992">&#182;</a>
              </div>
              <p>Create a function that will replace the _setOptions function of a widget,
and will pass the options on to the input of the filterable.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> replaceSetOptions = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( self, orig )</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
			orig.call( <span class="hljs-keyword">this</span>, options );
			self._syncTextInputOptions( options );
		};
	},
	rDividerListItem = <span class="hljs-regexp">/(^|\s)ui-li-divider(\s|$)/</span>,
	origDefaultFilterCallback = $.mobile.filterable.prototype.options.filterCallback;</pre></div></div>
            
        </li>
        
        
        <li id="section-993">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-993">&#182;</a>
              </div>
              <p>Override the default filter callback with one that does not hide list dividers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.mobile.filterable.prototype.options.filterCallback = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index, searchValue )</span> {</span>
	<span class="hljs-keyword">return</span> !<span class="hljs-keyword">this</span>.className.match( rDividerListItem ) &amp;&amp;
		origDefaultFilterCallback.call( <span class="hljs-keyword">this</span>, index, searchValue );
};

$.widget( <span class="hljs-string">"mobile.filterable"</span>, $.mobile.filterable, {
	options: {
		filterPlaceholder: <span class="hljs-string">"Filter items..."</span>,
		filterTheme: <span class="hljs-literal">null</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> idx, widgetName,
			elem = <span class="hljs-keyword">this</span>.element,
			recognizedWidgets = [ <span class="hljs-string">"collapsibleset"</span>, <span class="hljs-string">"selectmenu"</span>, <span class="hljs-string">"controlgroup"</span>, <span class="hljs-string">"listview"</span> ],
			createHandlers = {};

		<span class="hljs-keyword">this</span>._super();

		$.extend( <span class="hljs-keyword">this</span>, {
			_widget: <span class="hljs-literal">null</span>
		});

		<span class="hljs-keyword">for</span> ( idx = recognizedWidgets.length - <span class="hljs-number">1</span> ; idx &gt; -<span class="hljs-number">1</span> ; idx-- ) {
			widgetName = recognizedWidgets[ idx ];
			<span class="hljs-keyword">if</span> ( $.mobile[ widgetName ] ) {
				<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._setWidget( elem.data( <span class="hljs-string">"mobile-"</span> + widgetName ) ) ) {
					<span class="hljs-keyword">break</span>;
				} <span class="hljs-keyword">else</span> {
					createHandlers[ widgetName + <span class="hljs-string">"create"</span> ] = <span class="hljs-string">"_handleCreate"</span>;
				}
			}
		}

		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._widget ) {
			<span class="hljs-keyword">this</span>._on( elem, createHandlers );
		}
	},

	_handleCreate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( evt )</span> {</span>
		<span class="hljs-keyword">this</span>._setWidget( <span class="hljs-keyword">this</span>.element.data( <span class="hljs-string">"mobile-"</span> + evt.type.substring( <span class="hljs-number">0</span>, evt.type.length - <span class="hljs-number">6</span> ) ) );
	},

	_trigger: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( type, event, data )</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._widget &amp;&amp; <span class="hljs-keyword">this</span>._widget.widgetFullName === <span class="hljs-string">"mobile-listview"</span> &amp;&amp;
			type === <span class="hljs-string">"beforefilter"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-994">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-994">&#182;</a>
              </div>
              <p>Also trigger listviewbeforefilter if this widget is also a listview</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._widget._trigger( <span class="hljs-string">"beforefilter"</span>, event, data );
		}
		<span class="hljs-keyword">this</span>._super( type, event, data );
	},

	_setWidget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( widget )</span> {</span>
		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>._widget &amp;&amp; widget ) {
			<span class="hljs-keyword">this</span>._widget = widget;
			<span class="hljs-keyword">this</span>._widget._setOptions = replaceSetOptions( <span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._widget._setOptions );
		}

		<span class="hljs-keyword">if</span> ( !!<span class="hljs-keyword">this</span>._widget ) {
			<span class="hljs-keyword">this</span>._syncTextInputOptions( <span class="hljs-keyword">this</span>._widget.options );
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._widget.widgetName === <span class="hljs-string">"listview"</span> ) {
				<span class="hljs-keyword">this</span>._widget.options.hideDividers = <span class="hljs-literal">true</span>;
				<span class="hljs-keyword">this</span>._widget.element.listview( <span class="hljs-string">"refresh"</span> );
			}
		}

		<span class="hljs-keyword">return</span> !!<span class="hljs-keyword">this</span>._widget;
	},

	_isSearchInternal: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> ( <span class="hljs-keyword">this</span>._search &amp;&amp; <span class="hljs-keyword">this</span>._search.jqmData( <span class="hljs-string">"ui-filterable-"</span> + <span class="hljs-keyword">this</span>.uuid + <span class="hljs-string">"-internal"</span> ) );
	},

	_setInput: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( selector )</span> {</span>
		<span class="hljs-keyword">var</span> opts = <span class="hljs-keyword">this</span>.options,
			updatePlaceholder = <span class="hljs-literal">true</span>,
			textinputOpts = {};

		<span class="hljs-keyword">if</span> ( !selector ) {
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isSearchInternal() ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-995">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-995">&#182;</a>
              </div>
              <p>Ignore the call to set a new input if the selector goes to falsy and
the current textinput is already of the internally generated variety.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span>;
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-996">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-996">&#182;</a>
              </div>
              <p>Generating a new textinput widget. No need to set the placeholder
further down the function.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				updatePlaceholder = <span class="hljs-literal">false</span>;
				selector = $( <span class="hljs-string">"&lt;input "</span> +
					<span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"type='search' "</span> +
					<span class="hljs-string">"placeholder='"</span> + opts.filterPlaceholder + <span class="hljs-string">"'&gt;&lt;/input&gt;"</span> )
					.jqmData( <span class="hljs-string">"ui-filterable-"</span> + <span class="hljs-keyword">this</span>.uuid + <span class="hljs-string">"-internal"</span>, <span class="hljs-literal">true</span> );
				$( <span class="hljs-string">"&lt;form class='ui-filterable'&gt;&lt;/form&gt;"</span> )
					.append( selector )
					.submit( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( evt )</span> {</span>
						evt.preventDefault();
						selector.blur();
					})
					.insertBefore( <span class="hljs-keyword">this</span>.element );
				<span class="hljs-keyword">if</span> ( $.mobile.textinput ) {
					<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.filterTheme != <span class="hljs-literal">null</span> ) {
						textinputOpts[ <span class="hljs-string">"theme"</span> ] = opts.filterTheme;
					}

					selector.textinput( textinputOpts );
				}
			}
		}

		<span class="hljs-keyword">this</span>._super( selector );

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isSearchInternal() &amp;&amp; updatePlaceholder ) {
			<span class="hljs-keyword">this</span>._search.attr( <span class="hljs-string">"placeholder"</span>, <span class="hljs-keyword">this</span>.options.filterPlaceholder );
		}
	},

	_setOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> ret = <span class="hljs-keyword">this</span>._super( options );</pre></div></div>
            
        </li>
        
        
        <li id="section-997">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-997">&#182;</a>
              </div>
              <p>Need to set the filterPlaceholder after having established the search input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( options.filterPlaceholder !== <span class="hljs-literal">undefined</span> ) {
			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isSearchInternal() ) {
				<span class="hljs-keyword">this</span>._search.attr( <span class="hljs-string">"placeholder"</span>, options.filterPlaceholder );
			}
		}

		<span class="hljs-keyword">if</span> ( options.filterTheme !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>._search &amp;&amp; $.mobile.textinput ) {
			<span class="hljs-keyword">this</span>._search.textinput( <span class="hljs-string">"option"</span>, <span class="hljs-string">"theme"</span>, options.filterTheme );
		}

		<span class="hljs-keyword">return</span> ret;
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isSearchInternal() ) {
			<span class="hljs-keyword">this</span>._search.remove();
		}
		<span class="hljs-keyword">this</span>._super();
	},

	_syncTextInputOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( options )</span> {</span>
		<span class="hljs-keyword">var</span> idx,
			textinputOptions = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-998">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-998">&#182;</a>
              </div>
              <p>We only sync options if the filterable’s textinput is of the internally
generated variety, rather than one specified by the user.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._isSearchInternal() &amp;&amp; $.mobile.textinput ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-999">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-999">&#182;</a>
              </div>
              <p>Apply only the options understood by textinput</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">for</span> ( idx <span class="hljs-keyword">in</span> $.mobile.textinput.prototype.options ) {
				<span class="hljs-keyword">if</span> ( options[ idx ] !== <span class="hljs-literal">undefined</span> ) {
					<span class="hljs-keyword">if</span> ( idx === <span class="hljs-string">"theme"</span> &amp;&amp; <span class="hljs-keyword">this</span>.options.filterTheme != <span class="hljs-literal">null</span> ) {
						textinputOptions[ idx ] = <span class="hljs-keyword">this</span>.options.filterTheme;
					} <span class="hljs-keyword">else</span> {
						textinputOptions[ idx ] = options[ idx ];
					}
				}
			}
			<span class="hljs-keyword">this</span>._search.textinput( <span class="hljs-string">"option"</span>, textinputOptions );
		}
	}
});

})( jQuery );

<span class="hljs-comment">/*!
 * jQuery UI Tabs fadf2b312a05040436451c64bbfaf4814bc62c56
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/tabs/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

<span class="hljs-keyword">var</span> tabId = <span class="hljs-number">0</span>,
	rhash = <span class="hljs-regexp">/#.*$/</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNextTabId</span><span class="hljs-params">()</span> {</span>
	<span class="hljs-keyword">return</span> ++tabId;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isLocal</span><span class="hljs-params">( anchor )</span> {</span>
	<span class="hljs-keyword">return</span> anchor.hash.length &gt; <span class="hljs-number">1</span> &amp;&amp;
		<span class="hljs-built_in">decodeURIComponent</span>( anchor.href.replace( rhash, <span class="hljs-string">""</span> ) ) ===
			<span class="hljs-built_in">decodeURIComponent</span>( location.href.replace( rhash, <span class="hljs-string">""</span> ) );
}

$.widget( <span class="hljs-string">"ui.tabs"</span>, {
	version: <span class="hljs-string">"fadf2b312a05040436451c64bbfaf4814bc62c56"</span>,
	delay: <span class="hljs-number">300</span>,
	options: {
		active: <span class="hljs-literal">null</span>,
		collapsible: <span class="hljs-literal">false</span>,
		event: <span class="hljs-string">"click"</span>,
		heightStyle: <span class="hljs-string">"content"</span>,
		hide: <span class="hljs-literal">null</span>,
		show: <span class="hljs-literal">null</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-1000">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1000">&#182;</a>
              </div>
              <p>callbacks</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		activate: <span class="hljs-literal">null</span>,
		beforeActivate: <span class="hljs-literal">null</span>,
		beforeLoad: <span class="hljs-literal">null</span>,
		load: <span class="hljs-literal">null</span>
	},

	_create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>,
			options = <span class="hljs-keyword">this</span>.options;

		<span class="hljs-keyword">this</span>.running = <span class="hljs-literal">false</span>;

		<span class="hljs-keyword">this</span>.element
			.addClass( <span class="hljs-string">"ui-tabs ui-widget ui-widget-content ui-corner-all"</span> )
			.toggleClass( <span class="hljs-string">"ui-tabs-collapsible"</span>, options.collapsible )</pre></div></div>
            
        </li>
        
        
        <li id="section-1001">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1001">&#182;</a>
              </div>
              <p>Prevent users from focusing disabled tabs via click</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			.delegate( <span class="hljs-string">".ui-tabs-nav &gt; li"</span>, <span class="hljs-string">"mousedown"</span> + <span class="hljs-keyword">this</span>.eventNamespace, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
				<span class="hljs-keyword">if</span> ( $( <span class="hljs-keyword">this</span> ).is( <span class="hljs-string">".ui-state-disabled"</span> ) ) {
					event.preventDefault();
				}
			})</pre></div></div>
            
        </li>
        
        
        <li id="section-1002">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1002">&#182;</a>
              </div>
              <p>support: IE &lt;9
Preventing the default action in mousedown doesn’t prevent IE
from focusing the element, so if the anchor gets focused, blur.
We don’t have to worry about focusing the previously focused
element since clicking on a non-focusable element should focus
the body anyway.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			.delegate( <span class="hljs-string">".ui-tabs-anchor"</span>, <span class="hljs-string">"focus"</span> + <span class="hljs-keyword">this</span>.eventNamespace, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">if</span> ( $( <span class="hljs-keyword">this</span> ).closest( <span class="hljs-string">"li"</span> ).is( <span class="hljs-string">".ui-state-disabled"</span> ) ) {
					<span class="hljs-keyword">this</span>.blur();
				}
			});

		<span class="hljs-keyword">this</span>._processTabs();
		options.active = <span class="hljs-keyword">this</span>._initialActive();</pre></div></div>
            
        </li>
        
        
        <li id="section-1003">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1003">&#182;</a>
              </div>
              <p>Take disabling tabs via class attribute from HTML
into account and update option properly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.isArray( options.disabled ) ) {
			options.disabled = $.unique( options.disabled.concat(
				$.map( <span class="hljs-keyword">this</span>.tabs.filter( <span class="hljs-string">".ui-state-disabled"</span> ), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( li )</span> {</span>
					<span class="hljs-keyword">return</span> that.tabs.index( li );
				})
			) ).sort();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1004">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1004">&#182;</a>
              </div>
              <p>check for length avoids error when initializing empty list</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.active !== <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-keyword">this</span>.anchors.length ) {
			<span class="hljs-keyword">this</span>.active = <span class="hljs-keyword">this</span>._findActive( options.active );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.active = $();
		}

		<span class="hljs-keyword">this</span>._refresh();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.active.length ) {
			<span class="hljs-keyword">this</span>.load( options.active );
		}
	},

	_initialActive: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> active = <span class="hljs-keyword">this</span>.options.active,
			collapsible = <span class="hljs-keyword">this</span>.options.collapsible,
			locationHash = location.hash.substring( <span class="hljs-number">1</span> );

		<span class="hljs-keyword">if</span> ( active === <span class="hljs-literal">null</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-1005">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1005">&#182;</a>
              </div>
              <p>check the fragment identifier in the URL</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( locationHash ) {
				<span class="hljs-keyword">this</span>.tabs.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( i, tab )</span> {</span>
					<span class="hljs-keyword">if</span> ( $( tab ).attr( <span class="hljs-string">"aria-controls"</span> ) === locationHash ) {
						active = i;
						<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
					}
				});
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-1006">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1006">&#182;</a>
              </div>
              <p>check for a tab marked active via a class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( active === <span class="hljs-literal">null</span> ) {
				active = <span class="hljs-keyword">this</span>.tabs.index( <span class="hljs-keyword">this</span>.tabs.filter( <span class="hljs-string">".ui-tabs-active"</span> ) );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-1007">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1007">&#182;</a>
              </div>
              <p>no active tab, set to false</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( active === <span class="hljs-literal">null</span> || active === -<span class="hljs-number">1</span> ) {
				active = <span class="hljs-keyword">this</span>.tabs.length ? <span class="hljs-number">0</span> : <span class="hljs-literal">false</span>;
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1008">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1008">&#182;</a>
              </div>
              <p>handle numbers: negative, out of range</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( active !== <span class="hljs-literal">false</span> ) {
			active = <span class="hljs-keyword">this</span>.tabs.index( <span class="hljs-keyword">this</span>.tabs.eq( active ) );
			<span class="hljs-keyword">if</span> ( active === -<span class="hljs-number">1</span> ) {
				active = collapsible ? <span class="hljs-literal">false</span> : <span class="hljs-number">0</span>;
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1009">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1009">&#182;</a>
              </div>
              <p>don’t allow collapsible: false and active: false</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !collapsible &amp;&amp; active === <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-keyword">this</span>.anchors.length ) {
			active = <span class="hljs-number">0</span>;
		}

		<span class="hljs-keyword">return</span> active;
	},

	_getCreateEventData: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> {
			tab: <span class="hljs-keyword">this</span>.active,
			panel: !<span class="hljs-keyword">this</span>.active.length ? $() : <span class="hljs-keyword">this</span>._getPanelForTab( <span class="hljs-keyword">this</span>.active )
		};
	},

	_tabKeydown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">var</span> focusedTab = $( <span class="hljs-keyword">this</span>.document[<span class="hljs-number">0</span>].activeElement ).closest( <span class="hljs-string">"li"</span> ),
			selectedIndex = <span class="hljs-keyword">this</span>.tabs.index( focusedTab ),
			goingForward = <span class="hljs-literal">true</span>;

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._handlePageNav( event ) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">switch</span> ( event.keyCode ) {
			<span class="hljs-keyword">case</span> $.ui.keyCode.RIGHT:
			<span class="hljs-keyword">case</span> $.ui.keyCode.DOWN:
				selectedIndex++;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> $.ui.keyCode.UP:
			<span class="hljs-keyword">case</span> $.ui.keyCode.LEFT:
				goingForward = <span class="hljs-literal">false</span>;
				selectedIndex--;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> $.ui.keyCode.END:
				selectedIndex = <span class="hljs-keyword">this</span>.anchors.length - <span class="hljs-number">1</span>;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> $.ui.keyCode.HOME:
				selectedIndex = <span class="hljs-number">0</span>;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> $.ui.keyCode.SPACE:</pre></div></div>
            
        </li>
        
        
        <li id="section-1010">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1010">&#182;</a>
              </div>
              <p>Activate only, no collapsing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				event.preventDefault();
				clearTimeout( <span class="hljs-keyword">this</span>.activating );
				<span class="hljs-keyword">this</span>._activate( selectedIndex );
				<span class="hljs-keyword">return</span>;
			<span class="hljs-keyword">case</span> $.ui.keyCode.ENTER:</pre></div></div>
            
        </li>
        
        
        <li id="section-1011">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1011">&#182;</a>
              </div>
              <p>Toggle (cancel delayed activation, allow collapsing)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				event.preventDefault();
				clearTimeout( <span class="hljs-keyword">this</span>.activating );</pre></div></div>
            
        </li>
        
        
        <li id="section-1012">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1012">&#182;</a>
              </div>
              <p>Determine if we should collapse or activate</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>._activate( selectedIndex === <span class="hljs-keyword">this</span>.options.active ? <span class="hljs-literal">false</span> : selectedIndex );
				<span class="hljs-keyword">return</span>;
			<span class="hljs-keyword">default</span>:
				<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1013">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1013">&#182;</a>
              </div>
              <p>Focus the appropriate tab, based on which key was pressed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		event.preventDefault();
		clearTimeout( <span class="hljs-keyword">this</span>.activating );
		selectedIndex = <span class="hljs-keyword">this</span>._focusNextTab( selectedIndex, goingForward );</pre></div></div>
            
        </li>
        
        
        <li id="section-1014">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1014">&#182;</a>
              </div>
              <p>Navigating with control key will prevent automatic activation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !event.ctrlKey ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-1015">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1015">&#182;</a>
              </div>
              <p>Update aria-selected immediately so that AT think the tab is already selected.
Otherwise AT may confuse the user by stating that they need to activate the tab,
but the tab will already be activated by the time the announcement finishes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			focusedTab.attr( <span class="hljs-string">"aria-selected"</span>, <span class="hljs-string">"false"</span> );
			<span class="hljs-keyword">this</span>.tabs.eq( selectedIndex ).attr( <span class="hljs-string">"aria-selected"</span>, <span class="hljs-string">"true"</span> );

			<span class="hljs-keyword">this</span>.activating = <span class="hljs-keyword">this</span>._delay(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>.option( <span class="hljs-string">"active"</span>, selectedIndex );
			}, <span class="hljs-keyword">this</span>.delay );
		}
	},

	_panelKeydown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>._handlePageNav( event ) ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1016">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1016">&#182;</a>
              </div>
              <p>Ctrl+up moves focus to the current tab</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( event.ctrlKey &amp;&amp; event.keyCode === $.ui.keyCode.UP ) {
			event.preventDefault();
			<span class="hljs-keyword">this</span>.active.focus();
		}
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-1017">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1017">&#182;</a>
              </div>
              <p>Alt+page up/down moves focus to the previous/next tab (and activates)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_handlePageNav: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">if</span> ( event.altKey &amp;&amp; event.keyCode === $.ui.keyCode.PAGE_UP ) {
			<span class="hljs-keyword">this</span>._activate( <span class="hljs-keyword">this</span>._focusNextTab( <span class="hljs-keyword">this</span>.options.active - <span class="hljs-number">1</span>, <span class="hljs-literal">false</span> ) );
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		}
		<span class="hljs-keyword">if</span> ( event.altKey &amp;&amp; event.keyCode === $.ui.keyCode.PAGE_DOWN ) {
			<span class="hljs-keyword">this</span>._activate( <span class="hljs-keyword">this</span>._focusNextTab( <span class="hljs-keyword">this</span>.options.active + <span class="hljs-number">1</span>, <span class="hljs-literal">true</span> ) );
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		}
	},

	_findNextTab: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index, goingForward )</span> {</span>
		<span class="hljs-keyword">var</span> lastTabIndex = <span class="hljs-keyword">this</span>.tabs.length - <span class="hljs-number">1</span>;

		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">constrain</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( index &gt; lastTabIndex ) {
				index = <span class="hljs-number">0</span>;
			}
			<span class="hljs-keyword">if</span> ( index &lt; <span class="hljs-number">0</span> ) {
				index = lastTabIndex;
			}
			<span class="hljs-keyword">return</span> index;
		}

		<span class="hljs-keyword">while</span> ( $.inArray( constrain(), <span class="hljs-keyword">this</span>.options.disabled ) !== -<span class="hljs-number">1</span> ) {
			index = goingForward ? index + <span class="hljs-number">1</span> : index - <span class="hljs-number">1</span>;
		}

		<span class="hljs-keyword">return</span> index;
	},

	_focusNextTab: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index, goingForward )</span> {</span>
		index = <span class="hljs-keyword">this</span>._findNextTab( index, goingForward );
		<span class="hljs-keyword">this</span>.tabs.eq( index ).focus();
		<span class="hljs-keyword">return</span> index;
	},

	_setOption: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( key, value )</span> {</span>
		<span class="hljs-keyword">if</span> ( key === <span class="hljs-string">"active"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-1018">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1018">&#182;</a>
              </div>
              <p>_activate() will handle invalid values and update this.options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._activate( value );
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( key === <span class="hljs-string">"disabled"</span> ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-1019">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1019">&#182;</a>
              </div>
              <p>don’t use the widget factory’s disabled handling</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">this</span>._setupDisabled( value );
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>._super( key, value);

		<span class="hljs-keyword">if</span> ( key === <span class="hljs-string">"collapsible"</span> ) {
			<span class="hljs-keyword">this</span>.element.toggleClass( <span class="hljs-string">"ui-tabs-collapsible"</span>, value );</pre></div></div>
            
        </li>
        
        
        <li id="section-1020">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1020">&#182;</a>
              </div>
              <p>Setting collapsible: false while collapsed; open first panel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !value &amp;&amp; <span class="hljs-keyword">this</span>.options.active === <span class="hljs-literal">false</span> ) {
				<span class="hljs-keyword">this</span>._activate( <span class="hljs-number">0</span> );
			}
		}

		<span class="hljs-keyword">if</span> ( key === <span class="hljs-string">"event"</span> ) {
			<span class="hljs-keyword">this</span>._setupEvents( value );
		}

		<span class="hljs-keyword">if</span> ( key === <span class="hljs-string">"heightStyle"</span> ) {
			<span class="hljs-keyword">this</span>._setupHeightStyle( value );
		}
	},

	_tabId: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( tab )</span> {</span>
		<span class="hljs-keyword">return</span> tab.attr( <span class="hljs-string">"aria-controls"</span> ) || <span class="hljs-string">"ui-tabs-"</span> + getNextTabId();
	},

	_sanitizeSelector: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( hash )</span> {</span>
		<span class="hljs-keyword">return</span> hash ? hash.replace( <span class="hljs-regexp">/[!"$%&amp;'()*+,.\/:;&lt;=&gt;?@\[\]\^`{|}~]/g</span>, <span class="hljs-string">"\\$&amp;"</span> ) : <span class="hljs-string">""</span>;
	},

	refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
			lis = <span class="hljs-keyword">this</span>.tablist.children( <span class="hljs-string">":has(a[href])"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-1021">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1021">&#182;</a>
              </div>
              <p>get disabled tabs from class attribute from HTML
this will get converted to a boolean if needed in _refresh()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		options.disabled = $.map( lis.filter( <span class="hljs-string">".ui-state-disabled"</span> ), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( tab )</span> {</span>
			<span class="hljs-keyword">return</span> lis.index( tab );
		});

		<span class="hljs-keyword">this</span>._processTabs();</pre></div></div>
            
        </li>
        
        
        <li id="section-1022">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1022">&#182;</a>
              </div>
              <p>was collapsed or no tabs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( options.active === <span class="hljs-literal">false</span> || !<span class="hljs-keyword">this</span>.anchors.length ) {
			options.active = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">this</span>.active = $();</pre></div></div>
            
        </li>
        
        
        <li id="section-1023">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1023">&#182;</a>
              </div>
              <p>was active, but active tab is gone</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.active.length &amp;&amp; !$.contains( <span class="hljs-keyword">this</span>.tablist[ <span class="hljs-number">0</span> ], <span class="hljs-keyword">this</span>.active[ <span class="hljs-number">0</span> ] ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-1024">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1024">&#182;</a>
              </div>
              <p>all remaining tabs are disabled</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.tabs.length === options.disabled.length ) {
				options.active = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">this</span>.active = $();</pre></div></div>
            
        </li>
        
        
        <li id="section-1025">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1025">&#182;</a>
              </div>
              <p>activate previous tab</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			} <span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>._activate( <span class="hljs-keyword">this</span>._findNextTab( <span class="hljs-built_in">Math</span>.max( <span class="hljs-number">0</span>, options.active - <span class="hljs-number">1</span> ), <span class="hljs-literal">false</span> ) );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-1026">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1026">&#182;</a>
              </div>
              <p>was active, active tab still exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-1027">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1027">&#182;</a>
              </div>
              <p>make sure active index is correct</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			options.active = <span class="hljs-keyword">this</span>.tabs.index( <span class="hljs-keyword">this</span>.active );
		}

		<span class="hljs-keyword">this</span>._refresh();
	},

	_refresh: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">this</span>._setupDisabled( <span class="hljs-keyword">this</span>.options.disabled );
		<span class="hljs-keyword">this</span>._setupEvents( <span class="hljs-keyword">this</span>.options.event );
		<span class="hljs-keyword">this</span>._setupHeightStyle( <span class="hljs-keyword">this</span>.options.heightStyle );

		<span class="hljs-keyword">this</span>.tabs.not( <span class="hljs-keyword">this</span>.active ).attr({
			<span class="hljs-string">"aria-selected"</span>: <span class="hljs-string">"false"</span>,
			tabIndex: -<span class="hljs-number">1</span>
		});
		<span class="hljs-keyword">this</span>.panels.not( <span class="hljs-keyword">this</span>._getPanelForTab( <span class="hljs-keyword">this</span>.active ) )
			.hide()
			.attr({
				<span class="hljs-string">"aria-expanded"</span>: <span class="hljs-string">"false"</span>,
				<span class="hljs-string">"aria-hidden"</span>: <span class="hljs-string">"true"</span>
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-1028">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1028">&#182;</a>
              </div>
              <p>Make sure one tab is in the tab order</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !<span class="hljs-keyword">this</span>.active.length ) {
			<span class="hljs-keyword">this</span>.tabs.eq( <span class="hljs-number">0</span> ).attr( <span class="hljs-string">"tabIndex"</span>, <span class="hljs-number">0</span> );
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">this</span>.active
				.addClass( <span class="hljs-string">"ui-tabs-active ui-state-active"</span> )
				.attr({
					<span class="hljs-string">"aria-selected"</span>: <span class="hljs-string">"true"</span>,
					tabIndex: <span class="hljs-number">0</span>
				});
			<span class="hljs-keyword">this</span>._getPanelForTab( <span class="hljs-keyword">this</span>.active )
				.show()
				.attr({
					<span class="hljs-string">"aria-expanded"</span>: <span class="hljs-string">"true"</span>,
					<span class="hljs-string">"aria-hidden"</span>: <span class="hljs-string">"false"</span>
				});
		}
	},

	_processTabs: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;

		<span class="hljs-keyword">this</span>.tablist = <span class="hljs-keyword">this</span>._getList()
			.addClass( <span class="hljs-string">"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"</span> )
			.attr( <span class="hljs-string">"role"</span>, <span class="hljs-string">"tablist"</span> );

		<span class="hljs-keyword">this</span>.tabs = <span class="hljs-keyword">this</span>.tablist.find( <span class="hljs-string">"&gt; li:has(a[href])"</span> )
			.addClass( <span class="hljs-string">"ui-state-default ui-corner-top"</span> )
			.attr({
				role: <span class="hljs-string">"tab"</span>,
				tabIndex: -<span class="hljs-number">1</span>
			});

		<span class="hljs-keyword">this</span>.anchors = <span class="hljs-keyword">this</span>.tabs.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">return</span> $( <span class="hljs-string">"a"</span>, <span class="hljs-keyword">this</span> )[ <span class="hljs-number">0</span> ];
			})
			.addClass( <span class="hljs-string">"ui-tabs-anchor"</span> )
			.attr({
				role: <span class="hljs-string">"presentation"</span>,
				tabIndex: -<span class="hljs-number">1</span>
			});

		<span class="hljs-keyword">this</span>.panels = $();

		<span class="hljs-keyword">this</span>.anchors.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( i, anchor )</span> {</span>
			<span class="hljs-keyword">var</span> selector, panel, panelId,
				anchorId = $( anchor ).uniqueId().attr( <span class="hljs-string">"id"</span> ),
				tab = $( anchor ).closest( <span class="hljs-string">"li"</span> ),
				originalAriaControls = tab.attr( <span class="hljs-string">"aria-controls"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-1029">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1029">&#182;</a>
              </div>
              <p>inline tab</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( isLocal( anchor ) ) {
				selector = anchor.hash;
				panel = that.element.find( that._sanitizeSelector( selector ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-1030">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1030">&#182;</a>
              </div>
              <p>remote tab</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			} <span class="hljs-keyword">else</span> {
				panelId = that._tabId( tab );
				selector = <span class="hljs-string">"#"</span> + panelId;
				panel = that.element.find( selector );
				<span class="hljs-keyword">if</span> ( !panel.length ) {
					panel = that._createPanel( panelId );
					panel.insertAfter( that.panels[ i - <span class="hljs-number">1</span> ] || that.tablist );
				}
				panel.attr( <span class="hljs-string">"aria-live"</span>, <span class="hljs-string">"polite"</span> );
			}

			<span class="hljs-keyword">if</span> ( panel.length) {
				that.panels = that.panels.add( panel );
			}
			<span class="hljs-keyword">if</span> ( originalAriaControls ) {
				tab.data( <span class="hljs-string">"ui-tabs-aria-controls"</span>, originalAriaControls );
			}
			tab.attr({
				<span class="hljs-string">"aria-controls"</span>: selector.substring( <span class="hljs-number">1</span> ),
				<span class="hljs-string">"aria-labelledby"</span>: anchorId
			});
			panel.attr( <span class="hljs-string">"aria-labelledby"</span>, anchorId );
		});

		<span class="hljs-keyword">this</span>.panels
			.addClass( <span class="hljs-string">"ui-tabs-panel ui-widget-content ui-corner-bottom"</span> )
			.attr( <span class="hljs-string">"role"</span>, <span class="hljs-string">"tabpanel"</span> );
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-1031">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1031">&#182;</a>
              </div>
              <p>allow overriding how to find the list for rare usage scenarios (#7715)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_getList: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.element.find( <span class="hljs-string">"ol,ul"</span> ).eq( <span class="hljs-number">0</span> );
	},

	_createPanel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( id )</span> {</span>
		<span class="hljs-keyword">return</span> $( <span class="hljs-string">"&lt;div&gt;"</span> )
			.attr( <span class="hljs-string">"id"</span>, id )
			.addClass( <span class="hljs-string">"ui-tabs-panel ui-widget-content ui-corner-bottom"</span> )
			.data( <span class="hljs-string">"ui-tabs-destroy"</span>, <span class="hljs-literal">true</span> );
	},

	_setupDisabled: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( disabled )</span> {</span>
		<span class="hljs-keyword">if</span> ( $.isArray( disabled ) ) {
			<span class="hljs-keyword">if</span> ( !disabled.length ) {
				disabled = <span class="hljs-literal">false</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( disabled.length === <span class="hljs-keyword">this</span>.anchors.length ) {
				disabled = <span class="hljs-literal">true</span>;
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1032">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1032">&#182;</a>
              </div>
              <p>disable tabs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, li; ( li = <span class="hljs-keyword">this</span>.tabs[ i ] ); i++ ) {
			<span class="hljs-keyword">if</span> ( disabled === <span class="hljs-literal">true</span> || $.inArray( i, disabled ) !== -<span class="hljs-number">1</span> ) {
				$( li )
					.addClass( <span class="hljs-string">"ui-state-disabled"</span> )
					.attr( <span class="hljs-string">"aria-disabled"</span>, <span class="hljs-string">"true"</span> );
			} <span class="hljs-keyword">else</span> {
				$( li )
					.removeClass( <span class="hljs-string">"ui-state-disabled"</span> )
					.removeAttr( <span class="hljs-string">"aria-disabled"</span> );
			}
		}

		<span class="hljs-keyword">this</span>.options.disabled = disabled;
	},

	_setupEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">var</span> events = {
			click: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
				event.preventDefault();
			}
		};
		<span class="hljs-keyword">if</span> ( event ) {
			$.each( event.split(<span class="hljs-string">" "</span>), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index, eventName )</span> {</span>
				events[ eventName ] = <span class="hljs-string">"_eventHandler"</span>;
			});
		}

		<span class="hljs-keyword">this</span>._off( <span class="hljs-keyword">this</span>.anchors.add( <span class="hljs-keyword">this</span>.tabs ).add( <span class="hljs-keyword">this</span>.panels ) );
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.anchors, events );
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.tabs, { keydown: <span class="hljs-string">"_tabKeydown"</span> } );
		<span class="hljs-keyword">this</span>._on( <span class="hljs-keyword">this</span>.panels, { keydown: <span class="hljs-string">"_panelKeydown"</span> } );

		<span class="hljs-keyword">this</span>._focusable( <span class="hljs-keyword">this</span>.tabs );
		<span class="hljs-keyword">this</span>._hoverable( <span class="hljs-keyword">this</span>.tabs );
	},

	_setupHeightStyle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( heightStyle )</span> {</span>
		<span class="hljs-keyword">var</span> maxHeight,
			parent = <span class="hljs-keyword">this</span>.element.parent();

		<span class="hljs-keyword">if</span> ( heightStyle === <span class="hljs-string">"fill"</span> ) {
			maxHeight = parent.height();
			maxHeight -= <span class="hljs-keyword">this</span>.element.outerHeight() - <span class="hljs-keyword">this</span>.element.height();

			<span class="hljs-keyword">this</span>.element.siblings( <span class="hljs-string">":visible"</span> ).each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> elem = $( <span class="hljs-keyword">this</span> ),
					position = elem.css( <span class="hljs-string">"position"</span> );

				<span class="hljs-keyword">if</span> ( position === <span class="hljs-string">"absolute"</span> || position === <span class="hljs-string">"fixed"</span> ) {
					<span class="hljs-keyword">return</span>;
				}
				maxHeight -= elem.outerHeight( <span class="hljs-literal">true</span> );
			});

			<span class="hljs-keyword">this</span>.element.children().not( <span class="hljs-keyword">this</span>.panels ).each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				maxHeight -= $( <span class="hljs-keyword">this</span> ).outerHeight( <span class="hljs-literal">true</span> );
			});

			<span class="hljs-keyword">this</span>.panels.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				$( <span class="hljs-keyword">this</span> ).height( <span class="hljs-built_in">Math</span>.max( <span class="hljs-number">0</span>, maxHeight -
					$( <span class="hljs-keyword">this</span> ).innerHeight() + $( <span class="hljs-keyword">this</span> ).height() ) );
			})
			.css( <span class="hljs-string">"overflow"</span>, <span class="hljs-string">"auto"</span> );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( heightStyle === <span class="hljs-string">"auto"</span> ) {
			maxHeight = <span class="hljs-number">0</span>;
			<span class="hljs-keyword">this</span>.panels.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				maxHeight = <span class="hljs-built_in">Math</span>.max( maxHeight, $( <span class="hljs-keyword">this</span> ).height( <span class="hljs-string">""</span> ).height() );
			}).height( maxHeight );
		}
	},

	_eventHandler: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event )</span> {</span>
		<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
			active = <span class="hljs-keyword">this</span>.active,
			anchor = $( event.currentTarget ),
			tab = anchor.closest( <span class="hljs-string">"li"</span> ),
			clickedIsActive = tab[ <span class="hljs-number">0</span> ] === active[ <span class="hljs-number">0</span> ],
			collapsing = clickedIsActive &amp;&amp; options.collapsible,
			toShow = collapsing ? $() : <span class="hljs-keyword">this</span>._getPanelForTab( tab ),
			toHide = !active.length ? $() : <span class="hljs-keyword">this</span>._getPanelForTab( active ),
			eventData = {
				oldTab: active,
				oldPanel: toHide,
				newTab: collapsing ? $() : tab,
				newPanel: toShow
			};

		event.preventDefault();

		<span class="hljs-keyword">if</span> ( tab.hasClass( <span class="hljs-string">"ui-state-disabled"</span> ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-1033">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1033">&#182;</a>
              </div>
              <p>tab is already loading</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				tab.hasClass( <span class="hljs-string">"ui-tabs-loading"</span> ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-1034">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1034">&#182;</a>
              </div>
              <p>can’t switch durning an animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">this</span>.running ||</pre></div></div>
            
        </li>
        
        
        <li id="section-1035">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1035">&#182;</a>
              </div>
              <p>click on active header, but not collapsible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				( clickedIsActive &amp;&amp; !options.collapsible ) ||</pre></div></div>
            
        </li>
        
        
        <li id="section-1036">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1036">&#182;</a>
              </div>
              <p>allow canceling activation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				( <span class="hljs-keyword">this</span>._trigger( <span class="hljs-string">"beforeActivate"</span>, event, eventData ) === <span class="hljs-literal">false</span> ) ) {
			<span class="hljs-keyword">return</span>;
		}

		options.active = collapsing ? <span class="hljs-literal">false</span> : <span class="hljs-keyword">this</span>.tabs.index( tab );

		<span class="hljs-keyword">this</span>.active = clickedIsActive ? $() : tab;
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.xhr ) {
			<span class="hljs-keyword">this</span>.xhr.abort();
		}

		<span class="hljs-keyword">if</span> ( !toHide.length &amp;&amp; !toShow.length ) {
			$.error( <span class="hljs-string">"jQuery UI Tabs: Mismatching fragment identifier."</span> );
		}

		<span class="hljs-keyword">if</span> ( toShow.length ) {
			<span class="hljs-keyword">this</span>.load( <span class="hljs-keyword">this</span>.tabs.index( tab ), event );
		}
		<span class="hljs-keyword">this</span>._toggle( event, eventData );
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-1037">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1037">&#182;</a>
              </div>
              <p>handles show/hide for selecting tabs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	_toggle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( event, eventData )</span> {</span>
		<span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>,
			toShow = eventData.newPanel,
			toHide = eventData.oldPanel;

		<span class="hljs-keyword">this</span>.running = <span class="hljs-literal">true</span>;

		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complete</span><span class="hljs-params">()</span> {</span>
			that.running = <span class="hljs-literal">false</span>;
			that._trigger( <span class="hljs-string">"activate"</span>, event, eventData );
		}

		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span><span class="hljs-params">()</span> {</span>
			eventData.newTab.closest( <span class="hljs-string">"li"</span> ).addClass( <span class="hljs-string">"ui-tabs-active ui-state-active"</span> );

			<span class="hljs-keyword">if</span> ( toShow.length &amp;&amp; that.options.show ) {
				that._show( toShow, that.options.show, complete );
			} <span class="hljs-keyword">else</span> {
				toShow.show();
				complete();
			}
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1038">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1038">&#182;</a>
              </div>
              <p>start out by hiding, then showing, then completing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( toHide.length &amp;&amp; <span class="hljs-keyword">this</span>.options.hide ) {
			<span class="hljs-keyword">this</span>._hide( toHide, <span class="hljs-keyword">this</span>.options.hide, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				eventData.oldTab.closest( <span class="hljs-string">"li"</span> ).removeClass( <span class="hljs-string">"ui-tabs-active ui-state-active"</span> );
				show();
			});
		} <span class="hljs-keyword">else</span> {
			eventData.oldTab.closest( <span class="hljs-string">"li"</span> ).removeClass( <span class="hljs-string">"ui-tabs-active ui-state-active"</span> );
			toHide.hide();
			show();
		}

		toHide.attr({
			<span class="hljs-string">"aria-expanded"</span>: <span class="hljs-string">"false"</span>,
			<span class="hljs-string">"aria-hidden"</span>: <span class="hljs-string">"true"</span>
		});
		eventData.oldTab.attr( <span class="hljs-string">"aria-selected"</span>, <span class="hljs-string">"false"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-1039">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1039">&#182;</a>
              </div>
              <p>If we’re switching tabs, remove the old tab from the tab order.
If we’re opening from collapsed state, remove the previous tab from the tab order.
If we’re collapsing, then keep the collapsing tab in the tab order.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( toShow.length &amp;&amp; toHide.length ) {
			eventData.oldTab.attr( <span class="hljs-string">"tabIndex"</span>, -<span class="hljs-number">1</span> );
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( toShow.length ) {
			<span class="hljs-keyword">this</span>.tabs.filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">return</span> $( <span class="hljs-keyword">this</span> ).attr( <span class="hljs-string">"tabIndex"</span> ) === <span class="hljs-number">0</span>;
			})
			.attr( <span class="hljs-string">"tabIndex"</span>, -<span class="hljs-number">1</span> );
		}

		toShow.attr({
			<span class="hljs-string">"aria-expanded"</span>: <span class="hljs-string">"true"</span>,
			<span class="hljs-string">"aria-hidden"</span>: <span class="hljs-string">"false"</span>
		});
		eventData.newTab.attr({
			<span class="hljs-string">"aria-selected"</span>: <span class="hljs-string">"true"</span>,
			tabIndex: <span class="hljs-number">0</span>
		});
	},

	_activate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index )</span> {</span>
		<span class="hljs-keyword">var</span> anchor,
			active = <span class="hljs-keyword">this</span>._findActive( index );</pre></div></div>
            
        </li>
        
        
        <li id="section-1040">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1040">&#182;</a>
              </div>
              <p>trying to activate the already active panel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( active[ <span class="hljs-number">0</span> ] === <span class="hljs-keyword">this</span>.active[ <span class="hljs-number">0</span> ] ) {
			<span class="hljs-keyword">return</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1041">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1041">&#182;</a>
              </div>
              <p>trying to collapse, simulate a click on the current active header</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !active.length ) {
			active = <span class="hljs-keyword">this</span>.active;
		}

		anchor = active.find( <span class="hljs-string">".ui-tabs-anchor"</span> )[ <span class="hljs-number">0</span> ];
		<span class="hljs-keyword">this</span>._eventHandler({
			target: anchor,
			currentTarget: anchor,
			preventDefault: $.noop
		});
	},

	_findActive: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index )</span> {</span>
		<span class="hljs-keyword">return</span> index === <span class="hljs-literal">false</span> ? $() : <span class="hljs-keyword">this</span>.tabs.eq( index );
	},

	_getIndex: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-1042">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1042">&#182;</a>
              </div>
              <p>meta-function to give users option to provide a href string instead of a numerical index.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> index === <span class="hljs-string">"string"</span> ) {
			index = <span class="hljs-keyword">this</span>.anchors.index( <span class="hljs-keyword">this</span>.anchors.filter( <span class="hljs-string">"[href$='"</span> + index + <span class="hljs-string">"']"</span> ) );
		}

		<span class="hljs-keyword">return</span> index;
	},

	_destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.xhr ) {
			<span class="hljs-keyword">this</span>.xhr.abort();
		}

		<span class="hljs-keyword">this</span>.element.removeClass( <span class="hljs-string">"ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"</span> );

		<span class="hljs-keyword">this</span>.tablist
			.removeClass( <span class="hljs-string">"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"</span> )
			.removeAttr( <span class="hljs-string">"role"</span> );

		<span class="hljs-keyword">this</span>.anchors
			.removeClass( <span class="hljs-string">"ui-tabs-anchor"</span> )
			.removeAttr( <span class="hljs-string">"role"</span> )
			.removeAttr( <span class="hljs-string">"tabIndex"</span> )
			.removeUniqueId();

		<span class="hljs-keyword">this</span>.tabs.add( <span class="hljs-keyword">this</span>.panels ).each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span> ( $.data( <span class="hljs-keyword">this</span>, <span class="hljs-string">"ui-tabs-destroy"</span> ) ) {
				$( <span class="hljs-keyword">this</span> ).remove();
			} <span class="hljs-keyword">else</span> {
				$( <span class="hljs-keyword">this</span> )
					.removeClass( <span class="hljs-string">"ui-state-default ui-state-active ui-state-disabled "</span> +
						<span class="hljs-string">"ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel"</span> )
					.removeAttr( <span class="hljs-string">"tabIndex"</span> )
					.removeAttr( <span class="hljs-string">"aria-live"</span> )
					.removeAttr( <span class="hljs-string">"aria-busy"</span> )
					.removeAttr( <span class="hljs-string">"aria-selected"</span> )
					.removeAttr( <span class="hljs-string">"aria-labelledby"</span> )
					.removeAttr( <span class="hljs-string">"aria-hidden"</span> )
					.removeAttr( <span class="hljs-string">"aria-expanded"</span> )
					.removeAttr( <span class="hljs-string">"role"</span> );
			}
		});

		<span class="hljs-keyword">this</span>.tabs.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> li = $( <span class="hljs-keyword">this</span> ),
				prev = li.data( <span class="hljs-string">"ui-tabs-aria-controls"</span> );
			<span class="hljs-keyword">if</span> ( prev ) {
				li
					.attr( <span class="hljs-string">"aria-controls"</span>, prev )
					.removeData( <span class="hljs-string">"ui-tabs-aria-controls"</span> );
			} <span class="hljs-keyword">else</span> {
				li.removeAttr( <span class="hljs-string">"aria-controls"</span> );
			}
		});

		<span class="hljs-keyword">this</span>.panels.show();

		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.options.heightStyle !== <span class="hljs-string">"content"</span> ) {
			<span class="hljs-keyword">this</span>.panels.css( <span class="hljs-string">"height"</span>, <span class="hljs-string">""</span> );
		}
	},

	enable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index )</span> {</span>
		<span class="hljs-keyword">var</span> disabled = <span class="hljs-keyword">this</span>.options.disabled;
		<span class="hljs-keyword">if</span> ( disabled === <span class="hljs-literal">false</span> ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( index === <span class="hljs-literal">undefined</span> ) {
			disabled = <span class="hljs-literal">false</span>;
		} <span class="hljs-keyword">else</span> {
			index = <span class="hljs-keyword">this</span>._getIndex( index );
			<span class="hljs-keyword">if</span> ( $.isArray( disabled ) ) {
				disabled = $.map( disabled, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( num )</span> {</span>
					<span class="hljs-keyword">return</span> num !== index ? num : <span class="hljs-literal">null</span>;
				});
			} <span class="hljs-keyword">else</span> {
				disabled = $.map( <span class="hljs-keyword">this</span>.tabs, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( li, num )</span> {</span>
					<span class="hljs-keyword">return</span> num !== index ? num : <span class="hljs-literal">null</span>;
				});
			}
		}
		<span class="hljs-keyword">this</span>._setupDisabled( disabled );
	},

	disable: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index )</span> {</span>
		<span class="hljs-keyword">var</span> disabled = <span class="hljs-keyword">this</span>.options.disabled;
		<span class="hljs-keyword">if</span> ( disabled === <span class="hljs-literal">true</span> ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> ( index === <span class="hljs-literal">undefined</span> ) {
			disabled = <span class="hljs-literal">true</span>;
		} <span class="hljs-keyword">else</span> {
			index = <span class="hljs-keyword">this</span>._getIndex( index );
			<span class="hljs-keyword">if</span> ( $.inArray( index, disabled ) !== -<span class="hljs-number">1</span> ) {
				<span class="hljs-keyword">return</span>;
			}
			<span class="hljs-keyword">if</span> ( $.isArray( disabled ) ) {
				disabled = $.merge( [ index ], disabled ).sort();
			} <span class="hljs-keyword">else</span> {
				disabled = [ index ];
			}
		}
		<span class="hljs-keyword">this</span>._setupDisabled( disabled );
	},

	load: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( index, event )</span> {</span>
		index = <span class="hljs-keyword">this</span>._getIndex( index );
		<span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>,
			tab = <span class="hljs-keyword">this</span>.tabs.eq( index ),
			anchor = tab.find( <span class="hljs-string">".ui-tabs-anchor"</span> ),
			panel = <span class="hljs-keyword">this</span>._getPanelForTab( tab ),
			eventData = {
				tab: tab,
				panel: panel
			};</pre></div></div>
            
        </li>
        
        
        <li id="section-1043">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1043">&#182;</a>
              </div>
              <p>not remote</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( isLocal( anchor[ <span class="hljs-number">0</span> ] ) ) {
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">this</span>.xhr = $.ajax( <span class="hljs-keyword">this</span>._ajaxSettings( anchor, event, eventData ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-1044">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1044">&#182;</a>
              </div>
              <p>support: jQuery &lt;1.8
jQuery &lt;1.8 returns false if the request is canceled in beforeSend,
but as of 1.8, $.ajax() always returns a jqXHR object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.xhr &amp;&amp; <span class="hljs-keyword">this</span>.xhr.statusText !== <span class="hljs-string">"canceled"</span> ) {
			tab.addClass( <span class="hljs-string">"ui-tabs-loading"</span> );
			panel.attr( <span class="hljs-string">"aria-busy"</span>, <span class="hljs-string">"true"</span> );

			<span class="hljs-keyword">this</span>.xhr
				.success(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( response )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-1045">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1045">&#182;</a>
              </div>
              <p>support: jQuery &lt;1.8
<a href="http://bugs.jquery.com/ticket/11778">http://bugs.jquery.com/ticket/11778</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
						panel.html( response );
						that._trigger( <span class="hljs-string">"load"</span>, event, eventData );
					}, <span class="hljs-number">1</span> );
				})
				.complete(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( jqXHR, status )</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-1046">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1046">&#182;</a>
              </div>
              <p>support: jQuery &lt;1.8
<a href="http://bugs.jquery.com/ticket/11778">http://bugs.jquery.com/ticket/11778</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">if</span> ( status === <span class="hljs-string">"abort"</span> ) {
							that.panels.stop( <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span> );
						}

						tab.removeClass( <span class="hljs-string">"ui-tabs-loading"</span> );
						panel.removeAttr( <span class="hljs-string">"aria-busy"</span> );

						<span class="hljs-keyword">if</span> ( jqXHR === that.xhr ) {
							<span class="hljs-keyword">delete</span> that.xhr;
						}
					}, <span class="hljs-number">1</span> );
				});
		}
	},

	_ajaxSettings: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( anchor, event, eventData )</span> {</span>
		<span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;
		<span class="hljs-keyword">return</span> {
			url: anchor.attr( <span class="hljs-string">"href"</span> ),
			beforeSend: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( jqXHR, settings )</span> {</span>
				<span class="hljs-keyword">return</span> that._trigger( <span class="hljs-string">"beforeLoad"</span>, event,
					$.extend( { jqXHR : jqXHR, ajaxSettings: settings }, eventData ) );
			}
		};
	},

	_getPanelForTab: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( tab )</span> {</span>
		<span class="hljs-keyword">var</span> id = $( tab ).attr( <span class="hljs-string">"aria-controls"</span> );
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.element.find( <span class="hljs-keyword">this</span>._sanitizeSelector( <span class="hljs-string">"#"</span> + id ) );
	}
});

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, undefined )</span> {</span>

})( jQuery );

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window )</span> {</span>

	$.mobile.iosorientationfixEnabled = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-1047">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1047">&#182;</a>
              </div>
              <p>This fix addresses an iOS bug, so return early if the UA claims it’s something else.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> ua = navigator.userAgent,
		zoom,
		evt, x, y, z, aig;
	<span class="hljs-keyword">if</span> ( !( <span class="hljs-regexp">/iPhone|iPad|iPod/</span>.test( navigator.platform ) &amp;&amp; <span class="hljs-regexp">/OS [1-5]_[0-9_]* like Mac OS X/i</span>.test( ua ) &amp;&amp; ua.indexOf( <span class="hljs-string">"AppleWebKit"</span> ) &gt; -<span class="hljs-number">1</span> ) ) {
		$.mobile.iosorientationfixEnabled = <span class="hljs-literal">false</span>;
		<span class="hljs-keyword">return</span>;
	}

	zoom = $.mobile.zoom;

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkTilt</span><span class="hljs-params">( e )</span> {</span>
		evt = e.originalEvent;
		aig = evt.accelerationIncludingGravity;

		x = <span class="hljs-built_in">Math</span>.abs( aig.x );
		y = <span class="hljs-built_in">Math</span>.abs( aig.y );
		z = <span class="hljs-built_in">Math</span>.abs( aig.z );</pre></div></div>
            
        </li>
        
        
        <li id="section-1048">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1048">&#182;</a>
              </div>
              <p>If portrait orientation and in one of the danger zones</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !window.orientation &amp;&amp; ( x &gt; <span class="hljs-number">7</span> || ( ( z &gt; <span class="hljs-number">6</span> &amp;&amp; y &lt; <span class="hljs-number">8</span> || z &lt; <span class="hljs-number">8</span> &amp;&amp; y &gt; <span class="hljs-number">6</span> ) &amp;&amp; x &gt; <span class="hljs-number">5</span> ) ) ) {
				<span class="hljs-keyword">if</span> ( zoom.enabled ) {
					zoom.disable();
				}
		}	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( !zoom.enabled ) {
				zoom.enable();
		}
	}

	$.mobile.document.on( <span class="hljs-string">"mobileinit"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
		<span class="hljs-keyword">if</span> ( $.mobile.iosorientationfixEnabled ) {
			$.mobile.window
				.bind( <span class="hljs-string">"orientationchange.iosorientationfix"</span>, zoom.enable )
				.bind( <span class="hljs-string">"devicemotion.iosorientationfix"</span>, checkTilt );
		}
	});

}( jQuery, <span class="hljs-keyword">this</span> ));

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( $, window, undefined )</span> {</span>
	<span class="hljs-keyword">var</span>	$html = $( <span class="hljs-string">"html"</span> ),
		$window = $.mobile.window;</pre></div></div>
            
        </li>
        
        
        <li id="section-1049">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1049">&#182;</a>
              </div>
              <p>remove initial build class (only present on first pageshow)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideRenderingClass</span><span class="hljs-params">()</span> {</span>
		$html.removeClass( <span class="hljs-string">"ui-mobile-rendering"</span> );
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-1050">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1050">&#182;</a>
              </div>
              <p>trigger mobileinit event - useful hook for configuring $.mobile settings before they’re used</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$( window.document ).trigger( <span class="hljs-string">"mobileinit"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-1051">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1051">&#182;</a>
              </div>
              <p>support conditions
if device support condition(s) aren’t met, leave things as they are -&gt; a basic, usable experience,
otherwise, proceed with the enhancements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( !$.mobile.gradeA() ) {
		<span class="hljs-keyword">return</span>;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-1052">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1052">&#182;</a>
              </div>
              <p>override ajaxEnabled on platforms that have known conflicts with hash history updates
or generally work better browsing in regular http for full page refreshes (BB5, Opera Mini)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( $.mobile.ajaxBlacklist ) {
		$.mobile.ajaxEnabled = <span class="hljs-literal">false</span>;
	}</pre></div></div>
            
        </li>
        
        
        <li id="section-1053">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1053">&#182;</a>
              </div>
              <p>Add mobile, initial load “rendering” classes to docEl</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	$html.addClass( <span class="hljs-string">"ui-mobile ui-mobile-rendering"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-1054">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1054">&#182;</a>
              </div>
              <p>This is a fallback. If anything goes wrong (JS errors, etc), or events don’t fire,
this ensures the rendering class is removed after 5 seconds, so content is visible and accessible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	setTimeout( hideRenderingClass, <span class="hljs-number">5000</span> );

	$.extend( $.mobile, {</pre></div></div>
            
        </li>
        
        
        <li id="section-1055">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1055">&#182;</a>
              </div>
              <p>find and enhance the pages in the dom and transition to the first page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		initializePage: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-1056">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1056">&#182;</a>
              </div>
              <p>find present pages</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">var</span> path = $.mobile.path,
				$pages = $( <span class="hljs-string">":jqmData(role='page'), :jqmData(role='dialog')"</span> ),
				hash = path.stripHash( path.stripQueryParams(path.parseLocation().hash) ),
				hashPage = document.getElementById( hash );</pre></div></div>
            
        </li>
        
        
        <li id="section-1057">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1057">&#182;</a>
              </div>
              <p>if no pages are found, create one with body’s inner html</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( !$pages.length ) {
				$pages = $( <span class="hljs-string">"body"</span> ).wrapInner( <span class="hljs-string">"&lt;div data-"</span> + $.mobile.ns + <span class="hljs-string">"role='page'&gt;&lt;/div&gt;"</span> ).children( <span class="hljs-number">0</span> );
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-1058">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1058">&#182;</a>
              </div>
              <p>add dialogs, set data-url attrs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$pages.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> $<span class="hljs-keyword">this</span> = $( <span class="hljs-keyword">this</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-1059">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1059">&#182;</a>
              </div>
              <p>unless the data url is already set set it to the pathname</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !$<span class="hljs-keyword">this</span>[ <span class="hljs-number">0</span> ].getAttribute( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"url"</span> ) ) {
					$<span class="hljs-keyword">this</span>.attr( <span class="hljs-string">"data-"</span> + $.mobile.ns + <span class="hljs-string">"url"</span>, $<span class="hljs-keyword">this</span>.attr( <span class="hljs-string">"id"</span> ) || location.pathname + location.search );
				}
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-1060">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1060">&#182;</a>
              </div>
              <p>define first page in dom case one backs out to the directory root (not always the first page visited, but defined as fallback)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.mobile.firstPage = $pages.first();</pre></div></div>
            
        </li>
        
        
        <li id="section-1061">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1061">&#182;</a>
              </div>
              <p>define page container</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.mobile.pageContainer = $.mobile.firstPage
				.parent()
				.addClass( <span class="hljs-string">"ui-mobile-viewport"</span> )
				.pagecontainer();</pre></div></div>
            
        </li>
        
        
        <li id="section-1062">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1062">&#182;</a>
              </div>
              <p>initialize navigation events now, after mobileinit has occurred and the page container
has been created but before the rest of the library is alerted to that fact</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.mobile.navreadyDeferred.resolve();</pre></div></div>
            
        </li>
        
        
        <li id="section-1063">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1063">&#182;</a>
              </div>
              <p>alert listeners that the pagecontainer has been determined for binding
to events triggered on it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$window.trigger( <span class="hljs-string">"pagecontainercreate"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-1064">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1064">&#182;</a>
              </div>
              <p>cue page loading message</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.mobile.loading( <span class="hljs-string">"show"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-1065">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1065">&#182;</a>
              </div>
              <p>remove initial build class (only present on first pageshow)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			hideRenderingClass();</pre></div></div>
            
        </li>
        
        
        <li id="section-1066">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1066">&#182;</a>
              </div>
              <p>if hashchange listening is disabled, there’s no hash deeplink,
the hash is not valid (contains more than one # or does not start with #)
or there is no page with that hash, change to the first page in the DOM
Remember, however, that the hash can also be a path!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( ! ( $.mobile.hashListeningEnabled &amp;&amp;
				$.mobile.path.isHashValid( location.hash ) &amp;&amp;
				( $( hashPage ).is( <span class="hljs-string">":jqmData(role='page')"</span> ) ||
					$.mobile.path.isPath( hash ) ||
					hash === $.mobile.dialogHashKey ) ) ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-1067">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1067">&#182;</a>
              </div>
              <p>Store the initial destination</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( $.mobile.path.isHashValid( location.hash ) ) {
					$.mobile.navigate.history.initialDst = hash.replace( <span class="hljs-string">"#"</span>, <span class="hljs-string">""</span> );
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-1068">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1068">&#182;</a>
              </div>
              <p>make sure to set initial popstate state if it exists
so that navigation back to the initial page works properly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( $.event.special.navigate.isPushStateEnabled() ) {
					$.mobile.navigate.navigator.squash( path.parseLocation().href );
				}

				$.mobile.changePage( $.mobile.firstPage, {
					transition: <span class="hljs-string">"none"</span>,
					reverse: <span class="hljs-literal">true</span>,
					changeHash: <span class="hljs-literal">false</span>,
					fromHashChange: <span class="hljs-literal">true</span>
				});
			} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-1069">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1069">&#182;</a>
              </div>
              <p>trigger hashchange or navigate to squash and record the correct
history entry for an initial hash path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( !$.event.special.navigate.isPushStateEnabled() ) {
					$window.trigger( <span class="hljs-string">"hashchange"</span>, [<span class="hljs-literal">true</span>] );
				} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-1070">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1070">&#182;</a>
              </div>
              <p>TODO figure out how to simplify this interaction with the initial history entry
at the bottom js/navigate/navigate.js</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					$.mobile.navigate.history.stack = [];
					$.mobile.navigate( $.mobile.path.isPath( location.hash ) ? location.hash : location.href );
				}
			}
		}
	});

	$(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-1071">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1071">&#182;</a>
              </div>
              <p>Run inlineSVG support test</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.support.inlineSVG();</pre></div></div>
            
        </li>
        
        
        <li id="section-1072">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1072">&#182;</a>
              </div>
              <p>check which scrollTop value should be used by scrolling to 1 immediately at domready
then check what the scroll top is. Android will report 0… others 1
note that this initial scroll won’t hide the address bar. It’s just for the check.</p>

            </div>
            
        </li>
        
        
        <li id="section-1073">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1073">&#182;</a>
              </div>
              <p>hide iOS browser chrome on load if hideUrlBar is true this is to try and do it as soon as possible</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.mobile.hideUrlBar ) {
			window.scrollTo( <span class="hljs-number">0</span>, <span class="hljs-number">1</span> );
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1074">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1074">&#182;</a>
              </div>
              <p>if defaultHomeScroll hasn’t been set yet, see if scrollTop is 1
it should be 1 in most browsers, but android treats 1 as 0 (for hiding addr bar)
so if it’s 1, use 0 from now on</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.mobile.defaultHomeScroll = ( !$.support.scrollTop || $.mobile.window.scrollTop() === <span class="hljs-number">1</span> ) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-1075">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1075">&#182;</a>
              </div>
              <p>dom-ready inits</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.mobile.autoInitializePage ) {
			$.mobile.initializePage();
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-1076">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1076">&#182;</a>
              </div>
              <p>window load event
hide iOS browser chrome on load if hideUrlBar is true this is as fall back incase we were too early before</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.mobile.hideUrlBar ) {
			$window.load( $.mobile.silentScroll );
		}

		<span class="hljs-keyword">if</span> ( !$.support.cssPointerEvents ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-1077">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1077">&#182;</a>
              </div>
              <p>IE and Opera don’t support CSS pointer-events: none that we use to disable link-based buttons
by adding the ‘ui-disabled’ class to them. Using a JavaScript workaround for those browser.
<a href="https://github.com/jquery/jquery-mobile/issues/3558">https://github.com/jquery/jquery-mobile/issues/3558</a></p>

            </div>
            
        </li>
        
        
        <li id="section-1078">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1078">&#182;</a>
              </div>
              <p>DEPRECATED as of 1.4.0 - remove ui-disabled after 1.4.0 release
only ui-state-disabled should be present thereafter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$.mobile.document.delegate( <span class="hljs-string">".ui-state-disabled,.ui-disabled"</span>, <span class="hljs-string">"vclick"</span>,
				<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> {</span>
					e.preventDefault();
					e.stopImmediatePropagation();
				}
			);
		}
	});
}( jQuery, <span class="hljs-keyword">this</span> ));


}));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
